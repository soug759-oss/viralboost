<!DOCTYPE html>
<html lang="en">
  <head>
<meta charset="UTF-8"/>
<meta name="google-site-verification" content="ILdycSKP67wnVjPFXUO7_VZfyD2q9uSMpO1YSpU5DS0" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>ViralBoost — Publish your ad, reach your target</title>
<meta name="description" content="Free platform for creators and entrepreneurs. Publish your ad in 30 seconds, find collabs, grow your audience."/>
<meta name="theme-color" content="#22c55e"/>
<meta name="apple-mobile-web-app-capable" content="yes"/>
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"/>
<meta name="apple-mobile-web-app-title" content="ViralBoost"/>
<!-- DNS prefetch pour ressources externes -->
<link rel="dns-prefetch" href="https://images.unsplash.com"/>
<link rel="dns-prefetch" href="https://cloud.umami.is"/>
<link rel="dns-prefetch" href="https://www.googletagmanager.com"/>
<link rel="dns-prefetch" href="https://placehold.co"/>
<link rel="preconnect" href="https://images.unsplash.com" crossorigin/>
<!-- Umami analytics — defer -->
<script defer src="https://cloud.umami.is/script.js" data-website-id="2fb2c139-5a87-4082-b9f3-0aad697c9317"></script>
<!-- Google Analytics — chargement différé après interaction -->
<script>
  window.addEventListener('load', function() {
    setTimeout(function() {
      var s = document.createElement('script');
      s.src = 'https://www.googletagmanager.com/gtag/js?id=G-8GRTQLRM9C';
      s.async = true;
      document.head.appendChild(s);
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      window.gtag = gtag;
      gtag('js', new Date());
      gtag('config', 'G-8GRTQLRM9C');
    }, 3000);
  });
</script>
<link rel="manifest" href="data:application/json,%7B%22name%22%3A%22ViralBoost%22%2C%22short_name%22%3A%22ViralBoost%22%2C%22description%22%3A%22Post%20your%20ad%20in%2030%20seconds%22%2C%22start_url%22%3A%22%2F%22%2C%22display%22%3A%22standalone%22%2C%22background_color%22%3A%22%23040a05%22%2C%22theme_color%22%3A%22%2322c55e%22%2C%22orientation%22%3A%22portrait%22%2C%22icons%22%3A%5B%7B%22src%22%3A%22https%3A%2F%2Fplacehold.co%2F192x192%2F22c55e%2Fffffff%3Ftext%3DVB%22%2C%22sizes%22%3A%22192x192%22%2C%22type%22%3A%22image%2Fpng%22%7D%2C%7B%22src%22%3A%22https%3A%2F%2Fplacehold.co%2F512x512%2F22c55e%2Fffffff%3Ftext%3DVB%22%2C%22sizes%22%3A%22512x512%22%2C%22type%22%3A%22image%2Fpng%22%7D%5D%7D"/>
<!-- Google Fonts non-bloquant -->
<link rel="preconnect" href="https://fonts.googleapis.com"/>
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin/>
<link rel="preload" as="style" href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=DM+Mono:wght@300;400;500&family=Plus+Jakarta+Sans:wght@300;400;500;600;700;800&display=swap" onload="this.onload=null;this.rel='stylesheet'"/>
<noscript><link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=DM+Mono:wght@300;400;500&family=Plus+Jakarta+Sans:wght@300;400;500;600;700;800&display=swap" rel="stylesheet"/></noscript>
<style>
/* CRITICAL CSS INLINE — above the fold only */
body{font-family:'Plus Jakarta Sans',sans-serif;background:#040a05;color:#f0fdf4;overflow-x:hidden;margin:0}
#landing{display:block}
#app{display:none}
nav{position:fixed;top:0;left:0;right:0;z-index:1000;background:rgba(4,10,5,0.92);backdrop-filter:blur(12px);height:64px;display:flex;align-items:center;padding:0 5%}
.logo{font-family:'Bebas Neue',sans-serif;font-size:22px;letter-spacing:4px;color:#f0fdf4}
.logo span{color:#22c55e}
/* Optimize animations for GPU */
.orb{will-change:transform}
@keyframes drift{from{transform:translate3d(0,0,0)}to{transform:translate3d(40px,40px,0)}}
</style>
<style>
:root{
  --bg:#040a05;--bg2:#060e07;--s1:#0b1a0d;--s2:#0f2312;--s3:#142e17;
  --g1:#15803d;--g2:#16a34a;--g3:#22c55e;--g4:#4ade80;--g5:#86efac;--g6:#bbf7d0;
  --white:#f0fdf4;--muted:#4a7a58;--muted2:#2d5a3a;
  --border:rgba(34,197,94,0.15);--border2:rgba(34,197,94,0.08);--glow:rgba(34,197,94,0.08);
}
*{margin:0;padding:0;box-sizing:border-box;}
button,a,[onclick]{cursor:pointer !important;touch-action:manipulation;}
button{-webkit-appearance:none;}
html{scroll-behavior:smooth;}
body{font-family:'Plus Jakarta Sans',sans-serif;background:var(--bg);color:var(--white);overflow-x:hidden;}
#cursor{display:none;}

/* ══════════════════════════════════
   THEME SYSTEM
══════════════════════════════════ */
/* GREEN (default) = already in :root */

[data-theme="blue"]{
  --bg:#060810;--bg2:#080b14;--s1:#0d1220;--s2:#111829;--s3:#161f33;
  --g1:#1d4ed8;--g2:#2563eb;--g3:#3b82f6;--g4:#60a5fa;--g5:#93c5fd;--g6:#bfdbfe;
  --white:#eff6ff;--muted:#4a6080;--muted2:#2a3a55;
  --border:rgba(59,130,246,0.18);--border2:rgba(59,130,246,0.08);--glow:rgba(59,130,246,0.08);
}
[data-theme="gold"]{
  --bg:#08070a;--bg2:#0d0b10;--s1:#13111a;--s2:#1a1724;--s3:#201d2e;
  --g1:#92700a;--g2:#b8901a;--g3:#d4a833;--g4:#e8c86a;--g5:#f0d98a;--g6:#f8eecc;
  --white:#fdf8f0;--muted:#7a6a4a;--muted2:#4a3e2a;
  --border:rgba(212,168,51,0.18);--border2:rgba(212,168,51,0.08);--glow:rgba(212,168,51,0.08);
}
[data-theme="red"]{
  --bg:#0a0606;--bg2:#0f0808;--s1:#1a0d0d;--s2:#221010;--s3:#2e1414;
  --g1:#991b1b;--g2:#b91c1c;--g3:#ef4444;--g4:#f87171;--g5:#fca5a5;--g6:#fee2e2;
  --white:#fff5f5;--muted:#7a4a4a;--muted2:#5a2e2e;
  --border:rgba(239,68,68,0.18);--border2:rgba(239,68,68,0.08);--glow:rgba(239,68,68,0.08);
}
[data-theme="purple"]{
  --bg:#070610;--bg2:#0a0914;--s1:#110f1e;--s2:#171528;--s3:#1e1c33;
  --g1:#6d28d9;--g2:#7c3aed;--g3:#8b5cf6;--g4:#a78bfa;--g5:#c4b5fd;--g6:#ede9fe;
  --white:#f5f3ff;--muted:#5a4a7a;--muted2:#3a2e5a;
  --border:rgba(139,92,246,0.18);--border2:rgba(139,92,246,0.08);--glow:rgba(139,92,246,0.08);
}
[data-theme="pink"]{
  --bg:#0a0608;--bg2:#0f080c;--s1:#1a0d14;--s2:#22101b;--s3:#2e1525;
  --g1:#9d174d;--g2:#be185d;--g3:#ec4899;--g4:#f472b6;--g5:#f9a8d4;--g6:#fce7f3;
  --white:#fff0f7;--muted:#7a4a62;--muted2:#5a2e45;
  --border:rgba(236,72,153,0.18);--border2:rgba(236,72,153,0.08);--glow:rgba(236,72,153,0.08);
}

/* ── THEME SWITCHER WIDGET ── */
#theme-switcher{
  position:fixed;bottom:24px;right:24px;z-index:9999;
  display:flex;flex-direction:column;align-items:flex-end;gap:8px;
}
#theme-toggle-btn{
  width:44px;height:44px;border-radius:50%;
  background:var(--s2);border:1.5px solid var(--border);
  display:flex;align-items:center;justify-content:center;
  font-size:20px;cursor:pointer;
  box-shadow:0 4px 20px rgba(0,0,0,0.4);
  transition:all 0.2s;
}
#theme-toggle-btn:hover{transform:scale(1.1);}
#theme-panel{
  display:none;flex-direction:column;gap:6px;
  background:var(--s1);border:1.5px solid var(--border);
  border-radius:14px;padding:14px;
  box-shadow:0 8px 40px rgba(0,0,0,0.5);
  animation:popIn 0.2s ease;
  min-width:160px;
}
#theme-panel.open{display:flex;}
#theme-panel p{font-family:'DM Mono',monospace;font-size:9px;letter-spacing:1px;text-transform:uppercase;color:var(--muted);margin-bottom:4px;}
.theme-option{
  display:flex;align-items:center;gap:10px;
  padding:8px 10px;border-radius:8px;cursor:pointer;
  border:1.5px solid transparent;
  transition:all 0.15s;font-size:12px;font-weight:600;color:var(--white);
}
.theme-option:hover{background:var(--s2);border-color:var(--border);}
.theme-option.active{border-color:var(--g3);background:var(--s2);}
.theme-dot{width:14px;height:14px;border-radius:50%;flex-shrink:0;}

#cursor-ring{display:none;}
body::before{content:'';position:fixed;inset:0;background-image:linear-gradient(rgba(34,197,94,0.025) 1px,transparent 1px),linear-gradient(90deg,rgba(34,197,94,0.025) 1px,transparent 1px);background-size:60px 60px;pointer-events:none;z-index:0;}
.orb{position:fixed;border-radius:50%;filter:blur(120px);pointer-events:none;z-index:0;}
.o1{width:600px;height:600px;background:rgba(21,128,61,0.07);top:-200px;right:-100px;animation:drift 14s ease-in-out infinite alternate;}
.o2{width:400px;height:400px;background:rgba(74,222,128,0.04);bottom:-100px;left:-100px;animation:drift 18s ease-in-out infinite alternate-reverse;}
@keyframes drift{from{transform:translate(0,0)}to{transform:translate(40px,40px)}}
@keyframes fadeUp{from{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}
@keyframes popIn{from{opacity:0;transform:scale(0.95)}to{opacity:1;transform:scale(1)}}
@keyframes fadeIn{from{opacity:0}to{opacity:1}}
@keyframes blink{0%,100%{opacity:1}50%{opacity:0.3}}
@keyframes bounce{0%,60%,100%{transform:translateY(0);opacity:.3}30%{transform:translateY(-6px);opacity:1}}
@keyframes toastIn{from{opacity:0;transform:translateX(50px)}to{opacity:1;transform:translateX(0)}}

/* GOLD ELITE STYLES */
:root{--gold:#ffd700;--gold2:#ffb300;--gold3:#fff3b0;}
.elite-gold{color:var(--gold) !important;text-shadow:0 0 8px rgba(255,215,0,0.5);}
.btn-action.elite-action{border-color:var(--gold2)!important;color:var(--gold)!important;background:rgba(255,215,0,0.06)!important;box-shadow:0 0 8px rgba(255,215,0,0.15);}
.btn-action.elite-action:hover{box-shadow:0 0 16px rgba(255,215,0,0.3);}
.post-card.elite-post{border-color:rgba(255,215,0,0.25)!important;}
/* ── HERO SOCIAL PROOF ── */
.hero-social-proof{display:flex;align-items:center;gap:10px;font-size:13px;color:var(--g5);margin-bottom:28px;animation:fadeUp 0.6s 0.05s ease both;}
.hsp-avatars{display:flex;}
.hsp-avatars span{width:28px;height:28px;border-radius:50%;background:var(--s2);border:2px solid var(--bg);display:flex;align-items:center;justify-content:center;font-size:13px;margin-left:-8px;}
.hsp-avatars span:first-child{margin-left:0;}
.hero-social-proof strong{color:var(--g3);}

/* ── SIGNUP MODAL REFAIT ── */
.signup-header{text-align:center;margin-bottom:20px;}
.signup-logo{font-family:'Bebas Neue',sans-serif;font-size:16px;letter-spacing:3px;color:var(--g3);margin-bottom:8px;}
.signup-title{font-family:'Bebas Neue',sans-serif;font-size:30px;letter-spacing:2px;color:var(--white);margin-bottom:6px;}
.signup-subtitle{font-size:12px;color:var(--muted);}
.signup-benefits{display:flex;flex-direction:column;gap:7px;margin-bottom:20px;background:rgba(22,163,74,0.05);border:1px solid var(--border2);border-radius:10px;padding:14px 16px;}
.signup-benefit{font-size:12px;color:var(--g5);line-height:1.5;}
.signup-form{display:flex;flex-direction:column;gap:10px;margin-bottom:16px;}
.signup-input{width:100%;padding:12px 14px;background:rgba(4,10,5,0.9);border:1.5px solid var(--border2);border-radius:10px;font-family:'Plus Jakarta Sans',sans-serif;font-size:14px;color:var(--white);outline:none;transition:border-color 0.2s;}
.signup-input:focus{border-color:rgba(34,197,94,0.5);}
.signup-input::placeholder{color:var(--muted);}
.btn-signup-big{width:100%;padding:14px;background:linear-gradient(135deg,var(--g1),var(--g3));border:none;border-radius:10px;font-family:'Plus Jakarta Sans',sans-serif;font-size:15px;font-weight:800;cursor:pointer;color:var(--bg);box-shadow:0 0 28px rgba(34,197,94,0.35);transition:all 0.2s;margin-bottom:10px;}
.btn-signup-big:hover{transform:translateY(-2px);box-shadow:0 0 44px rgba(34,197,94,0.55);}
.signup-footer-note{text-align:center;font-size:11px;color:var(--muted2);margin-bottom:10px;}

.plan-elite-badge{background:linear-gradient(135deg,#ffd700,#ff8c00);color:#1a0a00;font-family:'DM Mono',monospace;font-size:8px;font-weight:700;padding:2px 7px;border-radius:2px;letter-spacing:1px;}

/* HERO AD BOX */
.hero-ad-box{background:rgba(22,163,74,0.06);border:2px solid rgba(22,163,74,0.25);border-radius:16px;padding:28px 32px;max-width:720px;width:100%;margin:0 auto 40px;animation:fadeUp 0.5s 0.1s ease both;}
.hero-ad-box h3{font-family:'Bebas Neue',sans-serif;font-size:22px;letter-spacing:2px;color:var(--g3);margin-bottom:12px;}
.hero-ad-form{display:grid;grid-template-columns:1fr 1fr;gap:10px;}
.hero-ad-form input,.hero-ad-form select,.hero-ad-form textarea{width:100%;padding:10px 13px;background:rgba(4,10,5,0.9);border:1.5px solid var(--border);border-radius:7px;font-family:'Plus Jakarta Sans',sans-serif;font-size:13px;color:var(--white);outline:none;transition:all 0.2s;}
.hero-ad-form input:focus,.hero-ad-form select:focus,.hero-ad-form textarea:focus{border-color:var(--g3);}
.hero-ad-form textarea{grid-column:1/-1;min-height:56px;resize:none;}
.hero-ad-form select option{background:var(--s1);}
.btn-hero-ad{grid-column:1/-1;padding:12px;background:var(--g2);border:none;border-radius:8px;font-family:'Plus Jakarta Sans',sans-serif;font-size:14px;font-weight:800;cursor:pointer;color:var(--bg);transition:all 0.2s;box-shadow:0 0 20px rgba(22,163,74,0.3);}
.btn-hero-ad:hover{background:var(--g3);box-shadow:0 0 40px rgba(22,163,74,0.5);}

/* ═══════════════════════════════════════════
   STEP-BY-STEP WIZARD — PUBLISH TAB
═══════════════════════════════════════════ */
/* Stepper header */
.wiz-stepper{display:flex;align-items:center;gap:0;margin-bottom:28px;padding:20px 24px;background:var(--s1);border:1.5px solid var(--border2);border-radius:14px;}
.wiz-step-dot{display:flex;flex-direction:column;align-items:center;gap:4px;flex:1;cursor:pointer;}
.wiz-step-circle{width:34px;height:34px;border-radius:50%;border:2px solid var(--border);background:var(--s2);display:flex;align-items:center;justify-content:center;font-size:12px;font-weight:800;font-family:'DM Mono',monospace;color:var(--muted);transition:all 0.3s;position:relative;}
.wiz-step-circle.active{border-color:var(--g3);background:linear-gradient(135deg,var(--g1),var(--g2));color:var(--bg);box-shadow:0 0 16px rgba(34,197,94,0.4);}
.wiz-step-circle.done{border-color:var(--g2);background:rgba(22,163,74,0.15);color:var(--g3);}
.wiz-step-circle.done::after{content:'✓';position:absolute;font-size:12px;}
.wiz-step-circle.done span{display:none;}
.wiz-step-lbl{font-size:9px;font-weight:700;font-family:'DM Mono',monospace;letter-spacing:0.5px;color:var(--muted);text-align:center;text-transform:uppercase;transition:color 0.3s;}
.wiz-step-dot.active .wiz-step-lbl{color:var(--g3);}
.wiz-step-dot.done .wiz-step-lbl{color:var(--g4);}
.wiz-connector{flex:1;height:2px;background:var(--border2);margin:0 4px;margin-bottom:18px;transition:background 0.4s;}
.wiz-connector.done{background:linear-gradient(90deg,var(--g2),var(--g3));}

/* Step panels */
.wiz-panel{display:none;animation:fadeUp 0.3s ease;}
.wiz-panel.active{display:block;}

/* Step card group */
.wiz-group-card{background:var(--s1);border:1.5px solid var(--border2);border-radius:14px;padding:24px 22px;margin-bottom:0;transition:border-color 0.3s;}
.wiz-group-card:focus-within{border-color:rgba(34,197,94,0.3);}
.wiz-group-title{display:flex;align-items:center;gap:12px;margin-bottom:18px;}
.wiz-group-icon{width:40px;height:40px;border-radius:10px;background:linear-gradient(135deg,var(--g1),var(--g2));display:flex;align-items:center;justify-content:center;font-size:18px;flex-shrink:0;}
.wiz-group-head{font-family:'Bebas Neue',sans-serif;font-size:20px;letter-spacing:1.5px;color:var(--white);}
.wiz-group-sub{font-size:12px;color:var(--muted);margin-top:1px;}

/* Nav boutons */
.wiz-nav{display:flex;gap:12px;margin-top:22px;}
.btn-wiz-back{flex:1;padding:13px;background:transparent;border:1.5px solid var(--border);border-radius:9px;font-family:'Plus Jakarta Sans',sans-serif;font-size:13px;font-weight:700;cursor:pointer;color:var(--muted);transition:all 0.2s;}
.btn-wiz-back:hover{border-color:var(--g3);color:var(--g3);}
.btn-wiz-next{flex:3;padding:13px;background:linear-gradient(135deg,var(--g1),var(--g2));border:none;border-radius:9px;font-family:'Plus Jakarta Sans',sans-serif;font-size:14px;font-weight:800;cursor:pointer;color:var(--bg);transition:all 0.2s;box-shadow:0 0 20px rgba(22,163,74,0.25);display:flex;align-items:center;justify-content:center;gap:8px;}
.btn-wiz-next:hover{background:linear-gradient(135deg,var(--g2),var(--g3));box-shadow:0 0 32px rgba(34,197,94,0.45);transform:translateY(-1px);}
.btn-wiz-publish{flex:3;padding:14px;background:linear-gradient(135deg,#15803d,#22c55e);border:none;border-radius:9px;font-family:'Plus Jakarta Sans',sans-serif;font-size:14px;font-weight:800;cursor:pointer;color:var(--bg);transition:all 0.2s;box-shadow:0 0 24px rgba(34,197,94,0.35);display:flex;align-items:center;justify-content:center;gap:8px;}
.btn-wiz-publish:hover{box-shadow:0 0 40px rgba(34,197,94,0.55);transform:translateY(-1px);}

/* Stepper progress bar */
.wiz-progress-bar{height:3px;background:var(--s3);border-radius:2px;overflow:hidden;margin-bottom:22px;}
.wiz-progress-fill{height:100%;background:linear-gradient(90deg,var(--g2),var(--g3));border-radius:2px;transition:width 0.5s cubic-bezier(0.4,0,0.2,1);}

/* Ad preview in step 5 */
.wiz-preview-card{background:linear-gradient(135deg,var(--s1),var(--s2));border:2px solid rgba(34,197,94,0.3);border-radius:14px;overflow:hidden;margin-bottom:14px;box-shadow:0 8px 32px rgba(0,0,0,0.4);}
.wiz-preview-banner{height:110px;background:linear-gradient(135deg,var(--s2),var(--s3));display:flex;align-items:center;justify-content:center;font-size:52px;position:relative;}
.wiz-preview-banner img{position:absolute;inset:0;width:100%;height:100%;object-fit:cover;}
.wiz-preview-body{padding:16px 18px;}
.wiz-preview-name{font-family:'Bebas Neue',sans-serif;font-size:22px;letter-spacing:1.5px;color:var(--white);margin-bottom:3px;}
.wiz-preview-hook{font-size:12px;color:var(--g3);font-weight:700;margin-bottom:8px;}
.wiz-preview-desc{font-size:13px;color:#c4d9cb;line-height:1.7;margin-bottom:10px;}
.wiz-preview-tags{display:flex;gap:5px;flex-wrap:wrap;margin-bottom:10px;}
.wiz-preview-footer{display:flex;align-items:center;justify-content:space-between;font-size:11px;color:var(--muted);}
.wiz-preview-label{display:inline-block;font-family:'DM Mono',monospace;font-size:9px;letter-spacing:1px;text-transform:uppercase;padding:2px 8px;border-radius:3px;background:rgba(34,197,94,0.1);border:1px solid rgba(34,197,94,0.2);color:var(--g4);}

/* ═══════════════════════════════════════════
   MODAL GUIDE — 1st opening
═══════════════════════════════════════════ */
.guide-overlay{position:fixed;inset:0;background:rgba(0,0,0,0.75);backdrop-filter:blur(8px);z-index:9999;display:flex;align-items:center;justify-content:center;padding:20px;animation:fadeIn 0.3s ease;}
.guide-overlay.hidden{display:none !important;}
.guide-box{background:var(--s1);border:2px solid rgba(34,197,94,0.4);border-radius:16px;max-width:340px;width:100%;padding:24px 22px;position:relative;animation:popIn 0.4s cubic-bezier(0.34,1.56,0.64,1);}
.guide-box-close{position:absolute;top:16px;right:16px;background:var(--s2);border:1px solid var(--border);border-radius:50%;width:30px;height:30px;display:flex;align-items:center;justify-content:center;cursor:pointer;font-size:13px;color:var(--muted);transition:all 0.2s;}
.guide-box-close:hover{border-color:var(--g3);color:var(--g3);}
.guide-badge{display:inline-flex;align-items:center;gap:6px;background:rgba(34,197,94,0.1);border:1px solid rgba(34,197,94,0.25);border-radius:20px;padding:5px 12px;font-size:11px;font-weight:700;color:var(--g4);font-family:'DM Mono',monospace;letter-spacing:1px;margin-bottom:16px;}
.guide-title{font-family:'Bebas Neue',sans-serif;font-size:34px;letter-spacing:2px;color:var(--white);line-height:1;margin-bottom:6px;}
.guide-subtitle{font-size:13px;color:var(--muted);margin-bottom:22px;line-height:1.7;}
.guide-steps-list{display:flex;flex-direction:column;gap:10px;margin-bottom:24px;}
.guide-step-row{display:flex;align-items:flex-start;gap:14px;background:rgba(22,163,74,0.04);border:1.5px solid var(--border2);border-radius:12px;padding:14px 16px;transition:border-color 0.2s;}
.guide-step-row:hover{border-color:rgba(34,197,94,0.2);}
.guide-step-num{width:26px;height:26px;border-radius:50%;background:linear-gradient(135deg,var(--g1),var(--g2));color:var(--bg);font-size:11px;font-weight:800;font-family:'DM Mono',monospace;display:flex;align-items:center;justify-content:center;flex-shrink:0;margin-top:1px;}
.guide-step-content{}
.guide-step-title{font-size:13px;font-weight:800;color:var(--white);margin-bottom:2px;}
.guide-step-desc{font-size:11px;color:var(--muted);line-height:1.6;}
.guide-tip-box{background:rgba(255,215,0,0.04);border:1px solid rgba(255,215,0,0.2);border-radius:10px;padding:12px 14px;margin-bottom:22px;font-size:12px;color:var(--g5);line-height:1.7;}
.guide-tip-box strong{color:var(--gold);}
.btn-guide-start{width:100%;padding:15px;background:linear-gradient(135deg,var(--g1),var(--g2));border:none;border-radius:10px;font-family:'Plus Jakarta Sans',sans-serif;font-size:15px;font-weight:800;cursor:pointer;color:var(--bg);box-shadow:0 0 28px rgba(34,197,94,0.35);transition:all 0.2s;}
.btn-guide-start:hover{background:linear-gradient(135deg,var(--g2),var(--g3));box-shadow:0 0 44px rgba(34,197,94,0.55);transform:translateY(-2px);}

/* PUBLIC FEED PREVIEW */
.public-feed-section{padding:60px 5% 80px;position:relative;z-index:1;}
.public-post-card{background:linear-gradient(160deg,var(--s1) 0%,var(--s2) 100%);border:1.5px solid var(--border2);border-radius:14px;padding:18px 20px;margin-bottom:12px;transition:all 0.3s cubic-bezier(0.4,0,0.2,1);box-shadow:0 2px 10px rgba(0,0,0,0.3),inset 0 1px 0 rgba(255,255,255,0.03);}
.public-post-card:hover{border-color:rgba(34,197,94,0.35);transform:translateY(-3px);box-shadow:0 10px 36px rgba(0,0,0,0.45),0 0 16px rgba(34,197,94,0.07);}
.public-post-card.elite-pub{border-color:rgba(255,215,0,0.25);box-shadow:0 2px 10px rgba(0,0,0,0.3),0 0 12px rgba(255,215,0,0.05);}
.public-feed-blur{position:relative;}
.public-feed-blur .feed-lock{position:absolute;bottom:0;left:0;right:0;height:180px;background:linear-gradient(transparent,var(--bg));display:flex;align-items:flex-end;justify-content:center;padding-bottom:20px;}
.btn-unlock-feed{padding:11px 28px;background:var(--g2);border:none;border-radius:6px;font-family:'Plus Jakarta Sans',sans-serif;font-size:13px;font-weight:700;cursor:pointer;color:var(--bg);box-shadow:0 0 24px rgba(22,163,74,0.35);transition:all 0.2s;}
@media(max-width:768px){footer [style*="grid-template-columns:2fr 1fr 1fr 1fr"]{grid-template-columns:1fr 1fr !important;}}
.btn-unlock-feed:hover{background:var(--g3);}

/* MEDIA UPLOAD */
.media-upload-area{border:2px dashed var(--border);border-radius:10px;padding:14px;margin:10px 0;cursor:pointer;transition:all 0.2s;text-align:center;}
.media-upload-area:hover{border-color:var(--g3);background:var(--glow);}
.media-upload-area input{display:none;}
.media-preview-row{display:flex;gap:8px;flex-wrap:wrap;margin-top:8px;}
.media-preview-item{position:relative;width:80px;height:80px;border-radius:8px;overflow:hidden;border:1.5px solid var(--border);}
.media-preview-item img,.media-preview-item video{width:100%;height:100%;object-fit:cover;}
.media-preview-item .rm-media{position:absolute;top:2px;right:2px;background:rgba(0,0,0,0.7);border:none;border-radius:50%;width:18px;height:18px;cursor:pointer;color:#fff;font-size:9px;display:flex;align-items:center;justify-content:center;}
.file-chip{display:flex;align-items:center;gap:6px;background:var(--s2);border:1px solid var(--border);border-radius:5px;padding:4px 10px;font-size:11px;color:var(--g4);}

/* GROUP CHAT */
.group-card{background:linear-gradient(160deg,var(--s1) 0%,var(--s2) 100%);border:1.5px solid var(--border2);border-radius:14px;padding:18px;margin-bottom:10px;transition:all 0.3s cubic-bezier(0.4,0,0.2,1);cursor:pointer;box-shadow:0 2px 10px rgba(0,0,0,0.3),inset 0 1px 0 rgba(255,255,255,0.03);}
.group-card:hover{border-color:rgba(34,197,94,0.35);transform:translateY(-3px);box-shadow:0 10px 36px rgba(0,0,0,0.45),0 0 16px rgba(34,197,94,0.07);}
.group-card.elite-group{border-color:rgba(255,215,0,0.25);}
.group-header{display:flex;align-items:center;gap:10px;margin-bottom:8px;}
.group-icon{width:44px;height:44px;border-radius:10px;display:flex;align-items:center;justify-content:center;font-size:20px;flex-shrink:0;}
.group-title{font-size:14px;font-weight:700;}
.group-desc{font-size:12px;color:var(--muted);margin-bottom:6px;}
.group-meta{font-family:'DM Mono',monospace;font-size:10px;color:var(--muted2);display:flex;align-items:center;gap:10px;}

/* GROUP SETTINGS (ELITE) */
.group-settings-section{background:var(--s2);border:1.5px solid rgba(255,215,0,0.15);border-radius:10px;padding:18px;margin-bottom:14px;}
.group-settings-section h3{font-family:'DM Mono',monospace;font-size:10px;color:var(--gold);letter-spacing:2px;text-transform:uppercase;margin-bottom:12px;}
.toggle-row{display:flex;align-items:center;justify-content:space-between;margin-bottom:10px;}
.toggle-row label{font-size:12px;color:var(--g5);}
.toggle{position:relative;width:38px;height:20px;cursor:pointer;}
.toggle input{opacity:0;width:0;height:0;}
.toggle-slider{position:absolute;inset:0;background:var(--muted2);border-radius:20px;transition:0.3s;}
.toggle-slider::before{content:'';position:absolute;width:14px;height:14px;left:3px;top:3px;background:#fff;border-radius:50%;transition:0.3s;}
.toggle input:checked+.toggle-slider{background:var(--g2);}
.toggle input:checked+.toggle-slider::before{transform:translateX(18px);}

/* WALLPAPER */
#app.has-wallpaper{background-size:cover;background-position:center;background-attachment:fixed;}
#app.has-wallpaper .app-bar{background:rgba(4,10,5,0.85);}
#app.has-wallpaper .tpanel{background:rgba(4,10,5,0.5);border-radius:12px;}

/* REPORT MODAL */
.report-reason{display:flex;flex-direction:column;gap:8px;margin:12px 0;}
.report-reason label{display:flex;align-items:center;gap:8px;font-size:13px;color:var(--g5);cursor:pointer;}
.report-reason input[type=radio]{accent-color:var(--g3);}

/* ADMIN MSG BADGE */
.admin-msg-badge{background:linear-gradient(135deg,#ffd700,#ff8c00);color:#1a0a00;font-size:9px;font-weight:700;padding:2px 6px;border-radius:3px;letter-spacing:0.5px;}

/* ── BADGES SYSTÈME ── */
.badges-section{margin-top:24px;}
.badges-section h3{font-family:'DM Mono',monospace;font-size:11px;color:var(--g3);letter-spacing:2px;margin-bottom:14px;text-transform:uppercase;}
.badges-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(88px,1fr));gap:10px;}
.badge-item{background:var(--s1);border:1.5px solid var(--border2);border-radius:10px;padding:12px 8px;text-align:center;transition:all 0.2s;position:relative;}
.badge-item.unlocked{border-color:rgba(34,197,94,0.35);background:rgba(22,163,74,0.06);}
.badge-item.unlocked:hover{transform:translateY(-2px);box-shadow:0 8px 24px rgba(0,0,0,0.3);}
.badge-item.locked{opacity:0.4;filter:grayscale(1);}
.badge-item.special{border-color:rgba(255,215,0,0.4);background:rgba(255,215,0,0.05);}
.badge-item.special.unlocked{box-shadow:0 0 12px rgba(255,215,0,0.15);}
.badge-emoji{font-size:26px;line-height:1;margin-bottom:6px;}
.badge-name{font-size:9px;font-weight:700;color:var(--g5);font-family:'DM Mono',monospace;letter-spacing:0.5px;line-height:1.3;}
.badge-item.locked .badge-name{color:var(--muted2);}
.badge-lock-icon{position:absolute;top:5px;right:6px;font-size:8px;color:var(--muted2);}
.badge-plan-tag{display:inline-block;font-family:'DM Mono',monospace;font-size:7px;padding:1px 5px;border-radius:2px;margin-top:3px;letter-spacing:0.5px;}
.badge-plan-starter{background:rgba(34,197,94,0.15);color:#4ade80;}
.badge-plan-pro{background:rgba(59,130,246,0.2);color:#60a5fa;}
.badge-plan-elite{background:rgba(168,85,247,0.2);color:#c084fc;}
.badge-plan-legend{background:rgba(249,115,22,0.2);color:#fb923c;}
.badge-plan-vip{background:linear-gradient(135deg,rgba(255,215,0,0.25),rgba(255,140,0,0.2));color:#ffd700;}
.badge-tooltip{position:absolute;bottom:calc(100% + 6px);left:50%;transform:translateX(-50%);background:var(--s3);border:1px solid var(--border);border-radius:6px;padding:6px 10px;font-size:10px;color:var(--g5);white-space:nowrap;pointer-events:none;opacity:0;transition:opacity 0.2s;z-index:10;font-family:'Plus Jakarta Sans',sans-serif;}
.badge-item:hover .badge-tooltip{opacity:1;}
.badge-progress-bar{height:3px;background:var(--s3);border-radius:2px;margin-top:5px;overflow:hidden;}
.badge-progress-fill{height:100%;background:var(--g3);border-radius:2px;transition:width 0.4s;}

/* ── MISSIONS & SHOP CREDITS ── */
.credits-tabs{display:flex;gap:0;margin-bottom:20px;border-bottom:1px solid var(--border2);}
.credits-tab{padding:9px 16px;font-size:12px;font-weight:600;color:var(--muted);cursor:pointer;border-bottom:2px solid transparent;transition:all 0.2s;background:none;border-top:none;border-left:none;border-right:none;font-family:'Plus Jakarta Sans',sans-serif;white-space:nowrap;}
.credits-tab.active{color:var(--gold);border-bottom-color:var(--gold);}
.credits-tab:hover{color:var(--white);}
.cpanel{display:none;}
.cpanel.active{display:block;animation:fadeUp 0.2s ease;}

/* Barre credits améliorée */
.credits-bar-v2{background:linear-gradient(135deg,rgba(255,215,0,0.08),rgba(255,140,0,0.04));border:1.5px solid rgba(255,215,0,0.25);border-radius:14px;padding:16px 20px;display:flex;align-items:center;justify-content:space-between;margin-bottom:20px;flex-wrap:wrap;gap:12px;}
.credits-big{font-family:'Bebas Neue',sans-serif;font-size:42px;color:var(--gold);line-height:1;letter-spacing:1px;}
.credits-sub{font-size:10px;color:var(--muted);font-family:'DM Mono',monospace;letter-spacing:1px;}
.credits-actions{display:flex;gap:8px;flex-wrap:wrap;}

/* Missions */
.mission-card{background:var(--s1);border:1.5px solid var(--border2);border-radius:10px;padding:14px 16px;margin-bottom:10px;display:flex;align-items:center;gap:14px;transition:all 0.2s;}
.mission-card.done{border-color:rgba(34,197,94,0.3);background:rgba(22,163,74,0.04);opacity:0.7;}
.mission-icon{font-size:26px;flex-shrink:0;width:44px;height:44px;background:var(--s2);border-radius:10px;display:flex;align-items:center;justify-content:center;}
.mission-info{flex:1;}
.mission-title{font-size:13px;font-weight:700;color:var(--white);margin-bottom:2px;}
.mission-desc{font-size:11px;color:var(--muted);margin-bottom:6px;}
.mission-prog-bar{height:4px;background:var(--s3);border-radius:2px;overflow:hidden;margin-bottom:4px;}
.mission-prog-fill{height:100%;background:var(--g3);border-radius:2px;transition:width 0.5s;}
.mission-prog-txt{font-family:'DM Mono',monospace;font-size:9px;color:var(--muted2);}
.mission-reward{display:flex;flex-direction:column;align-items:flex-end;gap:4px;flex-shrink:0;}
.mission-reward-val{font-family:'Bebas Neue',sans-serif;font-size:20px;color:var(--gold);line-height:1;}
.mission-reward-label{font-size:8px;color:var(--muted);font-family:'DM Mono',monospace;letter-spacing:1px;}
.btn-claim{background:linear-gradient(135deg,rgba(255,215,0,0.2),rgba(255,140,0,0.15));border:1.5px solid rgba(255,215,0,0.4);border-radius:5px;padding:5px 12px;font-size:11px;font-weight:700;cursor:pointer;color:var(--gold);transition:all 0.2s;font-family:'Plus Jakarta Sans',sans-serif;}
.btn-claim:hover{box-shadow:0 0 10px rgba(255,215,0,0.3);}
.btn-claim:disabled{opacity:0.4;cursor:not-allowed;}
.mission-done-tag{font-size:10px;color:var(--g3);font-weight:700;}
.missions-reset{font-family:'DM Mono',monospace;font-size:10px;color:var(--muted2);text-align:right;margin-bottom:12px;}

/* Shop */
.shop-section-title{font-family:'DM Mono',monospace;font-size:10px;color:var(--g4);letter-spacing:2px;text-transform:uppercase;margin:20px 0 10px;}
.shop-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(150px,1fr));gap:10px;margin-bottom:20px;}
.shop-item{background:var(--s1);border:1.5px solid var(--border2);border-radius:10px;padding:14px 12px;text-align:center;transition:all 0.2s;cursor:pointer;position:relative;}
.shop-item:hover{border-color:rgba(34,197,94,0.3);transform:translateY(-2px);}
.shop-item.premium{border-color:rgba(255,215,0,0.25);background:rgba(255,215,0,0.03);}
.shop-item.premium:hover{border-color:rgba(255,215,0,0.5);box-shadow:0 0 16px rgba(255,215,0,0.1);}
.shop-item-emoji{font-size:30px;margin-bottom:8px;}
.shop-item-name{font-size:12px;font-weight:700;color:var(--white);margin-bottom:3px;}
.shop-item-desc{font-size:10px;color:var(--muted);margin-bottom:8px;line-height:1.4;}
.shop-item-price{display:inline-flex;align-items:center;gap:4px;background:rgba(255,215,0,0.1);border:1px solid rgba(255,215,0,0.3);border-radius:4px;padding:3px 9px;font-family:'DM Mono',monospace;font-size:11px;font-weight:700;color:var(--gold);}
.shop-item-badge{position:absolute;top:-6px;right:-6px;background:linear-gradient(135deg,#ff6b6b,#ee5a24);color:#fff;font-size:8px;font-weight:700;padding:2px 6px;border-radius:3px;font-family:'DM Mono',monospace;}

/* Badge rewards in BADGES */
.badge-reward{font-family:'DM Mono',monospace;font-size:8px;color:var(--gold);margin-top:3px;}

/* ══ REVENUE DASHBOARD ══ */
.rev-kpi-grid{display:grid;grid-template-columns:repeat(4,1fr);gap:12px;margin-bottom:20px;}
.rev-kpi{background:var(--s1);border:1.5px solid var(--border2);border-radius:14px;padding:16px 18px;transition:border-color 0.2s;}
.rev-kpi:hover{border-color:rgba(34,197,94,0.3);}
.rev-kpi-icon{font-size:22px;margin-bottom:8px;}
.rev-kpi-val{font-family:'Bebas Neue',sans-serif;font-size:32px;letter-spacing:1px;line-height:1;margin-bottom:3px;}
.rev-kpi-lbl{font-family:'DM Mono',monospace;font-size:9px;letter-spacing:1.5px;color:var(--muted);text-transform:uppercase;}
.rev-kpi-trend{font-family:'DM Mono',monospace;font-size:10px;margin-top:5px;font-weight:700;}
.rev-kpi-trend.up{color:#4ade80;} .rev-kpi-trend.down{color:#f87171;} .rev-kpi-trend.flat{color:var(--muted);}
.rev-chart-wrap{background:var(--s1);border:1.5px solid var(--border2);border-radius:14px;padding:20px;margin-bottom:16px;}
.rev-chart-head{display:flex;align-items:center;justify-content:space-between;margin-bottom:18px;}
.rev-chart-title{font-family:'DM Mono',monospace;font-size:10px;letter-spacing:2px;color:var(--g4);text-transform:uppercase;}
.rev-chart-tabs{display:flex;gap:4px;}
.rev-chart-tab{background:transparent;border:1px solid var(--border2);border-radius:5px;padding:4px 10px;font-family:'DM Mono',monospace;font-size:9px;color:var(--muted);cursor:pointer;transition:all 0.2s;}
.rev-chart-tab.active{background:rgba(34,197,94,0.12);border-color:var(--g3);color:var(--g3);}
.rev-bar-chart{display:flex;align-items:flex-end;gap:6px;height:100px;}
.rev-bar-col{flex:1;display:flex;flex-direction:column;align-items:center;gap:4px;}
.rev-bar{width:100%;border-radius:4px 4px 0 0;transition:height 0.5s cubic-bezier(0.34,1.2,0.64,1);min-height:3px;cursor:pointer;position:relative;}
.rev-bar:hover::after{content:attr(data-val);position:absolute;top:-22px;left:50%;transform:translateX(-50%);font-family:'DM Mono',monospace;font-size:9px;color:var(--g3);white-space:nowrap;background:var(--s2);padding:2px 6px;border-radius:4px;}
.rev-bar-lbl{font-family:'DM Mono',monospace;font-size:8px;color:var(--muted2);letter-spacing:0.5px;}
.rev-sources-grid{display:grid;grid-template-columns:1fr 1fr;gap:14px;margin-bottom:16px;}
.rev-source-card{background:var(--s1);border:1.5px solid var(--border2);border-radius:12px;padding:16px;}
.rev-source-row{display:flex;align-items:center;justify-content:space-between;margin-bottom:10px;}
.rev-source-row:last-child{margin-bottom:0;}
.rev-source-name{display:flex;align-items:center;gap:8px;font-size:12px;font-weight:600;}
.rev-source-dot{width:8px;height:8px;border-radius:50%;flex-shrink:0;}
.rev-source-bar-wrap{flex:1;height:4px;background:var(--s3);border-radius:2px;margin:0 10px;overflow:hidden;}
.rev-source-bar-fill{height:100%;border-radius:2px;transition:width 0.6s ease;}
.rev-source-val{font-family:'DM Mono',monospace;font-size:11px;font-weight:700;color:var(--g3);}
.rev-top-table{width:100%;border-collapse:collapse;}
.rev-top-table th{font-family:'DM Mono',monospace;font-size:9px;letter-spacing:1px;color:var(--muted2);text-transform:uppercase;padding:0 0 10px;text-align:left;border-bottom:1px solid var(--border2);}
.rev-top-table td{padding:10px 0;font-size:12px;border-bottom:1px solid var(--border2);vertical-align:middle;}
.rev-top-table tr:last-child td{border-bottom:none;}
/* ══ PROFIL AMÉLIORÉ ══ */
.prof-cover{height:180px;border-radius:14px;position:relative;overflow:hidden;margin-bottom:56px;background:linear-gradient(135deg,var(--g1),var(--s3));}
.prof-cover-edit{position:absolute;top:12px;right:12px;background:rgba(0,0,0,0.45);border:1px solid rgba(255,255,255,0.15);border-radius:6px;padding:5px 11px;font-size:11px;color:rgba(255,255,255,0.7);cursor:pointer;transition:all 0.2s;}
.prof-cover-edit:hover{background:rgba(0,0,0,0.7);color:#fff;}
.prof-avatar-wrap{position:absolute;bottom:-44px;left:22px;}
.prof-ava-img{width:88px;height:88px;border-radius:50%;border:4px solid var(--bg);display:flex;align-items:center;justify-content:center;font-family:'Bebas Neue',sans-serif;font-size:36px;color:var(--bg);box-shadow:0 0 28px rgba(22,163,74,0.3);}
.prof-ava-online{position:absolute;bottom:6px;right:6px;width:14px;height:14px;background:#4ade80;border:2px solid var(--bg);border-radius:50%;box-shadow:0 0 8px rgba(74,222,128,0.7);}
.prof-completion{background:linear-gradient(135deg,rgba(22,163,74,0.08),rgba(74,222,128,0.04));border:1.5px solid rgba(34,197,94,0.2);border-radius:12px;padding:14px 18px;margin-bottom:16px;display:flex;align-items:center;gap:14px;}
.prof-activity-grid{display:grid;grid-template-columns:repeat(30,1fr);gap:3px;margin-top:8px;}
.prof-activity-cell{height:10px;border-radius:2px;transition:transform 0.15s;cursor:default;}
.prof-activity-cell:hover{transform:scale(1.3);}
.prof-social-row{display:flex;gap:8px;flex-wrap:wrap;margin-bottom:16px;}
.prof-social-btn{display:flex;align-items:center;gap:6px;padding:7px 13px;border-radius:8px;font-family:'DM Mono',monospace;font-size:10px;font-weight:700;letter-spacing:0.5px;border:1.5px solid;cursor:pointer;transition:all 0.2s;text-decoration:none;}
.prof-suggested{display:grid;grid-template-columns:repeat(3,1fr);gap:10px;margin-top:20px;}
.prof-sug-card{background:var(--s1);border:1.5px solid var(--border2);border-radius:12px;padding:14px;text-align:center;cursor:pointer;transition:all 0.2s;}
.prof-sug-card:hover{border-color:rgba(34,197,94,0.4);transform:translateY(-2px);}
@media(max-width:900px){.rev-kpi-grid{grid-template-columns:repeat(2,1fr);}.rev-sources-grid{grid-template-columns:1fr;}.prof-suggested{grid-template-columns:1fr 1fr;}}
/* NAV */
nav{position:fixed;top:0;left:0;right:0;z-index:200;padding:0 5%;height:66px;display:flex;align-items:center;justify-content:space-between;background:rgba(4,10,5,0.92);backdrop-filter:blur(24px);border-bottom:1px solid var(--border2);}
.logo{font-family:'Bebas Neue',sans-serif;font-size:24px;letter-spacing:3px;color:var(--g3);text-shadow:0 0 20px rgba(74,222,128,0.35);position:relative;z-index:1;}
.logo span{color:var(--white);}
.nav-links{display:flex;gap:28px;}
.nav-links a{font-size:13px;font-weight:500;color:var(--muted);text-decoration:none;letter-spacing:0.5px;transition:color 0.2s;position:relative;z-index:1;}
.nav-links a:hover{color:var(--g3);}
.lang-btn{background:rgba(34,197,94,0.08);border:1.5px solid var(--border);border-radius:6px;padding:5px 12px;font-size:12px;font-weight:700;color:var(--g4);cursor:pointer;transition:all 0.2s;font-family:'DM Mono',monospace;letter-spacing:0.5px;}
.lang-btn:hover{border-color:var(--g3);background:rgba(34,197,94,0.15);}
.nav-right{display:flex;gap:10px;align-items:center;}
.btn-g{padding:9px 22px;border-radius:6px;font-family:'Plus Jakarta Sans',sans-serif;font-size:13px;font-weight:700;cursor:pointer;transition:all 0.2s;letter-spacing:0.3px;}
.btn-ghost-g{background:transparent;border:1.5px solid var(--border);color:var(--g3);}
.btn-ghost-g:hover{border-color:var(--g3);background:var(--glow);}
.btn-solid-g{background:var(--g2);border:none;color:var(--bg);box-shadow:0 0 20px rgba(22,163,74,0.3);}
.btn-solid-g:hover{background:var(--g3);box-shadow:0 0 40px rgba(22,163,74,0.5);transform:translateY(-1px);}

/* HAMBURGER MOBILE */
.hamburger{display:none;flex-direction:column;justify-content:center;gap:5px;width:36px;height:36px;background:transparent;border:1.5px solid var(--border);border-radius:6px;cursor:pointer;padding:7px;flex-shrink:0;transition:border-color 0.2s;}
.hamburger span{display:block;height:2px;background:var(--g3);border-radius:2px;transition:all 0.3s;}
.hamburger.open span:nth-child(1){transform:translateY(7px) rotate(45deg);}
.hamburger.open span:nth-child(2){opacity:0;transform:scaleX(0);}
.hamburger.open span:nth-child(3){transform:translateY(-7px) rotate(-45deg);}
.hamburger:hover{border-color:var(--g3);}

/* MOBILE DROPDOWN MENU */
.mobile-menu{display:none;position:fixed;top:66px;left:0;right:0;z-index:199;background:rgba(4,10,5,0.97);backdrop-filter:blur(24px);border-bottom:1px solid var(--border2);padding:0;max-height:0;overflow:hidden;transition:max-height 0.35s cubic-bezier(0.4,0,0.2,1),padding 0.35s ease;}
.mobile-menu.open{max-height:400px;padding:16px 5% 20px;}
.mobile-menu a{display:block;padding:13px 0;font-size:15px;font-weight:600;color:var(--muted);text-decoration:none;border-bottom:1px solid var(--border2);transition:color 0.2s;}
.mobile-menu a:last-of-type{border-bottom:none;}
.mobile-menu a:hover,.mobile-menu a:active{color:var(--g3);}
.mobile-menu .mobile-btns{display:flex;gap:10px;margin-top:16px;}
.mobile-menu .mobile-btns button{flex:1;}

/* BOTTOM NAV BAR */
.bottom-nav{
  display:none;
  position:fixed;bottom:0;left:0;right:0;z-index:300;
  background:rgba(4,10,5,0.96);backdrop-filter:blur(28px);
  border-top:1px solid rgba(34,197,94,0.1);
  padding:8px 4px max(10px,env(safe-area-inset-bottom));
  gap:0;
}
body:not(.app-active) .bottom-nav{display:none !important;}
.bn-item{
  flex:1;display:flex;flex-direction:column;align-items:center;justify-content:center;
  gap:4px;padding:6px 0;background:none;border:none;cursor:pointer;
  font-family:'Plus Jakarta Sans',sans-serif;font-size:9px;font-weight:600;
  color:var(--muted);transition:color 0.2s, transform 0.15s;position:relative;
  touch-action:manipulation;-webkit-tap-highlight-color:transparent;
}
.bn-item:active{transform:scale(0.88);}
.bn-item.active{color:var(--g3);}
.bn-item.active .bn-icon{filter:drop-shadow(0 0 8px rgba(34,197,94,0.7));transform:translateY(-3px) scale(1.2);}
.bn-item.bn-publish.active{color:var(--bg) !important;}

/* Colors label per tab */
#bn-feed.active{color:#fb923c;}
#bn-showcase.active{color:#ff3c6e;}
#bn-profile.active{color:#38bdf8;}
#bn-more.active{color:#94a3b8;}
/* Individual colors — removed, icons auto-colored */
#bn-feed.active,#bn-showcase.active,#bn-profile.active,#bn-more.active{color:var(--g3);}
.bn-item .bn-icon{line-height:1;display:flex;align-items:center;justify-content:center;transition:transform 0.25s cubic-bezier(0.34,1.56,0.64,1);}
.bn-item .bn-icon svg{width:36px;height:36px;border-radius:10px;}
.bn-item.active .bn-icon{transform:translateY(-3px) scale(1.18);}
.bn-item.bn-publish .bn-icon{transform:none !important;filter:none !important;}
.bn-item.bn-publish .bn-icon svg{width:28px;height:28px;border-radius:0;}
@keyframes bnPop{0%{transform:scale(1)}40%{transform:scale(1.3)}100%{transform:scale(1)}}
.bn-item.bn-just-activated .bn-icon{animation:bnPop 0.3s cubic-bezier(0.34,1.56,0.64,1);}
.bn-item .bn-dot{
  position:absolute;top:4px;right:calc(50% - 14px);
  width:6px;height:6px;background:var(--g3);border-radius:50%;
  box-shadow:0 0 5px var(--g3);display:none;
}
.bn-item .bn-dot.show{display:block;}
.bn-item.bn-publish{
  background:linear-gradient(135deg,var(--g1),var(--g2));
  border-radius:16px;
  width:50px;max-width:50px;height:50px;padding:0;margin:0 auto;margin-top:-8px;
  box-shadow:0 0 20px rgba(34,197,94,0.4), 0 4px 12px rgba(0,0,0,0.3);
  color:var(--bg) !important;
  flex:0 0 50px;
  transition:transform 0.15s, box-shadow 0.2s;
}
.bn-item.bn-publish svg{stroke:var(--bg) !important;}
.bn-item.bn-publish:active{transform:scale(0.9);box-shadow:0 0 10px rgba(34,197,94,0.3);}
.bn-item#bn-credits{position:relative;}
/* ── MOBILE MORE MENU ── */
.bn-more-overlay{position:fixed;inset:0;background:rgba(0,0,0,0.6);backdrop-filter:blur(4px);z-index:8000;display:flex;align-items:flex-end;justify-content:center;}
.bn-more-overlay.hidden{display:none!important;}
.bn-more-sheet{background:var(--s1);border:1.5px solid var(--border);border-radius:20px 20px 0 0;width:100%;max-width:480px;padding:12px 20px 32px;animation:slideUp 0.3s cubic-bezier(0.34,1.2,0.64,1);}
@keyframes slideUp{from{transform:translateY(100%)}to{transform:translateY(0)}}
.bn-more-handle{width:36px;height:4px;background:var(--border);border-radius:2px;margin:0 auto 16px;}
.bn-more-title{font-family:'DM Mono',monospace;font-size:10px;color:var(--muted);letter-spacing:2px;text-transform:uppercase;margin-bottom:16px;text-align:center;}
.bn-more-grid{display:grid;grid-template-columns:repeat(4,1fr);gap:8px;}
.bn-more-item{display:flex;flex-direction:column;align-items:center;gap:6px;background:var(--s2);border:1.5px solid var(--border2);border-radius:14px;padding:14px 8px;cursor:pointer;transition:all 0.2s;font-family:'Plus Jakarta Sans',sans-serif;font-size:11px;font-weight:600;color:var(--muted);}
.bn-more-item:hover,.bn-more-item:active{border-color:var(--g3);color:var(--g3);background:var(--glow);}
.bn-more-item.bn-more-logout{border-color:rgba(248,113,113,0.2);color:#f87171;}
.bn-more-item.bn-more-logout:hover,.bn-more-item.bn-more-logout:active{border-color:#f87171;background:rgba(248,113,113,0.08);color:#f87171;}
.bn-more-icon{font-size:22px;line-height:1;display:flex;align-items:center;justify-content:center;}
.bn-more-icon svg{width:38px;height:38px;border-radius:10px;}
.bn-item#bn-credits .bn-icon{font-size:18px;}
.bn-credits-val{font-family:'Bebas Neue',sans-serif;font-size:12px;color:var(--gold);line-height:1;margin-top:-1px;}

@media(max-width:768px){
  /* On home (landing): logo + auth buttons, hide links and hamburger */
  #landing .nav-links{display:none;}
  #landing .nav-right{display:flex;gap:8px;}
  #landing .nav-right .lang-btn{display:flex;}
  #landing .nav-right .btn-ghost-g,
  #landing .nav-right .btn-solid-g{display:flex;padding:8px 14px;font-size:12px;}
  #landing .hamburger{display:none !important;}
  /* Hide mobile-menu dropdown on home */
  #mobile-menu{display:none !important;}
  /* For app (app-active): normal behavior */
  body.app-active nav .nav-links{display:none;}
  body.app-active nav .nav-right{display:none;}
  body.app-active nav .hamburger{display:flex !important;}
  body.app-active #mobile-menu{display:block !important;}
  body.app-active .bottom-nav{display:flex;}
  body.app-active #app{padding-bottom:72px;}
  .app-bar{padding:0 3%;gap:0;}
  .app-logo{font-size:15px;letter-spacing:2px;margin-right:8px;}
}

/* HERO */
.hero{min-height:100vh;display:flex;flex-direction:column;align-items:center;justify-content:center;text-align:center;padding:80px 5% 40px;position:relative;z-index:1;}
.hero-badge{display:inline-flex;align-items:center;gap:8px;background:rgba(22,163,74,0.1);border:1px solid rgba(22,163,74,0.25);border-radius:4px;padding:7px 16px;font-size:12px;font-weight:600;color:var(--g4);margin-bottom:32px;letter-spacing:1px;text-transform:uppercase;animation:fadeUp 0.6s ease both;}
.pulse-dot{width:7px;height:7px;border-radius:50%;background:var(--g3);box-shadow:0 0 8px var(--g3);animation:blink 1.8s infinite;flex-shrink:0;}
.hero-concept{background:rgba(22,163,74,0.06);border:1px solid rgba(22,163,74,0.18);border-radius:12px;padding:18px 28px;margin-bottom:36px;max-width:660px;animation:fadeUp 0.6s 0.08s ease both;}
.hero-concept p{font-size:15px;color:var(--g5);line-height:1.8;font-weight:400;}
.hero-concept p strong{color:var(--g3);}
.hero h1{font-family:'Bebas Neue',sans-serif;font-size:clamp(72px,12vw,148px);letter-spacing:2px;line-height:0.88;margin-bottom:20px;animation:fadeUp 0.6s 0.12s ease both;}
.hero h1 .line1{display:block;color:var(--white);}
.hero h1 .line2{display:block;color:var(--g3);text-shadow:0 0 60px rgba(74,222,128,0.35);}
.hero-sub{font-size:16px;color:var(--muted);max-width:500px;line-height:1.8;margin-bottom:44px;animation:fadeUp 0.6s 0.18s ease both;}
.hero-actions{display:flex;gap:12px;flex-wrap:wrap;justify-content:center;margin-bottom:18px;animation:fadeUp 0.6s 0.24s ease both;}
.btn-hero-big{padding:15px 38px;border-radius:14px;font-family:'Plus Jakarta Sans',sans-serif;font-size:15px;font-weight:800;cursor:pointer;transition:all 0.3s;letter-spacing:0.3px;position:relative;overflow:hidden;}
.btn-hero-solid{background:linear-gradient(135deg,#15803d 0%,#22c55e 60%,#4ade80 100%);border:none;color:#020d04;box-shadow:0 0 40px rgba(34,197,94,0.5),0 4px 24px rgba(0,0,0,0.4),inset 0 1px 0 rgba(255,255,255,0.25);}
.btn-hero-solid::after{content:'';position:absolute;inset:0;background:linear-gradient(180deg,rgba(255,255,255,0.12) 0%,transparent 60%);border-radius:14px;pointer-events:none;}
.btn-hero-solid:hover{background:linear-gradient(135deg,#16a34a 0%,#4ade80 60%,#86efac 100%);box-shadow:0 0 70px rgba(74,222,128,0.65),0 6px 32px rgba(0,0,0,0.5),inset 0 1px 0 rgba(255,255,255,0.3);transform:translateY(-3px) scale(1.02);}
.btn-hero-out{background:transparent;border:1.5px solid var(--border);color:var(--g4);}
.btn-hero-out:hover{border-color:var(--g3);background:var(--glow);}
.hero-note{font-size:13px;color:var(--muted2);animation:fadeUp 0.6s 0.3s ease both;}
.hero-note span{color:var(--g4);}
.how-simple{display:flex;gap:0;justify-content:center;max-width:860px;width:100%;animation:fadeUp 0.6s 0.36s ease both;}
.how-step-simple{flex:1;text-align:center;padding:24px 18px;border:1px solid var(--border2);position:relative;}
.how-step-simple+.how-step-simple{border-left:none;}
.how-step-simple::before{content:attr(data-n);position:absolute;top:10px;left:12px;font-family:'DM Mono',monospace;font-size:10px;color:var(--muted2);letter-spacing:1px;}
.step-icon{font-size:26px;margin-bottom:10px;}
.how-step-simple h4{font-size:13px;font-weight:700;color:var(--g3);margin-bottom:5px;}
.how-step-simple p{font-size:12px;color:var(--muted);line-height:1.6;}

/* SECTION HELPERS */
.sec-label{font-family:'DM Mono',monospace;font-size:11px;color:var(--g4);letter-spacing:3px;text-transform:uppercase;margin-bottom:14px;display:block;}
h2.section-title{font-family:'Bebas Neue',sans-serif;font-size:clamp(36px,5vw,60px);letter-spacing:2px;color:var(--white);margin-bottom:8px;}
h2.section-title em{color:var(--g3);font-style:normal;}
.section-sub{color:var(--muted);font-size:15px;margin-bottom:48px;max-width:480px;}

/* SHOWCASE */
.showcase-section{padding:100px 5%;position:relative;z-index:1;}
.filters-row{display:flex;gap:8px;flex-wrap:wrap;margin-bottom:24px;}
.f-btn{padding:7px 18px;border-radius:4px;border:1.5px solid var(--border2);background:transparent;color:var(--muted);font-family:'Plus Jakarta Sans',sans-serif;font-size:12px;font-weight:600;cursor:pointer;transition:all 0.2s;}
.f-btn:hover,.f-btn.active{border-color:var(--g3);color:var(--g3);background:var(--glow);}
.showcase-grid{max-width:800px;margin:0 auto;display:flex;flex-direction:column;gap:10px;}
.v-card{background:linear-gradient(135deg,var(--s1),var(--s2));border:1.5px solid var(--border2);border-radius:16px;overflow:hidden;transition:all 0.3s cubic-bezier(0.4,0,0.2,1);cursor:pointer;display:flex;flex-direction:row;align-items:stretch;}
.v-card:hover{border-color:rgba(34,197,94,0.4);transform:translateX(4px);box-shadow:0 8px 40px rgba(0,0,0,0.45),0 0 20px rgba(34,197,94,0.07);}
.v-banner{width:64px;min-width:64px;height:64px;display:flex;align-items:center;justify-content:center;font-size:24px;position:relative;overflow:hidden;flex-shrink:0;border-radius:10px;margin:12px 0 12px 12px;}
.v-banner::after{display:none;}
.v-body{padding:10px 14px;flex:1;display:flex;flex-direction:column;justify-content:center;min-width:0;}
.v-cat{font-family:'DM Mono',monospace;font-size:8px;color:var(--g3);letter-spacing:2px;text-transform:uppercase;margin-bottom:2px;}
.v-name{font-size:13px;font-weight:800;margin-bottom:3px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;}
.v-desc{font-size:10px;color:var(--muted);line-height:1.5;margin-bottom:6px;display:-webkit-box;-webkit-line-clamp:1;-webkit-box-orient:vertical;overflow:hidden;}
.v-stats{display:flex;align-items:center;gap:10px;}
.v-stat{display:flex;align-items:center;gap:3px;font-family:'DM Mono',monospace;font-size:9px;color:var(--muted);font-weight:600;}
.v-votes{color:var(--g3);}
.v-follow-btn{padding:4px 10px;border-radius:20px;font-size:10px;font-weight:700;font-family:'DM Mono',monospace;cursor:pointer;transition:all 0.2s;border:1.5px solid rgba(34,197,94,0.4);background:transparent;color:var(--g3);white-space:nowrap;letter-spacing:0.5px;}
.v-follow-btn:hover{background:rgba(34,197,94,0.1);border-color:var(--g3);}
.v-follow-btn.following{border-color:var(--muted2);color:var(--muted);background:rgba(255,255,255,0.03);}
.v-follow-btn.following:hover{border-color:#f87171;color:#f87171;}

/* ── SHOWCASE INTERACTION BUTTONS ── */
.v-action-row{display:flex;align-items:center;gap:6px;margin-top:8px;}
.v-like-btn,.v-save-btn{display:flex;align-items:center;gap:4px;padding:4px 10px;border-radius:6px;font-size:10px;font-weight:700;font-family:"DM Mono",monospace;cursor:pointer;transition:all 0.2s;border:1.5px solid var(--border2);background:transparent;color:var(--muted);}
.v-like-btn:hover{border-color:#f87171;color:#f87171;background:rgba(248,113,113,0.08);}
.v-like-btn.liked{border-color:#f87171;color:#f87171;background:rgba(248,113,113,0.1);}
.v-save-btn:hover{border-color:#facc15;color:#facc15;background:rgba(250,204,21,0.08);}
.v-save-btn.saved{border-color:#facc15;color:#facc15;background:rgba(250,204,21,0.1);}
@keyframes heartPop{0%{transform:scale(1)}40%{transform:scale(1.5)}70%{transform:scale(0.9)}100%{transform:scale(1)}}
.v-like-btn.liked .v-heart{display:inline-block;animation:heartPop 0.4s cubic-bezier(0.34,1.56,0.64,1);}
/* ── FEED LIKE ANIMATION + SAVE ── */
@keyframes likeBurst{0%{transform:scale(1)}30%{transform:scale(1.45)}60%{transform:scale(0.9)}100%{transform:scale(1)}}
.btn-action.like-burst svg{animation:likeBurst 0.35s cubic-bezier(0.34,1.56,0.64,1);}
.btn-action.like-active{border-color:#f87171!important;color:#f87171!important;background:rgba(248,113,113,0.1)!important;}
.btn-action.save-active{border-color:#facc15!important;color:#facc15!important;background:rgba(250,204,21,0.1)!important;}

/* ── EXIT INTENT POPUP ── */

.exit-box{background:linear-gradient(145deg,var(--s1),var(--s2));border:2px solid rgba(34,197,94,0.3);border-radius:20px;max-width:360px;width:100%;padding:32px 28px;text-align:center;position:relative;animation:popIn 0.4s cubic-bezier(0.34,1.56,0.64,1);}
.exit-close{position:absolute;top:14px;right:14px;background:var(--s2);border:1px solid var(--border);border-radius:50%;width:28px;height:28px;display:flex;align-items:center;justify-content:center;cursor:pointer;font-size:12px;color:var(--muted);}
.exit-emoji{font-size:48px;margin-bottom:12px;}
.exit-title{font-family:'Bebas Neue',sans-serif;font-size:28px;letter-spacing:2px;color:var(--white);margin-bottom:8px;}
.exit-sub{font-size:13px;color:var(--muted);line-height:1.7;margin-bottom:16px;}
.exit-sub strong{color:var(--g4);}
.exit-perks{display:flex;flex-direction:column;gap:6px;margin-bottom:20px;text-align:left;}
.exit-perks span{font-size:12px;color:var(--g5);padding:6px 12px;background:rgba(34,197,94,0.05);border:1px solid var(--border2);border-radius:6px;}
.btn-exit-cta{width:100%;padding:13px;background:linear-gradient(135deg,var(--g1),var(--g3));border:none;border-radius:10px;font-family:'Plus Jakarta Sans',sans-serif;font-size:14px;font-weight:800;cursor:pointer;color:var(--bg);box-shadow:0 0 24px rgba(34,197,94,0.3);transition:all 0.2s;margin-bottom:12px;}
.btn-exit-cta:hover{transform:translateY(-1px);box-shadow:0 0 40px rgba(34,197,94,0.5);}
.exit-skip{font-size:11px;color:var(--muted2);cursor:pointer;text-decoration:underline;}
.exit-skip:hover{color:var(--muted);}

/* ── MODAL PROJET ── */
.project-modal-overlay{position:fixed;inset:0;background:rgba(0,0,0,0.75);backdrop-filter:blur(8px);z-index:9000;display:flex;align-items:center;justify-content:center;padding:20px;animation:fadeIn 0.2s ease;}
.project-modal-overlay.hidden{display:none!important;}
.project-modal{background:var(--s1);border:1.5px solid rgba(34,197,94,0.25);border-radius:18px;max-width:480px;width:100%;max-height:85vh;overflow-y:auto;position:relative;animation:popIn 0.3s cubic-bezier(0.34,1.56,0.64,1);}
.pmo-banner{height:130px;display:flex;align-items:center;justify-content:center;font-size:60px;position:relative;flex-shrink:0;}
.pmo-banner img{position:absolute;inset:0;width:100%;height:100%;object-fit:cover;}
.pmo-close{position:absolute;top:12px;right:12px;background:rgba(0,0,0,0.5);border:none;border-radius:50%;width:32px;height:32px;display:flex;align-items:center;justify-content:center;cursor:pointer;font-size:13px;color:#fff;z-index:2;}
.pmo-body{padding:20px 22px 24px;}
.pmo-cat{font-family:'DM Mono',monospace;font-size:9px;color:var(--g3);letter-spacing:2px;text-transform:uppercase;margin-bottom:5px;}
.pmo-name{font-family:'Bebas Neue',sans-serif;font-size:28px;letter-spacing:1.5px;color:var(--white);margin-bottom:8px;line-height:1.1;}
.pmo-hook{font-size:13px;color:var(--g4);font-weight:700;margin-bottom:10px;}
.pmo-desc{font-size:13px;color:#c4d9cb;line-height:1.75;margin-bottom:14px;}
.pmo-tags{display:flex;gap:5px;flex-wrap:wrap;margin-bottom:14px;}
.pmo-tag{font-family:'DM Mono',monospace;font-size:10px;padding:3px 9px;border-radius:3px;background:rgba(34,197,94,0.08);border:1px solid rgba(34,197,94,0.2);color:var(--g4);}
.pmo-url{display:flex;align-items:center;gap:8px;padding:11px 14px;background:rgba(22,163,74,0.07);border:1.5px solid rgba(34,197,94,0.2);border-radius:10px;text-decoration:none;margin-bottom:14px;transition:all 0.2s;}
.pmo-url:hover{border-color:var(--g3);background:rgba(22,163,74,0.14);}
.pmo-url span{font-family:'DM Mono',monospace;font-size:12px;color:var(--g4);flex:1;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;}
.pmo-footer{display:flex;align-items:center;justify-content:space-between;padding-top:14px;border-top:1px solid var(--border2);}
.pmo-author{display:flex;align-items:center;gap:8px;font-size:13px;color:var(--muted);}
.pmo-ava{width:28px;height:28px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:13px;font-weight:700;color:var(--bg);}
.pmo-actions{display:flex;gap:8px;}
.pmo-btn{display:flex;align-items:center;gap:5px;background:transparent;border:1.5px solid var(--border2);border-radius:6px;padding:6px 14px;font-size:12px;font-weight:700;cursor:pointer;color:var(--muted);transition:all 0.2s;font-family:'Plus Jakarta Sans',sans-serif;}
.pmo-btn:hover,.pmo-btn.voted{border-color:var(--g3);color:var(--g3);background:var(--glow);}
.pmo-btn-dm{border-color:rgba(34,197,94,0.2);color:var(--g4);}
.pmo-btn-dm:hover{border-color:var(--g3);background:var(--glow);}

.v-url-link{display:flex;align-items:center;gap:6px;padding:7px 10px;margin-bottom:10px;background:rgba(22,163,74,0.05);border:1.5px solid rgba(34,197,94,0.15);border-radius:8px;text-decoration:none;transition:all 0.2s;font-size:11px;color:var(--g4);}
.v-url-link:hover{border-color:rgba(34,197,94,0.4);background:rgba(22,163,74,0.12);color:var(--g3);}
.v-url-text{font-family:'DM Mono',monospace;font-size:11px;flex:1;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;}
.v-footer{display:flex;align-items:center;justify-content:space-between;margin-top:auto;}
.v-author{display:flex;align-items:center;gap:5px;font-size:11px;color:var(--muted);overflow:hidden;}
.v-ava{width:18px;height:18px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:9px;font-weight:700;color:var(--bg);background:var(--g2);flex-shrink:0;}
.v-actions{display:flex;align-items:center;gap:4px;}
.btn-vote-g{display:flex;align-items:center;gap:4px;background:transparent;border:1.5px solid var(--border2);border-radius:4px;padding:4px 10px;font-size:12px;font-weight:700;cursor:pointer;color:var(--muted);transition:all 0.2s;font-family:'DM Mono',monospace;}
.btn-vote-g:hover,.btn-vote-g.voted{border-color:var(--g3);color:var(--g3);background:var(--glow);}
.btn-dm-small{background:transparent;border:1.5px solid var(--border2);border-radius:4px;width:28px;height:28px;cursor:pointer;display:flex;align-items:center;justify-content:center;font-size:12px;transition:all 0.2s;}
.btn-dm-small:hover{border-color:var(--g3);background:var(--glow);}
.v-badge{position:absolute;top:5px;left:5px;background:var(--g2);color:var(--bg);font-family:'DM Mono',monospace;font-size:7px;font-weight:700;padding:2px 5px;letter-spacing:1px;z-index:2;border-radius:3px;}
.v-url-link{display:none;}

/* PLANS */
.plans-section{padding:100px 5%;position:relative;z-index:1;background:linear-gradient(180deg,transparent,var(--bg2),transparent);}
.plans-grid{max-width:1300px;margin:0 auto;display:grid;grid-template-columns:repeat(6,1fr);gap:12px;}
.plan-card.plan-legend{border-color:rgba(249,115,22,0.35);}
.plan-card.plan-legend:hover{border-color:rgba(249,115,22,0.7);box-shadow:0 16px 40px rgba(0,0,0,0.4),0 0 20px rgba(249,115,22,0.15);}
.plan-card.plan-vip{background:linear-gradient(160deg,rgba(255,215,0,0.04),rgba(255,140,0,0.03));border:1.5px solid rgba(255,215,0,0.35);}
.plan-card.plan-vip:hover{border-color:rgba(255,215,0,0.7);box-shadow:0 16px 40px rgba(0,0,0,0.4),0 0 28px rgba(255,215,0,0.2);}
.plan-card.plan-elite-card{border-color:rgba(168,85,247,0.35);}
.plan-card.plan-elite-card:hover{border-color:rgba(168,85,247,0.7);box-shadow:0 16px 40px rgba(0,0,0,0.4),0 0 20px rgba(168,85,247,0.15);}
/* Showcase plan badge inside v-banner */
.v-plan-badge{display:flex;flex-direction:column;align-items:center;justify-content:center;width:100%;height:100%;gap:4px;}
.v-plan-icon{font-size:26px;line-height:1;filter:drop-shadow(0 2px 6px rgba(0,0,0,0.6));}
.v-plan-name{font-family:'DM Mono',monospace;font-size:8px;font-weight:700;letter-spacing:2px;text-transform:uppercase;opacity:0.9;}
.plan-card{background:var(--s1);border:1.5px solid var(--border2);border-radius:12px;padding:28px 20px;position:relative;transition:all 0.3s;}
.plan-card:hover{background:var(--s2);border-color:rgba(34,197,94,0.35);transform:translateY(-3px);box-shadow:0 16px 40px rgba(0,0,0,0.4);}
.plan-card.recommended{background:var(--s2);border:1.5px solid var(--g3);border-top:3px solid var(--g3);}
.plan-badge{position:absolute;top:-1px;left:50%;transform:translateX(-50%);background:var(--g2);color:var(--bg);font-family:'DM Mono',monospace;font-size:9px;font-weight:700;padding:3px 10px;letter-spacing:1px;white-space:nowrap;}
.plan-name{font-family:'DM Mono',monospace;font-size:10px;color:var(--muted);letter-spacing:3px;text-transform:uppercase;margin-bottom:14px;}
.plan-card.recommended .plan-name{color:var(--g3);}
.plan-price{font-family:'Bebas Neue',sans-serif;font-size:48px;color:var(--white);letter-spacing:-1px;line-height:1;}
.plan-card.recommended .plan-price{color:var(--g3);text-shadow:0 0 20px rgba(74,222,128,0.3);}
.plan-period{font-size:12px;color:var(--muted);margin:3px 0 14px;}
.plan-desc{font-size:12px;color:var(--muted);line-height:1.6;margin-bottom:16px;min-height:40px;}
.plan-features{list-style:none;margin-bottom:24px;}
.plan-features li{font-size:12px;color:#5a8a68;padding:6px 0;border-bottom:1px solid var(--border2);display:flex;align-items:flex-start;gap:7px;line-height:1.5;}
.plan-features li:last-child{border:none;}
.plan-features li::before{content:'✓';color:var(--g3);font-size:10px;font-weight:700;flex-shrink:0;margin-top:2px;}
.plan-features li.no::before{content:'✗';color:var(--muted2);}
.plan-features li.no{color:var(--muted2);}
.btn-plan-g{width:100%;padding:11px;border-radius:6px;font-family:'Plus Jakarta Sans',sans-serif;font-size:13px;font-weight:700;cursor:pointer;transition:all 0.2s;}
.btn-plan-outline-g{background:transparent;border:1.5px solid var(--border);color:var(--g4);}
.btn-plan-outline-g:hover{border-color:var(--g3);background:var(--glow);}
.btn-plan-solid-g{background:var(--g2);border:none;color:var(--bg);box-shadow:0 0 16px rgba(22,163,74,0.3);}
.btn-plan-solid-g:hover{background:var(--g3);}

/* REVIEWS */
.reviews-section{padding:100px 5%;position:relative;z-index:1;}
.reviews-grid{max-width:1100px;margin:0 auto;display:grid;grid-template-columns:repeat(3,1fr);gap:12px;}
.rev-card{background:linear-gradient(160deg,var(--s1) 0%,var(--s2) 100%);border:1.5px solid var(--border2);border-radius:14px;padding:22px;transition:all 0.3s cubic-bezier(0.4,0,0.2,1);box-shadow:0 2px 10px rgba(0,0,0,0.3),inset 0 1px 0 rgba(255,255,255,0.03);}
.rev-card:hover{border-color:rgba(34,197,94,0.35);transform:translateY(-3px);box-shadow:0 10px 36px rgba(0,0,0,0.45),0 0 16px rgba(34,197,94,0.07);}
.rev-stars{color:var(--g3);font-size:12px;margin-bottom:10px;letter-spacing:2px;}
.rev-text{font-size:13px;color:#6a9478;line-height:1.8;margin-bottom:16px;}
.rev-text strong{color:var(--g4);}
.rev-author{display:flex;align-items:center;gap:10px;}
.rev-ava{width:34px;height:34px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:12px;font-weight:700;color:var(--bg);}
.rev-name{font-size:13px;font-weight:700;}
.rev-handle{font-size:11px;color:var(--muted);}
.rev-result{font-size:11px;color:var(--g3);font-weight:600;margin-top:1px;}

/* CTA / FOOTER */
.cta-section{padding:100px 5%;text-align:center;position:relative;z-index:1;border-top:1px solid var(--border2);}
.cta-section h2{font-family:'Bebas Neue',sans-serif;font-size:clamp(48px,8vw,96px);letter-spacing:2px;color:var(--g3);text-shadow:0 0 60px rgba(74,222,128,0.3);margin-bottom:14px;}
.cta-section p{color:var(--muted);font-size:15px;margin-bottom:36px;}
footer{background:var(--bg2);border-top:1px solid var(--border2);padding:28px 5%;display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap;gap:14px;position:relative;z-index:1;}
.footer-logo{font-family:'Bebas Neue',sans-serif;font-size:18px;color:var(--g3);letter-spacing:3px;}
footer p{color:var(--muted);font-size:11px;font-family:'DM Mono',monospace;}

/* MODALS */
.modal-bg{display:none;position:fixed;inset:0;background:rgba(4,10,5,0.92);backdrop-filter:blur(16px);z-index:500;align-items:center;justify-content:center;padding:16px;overflow-y:auto;}
.modal-bg.open{display:flex;animation:fadeIn 0.2s ease;}
.modal{background:var(--s1);border:1.5px solid var(--border);border-radius:16px;padding:36px;width:100%;max-width:480px;position:relative;animation:popIn 0.3s cubic-bezier(0.34,1.56,0.64,1);max-height:90vh;overflow-y:auto;}
.modal.wide{max-width:900px;}
.modal::before{content:'';position:absolute;top:0;left:50%;transform:translateX(-50%);width:60%;height:2px;background:linear-gradient(90deg,transparent,var(--g3),transparent);border-radius:100px;}
.modal-close{position:absolute;top:12px;right:12px;background:rgba(22,163,74,0.08);border:1.5px solid var(--border);border-radius:50%;width:28px;height:28px;cursor:pointer;color:var(--muted);font-size:12px;display:flex;align-items:center;justify-content:center;transition:all 0.2s;}
.modal-close:hover{border-color:var(--g3);color:var(--g3);}
.modal h2{font-family:'Bebas Neue',sans-serif;font-size:26px;letter-spacing:2px;color:var(--g3);margin-bottom:3px;}
.modal-sub{color:var(--muted);font-size:11px;margin-bottom:22px;font-family:'DM Mono',monospace;letter-spacing:1px;}
.fg{margin-bottom:12px;}
label{display:block;font-family:'DM Mono',monospace;font-size:10px;color:var(--g4);margin-bottom:4px;letter-spacing:1.5px;text-transform:uppercase;}
input,select,textarea{width:100%;padding:10px 13px;background:rgba(4,10,5,0.8);border:1.5px solid var(--border);border-radius:7px;font-family:'Plus Jakarta Sans',sans-serif;font-size:13px;color:var(--white);outline:none;transition:all 0.2s;}
input:focus,select:focus,textarea:focus{border-color:var(--g3);box-shadow:0 0 10px rgba(34,197,94,0.08);}
select option{background:var(--s1);}
textarea{resize:vertical;min-height:68px;}
.btn-modal-g{width:100%;padding:12px;background:var(--g2);border:none;border-radius:8px;font-family:'Plus Jakarta Sans',sans-serif;font-size:14px;font-weight:800;cursor:pointer;color:var(--bg);transition:all 0.2s;margin-top:6px;box-shadow:0 0 18px rgba(22,163,74,0.28);}
.btn-modal-g:hover{background:var(--g3);}
.btn-modal-g:disabled{opacity:0.4;cursor:not-allowed;}
.modal-switch{text-align:center;margin-top:12px;font-size:13px;color:var(--muted);}
.modal-switch a{color:var(--g3);cursor:pointer;font-weight:600;}

/* SIGNUP PLANS */
.signup-plans{display:grid;grid-template-columns:repeat(4,1fr);gap:8px;margin-bottom:18px;}
.sp-card{background:var(--bg);border:1.5px solid var(--border2);border-radius:10px;padding:12px 8px;text-align:center;cursor:pointer;transition:all 0.2s;position:relative;}
.sp-card:hover,.sp-card.selected{border-color:var(--g3);background:rgba(22,163,74,0.07);}
.sp-card.selected::after{content:'✓';position:absolute;top:5px;right:7px;color:var(--g3);font-size:10px;font-weight:700;}
.sp-plan{font-family:'DM Mono',monospace;font-size:8px;color:var(--muted);letter-spacing:2px;text-transform:uppercase;margin-bottom:3px;}
.sp-price{font-family:'Bebas Neue',sans-serif;font-size:26px;color:var(--g3);line-height:1;}
.sp-per{font-size:9px;color:var(--muted);}
.sp-feat{font-size:10px;color:#4a7a58;margin-top:5px;line-height:1.5;}

/* PAYMENT */
.pay-sum{background:rgba(22,163,74,0.07);border:1.5px solid rgba(22,163,74,0.18);border-radius:10px;padding:16px;text-align:center;margin-bottom:16px;}
.pay-plan{font-family:'DM Mono',monospace;font-size:9px;color:var(--muted);letter-spacing:2px;text-transform:uppercase;margin-bottom:5px;}
.pay-price{font-family:'Bebas Neue',sans-serif;font-size:44px;color:var(--g3);}
.pay-period{font-size:11px;color:var(--muted);}
#card-element{background:rgba(4,10,5,0.8);border:1.5px solid var(--border);border-radius:8px;padding:12px;margin-bottom:5px;}
#card-errors{color:#f87171;font-size:11px;min-height:14px;margin-bottom:7px;font-family:'DM Mono',monospace;}

/* APP BAR */
#app{display:none;min-height:100vh;}
/* ══════════════════════════════════════
   APP-BAR — PREMIUM REDESIGN PC
══════════════════════════════════════ */
.app-bar{
  background:rgba(4,10,5,0.92);
  border-bottom:1px solid rgba(34,197,94,0.1);
  padding:0 2%;
  height:68px;
  display:flex;align-items:center;
  position:sticky;top:0;z-index:100;
  backdrop-filter:blur(32px) saturate(160%);
  -webkit-backdrop-filter:blur(32px) saturate(160%);
  box-shadow:0 1px 0 rgba(34,197,94,0.06), 0 4px 24px rgba(0,0,0,0.5);
  gap:0;
}

/* Logo VB — point animé */
.app-logo{
  font-family:'Bebas Neue',sans-serif;font-size:20px;color:var(--g3);
  letter-spacing:3px;text-shadow:0 0 16px rgba(74,222,128,0.45);
  margin-right:20px;white-space:nowrap;flex-shrink:0;
  display:flex;align-items:center;gap:6px;
}
.app-logo::before{
  content:'';width:7px;height:7px;border-radius:50%;
  background:var(--g3);box-shadow:0 0 10px rgba(34,197,94,0.9);
  animation:blink 2s ease-in-out infinite;flex-shrink:0;
}

/* Tabs container */
.app-tabs{display:flex;flex:1;overflow-x:auto;gap:2px;scrollbar-width:none;align-items:center;height:100%;}
.app-tabs::-webkit-scrollbar{display:none;}

/* Chaque onglet */
.app-tab{
  position:relative;
  padding:0 12px;height:68px;
  display:flex;align-items:center;gap:5px;
  font-size:11.5px;font-weight:600;
  color:rgba(74,122,88,0.9);
  cursor:pointer;
  border:none;background:none;
  font-family:'Plus Jakarta Sans',sans-serif;white-space:nowrap;
  transition:color 0.18s, background 0.18s;
  border-radius:0;
  flex-shrink:0;
}
/* Indicateur bas animé */
.app-tab::after{
  content:'';
  position:absolute;bottom:0;left:50%;right:50%;
  height:2.5px;border-radius:2px 2px 0 0;
  background:var(--g3);
  box-shadow:0 0 8px rgba(34,197,94,0.7);
  transition:left 0.22s cubic-bezier(0.34,1.2,0.64,1), right 0.22s cubic-bezier(0.34,1.2,0.64,1), opacity 0.2s;
  opacity:0;
}
.app-tab:hover{color:var(--g5);background:rgba(34,197,94,0.04);}
.app-tab:hover::after{left:10px;right:10px;opacity:0.5;}
.app-tab.active{color:var(--white) !important;}
.app-tab.active::after{left:8px;right:8px;opacity:1;}
/* Fond subtil sur l'onglet actif */
.app-tab.active::before{
  content:'';position:absolute;inset:0;
  background:linear-gradient(180deg, transparent 0%, rgba(34,197,94,0.06) 100%);
  pointer-events:none;
}

/* Icônes — visibles sur PC avec petite taille */
.tab-icon{
  display:inline-flex;align-items:center;justify-content:center;
  width:22px;height:22px;border-radius:6px;
  font-size:13px;flex-shrink:0;
  opacity:0.8;
  transition:opacity 0.2s, transform 0.2s;
}
.app-tab.active .tab-icon{opacity:1;transform:scale(1.1);}
.app-tab:hover .tab-icon{opacity:1;}
@media(max-width:600px){
  .tab-icon{width:52px;height:52px;border-radius:14px;display:inline-flex !important;align-items:center;justify-content:center;font-size:26px;flex-shrink:0;box-shadow:0 3px 10px rgba(0,0,0,0.45);}
  .app-bar{display:none !important;}
  .app-logo{display:none;}
  .app-right{display:none !important;}
  .app-tabs{display:grid !important;grid-template-columns:repeat(4,1fr);gap:6px;overflow:visible;padding:0;}
  .app-tab{flex-direction:column;height:88px;padding:10px 4px 8px;gap:5px;font-size:10px;font-weight:600;border-bottom:none !important;border-radius:14px;background:rgba(11,26,13,0.85);border:1.5px solid var(--border2);color:var(--muted);justify-content:center;}
  .app-tab::after,.app-tab::before{display:none !important;}
  .app-tab.active{background:rgba(255,255,255,0.08);border-color:rgba(255,255,255,0.25);color:var(--white);}
  .app-tab:hover{background:rgba(255,255,255,0.05);}
  .notif-dot{position:absolute;top:6px;right:6px;margin:0;}
}
.notif-dot{width:5px;height:5px;background:var(--g3);border-radius:50%;margin-top:-10px;margin-left:-3px;box-shadow:0 0 5px var(--g3);flex-shrink:0;}
.app-right{margin-left:auto;display:flex;align-items:center;gap:8px;flex-shrink:0;padding-left:14px;border-left:1px solid rgba(34,197,94,0.08);}
.plan-chip{
  background:linear-gradient(135deg,var(--g1),var(--g2));
  color:var(--bg);font-family:'DM Mono',monospace;
  font-size:8px;font-weight:800;padding:3px 8px;
  border-radius:4px;letter-spacing:1.5px;
  box-shadow:0 0 10px rgba(22,163,74,0.3);
}
.user-chip{
  display:flex;align-items:center;gap:7px;
  background:rgba(11,26,13,0.8);
  border:1.5px solid rgba(34,197,94,0.15);
  border-radius:8px;padding:5px 11px;cursor:pointer;
  transition:all 0.2s;
}
.user-chip:hover{border-color:var(--g3);background:rgba(22,163,74,0.08);transform:translateY(-1px);}
.user-chip-ava{width:26px;height:26px;border-radius:50%;background:linear-gradient(135deg,var(--g1),var(--g2));display:flex;align-items:center;justify-content:center;font-size:12px;font-weight:800;color:var(--bg);box-shadow:0 0 8px rgba(34,197,94,0.3);}
.user-chip-name{font-size:12px;font-weight:700;max-width:80px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;}
.btn-out-g{
  background:transparent;
  border:1.5px solid rgba(248,113,113,0.2);
  border-radius:7px;padding:6px 13px;
  font-family:'DM Mono',monospace;font-size:10px;
  font-weight:700;letter-spacing:0.5px;
  cursor:pointer;color:rgba(248,113,113,0.6);
  transition:all 0.2s;
}
.btn-out-g:hover{border-color:#f87171;color:#f87171;background:rgba(248,113,113,0.06);}

/* APP PANELS */
.tpanel{display:none;content-visibility:auto;}
.tpanel.active{display:block;animation:fadeUp 0.22s ease;}

/* PUBLISH BOX */
/* ── COMPOSER TWEET-STYLE ── */
.composer-intro{margin-bottom:20px;padding:0 2px;}
.composer-intro-label{font-family:'DM Mono',monospace;font-size:9px;letter-spacing:3px;color:var(--g3);text-transform:uppercase;margin-bottom:6px;opacity:0.7;}
.composer-intro-title{font-family:'Bebas Neue',sans-serif;font-size:28px;letter-spacing:2px;color:var(--white);line-height:1;margin-bottom:5px;}
.composer-intro-sub{font-size:12px;color:var(--muted);line-height:1.6;}

.publish-box{background:var(--s1);border:1.5px solid var(--border2);border-radius:16px;padding:0;margin-bottom:22px;overflow:hidden;transition:border-color 0.25s,box-shadow 0.25s;}
.publish-box:focus-within{border-color:rgba(34,197,94,0.35);box-shadow:0 4px 40px rgba(34,197,94,0.06);}
.publish-top{display:flex;gap:12px;align-items:flex-start;padding:16px 16px 0;}
.pub-ava{width:36px;height:36px;border-radius:50%;background:var(--g2);display:flex;align-items:center;justify-content:center;font-size:14px;font-weight:700;color:var(--bg);flex-shrink:0;margin-top:2px;}
.pub-input-wrap{flex:1;display:flex;flex-direction:column;gap:10px;}
.pub-text{width:100%;background:transparent;border:none;font-family:'Plus Jakarta Sans',sans-serif;font-size:15px;color:var(--white);resize:none;outline:none;min-height:52px;max-height:200px;line-height:1.65;overflow:hidden;}
.pub-text::placeholder{color:var(--muted);}

.pub-type-card{background:var(--s1);border:2px solid rgba(34,197,94,0.15);border-radius:14px;padding:14px 16px;cursor:pointer;display:flex;align-items:center;gap:12px;transition:all 0.22s;}
.pub-type-card:hover{transform:translateY(-2px);box-shadow:0 6px 24px rgba(0,0,0,0.3);}
.pub-type-card.ptc-selected{transform:translateY(-2px);box-shadow:0 6px 28px rgba(0,0,0,0.4);outline:2px solid rgba(255,255,255,0.12);}
.ptc-icon{width:42px;height:42px;border-radius:10px;display:flex;align-items:center;justify-content:center;font-size:20px;flex-shrink:0;}
.ptc-body{flex:1;}
.ptc-name{font-size:14px;font-weight:800;color:var(--white);margin-bottom:2px;}
.ptc-desc{font-size:11px;color:var(--muted);margin-bottom:4px;}
.ptc-fields{font-size:10px;color:var(--muted2);font-family:'DM Mono',monospace;}
.pub-type-row{display:flex;gap:5px;flex-wrap:wrap;max-height:0;overflow:hidden;opacity:0;transition:max-height 0.3s ease,opacity 0.25s ease;}
.pub-type-row.visible{max-height:80px;opacity:1;}
.pub-type-pill{display:flex;align-items:center;gap:4px;padding:4px 11px;border-radius:20px;border:1.5px solid var(--border2);background:transparent;font-family:'Plus Jakarta Sans',sans-serif;font-size:11px;font-weight:600;color:var(--muted);cursor:pointer;transition:all 0.18s;white-space:nowrap;}
.pub-type-pill:hover{border-color:var(--g3);color:var(--g3);}
.pub-type-pill.active{border-color:var(--g2);color:var(--bg);background:var(--g2);}

.pub-proj-wrap{padding-bottom:2px;}
.pub-proj-wrap input{width:100%;padding:7px 11px;background:rgba(4,10,5,0.9);border:1.5px solid var(--border2);border-radius:8px;font-family:'Plus Jakarta Sans',sans-serif;font-size:12px;color:var(--white);outline:none;transition:border-color 0.2s;}
.pub-proj-wrap input:focus{border-color:rgba(34,197,94,0.4);}
.pub-proj-wrap input::placeholder{color:var(--muted2);}
.pub-url-trigger{display:inline-flex;align-items:center;gap:5px;background:transparent;border:1.5px solid var(--border2);border-radius:20px;padding:4px 12px;font-family:'Plus Jakarta Sans',sans-serif;font-size:11px;font-weight:600;color:var(--muted);cursor:pointer;transition:all 0.18s;}
.pub-url-trigger:hover{border-color:var(--g3);color:var(--g3);}
.pub-url-wrap{padding-top:0;}
.pub-url-inner{display:flex;align-items:center;gap:8px;background:rgba(4,10,5,0.85);border:1.5px solid var(--border2);border-radius:8px;padding:7px 12px;transition:border-color 0.2s;}
.pub-url-inner:focus-within{border-color:rgba(34,197,94,0.4);}
.pub-url-icon{font-size:13px;flex-shrink:0;}
.pub-url-wrap input{flex:1;background:transparent;border:none;outline:none;font-family:'DM Mono',monospace;font-size:12px;color:var(--g4);letter-spacing:0.3px;}
.pub-url-wrap input::placeholder{color:var(--muted2);}
.pub-url-close{background:transparent;border:none;color:var(--muted);font-size:11px;cursor:pointer;padding:0 2px;line-height:1;transition:color 0.15s;}
.pub-url-close:hover{color:#f87171;}

.pub-divider{height:1px;background:var(--border2);margin:14px 0 0;}
.pub-actions{display:flex;justify-content:flex-end;align-items:center;padding:10px 16px;gap:12px;}
.pub-meta{display:none;}
.pub-right{display:flex;align-items:center;gap:12px;}
.pub-char-count{font-family:'DM Mono',monospace;font-size:10px;color:var(--muted2);transition:color 0.2s,opacity 0.2s;}
.pub-limit{font-family:'DM Mono',monospace;font-size:9px;color:var(--muted2);letter-spacing:0.4px;}
.btn-publish{background:var(--g2);border:none;border-radius:20px;padding:8px 22px;font-family:'Plus Jakarta Sans',sans-serif;font-size:13px;font-weight:800;cursor:pointer;color:var(--bg);transition:all 0.2s;letter-spacing:0.2px;}
.btn-publish:hover{background:var(--g3);box-shadow:0 0 20px rgba(34,197,94,0.35);transform:translateY(-1px);}
.btn-publish:disabled{opacity:0.3;cursor:not-allowed;transform:none;box-shadow:none;}

/* FEED */
.feed-tabs{display:flex;gap:0;margin-bottom:16px;border-bottom:1px solid var(--border2);}
.feed-tab{padding:9px 18px;font-size:13px;font-weight:600;color:var(--muted);cursor:pointer;border-bottom:2px solid transparent;transition:all 0.2s;background:none;border-top:none;border-left:none;border-right:none;font-family:'Plus Jakarta Sans',sans-serif;}
.feed-tab.active{color:var(--g3);border-bottom-color:var(--g3);}
.post-card{background:linear-gradient(160deg,var(--s1) 0%,var(--s2) 100%);border:1.5px solid var(--border2);border-radius:16px;padding:20px;margin-bottom:14px;transition:all 0.3s cubic-bezier(0.4,0,0.2,1);box-shadow:0 2px 12px rgba(0,0,0,0.3),inset 0 1px 0 rgba(255,255,255,0.03);}
.post-card:hover{border-color:rgba(34,197,94,0.35);transform:translateY(-3px);box-shadow:0 12px 40px rgba(0,0,0,0.5),0 0 20px rgba(34,197,94,0.08),inset 0 1px 0 rgba(74,222,128,0.06);background:linear-gradient(160deg,#0d1f10 0%,#0f2312 100%);}
.post-card.elite-post{border-color:rgba(255,215,0,0.3)!important;box-shadow:0 2px 12px rgba(0,0,0,0.3),0 0 16px rgba(255,215,0,0.06);}
.post-card.elite-post:hover{border-color:rgba(255,215,0,0.55)!important;box-shadow:0 12px 40px rgba(0,0,0,0.5),0 0 24px rgba(255,215,0,0.12);}
.post-url-card{display:flex;align-items:center;gap:8px;margin:10px 0 4px;padding:10px 14px;background:rgba(22,163,74,0.05);border:1.5px solid rgba(34,197,94,0.15);border-radius:10px;text-decoration:none;transition:all 0.2s;cursor:pointer;}
.post-url-card:hover{border-color:rgba(34,197,94,0.4);background:rgba(22,163,74,0.1);}
.post-url-icon{font-size:14px;flex-shrink:0;}
.post-url-text{font-family:'DM Mono',monospace;font-size:12px;color:var(--g4);flex:1;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;}
.post-url-arrow{font-size:14px;color:var(--g3);flex-shrink:0;}
.post-header{display:flex;align-items:center;gap:9px;margin-bottom:12px;}
.post-ava{width:36px;height:36px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:14px;font-weight:700;color:var(--bg);flex-shrink:0;cursor:pointer;}
.post-meta{flex:1;}
.post-author{font-size:14px;font-weight:700;cursor:pointer;transition:color 0.2s;}
.post-author:hover{color:var(--g3);}
.post-info{font-size:11px;color:var(--muted);font-family:'DM Mono',monospace;display:flex;align-items:center;gap:6px;flex-wrap:wrap;}
.chat-msg-plan-badge{font-family:'DM Mono',monospace;font-size:8px;padding:1px 5px;border-radius:2px;letter-spacing:0.5px;}
.plan-free{background:rgba(107,114,128,0.2);color:#9ca3af;}
.plan-starter{background:rgba(34,197,94,0.15);color:#4ade80;}
.plan-pro{background:rgba(59,130,246,0.2);color:#60a5fa;}
.plan-elite{background:rgba(168,85,247,0.2);color:#c084fc;box-shadow:0 0 5px rgba(168,85,247,0.2);}
.plan-legend{background:rgba(249,115,22,0.2);color:#fb923c;box-shadow:0 0 5px rgba(249,115,22,0.25);}
.plan-vip{background:linear-gradient(135deg,rgba(255,215,0,0.2),rgba(255,179,0,0.15));color:#ffd700;box-shadow:0 0 8px rgba(255,215,0,0.3);}
.post-content{font-size:14px;line-height:1.7;color:#c4d9cb;margin-bottom:12px;}
.post-project{background:var(--s2);border:1.5px solid var(--border2);border-radius:10px;padding:12px;margin-bottom:12px;display:flex;gap:10px;align-items:center;transition:all 0.2s;}
.post-project:hover{border-color:rgba(34,197,94,0.22);}
.post-proj-icon{width:42px;height:42px;background:var(--s3);border-radius:10px;display:flex;align-items:center;justify-content:center;flex-shrink:0;}
.post-proj-svg{width:22px;height:22px;display:flex;align-items:center;justify-content:center;}
.post-proj-svg svg{width:22px;height:22px;}
.post-proj-name{font-size:13px;font-weight:700;margin-bottom:2px;}
.post-proj-cat{font-family:'DM Mono',monospace;font-size:9px;color:var(--g3);letter-spacing:1px;text-transform:uppercase;}
.post-proj-desc{font-size:11px;color:var(--muted);margin-top:3px;}
.post-timer{font-family:'DM Mono',monospace;font-size:10px;color:var(--g4);background:rgba(22,163,74,0.1);border:1px solid rgba(22,163,74,0.15);border-radius:3px;padding:2px 7px;display:inline-flex;align-items:center;gap:3px;}
.post-actions{display:flex;gap:5px;align-items:center;flex-wrap:wrap;}
.btn-action{background:transparent;border:1.5px solid var(--border2);border-radius:6px;padding:5px 12px;font-size:12px;font-weight:600;cursor:pointer;color:var(--muted);transition:all 0.2s;display:flex;align-items:center;gap:4px;font-family:'Plus Jakarta Sans',sans-serif;}
.btn-action:hover{border-color:var(--g3);color:var(--g3);}
.btn-action.active{border-color:var(--g3);color:var(--g3);background:var(--glow);}

/* WORLD CHAT PANEL */
.chat-panel-container{max-width:740px;margin:0 auto;padding:24px 0;}
.chat-box{background:var(--s1);border:1.5px solid var(--border2);border-radius:12px;display:flex;flex-direction:column;height:500px;}
.chat-msgs-area{flex:1;overflow-y:auto;padding:18px;display:flex;flex-direction:column;gap:9px;}
.chat-msgs-area::-webkit-scrollbar{width:3px;}
.chat-msgs-area::-webkit-scrollbar-thumb{background:var(--muted2);border-radius:2px;}
.chat-msg-item{background:var(--s2);border-radius:8px;padding:8px 11px;}
.chat-msg-name{font-size:11px;font-weight:700;color:var(--g4);margin-bottom:2px;display:flex;align-items:center;gap:6px;flex-wrap:wrap;}
.chat-msg-text{font-size:13px;color:#7a9a82;line-height:1.5;}
.chat-input-row{padding:12px 14px;border-top:1px solid var(--border2);display:flex;gap:7px;}
.chat-input-field{flex:1;background:var(--s2);border:1.5px solid var(--border2);border-radius:7px;padding:9px 12px;font-family:'Plus Jakarta Sans',sans-serif;font-size:13px;color:var(--white);outline:none;transition:all 0.2s;}
.chat-input-field:focus{border-color:var(--g3);}
.btn-send{background:var(--g2);border:none;border-radius:7px;width:38px;height:38px;cursor:pointer;display:flex;align-items:center;justify-content:center;font-size:14px;color:var(--bg);transition:all 0.2s;flex-shrink:0;}
.btn-send:hover{background:var(--g3);}

/* PROFILE */
.profile-banner{height:160px;background:linear-gradient(135deg,var(--s2),var(--s3));border-radius:12px;position:relative;margin-bottom:52px;}
.profile-avatar{position:absolute;bottom:-40px;left:22px;width:80px;height:80px;border-radius:50%;border:3px solid var(--bg);display:flex;align-items:center;justify-content:center;font-size:30px;font-weight:700;color:var(--bg);box-shadow:0 0 20px rgba(22,163,74,0.25);line-height:1;overflow:hidden;}
.profile-edit-btn{position:absolute;top:14px;right:14px;background:rgba(4,10,5,0.7);border:1.5px solid var(--border);border-radius:6px;padding:6px 12px;font-size:12px;font-weight:600;cursor:pointer;color:var(--g4);transition:all 0.2s;font-family:'Plus Jakarta Sans',sans-serif;}
.profile-edit-btn:hover{border-color:var(--g3);color:var(--g3);}
.profile-info{padding:0 22px;}
.profile-name{font-family:'Bebas Neue',sans-serif;font-size:28px;letter-spacing:1px;margin-bottom:2px;}
.profile-handle{font-family:'DM Mono',monospace;font-size:11px;color:var(--g4);margin-bottom:9px;display:flex;align-items:center;gap:8px;}
.profile-bio{font-size:13px;color:var(--muted);line-height:1.7;max-width:600px;margin-bottom:14px;}
.profile-tags{display:flex;gap:5px;flex-wrap:wrap;margin-bottom:14px;}
.profile-tag{background:rgba(22,163,74,0.08);border:1px solid rgba(22,163,74,0.18);border-radius:3px;padding:2px 9px;font-size:10px;color:var(--g4);font-family:'DM Mono',monospace;}
.profile-stats{display:flex;gap:20px;margin-bottom:16px;}
.pstat{text-align:center;}
.pstat-num{font-family:'Bebas Neue',sans-serif;font-size:22px;color:var(--g3);}
.pstat-label{font-size:10px;color:var(--muted);}
.profile-links{display:flex;gap:6px;flex-wrap:wrap;margin-bottom:14px;}
.profile-link{display:flex;align-items:center;gap:5px;background:var(--s1);border:1.5px solid var(--border2);border-radius:5px;padding:5px 10px;font-size:11px;color:var(--muted);text-decoration:none;transition:all 0.2s;cursor:pointer;}
.profile-link:hover{border-color:var(--g3);color:var(--g3);}
.profile-fields{display:grid;grid-template-columns:repeat(3,1fr);gap:10px;margin:16px 0;padding:16px;background:var(--s1);border:1.5px solid var(--border2);border-radius:10px;}
.pfield{display:flex;flex-direction:column;gap:2px;}
.pfield-label{font-family:'DM Mono',monospace;font-size:8px;color:var(--muted2);letter-spacing:1.5px;text-transform:uppercase;}
.pfield-value{font-size:12px;color:var(--white);}
.profile-actions{display:flex;gap:7px;margin-bottom:20px;}
.btn-follow{background:var(--g2);border:none;border-radius:6px;padding:8px 20px;font-family:'Plus Jakarta Sans',sans-serif;font-size:13px;font-weight:700;cursor:pointer;color:var(--bg);transition:all 0.2s;}
.btn-follow:hover{background:var(--g3);}
.btn-follow.following{background:transparent;border:1.5px solid var(--border);color:var(--muted);}
.btn-dm-profile{background:transparent;border:1.5px solid var(--border);border-radius:6px;padding:8px 16px;font-family:'Plus Jakarta Sans',sans-serif;font-size:13px;font-weight:600;cursor:pointer;color:var(--g4);transition:all 0.2s;}
.btn-dm-profile:hover{border-color:var(--g3);color:var(--g3);}

/* EDIT PROFILE */
.edit-section{background:var(--s2);border:1.5px solid var(--border2);border-radius:10px;padding:20px;margin-bottom:12px;}
.edit-section h3{font-family:'DM Mono',monospace;font-size:10px;color:var(--g3);letter-spacing:2px;text-transform:uppercase;margin-bottom:14px;}
.edit-grid{display:grid;grid-template-columns:1fr 1fr;gap:10px;}
.edit-avatar-row{display:flex;align-items:flex-start;gap:14px;margin-bottom:14px;}
.edit-avatar-big{width:72px;height:72px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:28px;font-weight:700;color:var(--bg);flex-shrink:0;position:relative;cursor:pointer;overflow:hidden;border:2.5px solid rgba(34,197,94,0.3);transition:border-color 0.2s;}
.edit-avatar-big:hover{border-color:var(--g3);}
.edit-avatar-big img{width:100%;height:100%;object-fit:cover;position:absolute;inset:0;border-radius:50%;}
.edit-avatar-big .ava-upload-overlay{position:absolute;inset:0;background:rgba(0,0,0,0.55);display:flex;align-items:center;justify-content:center;opacity:0;transition:opacity 0.2s;border-radius:50%;font-size:20px;pointer-events:none;}
.edit-avatar-big:hover .ava-upload-overlay{opacity:1;}
.edit-avatar-big.has-photo .ava-upload-overlay{display:none!important;}
#edit-ava-emoji{position:relative;z-index:1;line-height:1;pointer-events:none;}
.emoji-picker{display:flex;gap:5px;flex-wrap:wrap;}
.emoji-opt{width:32px;height:32px;border-radius:8px;border:2px solid transparent;cursor:pointer;display:flex;align-items:center;justify-content:center;font-size:16px;transition:all 0.2s;background:var(--s2);}
.emoji-opt:hover,.emoji-opt.selected{border-color:var(--g3);background:rgba(22,163,74,0.12);}
.emoji-opt.premium-emoji{position:relative;}
.emoji-opt.premium-emoji::after{content:'⭐';position:absolute;top:-4px;right:-4px;font-size:8px;background:linear-gradient(135deg,#ffd700,#ff8c00);border-radius:50%;width:12px;height:12px;display:flex;align-items:center;justify-content:center;padding:0;}
/* Media upload improved */
.media-upload-bar{display:flex;gap:8px;align-items:center;padding:8px 0;}
.media-btn{display:flex;align-items:center;gap:5px;background:var(--s2);border:1.5px solid var(--border2);border-radius:8px;padding:7px 12px;font-size:12px;font-weight:600;color:var(--muted);cursor:pointer;transition:all 0.2s;font-family:'Plus Jakarta Sans',sans-serif;}
.media-btn:hover{border-color:var(--g3);color:var(--g3);}
.media-btn input{display:none;}
.media-btn .media-btn-icon{font-size:16px;}

/* DM */
.dm-thread{display:flex;flex-direction:column;height:380px;}
.dm-msgs{flex:1;overflow-y:auto;display:flex;flex-direction:column;gap:7px;padding-bottom:6px;}
.dm-msg{display:flex;flex-direction:column;max-width:75%;}
.dm-msg.mine{align-self:flex-end;align-items:flex-end;}
.dm-msg.theirs{align-self:flex-start;}
.dm-bubble-g{padding:9px 13px;border-radius:12px;font-size:13px;line-height:1.5;}
.dm-msg.mine .dm-bubble-g{background:var(--g2);color:var(--bg);border-bottom-right-radius:3px;}
.dm-msg.theirs .dm-bubble-g{background:var(--s2);border:1px solid var(--border2);border-bottom-left-radius:3px;}
.dm-time{font-size:9px;color:var(--muted);margin-top:2px;font-family:'DM Mono',monospace;}
.dm-input-row{display:flex;gap:7px;margin-top:10px;border-top:1px solid var(--border2);padding-top:10px;}

/* ELITE GOLD ACTIONS */
.elite-action { border-color: #d4af37 !important; color: #f5c842 !important; background: rgba(212,175,55,0.08) !important; }
.elite-action:hover { border-color: #f5c842 !important; box-shadow: 0 0 12px rgba(212,175,55,0.3) !important; }
.elite-action.active { background: rgba(212,175,55,0.15) !important; }
.plan-elite-action { border-color: #d4af37 !important; color: #f5c842 !important; }
.badge-elite-gold { color: #f5c842; text-shadow: 0 0 8px rgba(212,175,55,0.5); }

/* GROUP CARDS */
.group-card { background:var(--s1);border:1.5px solid var(--border2);border-radius:12px;overflow:hidden;transition:all 0.3s;cursor:pointer; }
.group-card:hover { border-color:rgba(34,197,94,0.35);transform:translateY(-2px);box-shadow:0 12px 36px rgba(0,0,0,0.4); }
.group-banner { height:90px;display:flex;align-items:center;justify-content:center;font-size:36px;position:relative;background:linear-gradient(135deg,var(--s2),var(--s3)); }
.group-body { padding:14px 16px; }
.group-name { font-size:15px;font-weight:700;margin-bottom:4px; }
.group-desc { font-size:12px;color:var(--muted);line-height:1.6;margin-bottom:10px; }
.group-footer { display:flex;align-items:center;justify-content:space-between; }
.group-meta { font-family:'DM Mono',monospace;font-size:10px;color:var(--muted2); }

/* MEDIA PREVIEW */
.media-preview-item { display:flex;align-items:center;gap:8px;background:var(--s2);border:1.5px solid var(--border2);border-radius:8px;padding:8px 12px;margin-top:6px;font-size:12px;color:var(--muted); }
.media-preview-item img, .media-preview-item video { max-width:100px;max-height:70px;border-radius:4px;object-fit:cover; }
.media-preview-item .remove-media { cursor:pointer;color:#f87171;margin-left:auto; }

/* POST MEDIA */
.post-media { width:100%;border-radius:12px;margin-bottom:10px;max-height:320px;object-fit:cover;cursor:zoom-in;transition:transform 0.3s;display:block; }
.post-media:hover { transform:scale(1.01); }
.post-media-video { width:100%;border-radius:12px;margin-bottom:10px;max-height:320px; }

/* REPORT BTN */
.btn-report { background:transparent;border:1.5px solid var(--border2);border-radius:6px;padding:5px 10px;font-size:11px;cursor:pointer;color:var(--muted);transition:all 0.2s;font-family:'Plus Jakarta Sans',sans-serif; }
.btn-report:hover { border-color:#f87171;color:#f87171; }

/* CONTACT ADMIN BTN (ELITE in profile) */
.btn-contact-admin { background:linear-gradient(135deg,rgba(212,175,55,0.15),rgba(245,200,66,0.1));border:1.5px solid rgba(212,175,55,0.4);border-radius:6px;padding:8px 16px;font-family:'Plus Jakarta Sans',sans-serif;font-size:13px;font-weight:600;cursor:pointer;color:#f5c842;transition:all 0.2s; }
.btn-contact-admin:hover { border-color:#f5c842;box-shadow:0 0 12px rgba(212,175,55,0.25); }
.follow-list{display:flex;flex-direction:column;gap:7px;}
.follow-item{display:flex;align-items:center;gap:9px;padding:10px 12px;background:var(--s1);border:1.5px solid var(--border2);border-radius:8px;transition:all 0.2s;}
.follow-item:hover{border-color:rgba(34,197,94,0.2);}
.follow-item-ava{width:34px;height:34px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:14px;font-weight:700;color:var(--bg);flex-shrink:0;}
.follow-item-name{font-size:13px;font-weight:700;flex:1;}
.follow-item-sub{font-size:11px;color:var(--muted);}
.btn-dm-list{background:transparent;border:1.5px solid var(--border2);border-radius:5px;width:28px;height:28px;cursor:pointer;display:flex;align-items:center;justify-content:center;font-size:12px;transition:all 0.2s;flex-shrink:0;}
.btn-dm-list:hover{border-color:var(--g3);}
.btn-follow-list{background:var(--g2);border:none;border-radius:5px;padding:5px 10px;font-size:11px;font-weight:700;cursor:pointer;color:var(--bg);transition:all 0.2s;flex-shrink:0;}
.btn-follow-list:hover{background:var(--g3);}
.btn-follow-list.following{background:transparent;border:1px solid var(--border);color:var(--muted);}

/* IA BOOST */
.boost-type-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:8px;margin-bottom:0;}
.boost-type-card{background:var(--bg);border:1.5px solid var(--border2);border-radius:8px;padding:12px 8px;text-align:center;cursor:pointer;transition:all 0.2s;font-size:22px;}
.boost-type-card:hover,.boost-type-card.selected{border-color:var(--g3);background:rgba(22,163,74,0.07);}
.boost-type-card span{display:block;font-size:11px;color:var(--muted);margin-top:4px;font-weight:600;}
.boost-type-card.selected span{color:var(--g3);}

/* UPGRADE */
.upgrade-strip{background:rgba(22,163,74,0.05);border:1.5px solid rgba(22,163,74,0.14);border-radius:10px;padding:14px 18px;display:flex;align-items:center;justify-content:space-between;gap:10px;flex-wrap:wrap;margin-top:14px;}
.upgrade-strip h4{font-size:13px;font-weight:700;color:var(--g4);margin-bottom:2px;}
.upgrade-strip p{font-size:11px;color:var(--muted);}

/* DOTS */
.dots{display:inline-flex;gap:3px;align-items:center;}
.dots span{width:5px;height:5px;border-radius:50%;background:var(--g3);animation:bounce 1.2s ease infinite;}
.dots span:nth-child(2){animation-delay:.2s;}
.dots span:nth-child(3){animation-delay:.4s;}

/* TOAST */
#toast-container{position:fixed;bottom:22px;right:22px;z-index:9999;display:flex;flex-direction:column;gap:7px;pointer-events:none;}
.toast-g{background:var(--s2);border:1.5px solid var(--border);border-radius:10px;padding:11px 16px;font-size:13px;font-weight:600;color:var(--white);display:flex;align-items:center;gap:7px;box-shadow:0 8px 30px rgba(0,0,0,0.5);pointer-events:auto;animation:toastIn 0.4s ease both;min-width:200px;}
.toast-g.success{border-color:rgba(22,163,74,0.4);}

/* ── NEW FEATURES ── */

/* ANALYTICS DASHBOARD */
.analytics-grid{display:grid;grid-template-columns:repeat(4,1fr);gap:12px;margin-bottom:20px;}
.stat-card{background:var(--s1);border:1.5px solid var(--border2);border-radius:10px;padding:16px 18px;transition:all 0.2s;}
.stat-card:hover{border-color:rgba(34,197,94,0.25);}
.stat-card-label{font-family:'DM Mono',monospace;font-size:10px;color:var(--muted);letter-spacing:2px;text-transform:uppercase;margin-bottom:6px;}
.stat-card-value{font-family:'Bebas Neue',sans-serif;font-size:36px;color:var(--g3);line-height:1;}
.stat-card-sub{font-size:11px;color:var(--muted);margin-top:3px;}
.stat-card-trend{font-size:11px;font-weight:700;margin-top:5px;}
.stat-card-trend.up{color:#4ade80;}
.stat-card-trend.down{color:#f87171;}
.chart-wrap{background:var(--s1);border:1.5px solid var(--border2);border-radius:10px;padding:18px;margin-bottom:16px;}
.chart-title{font-family:'DM Mono',monospace;font-size:10px;color:var(--g4);letter-spacing:2px;text-transform:uppercase;margin-bottom:14px;}
.mini-chart{display:flex;align-items:flex-end;gap:4px;height:60px;}
.mini-bar{flex:1;background:var(--g2);border-radius:3px 3px 0 0;opacity:0.7;transition:opacity 0.2s;cursor:pointer;}
.mini-bar:hover{opacity:1;}
.mini-chart-labels{display:flex;gap:4px;margin-top:5px;}
.mini-chart-labels span{flex:1;font-family:'DM Mono',monospace;font-size:8px;color:var(--muted2);text-align:center;}

/* BOOST TOKENS / CREDITS */
.credits-bar{background:var(--s1);border:1.5px solid rgba(255,215,0,0.2);border-radius:10px;padding:12px 16px;display:flex;align-items:center;justify-content:space-between;margin-bottom:16px;flex-wrap:wrap;gap:10px;}
.credits-info{display:flex;align-items:center;gap:8px;}
.credits-icon{font-size:20px;}
.credits-count{font-family:'Bebas Neue',sans-serif;font-size:28px;color:var(--gold);line-height:1;}
.credits-label{font-size:11px;color:var(--muted);}
.btn-buy-credits{background:linear-gradient(135deg,rgba(255,215,0,0.15),rgba(255,179,0,0.1));border:1.5px solid rgba(255,215,0,0.4);border-radius:6px;padding:7px 16px;font-size:12px;font-weight:700;cursor:pointer;color:var(--gold);transition:all 0.2s;font-family:'Plus Jakarta Sans',sans-serif;}
.btn-buy-credits:hover{box-shadow:0 0 12px rgba(255,215,0,0.3);}
.boost-options{display:grid;grid-template-columns:repeat(3,1fr);gap:10px;margin-bottom:14px;}
.boost-opt{background:var(--s1);border:1.5px solid var(--border2);border-radius:10px;padding:14px;text-align:center;cursor:pointer;transition:all 0.2s;}
.boost-opt:hover,.boost-opt.selected{border-color:var(--gold);background:rgba(255,215,0,0.04);}
.boost-opt-icon{font-size:24px;margin-bottom:5px;}
.boost-opt-name{font-size:12px;font-weight:700;color:var(--g5);margin-bottom:3px;}
.boost-opt-cost{font-family:'DM Mono',monospace;font-size:11px;color:var(--gold);}
.boost-opt-desc{font-size:10px;color:var(--muted);margin-top:4px;}

/* A/B TEST IA */
.ab-compare{display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-bottom:14px;}
.ab-side{background:var(--s1);border:1.5px solid var(--border2);border-radius:10px;padding:14px;}
.ab-side-label{font-family:'DM Mono',monospace;font-size:9px;letter-spacing:2px;text-transform:uppercase;margin-bottom:7px;}
.ab-side-label.a{color:#4ade80;}
.ab-side-label.b{color:#60a5fa;}
.ab-result{background:var(--s2);border:1.5px solid rgba(34,197,94,0.2);border-radius:10px;padding:14px;margin-top:12px;}
.ab-winner{font-family:'Bebas Neue',sans-serif;font-size:20px;color:var(--g3);margin-bottom:6px;}
.ab-analysis{font-size:12px;color:#7a9a82;line-height:1.8;white-space:pre-wrap;}

/* LEADERBOARD */
.leaderboard-list{display:flex;flex-direction:column;gap:8px;}
.lb-item{display:flex;align-items:center;gap:12px;background:var(--s1);border:1.5px solid var(--border2);border-radius:10px;padding:12px 16px;transition:all 0.2s;}
.lb-item:hover{border-color:rgba(34,197,94,0.2);}
.lb-item.top1{border-color:rgba(255,215,0,0.4);background:rgba(255,215,0,0.03);}
.lb-item.top2{border-color:rgba(192,192,192,0.35);}
.lb-item.top3{border-color:rgba(205,127,50,0.35);}
.lb-rank{font-family:'Bebas Neue',sans-serif;font-size:22px;width:30px;text-align:center;flex-shrink:0;}
.lb-item.top1 .lb-rank{color:var(--gold);}
.lb-item.top2 .lb-rank{color:#c0c0c0;}
.lb-item.top3 .lb-rank{color:#cd7f32;}
.lb-info{flex:1;}
.lb-name{font-size:14px;font-weight:700;margin-bottom:2px;}
.lb-sub{font-size:11px;color:var(--muted);}
.lb-score{font-family:'DM Mono',monospace;font-size:13px;color:var(--g3);font-weight:700;text-align:right;}
.lb-medal{font-size:18px;}

/* RÉACTIONS ENRICHIES */
.reactions-row{display:flex;gap:4px;flex-wrap:wrap;margin-top:8px;padding-top:8px;border-top:1px solid var(--border2);}
.react-btn{display:flex;align-items:center;gap:3px;background:transparent;border:1.5px solid var(--border2);border-radius:20px;padding:4px 10px;font-size:13px;cursor:pointer;color:var(--muted);transition:all 0.2s;font-family:'Plus Jakarta Sans',sans-serif;position:relative;}
.react-btn:hover{transform:scale(1.08);}
.react-btn.active-fire{border-color:#f97316;color:#f97316;background:rgba(249,115,22,0.1);}
.react-btn.active-money{border-color:#4ade80;color:#4ade80;background:rgba(74,222,128,0.1);}
.react-btn.active-bulb{border-color:#facc15;color:#facc15;background:rgba(250,204,21,0.1);}
.react-btn.active-rocket{border-color:#818cf8;color:#818cf8;background:rgba(129,140,248,0.1);}
.react-btn.active-crown{border-color:#ffd700;color:#ffd700;background:rgba(255,215,0,0.1);}
.react-btn.active-gem{border-color:#22d3ee;color:#22d3ee;background:rgba(34,211,238,0.1);}
.react-btn.active-clap{border-color:#fb923c;color:#fb923c;background:rgba(251,146,60,0.1);}
.react-btn.active-eyes{border-color:#a78bfa;color:#a78bfa;background:rgba(167,139,250,0.1);}
.react-btn.active-star{border-color:#ffd700;color:#ffd700;background:rgba(255,215,0,0.1);}
.react-btn.active-zap{border-color:#86efac;color:#86efac;background:rgba(134,239,172,0.1);}
/* Reactions premium lockées */
.react-btn.premium-lock{opacity:0.5;}
.react-btn.premium-lock::after{content:'🔒';position:absolute;top:-5px;right:-5px;font-size:9px;background:linear-gradient(135deg,#ffd700,#ff8c00);border-radius:50%;width:14px;height:14px;display:flex;align-items:center;justify-content:center;padding:0;}
.react-premium-tip{position:absolute;bottom:calc(100% + 6px);left:50%;transform:translateX(-50%);background:linear-gradient(135deg,#1a0f00,#2a1800);border:1px solid rgba(255,215,0,0.4);border-radius:7px;padding:6px 10px;font-size:10px;color:var(--gold);white-space:nowrap;pointer-events:none;opacity:0;transition:opacity 0.2s;z-index:10;font-family:'DM Mono',monospace;}
.react-btn.premium-lock:hover .react-premium-tip{opacity:1;}
.react-count{font-family:'DM Mono',monospace;font-size:10px;}

/* EDITORIAL CALENDAR */
.cal-grid{display:grid;grid-template-columns:repeat(7,1fr);gap:4px;margin-bottom:14px;}
.cal-day{min-height:64px;background:var(--s1);border:1.5px solid var(--border2);border-radius:7px;padding:6px;font-family:'DM Mono',monospace;font-size:10px;color:var(--muted);cursor:pointer;transition:all 0.2s;}
.cal-day:hover{border-color:rgba(34,197,94,0.25);}
.cal-day.has-post{border-color:rgba(34,197,94,0.3);background:rgba(34,197,94,0.04);}
.cal-day.today{border-color:var(--g3);background:rgba(34,197,94,0.08);}
.cal-day .cal-num{font-size:11px;font-weight:700;color:var(--g4);margin-bottom:4px;}
.cal-day .cal-post-dot{width:6px;height:6px;border-radius:50%;background:var(--g3);display:inline-block;margin:1px;}
.cal-header-days{display:grid;grid-template-columns:repeat(7,1fr);gap:4px;margin-bottom:6px;}
.cal-header-days span{font-family:'DM Mono',monospace;font-size:9px;color:var(--muted2);text-align:center;letter-spacing:1px;}
.slot-chip{display:inline-flex;align-items:center;gap:5px;background:rgba(34,197,94,0.07);border:1px solid rgba(34,197,94,0.2);border-radius:4px;padding:3px 8px;font-size:11px;color:var(--g4);margin:2px;cursor:pointer;font-family:'DM Mono',monospace;transition:all 0.2s;}
.slot-chip:hover,.slot-chip.selected{background:rgba(34,197,94,0.15);border-color:var(--g3);color:var(--g3);}

/* COLLABORATIONS MATCHING */
.collab-card{background:var(--s1);border:1.5px solid var(--border2);border-radius:10px;padding:16px;margin-bottom:10px;transition:all 0.2s;}
.collab-card:hover{border-color:rgba(34,197,94,0.25);}
.collab-match-score{display:inline-flex;align-items:center;gap:5px;background:rgba(34,197,94,0.1);border:1px solid rgba(34,197,94,0.2);border-radius:4px;padding:3px 9px;font-family:'DM Mono',monospace;font-size:10px;color:var(--g3);}
.collab-header{display:flex;align-items:center;gap:10px;margin-bottom:10px;}
.collab-ava{width:42px;height:42px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:18px;font-weight:700;color:var(--bg);flex-shrink:0;}
.collab-why{font-size:12px;color:#7a9a82;line-height:1.6;margin-bottom:10px;font-style:italic;}
.btn-collab{background:var(--g2);border:none;border-radius:6px;padding:7px 16px;font-size:12px;font-weight:700;cursor:pointer;color:var(--bg);transition:all 0.2s;}
.btn-collab:hover{background:var(--g3);}

/* MOBILE PREVIEW */
.mobile-preview{background:#111;border-radius:24px;width:200px;min-height:340px;padding:12px;border:3px solid var(--border);flex-shrink:0;position:relative;overflow:hidden;}
.mobile-preview::before{content:'';position:absolute;top:8px;left:50%;transform:translateX(-50%);width:60px;height:5px;background:rgba(255,255,255,0.1);border-radius:3px;}
.mobile-screen{background:var(--s1);border-radius:16px;width:100%;height:100%;min-height:310px;padding:10px;overflow:hidden;margin-top:10px;}
.mobile-post-preview{background:var(--bg);border-radius:8px;padding:10px;font-size:10px;}
.mobile-post-preview .mob-title{font-weight:700;font-size:11px;margin-bottom:4px;color:var(--white);}
.mobile-post-preview .mob-text{color:var(--muted);font-size:10px;line-height:1.5;}
.mobile-post-preview .mob-cta{margin-top:8px;background:var(--g2);border-radius:4px;padding:5px 8px;font-size:10px;font-weight:700;color:var(--bg);display:inline-block;}
.preview-tabs{display:flex;gap:5px;margin-bottom:10px;}
.prev-tab{flex:1;background:transparent;border:1px solid var(--border2);border-radius:4px;padding:4px;font-size:10px;font-family:'DM Mono',monospace;color:var(--muted);cursor:pointer;text-align:center;transition:all 0.2s;}
.prev-tab.active,.prev-tab:hover{border-color:var(--g3);color:var(--g3);}

/* ── PUBLICATION STEPS ── */
.pub-step-card{background:var(--s1);border:1.5px solid var(--border2);border-radius:14px;padding:20px;margin-bottom:14px;transition:border-color 0.3s;}
.pub-step-card:focus-within{border-color:rgba(34,197,94,0.3);}
.pub-step-header{display:flex;align-items:flex-start;gap:14px;}
.pub-step-num{width:28px;height:28px;border-radius:50%;background:linear-gradient(135deg,var(--g1),var(--g2));color:var(--bg);font-size:12px;font-weight:800;display:flex;align-items:center;justify-content:center;flex-shrink:0;font-family:'DM Mono',monospace;}
.pub-step-title{font-size:14px;font-weight:700;color:var(--white);margin-bottom:2px;}
.pub-step-sub{font-size:11px;color:var(--muted);}
.pub-hint{font-size:10px;font-family:'DM Mono',monospace;padding:3px 9px;border-radius:20px;border:1px solid;transition:all 0.3s;}
.pub-hint.pending{color:var(--muted2);border-color:var(--border2);}
.pub-hint.done{color:var(--g3);border-color:rgba(34,197,94,0.3);background:rgba(34,197,94,0.06);}
.pub-hint.done::before{content:'✓ ';}
.pub-tip-item{background:var(--s2);border:1px solid var(--border2);border-radius:6px;padding:7px 10px;font-size:11px;color:var(--muted);cursor:pointer;transition:all 0.2s;user-select:none;}
.pub-tip-item:hover{border-color:rgba(34,197,94,0.3);color:var(--g4);background:rgba(34,197,94,0.05);}
.pub-tag-chip{background:rgba(34,197,94,0.1);border:1px solid rgba(34,197,94,0.25);border-radius:20px;padding:3px 10px;font-size:11px;color:var(--g4);font-family:'DM Mono',monospace;}

/* ── ONBOARDING TOOLTIP (mini help) ── */
.ob-tooltip{position:fixed;bottom:80px;left:50%;transform:translateX(-50%);z-index:9990;width:min(520px,94vw);background:linear-gradient(135deg,#061a08,#0c2610);border:1.5px solid rgba(34,197,94,0.35);border-radius:16px;box-shadow:0 12px 48px rgba(0,0,0,0.7),0 0 40px rgba(34,197,94,0.08);animation:slideUpTooltip 0.5s cubic-bezier(.34,1.56,.64,1) both;}
.ob-tooltip.hiding{animation:slideDownTooltip 0.35s ease forwards;}
@keyframes slideUpTooltip{from{opacity:0;transform:translateX(-50%) translateY(30px)}to{opacity:1;transform:translateX(-50%) translateY(0)}}
@keyframes slideDownTooltip{from{opacity:1;transform:translateX(-50%) translateY(0)}to{opacity:0;transform:translateX(-50%) translateY(20px)}}
.ob-tooltip-inner{padding:18px 20px 14px;}
.ob-tooltip-header{display:flex;align-items:center;justify-content:space-between;margin-bottom:12px;}
.ob-tooltip-close{background:none;border:none;color:var(--muted2);font-size:18px;cursor:pointer;line-height:1;padding:2px 6px;border-radius:4px;transition:color 0.2s;}
.ob-tooltip-close:hover{color:var(--g3);}
.ob-steps-row{display:flex;gap:10px;overflow-x:auto;padding-bottom:4px;scrollbar-width:none;}
.ob-steps-row::-webkit-scrollbar{display:none;}
.ob-step-card{flex-shrink:0;width:130px;background:rgba(22,163,74,0.04);border:1.5px solid var(--border2);border-radius:10px;padding:12px 10px;text-align:center;cursor:pointer;transition:all 0.25s;}
.ob-step-card:hover,.ob-step-card.active{border-color:rgba(34,197,94,0.4);background:rgba(34,197,94,0.08);}
.ob-step-card.active{border-color:var(--g3);}
.ob-step-icon{font-size:24px;margin-bottom:6px;}
.ob-step-label{font-size:10px;font-weight:700;color:var(--g5);margin-bottom:4px;font-family:'DM Mono',monospace;letter-spacing:0.5px;}
.ob-step-desc{font-size:10px;color:var(--muted);line-height:1.5;}
.ob-tooltip-footer{display:flex;align-items:center;justify-content:space-between;margin-top:12px;padding-top:10px;border-top:1px solid var(--border2);}
.ob-progress{display:flex;gap:5px;align-items:center;}
.ob-dot{width:6px;height:6px;border-radius:50%;background:var(--muted2);transition:all 0.3s;}
.ob-dot.active{background:var(--g3);box-shadow:0 0 5px var(--g3);width:18px;border-radius:3px;}
.ob-btn-next{padding:7px 18px;background:var(--g2);border:none;border-radius:7px;font-family:'Plus Jakarta Sans',sans-serif;font-size:12px;font-weight:700;color:var(--bg);cursor:pointer;transition:all 0.2s;}
.ob-btn-next:hover{background:var(--g3);}

/* ── ONBOARDING MODAL (oldne) ── */
.onboarding-overlay{position:fixed;inset:0;background:rgba(4,10,5,0.96);z-index:9998;display:flex;align-items:center;justify-content:center;}
.onboarding-overlay.hidden{display:none;}
.onboarding-box{background:var(--s1);border:1.5px solid var(--border);border-radius:20px;padding:36px;max-width:460px;width:92%;text-align:center;animation:popIn 0.4s ease;}
.onboarding-step{display:none;}
.onboarding-step.active{display:block;animation:fadeUp 0.3s ease;}
.onboarding-progress{display:flex;justify-content:center;gap:6px;margin-bottom:24px;}
.onboarding-progress-dot{width:8px;height:8px;border-radius:50%;background:var(--muted2);transition:all 0.3s;}
.onboarding-progress-dot.active{background:var(--g3);box-shadow:0 0 6px var(--g3);}
.onboarding-icon{font-size:48px;margin-bottom:10px;}
.onboarding-title{font-family:'Bebas Neue',sans-serif;font-size:28px;letter-spacing:2px;color:var(--g3);margin-bottom:8px;}
.onboarding-sub{font-size:13px;color:var(--muted);margin-bottom:24px;line-height:1.7;}
.btn-onboard-next{width:100%;padding:12px;background:var(--g2);border:none;border-radius:8px;font-size:14px;font-weight:800;cursor:pointer;color:var(--bg);transition:all 0.2s;}
.btn-onboard-next:hover{background:var(--g3);}
.btn-onboard-skip{font-size:11px;color:var(--muted2);cursor:pointer;margin-top:10px;display:block;text-decoration:underline;}

/* AGENCE */
.agency-client-card{background:var(--s1);border:1.5px solid var(--border2);border-radius:10px;padding:14px 16px;display:flex;align-items:center;gap:12px;margin-bottom:8px;transition:all 0.2s;}
.agency-client-card:hover{border-color:rgba(34,197,94,0.2);}
.agency-client-ava{width:36px;height:36px;border-radius:50%;background:linear-gradient(135deg,var(--g1),var(--g3));display:flex;align-items:center;justify-content:center;font-size:14px;flex-shrink:0;}
.agency-client-info{flex:1;}
.agency-client-name{font-size:13px;font-weight:700;margin-bottom:1px;}
.agency-client-plan{font-family:'DM Mono',monospace;font-size:9px;color:var(--muted);}
.agency-client-stats{font-family:'DM Mono',monospace;font-size:10px;color:var(--g3);}

@media(max-width:860px){#tab-publish .tpanel>div>div[style*="grid-template-columns:1fr 340px"]{display:block !important;}
#tab-publish [style*="position:sticky"]{position:static !important;margin-top:20px;}}
@media(max-width:600px){.analytics-grid{grid-template-columns:1fr;}.cal-day{min-height:44px;}}

/* RESPONSIVE */
@media(max-width:900px){.reviews-grid,.signup-plans{grid-template-columns:1fr 1fr;}.plans-grid{grid-template-columns:repeat(3,1fr);}.profile-fields{grid-template-columns:1fr 1fr;}.edit-grid{grid-template-columns:1fr;}.how-simple{flex-direction:column;}}
@media(max-width:600px){.reviews-grid,.plans-grid,.signup-plans,.boost-type-grid{grid-template-columns:1fr 1fr;}.v-banner{width:64px;min-width:64px;height:64px;}.profile-fields{grid-template-columns:1fr;}}

#offer-popup{position:fixed;inset:0;background:rgba(0,0,0,0.88);z-index:9999;display:flex;align-items:center;justify-content:center;backdrop-filter:blur(8px);}
#offer-popup.hidden{display:none;}
.offer-box{background:linear-gradient(135deg,#061a08,#0a2a0d);border:2px solid rgba(34,197,94,0.45);border-radius:20px;padding:24px 26px;max-width:360px;width:92%;text-align:center;box-shadow:0 0 60px rgba(34,197,94,0.18);position:relative;}
.offer-crown{font-size:36px;margin-bottom:4px;}
.offer-title{font-family:'Bebas Neue',sans-serif;font-size:28px;letter-spacing:3px;background:linear-gradient(135deg,#4ade80,#86efac);-webkit-background-clip:text;-webkit-text-fill-color:transparent;margin-bottom:3px;}
.offer-sub{font-size:11px;color:#4a7a58;margin-bottom:12px;font-family:'DM Mono',monospace;}
.offer-badge{display:inline-block;background:linear-gradient(135deg,#22c55e,#16a34a);color:#fff;font-size:11px;font-weight:800;padding:5px 14px;border-radius:20px;margin-bottom:12px;letter-spacing:1px;}
.offer-desc{font-size:12px;color:#e8fef0;line-height:1.6;margin-bottom:14px;}
.offer-desc strong{color:#4ade80;}
.offer-counter{background:rgba(34,197,94,0.07);border:1px solid rgba(34,197,94,0.2);border-radius:12px;padding:14px;margin-bottom:22px;}
.offer-counter-num{font-family:'Bebas Neue',sans-serif;font-size:34px;color:#4ade80;line-height:1;}
.offer-counter-lbl{font-size:11px;color:#4a7a58;font-family:'DM Mono',monospace;margin-top:3px;}
.offer-cta{width:100%;padding:11px;background:linear-gradient(135deg,#22c55e,#16a34a);color:#fff;border:none;border-radius:10px;font-size:14px;font-weight:800;cursor:pointer;letter-spacing:1px;margin-bottom:8px;transition:.2s;}
.offer-cta:hover{transform:translateY(-1px);box-shadow:0 8px 24px rgba(34,197,94,0.3);}
.offer-skip{font-size:11px;color:#2d5a38;cursor:pointer;text-decoration:underline;}
.offer-close-btn{position:absolute;top:12px;right:14px;background:none;border:none;color:#2d5a38;font-size:20px;cursor:pointer;line-height:1;padding:4px;transition:.2s;}
.offer-close-btn:hover{color:#4ade80;}
.offer-timer{background:rgba(239,68,68,0.08);border:1px solid rgba(239,68,68,0.2);border-radius:8px;padding:8px 12px;margin-bottom:14px;font-family:'DM Mono',monospace;font-size:12px;color:#f87171;}
.offer-timer span{font-weight:800;font-size:14px;}
.offer-full{background:rgba(234,179,8,0.08);border:1px solid rgba(234,179,8,0.25);border-radius:12px;padding:20px;text-align:center;max-width:460px;width:92%;}
</style>
<style>
.ob-input{width:100%;padding:11px 13px;background:var(--s1);border:1.5px solid var(--border2);border-radius:10px;color:var(--white);font-family:'Plus Jakarta Sans',sans-serif;font-size:13px;outline:none;transition:border-color 0.2s;}
.ob-input:focus{border-color:var(--g3);}
.ob-btn-next{flex:1;padding:13px;background:var(--g2);border:none;border-radius:12px;font-family:'Plus Jakarta Sans',sans-serif;font-size:14px;font-weight:800;color:var(--bg);cursor:pointer;width:100%;}
.ob-btn-back{flex:1;padding:13px;background:var(--s2);border:1.5px solid var(--border);border-radius:12px;font-family:'Plus Jakarta Sans',sans-serif;font-size:13px;font-weight:700;color:var(--muted);cursor:pointer;}
.ob-btn-skip{width:100%;margin-top:8px;background:none;border:none;font-size:11px;color:var(--muted2);cursor:pointer;font-family:'Plus Jakarta Sans',sans-serif;padding:6px;}
.av-opt{font-size:26px;cursor:pointer;padding:7px;border-radius:10px;border:2px solid var(--border2);transition:all 0.15s;display:inline-flex;}
.av-opt:hover{border-color:var(--g3);background:rgba(34,197,94,0.08);}
.av-premium{position:relative;}
.ob-goal-card{background:var(--s1);border:1.5px solid var(--border2);border-radius:12px;padding:13px 16px;cursor:pointer;display:flex;align-items:center;gap:12px;transition:all 0.2s;}
.ob-goal-card:hover{border-color:var(--g3);background:rgba(34,197,94,0.04);}

/* ── PROFILE COMPLETION BAR ── */
.profile-completion-bar{background:var(--s1);border:1.5px solid var(--border2);border-radius:14px;padding:16px 20px;margin-bottom:16px;}
.pcb-header{display:flex;align-items:center;justify-content:space-between;margin-bottom:10px;}
.pcb-title{font-family:'DM Mono',monospace;font-size:10px;color:var(--g3);letter-spacing:2px;text-transform:uppercase;}
.pcb-pct{font-family:'Bebas Neue',sans-serif;font-size:22px;color:var(--g3);}
.pcb-bar{height:8px;background:var(--s3);border-radius:4px;overflow:hidden;margin-bottom:10px;}
.pcb-fill{height:100%;border-radius:4px;transition:width 0.6s cubic-bezier(0.4,0,0.2,1);}
.pcb-items{display:flex;flex-wrap:wrap;gap:6px;}
.pcb-item{font-size:11px;padding:3px 10px;border-radius:20px;display:flex;align-items:center;gap:4px;}
.pcb-item.done{background:rgba(34,197,94,0.1);color:var(--g4);border:1px solid rgba(34,197,94,0.2);}
.pcb-item.todo{background:rgba(255,255,255,0.03);color:var(--muted);border:1px solid var(--border2);}

/* ── REFERRAL / PARRAINAGE ── */
.referral-box{background:linear-gradient(135deg,rgba(34,197,94,0.08),rgba(74,222,128,0.04));border:1.5px solid rgba(34,197,94,0.25);border-radius:14px;padding:18px 20px;margin-bottom:16px;}
.referral-link{display:flex;align-items:center;gap:8px;background:rgba(4,10,5,0.8);border:1.5px solid var(--border);border-radius:8px;padding:10px 14px;margin:12px 0;}
.referral-link span{flex:1;font-family:'DM Mono',monospace;font-size:12px;color:var(--g4);overflow:hidden;text-overflow:ellipsis;white-space:nowrap;}
.referral-copy-btn{background:var(--g2);border:none;border-radius:6px;padding:6px 12px;font-size:11px;font-weight:700;color:var(--bg);cursor:pointer;white-space:nowrap;transition:all 0.2s;}
.referral-copy-btn:hover{background:var(--g3);}
.referral-stats{display:grid;grid-template-columns:1fr 1fr 1fr;gap:8px;margin-top:10px;}
.referral-stat{text-align:center;background:rgba(255,255,255,0.02);border:1px solid var(--border2);border-radius:8px;padding:10px 6px;}
.referral-stat-num{font-family:'Bebas Neue',sans-serif;font-size:24px;color:var(--g3);}
.referral-stat-lbl{font-size:10px;color:var(--muted);font-family:'DM Mono',monospace;}

/* ── BADGE VERIFIE ── */
.badge-verified{display:inline-flex;align-items:center;gap:3px;background:linear-gradient(135deg,rgba(34,197,94,0.15),rgba(74,222,128,0.08));border:1px solid rgba(34,197,94,0.35);border-radius:4px;padding:2px 7px;font-size:10px;font-weight:700;color:var(--g3);font-family:'DM Mono',monospace;letter-spacing:0.5px;}
.badge-verified::before{content:'✓';font-size:11px;}

/* ── TRENDING TOPICS ── */
.trending-widget{background:var(--s1);border:1.5px solid var(--border2);border-radius:14px;padding:16px 18px;margin-bottom:16px;}
.trending-title{font-family:'DM Mono',monospace;font-size:10px;color:var(--g3);letter-spacing:2px;text-transform:uppercase;margin-bottom:12px;display:flex;align-items:center;gap:6px;}
.trending-item{display:flex;align-items:center;justify-content:space-between;padding:8px 0;border-bottom:1px solid var(--border2);cursor:pointer;transition:all 0.2s;}
.trending-item:last-child{border-bottom:none;}
.trending-item:hover .trending-tag{color:var(--g3);}
.trending-rank{font-family:'DM Mono',monospace;font-size:11px;color:var(--muted2);width:18px;}
.trending-tag{font-size:13px;font-weight:700;flex:1;padding:0 8px;}
.trending-count{font-family:'DM Mono',monospace;font-size:10px;color:var(--muted);}
.trending-fire{font-size:12px;}

/* ── STORIES ── */
.stories-bar{display:flex;gap:10px;padding:14px 0 10px;overflow-x:auto;scrollbar-width:none;margin-bottom:4px;}
.stories-bar::-webkit-scrollbar{display:none;}
.story-item{flex-shrink:0;display:flex;flex-direction:column;align-items:center;gap:6px;cursor:pointer;}
.story-ring{width:56px;height:56px;border-radius:50%;padding:2.5px;background:linear-gradient(135deg,var(--g2),var(--g4));position:relative;}
.story-ring.seen{background:var(--muted2);}
.story-ring.add-story{background:var(--s2);border:2px dashed var(--border);}
.story-ava{width:100%;height:100%;border-radius:50%;background:var(--s1);display:flex;align-items:center;justify-content:center;font-size:22px;border:2px solid var(--bg);}
.story-label{font-size:10px;color:var(--muted);max-width:60px;text-align:center;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;}
.story-add-icon{position:absolute;bottom:0;right:0;width:18px;height:18px;background:var(--g2);border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:12px;border:2px solid var(--bg);}

/* ── STORY VIEWER ── */
.story-viewer-overlay{position:fixed;inset:0;background:rgba(0,0,0,0.95);z-index:10002;display:flex;align-items:center;justify-content:center;}
.story-viewer-overlay.hidden{display:none;}
.story-viewer-box{max-width:400px;width:100%;position:relative;}
.story-viewer-progress{display:flex;gap:3px;padding:10px 12px 6px;position:absolute;top:0;left:0;right:0;z-index:10;}
.story-progress-bar{flex:1;height:3px;background:rgba(255,255,255,0.3);border-radius:2px;overflow:hidden;}
.story-progress-fill{height:100%;background:#fff;border-radius:2px;animation:storyProgress 5s linear forwards;}
@keyframes storyProgress{from{width:0}to{width:100%}}
.story-viewer-header{position:absolute;top:24px;left:12px;right:12px;display:flex;align-items:center;justify-content:space-between;z-index:10;}
.story-viewer-close{background:none;border:none;color:#fff;font-size:22px;cursor:pointer;padding:4px;}
.story-content{width:100%;aspect-ratio:9/16;max-height:80vh;background:var(--s1);border-radius:16px;display:flex;align-items:center;justify-content:center;overflow:hidden;position:relative;}

/* ── PAID BOOST ── */
.boost-promo-card{background:linear-gradient(135deg,rgba(255,215,0,0.08),rgba(255,140,0,0.04));border:1.5px solid rgba(255,215,0,0.25);border-radius:14px;padding:18px 20px;margin-bottom:12px;cursor:pointer;transition:all 0.2s;}
.boost-promo-card:hover{border-color:rgba(255,215,0,0.5);box-shadow:0 4px 20px rgba(255,215,0,0.1);}
.boost-promo-title{font-family:'Bebas Neue',sans-serif;font-size:20px;letter-spacing:1.5px;color:var(--gold);margin-bottom:4px;}
.boost-promo-desc{font-size:12px;color:var(--muted);line-height:1.6;}
.boost-promo-price{font-family:'Bebas Neue',sans-serif;font-size:28px;color:var(--gold);}

/* ── GLOBAL SEARCH ── */
.search-overlay{position:fixed;inset:0;background:rgba(4,10,5,0.97);backdrop-filter:blur(20px);z-index:9998;display:flex;flex-direction:column;padding:20px;}
.search-overlay.hidden{display:none;}
.search-input-row{display:flex;align-items:center;gap:12px;margin-bottom:20px;}
.search-big-input{flex:1;padding:14px 18px;background:var(--s1);border:2px solid rgba(34,197,94,0.4);border-radius:12px;font-family:'Plus Jakarta Sans',sans-serif;font-size:16px;color:var(--white);outline:none;}
.search-big-input::placeholder{color:var(--muted);}
.search-close-btn{background:var(--s2);border:1.5px solid var(--border);border-radius:8px;padding:10px 14px;font-size:18px;cursor:pointer;color:var(--muted);}
.search-results{flex:1;overflow-y:auto;}
.search-section-title{font-family:'DM Mono',monospace;font-size:10px;color:var(--g3);letter-spacing:2px;text-transform:uppercase;margin:16px 0 10px;}
.search-result-item{display:flex;align-items:center;gap:12px;padding:12px 16px;background:var(--s1);border:1.5px solid var(--border2);border-radius:10px;margin-bottom:8px;cursor:pointer;transition:all 0.2s;}
.search-result-item:hover{border-color:rgba(34,197,94,0.3);}
.search-result-ava{width:36px;height:36px;border-radius:50%;background:var(--g2);display:flex;align-items:center;justify-content:center;font-size:16px;flex-shrink:0;}
.search-result-name{font-size:14px;font-weight:700;}
.search-result-sub{font-size:11px;color:var(--muted);}

/* ── MODE CLAIR ── */
body.light-mode{
  --bg:#f0fdf4;--bg2:#e8f5e9;--s1:#ffffff;--s2:#f1f8f2;--s3:#e8f5e9;
  --white:#1a2e1c;--muted:#4a7a58;--muted2:#6b9b76;
  --border:rgba(34,197,94,0.2);--border2:rgba(34,197,94,0.12);--glow:rgba(34,197,94,0.08);
}
body.light-mode .app-bar{background:rgba(240,253,244,0.97);}
body.light-mode input,body.light-mode select,body.light-mode textarea{background:#f8fdf9;color:#1a2e1c;}
.theme-toggle{display:flex;align-items:center;gap:6px;cursor:pointer;font-size:13px;color:var(--muted);}
.theme-toggle-track{width:36px;height:20px;border-radius:10px;background:var(--s3);border:1.5px solid var(--border);position:relative;transition:background 0.3s;}
.theme-toggle-thumb{width:14px;height:14px;border-radius:50%;background:var(--g3);position:absolute;top:2px;left:2px;transition:transform 0.3s;}
#featured-creators-carousel::-webkit-scrollbar{display:none;}
#featured-creators-carousel{-ms-overflow-style:none;scrollbar-width:none;}


/* ── SHAREABLE PUBLIC PROFILE ── */
.share-profile-btn{display:flex;align-items:center;gap:6px;background:rgba(34,197,94,0.08);border:1.5px solid var(--border);border-radius:8px;padding:8px 14px;font-size:12px;font-weight:600;color:var(--g3);cursor:pointer;transition:all 0.2s;}
.share-profile-btn:hover{border-color:var(--g3);background:rgba(34,197,94,0.15);}

/* ═══ APP BAR COMPACT SCROLL ═══ */
.app-bar{transition:transform 0.3s ease;}
.app-bar.bar-hidden{transform:translateY(-100%);pointer-events:none;}

/* ═══ PUBCREATOR ═══ */
.pc-step-item{transition:all 0.2s;}
.pc-step-item.active{background:rgba(255,215,0,0.08);}
.pc-step-panel{animation:fadeUp 0.3s ease;}
.pcg-ad-card{background:var(--s1);border:1.5px solid rgba(255,215,0,0.12);border-radius:12px;overflow:hidden;transition:border-color 0.25s,box-shadow 0.25s;margin-bottom:0;}
.pcg-ad-card.expanded{border-color:rgba(255,215,0,0.45);box-shadow:0 0 20px rgba(255,215,0,0.08);}
.pcg-card-header{display:flex;align-items:center;gap:12px;padding:14px 18px;cursor:pointer;user-select:none;transition:background 0.2s;}
.pcg-card-header:hover{background:rgba(255,215,0,0.03);}
.pcg-card-body{display:none;padding:0 18px 18px;flex-direction:column;gap:12px;}
.pcg-card-body.open{display:flex;}
.pcg-num{width:32px;height:32px;border-radius:8px;background:linear-gradient(135deg,rgba(255,215,0,0.2),rgba(255,140,0,0.1));border:1.5px solid rgba(255,215,0,0.3);display:flex;align-items:center;justify-content:center;font-family:'Bebas Neue',sans-serif;font-size:16px;color:#ffd700;flex-shrink:0;}
.pcg-cat-label{font-family:'DM Mono',monospace;font-size:8px;letter-spacing:1.5px;font-weight:700;padding:2px 8px;border-radius:3px;}

/* ═══ SPONSOR PANEL ═══ */
.sp-tab{transition:all 0.2s;}
.sp-tab.active{background:rgba(244,63,94,0.1) !important;color:#f43f5e !important;}
.sp-panel{animation:fadeUp 0.25s ease;}
.sp-place-opt{transition:all 0.2s;}
.sp-place-opt.selected{background:rgba(244,63,94,0.12) !important;border-color:rgba(244,63,94,0.55) !important;}
.sp-day-btn.active{background:rgba(244,63,94,0.12) !important;border-color:rgba(244,63,94,0.5) !important;color:#f43f5e !important;}
</style></head>
<body>
<script>var currentUser = null;</script>
<main id="app-main">



<div id="cursor"></div>
<div id="cursor-ring"></div>
<div class="orb o1"></div>

<!-- THEME SWITCHER -->
<div id="theme-switcher">
  <div id="theme-panel">
    <p>🎨 Thème</p>
    <div class="theme-option active" data-t="green" onclick="setTheme('green',this)">
      <span class="theme-dot" style="background:linear-gradient(135deg,#15803d,#22c55e)"></span> Vert (défaut)
    </div>
    <div class="theme-option" data-t="blue" onclick="setTheme('blue',this)">
      <span class="theme-dot" style="background:linear-gradient(135deg,#1d4ed8,#3b82f6)"></span> Bleu électrique
    </div>
    <div class="theme-option" data-t="purple" onclick="setTheme('purple',this)">
      <span class="theme-dot" style="background:linear-gradient(135deg,#6d28d9,#8b5cf6)"></span> Violet
    </div>
    <div class="theme-option" data-t="gold" onclick="setTheme('gold',this)">
      <span class="theme-dot" style="background:linear-gradient(135deg,#92700a,#d4a833)"></span> Or premium
    </div>
    <div class="theme-option" data-t="red" onclick="setTheme('red',this)">
      <span class="theme-dot" style="background:linear-gradient(135deg,#991b1b,#ef4444)"></span> Rouge
    </div>
    <div class="theme-option" data-t="pink" onclick="setTheme('pink',this)">
      <span class="theme-dot" style="background:linear-gradient(135deg,#9d174d,#ec4899)"></span> Rose
    </div>
  </div>
  <button id="theme-toggle-btn" onclick="document.getElementById('theme-panel').classList.toggle('open')" title="Changer le thème">🎨</button>
</div>

<script>
// Couleurs par thème pour les icônes nav
const THEME_COLORS = {
  green:  { c1:'#22c55e', c2:'#15803d' },
  blue:   { c1:'#3b82f6', c2:'#1d4ed8' },
  purple: { c1:'#8b5cf6', c2:'#6d28d9' },
  gold:   { c1:'#d4a833', c2:'#92700a' },
  red:    { c1:'#ef4444', c2:'#991b1b' },
  pink:   { c1:'#ec4899', c2:'#9d174d' },
};

function updateNavIconColors(t){
  var tc = THEME_COLORS[t] || THEME_COLORS.green;
  // Met à jour les stops du gradient gh1 (Home)
  var gh1 = document.getElementById('gh1');
  if(gh1){ gh1.querySelectorAll('stop')[0].setAttribute('stop-color', tc.c1); gh1.querySelectorAll('stop')[1].setAttribute('stop-color', tc.c2); }
  // Door de la maison
  var door = document.getElementById('home-door');
  if(door) door.setAttribute('fill', tc.c2);
  // Publish button background
  var publishBtn = document.querySelector('.bn-publish');
  if(publishBtn) publishBtn.style.background = 'linear-gradient(135deg,'+tc.c1+','+tc.c2+')';
  // CSS var pour active states
  document.documentElement.style.setProperty('--nav-active', tc.c1);
}

function setTheme(t, el){
  document.documentElement.setAttribute('data-theme', t === 'green' ? '' : t);
  document.querySelectorAll('.theme-option').forEach(o => o.classList.remove('active'));
  if(el) el.classList.add('active');
  localStorage.setItem('vb_theme', t);
  document.getElementById('theme-panel').classList.remove('open');
  updateNavIconColors(t);
}
(function(){
  var saved = localStorage.getItem('vb_theme') || 'green';
  var el = document.querySelector('[data-t="'+saved+'"]');
  setTheme(saved, el);
})();
</script>

<div class="orb o2"></div>
<div id="toast-container"></div>

<!-- ══════════ LANDING ══════════ -->
<div id="landing">

<nav>
  <div class="logo">VIRAL<span>BOOST</span></div>
  <div class="nav-links">
    <a href="#" onclick="event.preventDefault();vbStartDemo();setTimeout(()=>{var btn=document.querySelector('[data-tab=campaign]');if(btn){showAppTab('campaign',btn);}if(typeof campaignRender==='function')campaignRender();},800)">Campaign Tools</a>
    <a href="#" onclick="event.preventDefault();vbStartDemo();setTimeout(()=>{var btn=document.querySelector('[data-tab=big-campaign]');if(btn){showAppTab('big-campaign',btn);}if(typeof bcRender==='function')bcRender();},800)">Big Campaign</a>
    <a href="#" onclick="event.preventDefault();vbStartDemo();setTimeout(()=>{showSponsorTab(document.querySelector('[data-tab=sponsor]'));},800)">Sponsor</a>
    <a href="#" onclick="event.preventDefault();vbStartDemo();setTimeout(()=>{var btn=document.querySelector('[data-tab=feed]');if(btn){showAppTab('feed',btn);}},800)">Feed</a>
    <a href="#plans" data-i18n="nav_plans">Pricing</a>
    <a href="#reviews" data-i18n="nav_reviews">Reviews</a>
    <a href="#advertise" onclick="event.preventDefault();toggleAdvertisePage()">Advertise</a>
  </div>
  <div class="nav-right">
    <button class="lang-btn" id="lang-btn" onclick="toggleLang()" title="Switch language">🇺🇸 EN</button>

  </div>
  <button class="hamburger" id="hamburger-btn" onclick="toggleMobileMenu()" aria-label="Menu">
    <span></span><span></span><span></span>
  </button>
</nav>
<!-- MOBILE MENU -->
<div class="mobile-menu" id="mobile-menu">
  <a href="#" onclick="closeMobileMenu();vbStartDemo();setTimeout(()=>{var btn=document.querySelector('[data-tab=campaign]');if(btn){showAppTab('campaign',btn);}if(typeof campaignRender==='function')campaignRender();},800)">🔥 Campaign Tools</a>
  <a href="#plans" onclick="closeMobileMenu()" data-i18n="mob_plans">Plans</a>
  <a href="#reviews" onclick="closeMobileMenu()" data-i18n="mob_reviews">Reviews</a>
  <div class="mobile-btns" id="mob-btns-guest">
    <button class="btn-g btn-ghost-g" onclick="closeMobileMenu();openModal('login-modal')">Log in</button>
    <button class="btn-g btn-solid-g" onclick="closeMobileMenu();openModal('signup-modal')">Get Started</button>
  </div>
  <div class="mobile-btns" id="mob-btns-user" style="display:none">
    <button class="btn-g btn-ghost-g" onclick="closeMobileMenu();logout()" style="color:#f87171;border-color:rgba(248,113,113,0.3)">Log out</button>
  </div>
</div>

<section class="hero" style="min-height:100vh;display:flex;flex-direction:column;align-items:center;justify-content:center;text-align:center;position:relative;z-index:1;padding:90px 5% 40px;box-sizing:border-box;">

  <!-- BADGE -->
  <div style="display:inline-flex;align-items:center;gap:8px;background:rgba(34,197,94,0.07);border:1px solid rgba(34,197,94,0.2);border-radius:4px;padding:5px 14px;font-family:'DM Mono',monospace;font-size:11px;letter-spacing:2px;color:var(--g4);margin-bottom:20px;animation:fadeUp 0.4s ease both;text-transform:uppercase;">
    #1 Digital Advertising Platform
  </div>

  <!-- HEADLINE -->
  <h1 style="font-family:'Bebas Neue',sans-serif;font-size:clamp(40px,6vw,76px);letter-spacing:3px;line-height:0.95;color:var(--white);margin-bottom:16px;animation:fadeUp 0.5s 0.05s ease both;">
    PUBLISH YOUR AD<br><span style="color:var(--g3);">REACH YOUR AUDIENCE</span>
  </h1>

  <!-- SOUS-TITRE COURT -->
  <p style="font-size:clamp(14px,1.8vw,17px);color:var(--muted);max-width:480px;margin:0 auto 32px;line-height:1.6;animation:fadeUp 0.5s 0.1s ease both;">
    Publish · Reach creators & entrepreneurs · Grow your audience. No experience needed.
  </p>

  <!-- CTA PRINCIPAL — publier une pub -->
  <div style="display:flex;flex-wrap:wrap;align-items:center;justify-content:center;gap:10px;margin-bottom:16px;animation:fadeUp 0.5s 0.15s ease both;">
    <button onclick="vbStartDemo()" style="padding:16px 44px;background:linear-gradient(135deg,var(--g1),var(--g3));border:none;border-radius:8px;font-family:'Plus Jakarta Sans',sans-serif;font-size:16px;font-weight:800;color:var(--bg);cursor:pointer;box-shadow:0 0 32px rgba(34,197,94,0.35);transition:all 0.2s;letter-spacing:0.3px;" onmouseover="this.style.transform='translateY(-2px)';this.style.boxShadow='0 0 48px rgba(34,197,94,0.5)'" onmouseout="this.style.transform='';this.style.boxShadow='0 0 32px rgba(34,197,94,0.35)'">
      Publish my ad — Free
    </button>
    <button onclick="vbShowLogin()" style="padding:15px 28px;background:transparent;border:1.5px solid var(--border);border-radius:8px;font-family:'Plus Jakarta Sans',sans-serif;font-size:15px;font-weight:600;color:var(--g5);cursor:pointer;transition:all 0.2s;" onmouseover="this.style.borderColor='var(--g3)';this.style.color='var(--white)'" onmouseout="this.style.borderColor='var(--border)';this.style.color='var(--g5)'">Sign in</button>
  </div>

  <!-- TRUST LINE -->
  <div style="font-size:12px;color:var(--muted2);animation:fadeUp 0.5s 0.18s ease both;margin-bottom:36px;">
    Free forever · No credit card · 30 seconds to go live
  </div>

  <!-- STATS COMPACTES -->
  <div style="display:flex;align-items:center;gap:0;border:1px solid var(--border2);border-radius:10px;overflow:hidden;animation:fadeUp 0.5s 0.22s ease both;">
    <div style="padding:14px 24px;text-align:center;border-right:1px solid var(--border2);">
      <div style="font-family:'Bebas Neue',sans-serif;font-size:26px;color:var(--g3);line-height:1;">12K+</div>
      <div style="font-size:10px;color:var(--muted);font-family:'DM Mono',monospace;letter-spacing:1px;text-transform:uppercase;margin-top:2px;">Users</div>
    </div>
    <div style="padding:14px 24px;text-align:center;border-right:1px solid var(--border2);">
      <div style="font-family:'Bebas Neue',sans-serif;font-size:26px;color:var(--g3);line-height:1;">48K+</div>
      <div style="font-size:10px;color:var(--muted);font-family:'DM Mono',monospace;letter-spacing:1px;text-transform:uppercase;margin-top:2px;">Ads live</div>
    </div>
    <div style="padding:14px 24px;text-align:center;border-right:1px solid var(--border2);">
      <div style="font-family:'Bebas Neue',sans-serif;font-size:26px;color:var(--g3);line-height:1;">94%</div>
      <div style="font-size:10px;color:var(--muted);font-family:'DM Mono',monospace;letter-spacing:1px;text-transform:uppercase;margin-top:2px;">Satisfied</div>
    </div>
    <div style="padding:14px 24px;text-align:center;">
      <div style="font-family:'Bebas Neue',sans-serif;font-size:26px;color:var(--g3);line-height:1;">30s</div>
      <div style="font-size:10px;color:var(--muted);font-family:'DM Mono',monospace;letter-spacing:1px;text-transform:uppercase;margin-top:2px;">To go live</div>
    </div>
  </div>

  <!-- LIVE TICKER (discret, en bas) -->
  <div id="hero-ticker" style="max-width:480px;margin:20px auto 0;overflow:hidden;height:28px;animation:fadeUp 0.5s 0.25s ease both;opacity:0.7;">
    <div id="ticker-inner" style="display:flex;flex-direction:column;"></div>
  </div>

</section>

<!-- PUBLIC FEED (visible without account) -->
<section class="public-feed-section" id="public-feed">
  <div style="max-width:660px;margin:0 auto">
    <div style="text-align:center;margin-bottom:24px">
      <span class="sec-label" data-i18n="sec_feed">Public feed</span>
      <h2 class="section-title">Ads <em>live</em></h2>
      <p class="section-sub" style="margin:0 auto">The latest community ads — visible to everyone.</p>
    </div>
    <div id="public-feed-list" class="public-feed-blur">
      <!-- Public posts will be injected here -->
    </div>
    <div style="text-align:center;margin-top:28px">
      <button class="btn-unlock-feed" onclick="openModal('signup-modal')">Join & publish your ad</button>
    </div>
  </div>
</section>

<section class="showcase-section" id="showcase">
  <div style="max-width:1100px;margin:0 auto 36px">
    <span class="sec-label" data-i18n="sec_showcase">Community Showcase</span>
    <h2 class="section-title"><em>Trending</em> projects</h2>
    <p class="section-sub">Vote for your favorites. The most voted gain visibility.</p>
  </div>
  <div class="showcase-grid" id="landing-showcase-grid" style="max-width:1100px;margin:0 auto"></div>
</section>

<section class="plans-section" id="plans">
  <div style="text-align:center;margin-bottom:48px">
    <span class="sec-label" data-i18n="sec_plans">Plans</span>
    <h2 class="section-title">Choose your <em>plan</em></h2>
    <p class="section-sub" style="margin:0 auto">Start for free. Upgrade whenever you want.</p>
  </div>
  <div class="plans-grid" id="landing-plans"></div>
</section>

<section style="padding:80px 5%;position:relative;z-index:1;" id="reviews">
  <div style="max-width:1100px;margin:0 auto;">
    <div style="text-align:center;margin-bottom:50px">
      <span class="sec-label" id="community-label">The community</span>
      <h2 class="section-title" id="community-title">What creators <em>say about us</em></h2>
      <p class="section-sub" id="community-sub" style="margin:0 auto 10px">Real testimonials from creators around the world using ViralBoost to grow their projects.</p>
      <div style="display:inline-flex;align-items:center;gap:6px;font-family:'DM Mono',monospace;font-size:10px;color:var(--muted);letter-spacing:1px;margin-top:8px">
        <span id="lang-indicator" style="width:8px;height:8px;border-radius:50%;background:var(--g3);display:inline-block;animation:blink 2s infinite"></span>
        <span id="lang-display">EN · Refreshes every hour</span>
      </div>
    </div>

    <!-- TESTIMONIALS GRID -->
    <div id="multilang-testimonials" style="display:grid;grid-template-columns:repeat(3,1fr);gap:16px;margin-bottom:50px"></div>

    <!-- ADS SECTION -->
    <div style="text-align:center;margin-bottom:28px">
      <span class="sec-label" id="ads-label">Featured ads</span>
      <h2 class="section-title" style="font-size:clamp(28px,4vw,42px)" id="ads-title">Projects from the <em>community</em></h2>
    </div>
    <div id="multilang-ads" style="display:grid;grid-template-columns:repeat(3,1fr);gap:14px;margin-bottom:50px"></div>

    <!-- CTA final -->
    <div style="background:var(--s1);border:1px solid var(--border);border-radius:16px;padding:56px 40px;text-align:center;margin-top:24px;">
      <div style="font-family:'DM Mono',monospace;font-size:10px;letter-spacing:2px;color:var(--g4);text-transform:uppercase;margin-bottom:16px;">Start today</div>
      <h2 id="cta-title" style="font-family:'Bebas Neue',sans-serif;font-size:clamp(36px,5vw,56px);letter-spacing:2px;color:var(--white);margin-bottom:12px;line-height:1;">READY TO GET STARTED?</h2>
      <p id="cta-sub" style="font-size:14px;color:var(--muted);line-height:1.8;margin-bottom:32px;max-width:480px;margin-left:auto;margin-right:auto;">Free account — no credit card required — immediate access to all tools</p>
      <button class="btn-hero-big btn-hero-solid" onclick="openModal('signup-modal')" style="font-size:15px;padding:16px 44px;border-radius:8px;" id="cta-btn">Create my free account</button>
    </div>
  </div>
</section>

<!-- FOOTER -->
<footer style="position:relative;z-index:1;border-top:1px solid var(--border2);padding:60px 5% 32px;margin-top:0;">
  <div style="max-width:1100px;margin:0 auto;">

    <!-- TOP ROW -->
    <div style="display:grid;grid-template-columns:2fr 1fr 1fr 1fr;gap:48px;margin-bottom:48px;">

      <!-- Brand -->
      <div>
        <div style="font-family:'Bebas Neue',sans-serif;font-size:22px;letter-spacing:3px;color:var(--white);margin-bottom:12px;">VIRAL<span style="color:var(--g3);">BOOST</span></div>
        <p style="font-size:13px;color:var(--muted);line-height:1.7;max-width:280px;margin-bottom:20px;">The digital advertising platform for creators, entrepreneurs and brands. Publish, connect, grow.</p>
        <div style="display:flex;gap:10px;">
          <a href="#" aria-label="Twitter / X" style="width:34px;height:34px;border-radius:6px;background:var(--s2);border:1px solid var(--border2);display:flex;align-items:center;justify-content:center;transition:border-color 0.2s;text-decoration:none;" onmouseover="this.style.borderColor='var(--g3)'" onmouseout="this.style.borderColor='var(--border2)'">
            <svg width="14" height="14" viewBox="0 0 24 24" fill="var(--muted)" aria-hidden="true"><path d="M23 3a10.9 10.9 0 01-3.14 1.53 4.48 4.48 0 00-7.86 3v1A10.66 10.66 0 013 4s-4 9 5 13a11.64 11.64 0 01-7 2c9 5 20 0 20-11.5a4.5 4.5 0 00-.08-.83A7.72 7.72 0 0023 3z"/></svg>
          </a>
          <a href="#" aria-label="LinkedIn" style="width:34px;height:34px;border-radius:6px;background:var(--s2);border:1px solid var(--border2);display:flex;align-items:center;justify-content:center;transition:border-color 0.2s;text-decoration:none;" onmouseover="this.style.borderColor='var(--g3)'" onmouseout="this.style.borderColor='var(--border2)'">
            <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="var(--muted)" stroke-width="2" aria-hidden="true"><path d="M16 8a6 6 0 016 6v7h-4v-7a2 2 0 00-2-2 2 2 0 00-2 2v7h-4v-7a6 6 0 016-6z"/><rect x="2" y="9" width="4" height="12"/><circle cx="4" cy="4" r="2"/></svg>
          </a>
          <a href="#" aria-label="Instagram" style="width:34px;height:34px;border-radius:6px;background:var(--s2);border:1px solid var(--border2);display:flex;align-items:center;justify-content:center;transition:border-color 0.2s;text-decoration:none;" onmouseover="this.style.borderColor='var(--g3)'" onmouseout="this.style.borderColor='var(--border2)'">
            <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="var(--muted)" stroke-width="2" aria-hidden="true"><rect x="2" y="2" width="20" height="20" rx="5"/><path d="M16 11.37A4 4 0 1112.63 8 4 4 0 0116 11.37z"/><line x1="17.5" y1="6.5" x2="17.51" y2="6.5"/></svg>
          </a>
        </div>
      </div>

      <!-- Platform -->
      <div>
        <div style="font-family:'DM Mono',monospace;font-size:10px;letter-spacing:1.5px;text-transform:uppercase;color:var(--muted);margin-bottom:16px;">Platform</div>
        <div style="display:flex;flex-direction:column;gap:10px;">
          <a href="#advertise" style="font-size:13px;color:var(--g5);text-decoration:none;transition:color 0.2s;" onmouseover="this.style.color='var(--white)'" onmouseout="this.style.color='var(--g5)'">Publish an ad</a>
          <a href="#showcase" style="font-size:13px;color:var(--g5);text-decoration:none;transition:color 0.2s;" onmouseover="this.style.color='var(--white)'" onmouseout="this.style.color='var(--g5)'">Showcase</a>
          <a href="#plans" style="font-size:13px;color:var(--g5);text-decoration:none;transition:color 0.2s;" onmouseover="this.style.color='var(--white)'" onmouseout="this.style.color='var(--g5)'">Pricing</a>
          <a href="#showcase" style="font-size:13px;color:var(--g5);text-decoration:none;transition:color 0.2s;" onmouseover="this.style.color='var(--white)'" onmouseout="this.style.color='var(--g5)'">AI Matching</a>
          <a href="#reviews" style="font-size:13px;color:var(--g5);text-decoration:none;transition:color 0.2s;" onmouseover="this.style.color='var(--white)'" onmouseout="this.style.color='var(--g5)'">Community</a>
        </div>
      </div>

      <!-- Company -->
      <div>
        <div style="font-family:'DM Mono',monospace;font-size:10px;letter-spacing:1.5px;text-transform:uppercase;color:var(--muted);margin-bottom:16px;">Company</div>
        <div style="display:flex;flex-direction:column;gap:10px;">
          <a href="#plans" style="font-size:13px;color:var(--g5);text-decoration:none;transition:color 0.2s;" onmouseover="this.style.color='var(--white)'" onmouseout="this.style.color='var(--g5)'">About us</a>
          <a href="#showcase" style="font-size:13px;color:var(--g5);text-decoration:none;transition:color 0.2s;" onmouseover="this.style.color='var(--white)'" onmouseout="this.style.color='var(--g5)'">Blog</a>
          <a href="#plans" style="font-size:13px;color:var(--g5);text-decoration:none;transition:color 0.2s;" onmouseover="this.style.color='var(--white)'" onmouseout="this.style.color='var(--g5)'">Careers</a>
          <a href="#advertise" style="font-size:13px;color:var(--g5);text-decoration:none;transition:color 0.2s;" onmouseover="this.style.color='var(--white)'" onmouseout="this.style.color='var(--g5)'">Advertise</a>
          <a href="#reviews" style="font-size:13px;color:var(--g5);text-decoration:none;transition:color 0.2s;" onmouseover="this.style.color='var(--white)'" onmouseout="this.style.color='var(--g5)'">Reviews</a>
        </div>
      </div>

      <!-- Legal -->
      <div>
        <div style="font-family:'DM Mono',monospace;font-size:10px;letter-spacing:1.5px;text-transform:uppercase;color:var(--muted);margin-bottom:16px;">Legal</div>
        <div style="display:flex;flex-direction:column;gap:10px;">
          <a href="#plans" style="font-size:13px;color:var(--g5);text-decoration:none;transition:color 0.2s;" onmouseover="this.style.color='var(--white)'" onmouseout="this.style.color='var(--g5)'">Terms of Service</a>
          <a href="#plans" style="font-size:13px;color:var(--g5);text-decoration:none;transition:color 0.2s;" onmouseover="this.style.color='var(--white)'" onmouseout="this.style.color='var(--g5)'">Privacy Policy</a>
          <a href="#plans" style="font-size:13px;color:var(--g5);text-decoration:none;transition:color 0.2s;" onmouseover="this.style.color='var(--white)'" onmouseout="this.style.color='var(--g5)'">Cookie Policy</a>
          <a href="#plans" style="font-size:13px;color:var(--g5);text-decoration:none;transition:color 0.2s;" onmouseover="this.style.color='var(--white)'" onmouseout="this.style.color='var(--g5)'">GDPR</a>
          <a href="#advertise" style="font-size:13px;color:var(--g5);text-decoration:none;transition:color 0.2s;" onmouseover="this.style.color='var(--white)'" onmouseout="this.style.color='var(--g5)'">Contact</a>
        </div>
      </div>

    </div>

    <!-- BOTTOM ROW -->
    <div style="border-top:1px solid var(--border2);padding-top:24px;display:flex;align-items:center;justify-content:space-between;flex-wrap:wrap;gap:12px;">
      <div style="font-size:12px;color:var(--muted2);">© 2025 ViralBoost. All rights reserved.</div>
      <div style="display:flex;align-items:center;gap:6px;font-family:'DM Mono',monospace;font-size:10px;color:var(--muted2);">
        <span style="width:6px;height:6px;border-radius:50%;background:var(--g3);display:inline-block;animation:blink 2s infinite;"></span>
        All systems operational
      </div>
      <div style="font-size:12px;color:var(--muted2);">
        <a href="#plans" style="color:var(--muted2);text-decoration:none;margin-right:16px;" onmouseover="this.style.color='var(--g5)'" onmouseout="this.style.color='var(--muted2)'">Privacy</a>
        <a href="#plans" style="color:var(--muted2);text-decoration:none;" onmouseover="this.style.color='var(--g5)'" onmouseout="this.style.color='var(--muted2)'">Terms</a>
      </div>
    </div>

  </div>
</footer>

<script>
// ══ MULTILINGUAL TESTIMONIALS & ADS ══
(function(){
  const LANGS = [
    { code:'en', flag:'🇬🇧', name:'EN · English', label:'The community', title:'What creators say about us', sub:'Real testimonials from creators around the world.', adTitle:'Projects from the community', adsLabel:'Featured ads', ctaTitle:'READY TO GET STARTED?', ctaSub:'Sign up free · No credit card · Immediate access to all tools', ctaBtn:'Create my free account', refresh:'EN · Refreshes every hour' },
    { code:'fr', flag:'🇫🇷', name:'FR · Français', label:'La communauté', title:'Ce que disent les créateurs', sub:'Vrais témoignages de créateurs du monde entier.', adTitle:'Projets de la communauté', adsLabel:'Annonces à la une', ctaTitle:'PRÊT À DÉMARRER ?', ctaSub:'Inscription gratuite · Sans carte · Accès immédiat à tous les outils', ctaBtn:'Créer mon compte gratuit', refresh:'FR · Actualisé chaque heure' },
    { code:'es', flag:'🇪🇸', name:'ES · Español', label:'La comunidad', title:'Lo que dicen los creadores', sub:'Testimonios reales de creadores de todo el mundo.', adTitle:'Proyectos de la comunidad', adsLabel:'Anuncios destacados', ctaTitle:'¿LISTO PARA EMPEZAR?', ctaSub:'Registro gratuito · Sin tarjeta · Acceso inmediato a todas las herramientas', ctaBtn:'Crear mi cuenta gratis', refresh:'ES · Se actualiza cada hora' },
    { code:'de', flag:'🇩🇪', name:'DE · Deutsch', label:'Die Community', title:'Was Kreative sagen', sub:'Echte Bewertungen von Kreativen aus aller Welt.', adTitle:'Projekte der Community', adsLabel:'Empfohlene Anzeigen', ctaTitle:'BEREIT LOSZULEGEN?', ctaSub:'Kostenlos anmelden · Keine Karte · Sofortiger Zugang zu allen Tools', ctaBtn:'Mein kostenloses Konto erstellen', refresh:'DE · Stündlich aktualisiert' },
    { code:'pt', flag:'🇧🇷', name:'PT · Português', label:'A comunidade', title:'O que os criadores dizem', sub:'Depoimentos reais de criadores do mundo todo.', adTitle:'Projetos da comunidade', adsLabel:'Anúncios em destaque', ctaTitle:'PRONTO PARA COMEÇAR?', ctaSub:'Cadastro grátis · Sem cartão · Acesso imediato a todas as ferramentas', ctaBtn:'Criar minha conta grátis', refresh:'PT · Atualizado a cada hora' },
    { code:'it', flag:'🇮🇹', name:'IT · Italiano', label:'La community', title:'Cosa dicono i creator', sub:'Testimonianze reali da creator di tutto il mondo.', adTitle:'Progetti della community', adsLabel:'Annunci in evidenza', ctaTitle:'PRONTO PER INIZIARE?', ctaSub:'Registrazione gratuita · Nessuna carta · Accesso immediato a tutti gli strumenti', ctaBtn:'Crea il mio account gratuito', refresh:'IT · Aggiornato ogni ora' },
    { code:'ar', flag:'🇸🇦', name:'AR · العربية', label:'المجتمع', title:'ما يقوله المبدعون', sub:'شهادات حقيقية من منشئي المحتوى حول العالم.', adTitle:'مشاريع المجتمع', adsLabel:'إعلانات مميزة', ctaTitle:'مستعد للبدء؟', ctaSub:'تسجيل مجاني · بدون بطاقة · وصول فوري لجميع الأدوات', ctaBtn:'أنشئ حسابي المجاني', refresh:'AR · يتجدد كل ساعة' },
    { code:'zh', flag:'🇨🇳', name:'ZH · 中文', label:'社区', title:'创作者怎么说', sub:'来自世界各地创作者的真实评价。', adTitle:'社区项目', adsLabel:'精选广告', ctaTitle:'准备好开始了吗？', ctaSub:'免费注册 · 无需信用卡 · 立即使用所有工具', ctaBtn:'创建我的免费账号', refresh:'ZH · 每小时刷新' },
    { code:'ja', flag:'🇯🇵', name:'JA · 日本語', label:'コミュニティ', title:'クリエイターの声', sub:'世界中のクリエイターからのリアルな声。', adTitle:'コミュニティのプロジェクト', adsLabel:'注目の広告', ctaTitle:'始める準備はできましたか？', ctaSub:'無料登録 · カード不要 · 全ツールへの即時アクセス', ctaBtn:'無料アカウントを作成', refresh:'JA · 毎時更新' },
    { code:'ru', flag:'🇷🇺', name:'RU · Русский', label:'Сообщество', title:'Что говорят авторы', sub:'Реальные отзывы авторов со всего мира.', adTitle:'Проекты сообщества', adsLabel:'Избранные объявления', ctaTitle:'ГОТОВЫ НАЧАТЬ?', ctaSub:'Бесплатная регистрация · Без карты · Немедленный доступ ко всем инструментам', ctaBtn:'Создать бесплатный аккаунт', refresh:'RU · Обновляется каждый час' },
  ];

  const TESTIMONIALS = {
    en: [
      { text: "ViralBoost helped me find a developer for my SaaS in just 2 days. The matching feature is incredibly accurate.", name: "James Carter", handle: "@jcarter_dev", role: "SaaS Founder", stars: 5, avatar: "JC", color: "#16a34a" },
      { text: "I posted my ad on a Monday and had 3 collab requests by Wednesday. This platform is a game-changer for indie creators.", name: "Mia Thompson", handle: "@mia_builds", role: "Indie Creator", stars: 5, avatar: "MT", color: "#7c3aed" },
      { text: "Finally a platform where everyone is actually trying to build something. Real connections, zero noise.", name: "Oliver Nash", handle: "@olivernash", role: "Growth Hacker", stars: 5, avatar: "ON", color: "#0891b2" },
    ],
    fr: [
      { text: "J'ai trouvé mon associé technique en 3 jours grâce à ViralBoost. La communauté est sérieuse et engagée.", name: "Lucas Moreau", handle: "@lmoreau_tech", role: "Fondateur SaaS", stars: 5, avatar: "LM", color: "#15803d" },
      { text: "Enfin une plateforme où les créateurs se retrouvent vraiment. J'ai doublé ma visibilité en une semaine.", name: "Chloé Dupont", handle: "@chloe_cree", role: "Créatrice de contenu", stars: 5, avatar: "CD", color: "#be185d" },
      { text: "Le matching IA est bluffant. Il m'a suggéré des partenaires que je n'aurais jamais trouvés seul.", name: "Antoine Bernard", handle: "@antoineb", role: "Entrepreneur", stars: 5, avatar: "AB", color: "#d97706" },
    ],
    es: [
      { text: "Encontré un co-fundador para mi startup en menos de una semana. La plataforma es increíble.", name: "Carlos Ruiz", handle: "@carlosruiz_mx", role: "Co-fundador", stars: 5, avatar: "CR", color: "#dc2626" },
      { text: "Publiqué mi proyecto el martes y el viernes ya tenía tres colaboraciones confirmadas. ¡Esto es lo que necesitaba!", name: "Valentina López", handle: "@vali_creator", role: "Creadora digital", stars: 5, avatar: "VL", color: "#7c3aed" },
      { text: "La mejor inversión de tiempo que he hecho. La comunidad de ViralBoost es seria y muy activa.", name: "Diego Fernández", handle: "@diegof_dev", role: "Desarrollador freelance", stars: 5, avatar: "DF", color: "#0891b2" },
    ],
    de: [
      { text: "Ich habe meinen Entwickler innerhalb von 3 Tagen gefunden. Die KI-Matching-Funktion ist beeindruckend genau.", name: "Felix Müller", handle: "@felixm_dev", role: "Startup-Gründer", stars: 5, avatar: "FM", color: "#15803d" },
      { text: "Endlich eine Plattform, auf der alle wirklich etwas aufbauen wollen. Echte Verbindungen, kein Lärm.", name: "Hannah Schneider", handle: "@hanna_creates", role: "Content Creatorin", stars: 5, avatar: "HS", color: "#d97706" },
      { text: "Mein Projekt hat in der ersten Woche über 200 Stimmen erhalten. Die Sichtbarkeit hier ist phänomenal.", name: "Lukas Wagner", handle: "@lukas_builds", role: "Indie-Entwickler", stars: 5, avatar: "LW", color: "#0891b2" },
    ],
    pt: [
      { text: "Encontrei meu co-fundador em 4 dias! O matching de IA é muito preciso e eficiente.", name: "Pedro Oliveira", handle: "@pedrooli_br", role: "Fundador de startup", stars: 5, avatar: "PO", color: "#16a34a" },
      { text: "Publiquei meu app na segunda-feira e na sexta tinha 5 pedidos de colaboração. Plataforma incrível!", name: "Ana Silva", handle: "@anasilva_dev", role: "Desenvolvedora", stars: 5, avatar: "AS", color: "#be185d" },
      { text: "A melhor comunidade para empreendedores digitais que já participei. Todo mundo quer crescer junto.", name: "Mateus Santos", handle: "@mateussantos", role: "Growth Marketer", stars: 5, avatar: "MS", color: "#7c3aed" },
    ],
    it: [
      { text: "Ho trovato il mio co-fondatore in 3 giorni grazie al matching AI. Piattaforma straordinaria!", name: "Marco Ferrari", handle: "@marcoferrari", role: "Fondatore startup", stars: 5, avatar: "MF", color: "#dc2626" },
      { text: "Ho pubblicato il mio progetto lunedì e il mercoledì avevo già 4 richieste di collaborazione.", name: "Giulia Romano", handle: "@giulia_crea", role: "Content Creator", stars: 5, avatar: "GR", color: "#be185d" },
      { text: "Finalmente una piattaforma seria per chi vuole costruire qualcosa di vero. Community fantastica.", name: "Luca Bianchi", handle: "@lucab_dev", role: "Developer freelance", stars: 5, avatar: "LB", color: "#0891b2" },
    ],
    ar: [
      { text: "وجدت شريكي التقني خلال 3 أيام فقط! نظام المطابقة بالذكاء الاصطناعي دقيق جداً.", name: "أحمد الشريف", handle: "@ahmed_sharif", role: "مؤسس شركة ناشئة", stars: 5, avatar: "أح", color: "#15803d" },
      { text: "نشرت مشروعي يوم الإثنين وحصلت على 5 طلبات تعاون بحلول الجمعة. منصة رائعة!", name: "سارة المنصوري", handle: "@sara_creates", role: "منشئة محتوى", stars: 5, avatar: "سا", color: "#d97706" },
      { text: "أفضل مجتمع للمبدعين الرقميين. الجميع يريد النمو معاً وهذا نادر جداً.", name: "عمر حسين", handle: "@omar_dev", role: "مطور مستقل", stars: 5, avatar: "عم", color: "#7c3aed" },
    ],
    zh: [
      { text: "通过ViralBoost，我在3天内找到了我的技术联合创始人。AI匹配功能非常精准！", name: "李伟", handle: "@liwei_builds", role: "创业者", stars: 5, avatar: "李", color: "#dc2626" },
      { text: "周一发布项目，周三就收到了5个合作请求。这个平台太棒了！", name: "王芳", handle: "@wangfang_dev", role: "内容创作者", stars: 5, avatar: "王", color: "#be185d" },
      { text: "终于找到一个认真做事的创作者社区。真实的联系，没有噪音。", name: "张明", handle: "@zhangming_tech", role: "独立开发者", stars: 5, avatar: "张", color: "#0891b2" },
    ],
    ja: [
      { text: "ViralBoostで3日以内に技術共同創業者を見つけました。AIマッチングの精度が驚異的です！", name: "田中一郎", handle: "@tanaka_builds", role: "スタートアップ創業者", stars: 5, avatar: "田", color: "#15803d" },
      { text: "月曜日にプロジェクトを投稿し、水曜日には5つのコラボリクエストが届きました。", name: "佐藤花子", handle: "@sato_creator", role: "コンテンツクリエイター", stars: 5, avatar: "佐", color: "#d97706" },
      { text: "本当に何かを作ろうとしている人たちのコミュニティ。リアルなつながり、ノイズなし。", name: "鈴木健", handle: "@suzuki_dev", role: "フリーランス開発者", stars: 5, avatar: "鈴", color: "#7c3aed" },
    ],
    ru: [
      { text: "Нашёл технического сооснователя за 3 дня! Функция AI-матчинга работает невероятно точно.", name: "Алексей Иванов", handle: "@alexei_builds", role: "Основатель стартапа", stars: 5, avatar: "АИ", color: "#dc2626" },
      { text: "Опубликовал проект в понедельник, а в среду уже получил 5 запросов на сотрудничество.", name: "Мария Соколова", handle: "@maria_creates", role: "Контент-криэйтор", stars: 5, avatar: "МС", color: "#be185d" },
      { text: "Наконец-то сообщество, где все действительно хотят что-то создать. Реальные связи без шума.", name: "Дмитрий Петров", handle: "@dmitry_dev", role: "Фриланс-разработчик", stars: 5, avatar: "ДП", color: "#0891b2" },
    ],
  };

  const ADS = {
    en: [
      { emoji: "🚀", name: "LaunchPad AI", hook: "Turn your idea into a validated startup in 7 days", desc: "AI-powered framework that helps founders validate, build and launch their product with real market feedback.", tags: ["AI","Startup","Validate"], votes: 142 },
      { emoji: "📊", name: "DashMetrics", hook: "All your KPIs in one beautiful dashboard", desc: "Connect Stripe, GA4, Shopify and 30+ tools. Real-time analytics designed for growth-focused founders.", tags: ["SaaS","Analytics","Dashboard"], votes: 89 },
      { emoji: "🎯", name: "CollabMatch", hook: "Find your perfect co-founder in 48h", desc: "AI matches you with complementary profiles based on your skills, vision and work style. Free to try.", tags: ["Collab","AI","Founders"], votes: 201 },
    ],
    fr: [
      { emoji: "🚀", name: "IdéeBoost", hook: "Transformez votre idée en startup validée en 7 jours", desc: "Cadre IA qui aide les fondateurs à valider, construire et lancer leur produit avec de vrais retours marché.", tags: ["IA","Startup","Validation"], votes: 134 },
      { emoji: "📊", name: "PilotageKPI", hook: "Tous vos KPIs dans un tableau de bord magnifique", desc: "Connectez Stripe, GA4, Shopify et 30+ outils. Analytics temps réel conçu pour les fondateurs.", tags: ["SaaS","Analytics","Dashboard"], votes: 76 },
      { emoji: "🎨", name: "DesignSprint.fr", hook: "Logo + charte graphique pro en 48h", desc: "Service de design rapide pour startups. Livrables premium, prix accessible. Plus de 500 clients satisfaits.", tags: ["Design","Branding","Rapide"], votes: 98 },
    ],
    es: [
      { emoji: "🚀", name: "IdeaLanzar", hook: "Convierte tu idea en una startup validada en 7 días", desc: "Marco impulsado por IA que ayuda a los fundadores a validar, construir y lanzar su producto.", tags: ["IA","Startup","Validar"], votes: 118 },
      { emoji: "📊", name: "MetricasPro", hook: "Todos tus KPIs en un hermoso dashboard", desc: "Conecta Stripe, GA4, Shopify y más de 30 herramientas. Analytics en tiempo real para fundadores.", tags: ["SaaS","Analytics","Dashboard"], votes: 67 },
      { emoji: "🎯", name: "SocioIdeal", hook: "Encuentra tu cofundador perfecto en 48h", desc: "IA que te conecta con perfiles complementarios según habilidades, visión y estilo de trabajo.", tags: ["Colaboración","IA","Fundadores"], votes: 183 },
    ],
    de: [
      { emoji: "🚀", name: "StartupBoost DE", hook: "Deine Idee zur validierten Startup in 7 Tagen", desc: "KI-Framework für Gründer: validieren, aufbauen und launchen mit echtem Marktfeedback.", tags: ["KI","Startup","Validierung"], votes: 109 },
      { emoji: "📊", name: "KPI Cockpit", hook: "Alle KPIs in einem schönen Dashboard", desc: "Verbinde Stripe, GA4, Shopify und 30+ Tools. Echtzeit-Analytics für wachstumsorientierte Gründer.", tags: ["SaaS","Analytics","Dashboard"], votes: 54 },
      { emoji: "🎨", name: "DesignSchnell", hook: "Logo + Corporate Design in 48h", desc: "Schneller Design-Service für Startups. Premium-Lieferungen, erschwingliche Preise. 500+ zufriedene Kunden.", tags: ["Design","Branding","Schnell"], votes: 87 },
    ],
    pt: [
      { emoji: "🚀", name: "LaunchBR", hook: "Transforme sua ideia em startup validada em 7 dias", desc: "Framework com IA que ajuda fundadores a validar, construir e lançar seu produto com feedback real.", tags: ["IA","Startup","Validar"], votes: 127 },
      { emoji: "📊", name: "DashBrasil", hook: "Todos os seus KPIs em um dashboard bonito", desc: "Conecte Stripe, GA4, Shopify e 30+ ferramentas. Analytics em tempo real para fundadores.", tags: ["SaaS","Analytics","Dashboard"], votes: 61 },
      { emoji: "🎯", name: "SócioPerfeito", hook: "Encontre seu co-fundador ideal em 48h", desc: "IA que conecta você com perfis complementares baseados em habilidades e visão de trabalho.", tags: ["Colaboração","IA","Fundadores"], votes: 174 },
    ],
    it: [
      { emoji: "🚀", name: "LanciaIdea", hook: "Trasforma la tua idea in una startup validata in 7 giorni", desc: "Framework AI per fondatori: valida, costruisci e lancia il tuo prodotto con feedback reali.", tags: ["AI","Startup","Validazione"], votes: 115 },
      { emoji: "📊", name: "DashboardIT", hook: "Tutti i tuoi KPI in una dashboard bellissima", desc: "Connetti Stripe, GA4, Shopify e 30+ tool. Analytics in tempo reale per fondatori orientati alla crescita.", tags: ["SaaS","Analytics","Dashboard"], votes: 58 },
      { emoji: "🎨", name: "DesignVeloce", hook: "Logo + brand identity professionale in 48h", desc: "Servizio design rapido per startup. Deliverable premium, prezzi accessibili. 500+ clienti soddisfatti.", tags: ["Design","Branding","Veloce"], votes: 93 },
    ],
    ar: [
      { emoji: "🚀", name: "انطلق الآن", hook: "حوّل فكرتك إلى شركة ناشئة في 7 أيام", desc: "إطار عمل بالذكاء الاصطناعي يساعد المؤسسين على التحقق والبناء والإطلاق مع ردود فعل السوق الحقيقية.", tags: ["ذكاء اصطناعي","شركة ناشئة","تحقق"], votes: 103 },
      { emoji: "📊", name: "لوحة المقاييس", hook: "جميع مؤشراتك في لوحة معلومات جميلة", desc: "اربط Stripe وGA4 وShopify و30+ أداة. تحليلات في الوقت الفعلي للمؤسسين.", tags: ["SaaS","تحليلات","لوحة تحكم"], votes: 49 },
      { emoji: "🎯", name: "شريك مثالي", hook: "اعثر على شريكك المثالي في 48 ساعة", desc: "يربطك الذكاء الاصطناعي بالملفات التكميلية بناءً على مهاراتك ورؤيتك وأسلوب عملك.", tags: ["تعاون","ذكاء اصطناعي","مؤسسون"], votes: 168 },
    ],
    zh: [
      { emoji: "🚀", name: "创业加速器", hook: "7天内将你的想法变成验证过的初创公司", desc: "AI驱动的框架，帮助创始人通过真实市场反馈来验证、构建和发布产品。", tags: ["AI","创业","验证"], votes: 131 },
      { emoji: "📊", name: "数据仪表盘", hook: "一个漂亮的仪表盘展示所有KPI", desc: "连接Stripe、GA4、Shopify等30+工具。专为注重增长的创始人设计的实时分析。", tags: ["SaaS","分析","仪表盘"], votes: 72 },
      { emoji: "🎯", name: "完美合伙人", hook: "48小时内找到你的理想联合创始人", desc: "AI根据你的技能、愿景和工作方式为你匹配互补的合作伙伴。", tags: ["合作","AI","创始人"], votes: 195 },
    ],
    ja: [
      { emoji: "🚀", name: "スタートアップ加速", hook: "7日間でアイデアを検証済みスタートアップに", desc: "創業者が本物の市場フィードバックで製品を検証・構築・ローンチするためのAIフレームワーク。", tags: ["AI","スタートアップ","検証"], votes: 119 },
      { emoji: "📊", name: "KPIダッシュ", hook: "すべてのKPIを美しいダッシュボードで", desc: "Stripe、GA4、Shopifyなど30以上のツールに接続。成長志向の創業者向けリアルタイム分析。", tags: ["SaaS","分析","ダッシュボード"], votes: 63 },
      { emoji: "🎯", name: "共同創業者マッチ", hook: "48時間で理想の共同創業者を見つける", desc: "AIがスキル・ビジョン・仕事スタイルに基づいて補完的なプロフィールとマッチング。", tags: ["コラボ","AI","創業者"], votes: 177 },
    ],
    ru: [
      { emoji: "🚀", name: "Запуск Идеи", hook: "Превратите идею в валидированный стартап за 7 дней", desc: "AI-фреймворк, который помогает основателям валидировать, создавать и запускать продукт.", tags: ["ИИ","Стартап","Валидация"], votes: 122 },
      { emoji: "📊", name: "DashMetrics RU", hook: "Все ваши KPI в одном красивом дашборде", desc: "Подключите Stripe, GA4, Shopify и 30+ инструментов. Аналитика в реальном времени для основателей.", tags: ["SaaS","Аналитика","Дашборд"], votes: 57 },
      { emoji: "🎯", name: "ИдеальныйПартнёр", hook: "Найдите идеального сооснователя за 48 часов", desc: "ИИ подбирает профили с дополняющими навыками на основе вашего видения и стиля работы.", tags: ["Коллаборация","ИИ","Основатели"], votes: 188 },
    ],
  };

  function getCurrentLangIndex() {
    // Rotate language every hour based on UTC hour
    const hour = new Date().getUTCHours();
    return hour % LANGS.length;
  }

  function renderStars(n) {
    return '★'.repeat(n) + '☆'.repeat(5-n);
  }

  function renderTestimonials(langCode) {
    const items = TESTIMONIALS[langCode] || TESTIMONIALS['en'];
    const container = document.getElementById('multilang-testimonials');
    if (!container) return;
    container.innerHTML = items.map(t => `
      <div class="rev-card" style="background:var(--s1);border:1.5px solid var(--border2);border-radius:12px;padding:22px;transition:all 0.2s;" onmouseover="this.style.borderColor=\'rgba(34,197,94,0.25)\'" onmouseout="this.style.borderColor=\'var(--border2)\'">
        <div style="color:var(--g3);font-size:14px;letter-spacing:3px;margin-bottom:12px">${renderStars(t.stars)}</div>
        <div style="font-size:13px;color:#6a9478;line-height:1.8;margin-bottom:16px">"${t.text}"</div>
        <div style="display:flex;align-items:center;gap:10px">
          <div style="width:36px;height:36px;border-radius:50%;background:${t.color};display:flex;align-items:center;justify-content:center;font-size:11px;font-weight:700;color:white;flex-shrink:0">${t.avatar}</div>
          <div>
            <div style="font-size:13px;font-weight:700;color:var(--white)">${t.name}</div>
            <div style="font-size:11px;color:var(--muted)">${t.handle} · ${t.role}</div>
          </div>
        </div>
      </div>
    `).join('');
  }

  function renderAds(langCode) {
    const items = ADS[langCode] || ADS['en'];
    const container = document.getElementById('multilang-ads');
    if (!container) return;
    container.innerHTML = items.map(a => `
      <div style="background:var(--s1);border:1.5px solid var(--border2);border-radius:12px;overflow:hidden;transition:all 0.2s;" onmouseover="this.style.borderColor='rgba(34,197,94,0.3)';this.style.transform='translateY(-2px)'" onmouseout="this.style.borderColor='var(--border2)';this.style.transform='translateY(0)'">
        <div style="height:80px;background:linear-gradient(135deg,var(--s2),var(--s3));display:flex;align-items:center;justify-content:center;font-size:40px">${a.emoji}</div>
        <div style="padding:16px 18px">
          <div style="font-family:'Bebas Neue',sans-serif;font-size:18px;letter-spacing:1px;color:var(--white);margin-bottom:4px">${a.name}</div>
          <div style="font-size:12px;color:var(--g3);font-weight:700;margin-bottom:8px">${a.hook}</div>
          <div style="font-size:12px;color:#6a9478;line-height:1.6;margin-bottom:10px">${a.desc}</div>
          <div style="display:flex;gap:5px;flex-wrap:wrap;margin-bottom:10px">${a.tags.map(t=>`<span style="font-family:'DM Mono',monospace;font-size:9px;letter-spacing:1px;padding:2px 7px;border-radius:3px;background:rgba(34,197,94,0.1);border:1px solid rgba(34,197,94,0.2);color:var(--g4)">#${t}</span>`).join('')}</div>
          <div style="display:flex;align-items:center;justify-content:space-between;font-size:11px;color:var(--muted)">
            <span>🔥 ${a.votes} votes</span>
            <button onclick="openModal('signup-modal')" style="background:var(--g2);border:none;border-radius:5px;padding:5px 12px;font-size:11px;font-weight:700;cursor:pointer;color:var(--bg)">View →</button>
          </div>
        </div>
      </div>
    `).join('');
  }

  function applyLang() {
    const idx = getCurrentLangIndex();
    const lang = LANGS[idx];

    // Update labels
    const el = (id) => document.getElementById(id);
    if(el('community-label')) el('community-label').textContent = lang.label;
    if(el('community-title')) el('community-title').innerHTML = lang.title.replace(/say about us|Ce que|Lo que|Was Kreative|O que|Cosa dicono|ما يقوله|怎么说|の声|Что говорят/, '<em>$&</em>');
    if(el('community-sub')) el('community-sub').textContent = lang.sub;
    if(el('ads-label')) el('ads-label').textContent = lang.adsLabel;
    if(el('ads-title')) el('ads-title').innerHTML = `${lang.adTitle.replace(/(community|communauté|comunidad|Community|comunidade|community|المجتمع|社区|コミュニティ|сообщества)/, '<em>$1</em>')}`;
    if(el('cta-title')) el('cta-title').textContent = lang.ctaTitle;
    if(el('cta-sub')) el('cta-sub').textContent = lang.ctaSub;
    if(el('cta-btn')) el('cta-btn').textContent = lang.ctaBtn;
    if(el('lang-display')) el('lang-display').textContent = lang.flag + ' ' + lang.refresh;

    renderTestimonials(lang.code);
    renderAds(lang.code);
  }

  // Run immediately
  applyLang();

  // Recalculate at top of next hour
  function scheduleNextHour() {
    const now = new Date();
    const msUntilNextHour = (3600 - (now.getMinutes()*60 + now.getSeconds())) * 1000;
    setTimeout(() => { applyLang(); scheduleNextHour(); }, msUntilNextHour);
  }
  scheduleNextHour();
})();
</script>

<!-- COLLABORATION HIGHLIGHT SECTION -->
<section style="padding:80px 5%;position:relative;z-index:1;background:rgba(11,26,13,0.6);">
  <div style="max-width:900px;margin:0 auto;text-align:center">
    <span class="sec-label">Matching IA</span>
    <h2 class="section-title">Find your <em>next partner</em></h2>
    <p class="section-sub" style="margin:0 auto 40px">The algorithm analyzes your profiles, projects and goals to automatically connect you with the most compatible creators.</p>
    <div style="display:grid;grid-template-columns:repeat(3,1fr);gap:20px;margin-bottom:32px">
      <div style="background:var(--s1);border:1.5px solid var(--border2);border-radius:14px;padding:24px 20px;text-align:center">
        <div style="font-size:36px;margin-bottom:10px">🧠</div>
        <div style="font-size:15px;font-weight:700;color:var(--white);margin-bottom:6px">Compatibility score</div>
        <div style="font-size:12px;color:var(--muted);line-height:1.6">AI analyzes your profile and suggests the most compatible partners with a matching score.</div>
      </div>
      <div style="background:var(--s1);border:1.5px solid var(--border2);border-radius:14px;padding:24px 20px;text-align:center">
        <div style="font-size:36px;margin-bottom:10px">💬</div>
        <div style="font-size:15px;font-weight:700;color:var(--white);margin-bottom:6px">Contact direct</div>
        <div style="font-size:12px;color:var(--muted);line-height:1.6">Send a DM directly from the matching profile. No middleman, immediate contact.</div>
      </div>
      <div style="background:var(--s1);border:1.5px solid var(--border2);border-radius:14px;padding:24px 20px;text-align:center">
        <div style="font-size:36px;margin-bottom:10px">🎯</div>
        <div style="font-size:15px;font-weight:700;color:var(--white);margin-bottom:6px">Niche-targeted</div>
        <div style="font-size:12px;color:var(--muted);line-height:1.6">Filter by sector, objective and availability for truly relevant collaborations.</div>
      </div>
    </div>
    <button class="btn-hero-big btn-hero-solid" onclick="openModal('signup-modal')">🤝 Discover my matches →</button>
  </div>
</section>

<section class="cta-section">
  <h2>JOIN THE COMMUNITY</h2>
  <p style="font-size:15px;color:var(--muted);margin:8px 0 28px">Platform in launch — be among the first creators on board.</p>
  <button class="btn-hero-big btn-hero-solid" onclick="openModal('signup-modal')" data-i18n="hero_cta1">Create my account →</button>
</section>

<footer>
  <div class="footer-logo">VIRALBOOST</div>
  <p>© 2025 ViralBoost — The creator social network</p>
  <p>Stripe · Claude AI · Real-time WebSocket</p>
</footer>

<!-- ══════ ADVERTISE PAGE ══════ -->
<section id="advertise" style="display:none;padding:80px 20px;max-width:900px;margin:0 auto;">
  <div style="text-align:center;margin-bottom:60px;">
    <div style="display:inline-block;background:rgba(244,63,94,0.1);border:1px solid rgba(244,63,94,0.3);border-radius:20px;padding:6px 18px;font-family:'DM Mono',monospace;font-size:10px;color:#f43f5e;letter-spacing:2px;margin-bottom:20px;">ADVERTISE ON VIRALBOOST</div>
    <h1 style="font-family:'Bebas Neue',sans-serif;font-size:clamp(42px,8vw,80px);letter-spacing:3px;color:#f0fdf4;line-height:1;margin-bottom:16px;">REACH <span style="color:#f43f5e;">12,000+</span><br>CREATORS & FOUNDERS</h1>
    <p style="font-size:16px;color:var(--muted);max-width:560px;margin:0 auto;line-height:1.7;">The most engaged community of digital creators, entrepreneurs, and indie founders. Your brand, front and center.</p>
  </div>

  <!-- Stats row -->
  <div style="display:grid;grid-template-columns:repeat(4,1fr);gap:16px;margin-bottom:64px;">
    <div style="background:rgba(244,63,94,0.06);border:1.5px solid rgba(244,63,94,0.15);border-radius:16px;padding:24px 16px;text-align:center;">
      <div style="font-family:'Bebas Neue',sans-serif;font-size:40px;color:#f43f5e;line-height:1;">12K+</div>
      <div style="font-size:12px;color:var(--muted);margin-top:6px;">Active Members</div>
    </div>
    <div style="background:rgba(244,63,94,0.06);border:1.5px solid rgba(244,63,94,0.15);border-radius:16px;padding:24px 16px;text-align:center;">
      <div style="font-family:'Bebas Neue',sans-serif;font-size:40px;color:#f43f5e;line-height:1;">84K</div>
      <div style="font-size:12px;color:var(--muted);margin-top:6px;">Daily Impressions</div>
    </div>
    <div style="background:rgba(244,63,94,0.06);border:1.5px solid rgba(244,63,94,0.15);border-radius:16px;padding:24px 16px;text-align:center;">
      <div style="font-family:'Bebas Neue',sans-serif;font-size:40px;color:#f43f5e;line-height:1;">7.4%</div>
      <div style="font-size:12px;color:var(--muted);margin-top:6px;">Avg. CTR</div>
    </div>
    <div style="background:rgba(244,63,94,0.06);border:1.5px solid rgba(244,63,94,0.15);border-radius:16px;padding:24px 16px;text-align:center;">
      <div style="font-family:'Bebas Neue',sans-serif;font-size:40px;color:#f43f5e;line-height:1;">68%</div>
      <div style="font-size:12px;color:var(--muted);margin-top:6px;">Creators & Founders</div>
    </div>
  </div>

  <!-- Ad formats -->
  <div style="margin-bottom:64px;">
    <div style="font-family:'DM Mono',monospace;font-size:10px;color:rgba(244,63,94,0.6);letter-spacing:2px;margin-bottom:24px;text-align:center;">AD FORMATS</div>
    <div style="display:grid;grid-template-columns:repeat(auto-fill,minmax(260px,1fr));gap:16px;">
      <div style="background:var(--s1);border:1.5px solid rgba(244,63,94,0.15);border-radius:16px;padding:22px;transition:all 0.2s;" onmouseover="this.style.borderColor='rgba(244,63,94,0.5)';this.style.transform='translateY(-3px)'" onmouseout="this.style.borderColor='rgba(244,63,94,0.15)';this.style.transform=''">
        <div style="font-size:28px;margin-bottom:12px;">📰</div>
        <div style="font-family:'Bebas Neue',sans-serif;font-size:18px;letter-spacing:1.5px;color:#f0fdf4;margin-bottom:6px;">FEED SPONSORED POST</div>
        <div style="font-size:12px;color:var(--muted);line-height:1.6;margin-bottom:14px;">Native post in the main feed. Seen by every active member while scrolling.</div>
        <div style="font-family:'Bebas Neue',sans-serif;font-size:28px;color:#f43f5e;">$9.99<span style="font-size:14px;opacity:0.6">/mo</span></div>
      </div>
      <div style="background:var(--s1);border:1.5px solid rgba(244,63,94,0.15);border-radius:16px;padding:22px;transition:all 0.2s;" onmouseover="this.style.borderColor='rgba(244,63,94,0.5)';this.style.transform='translateY(-3px)'" onmouseout="this.style.borderColor='rgba(244,63,94,0.15)';this.style.transform=''">
        <div style="font-size:28px;margin-bottom:12px;">🔔</div>
        <div style="font-family:'Bebas Neue',sans-serif;font-size:18px;letter-spacing:1.5px;color:#f0fdf4;margin-bottom:6px;">POPUP NOTIFICATION</div>
        <div style="font-size:12px;color:var(--muted);line-height:1.6;margin-bottom:14px;">Floating banner at the bottom of the screen. Impossible to miss. CTR ~12%.</div>
        <div style="font-family:'Bebas Neue',sans-serif;font-size:28px;color:#f43f5e;">$14.99<span style="font-size:14px;opacity:0.6">/mo</span></div>
      </div>
      <div style="background:var(--s1);border:1.5px solid rgba(244,63,94,0.15);border-radius:16px;padding:22px;transition:all 0.2s;position:relative;" onmouseover="this.style.borderColor='rgba(244,63,94,0.5)';this.style.transform='translateY(-3px)'" onmouseout="this.style.borderColor='rgba(244,63,94,0.15)';this.style.transform=''">
        <div style="position:absolute;top:12px;right:12px;background:linear-gradient(135deg,#f43f5e,#be123c);color:#fff;font-family:'DM Mono',monospace;font-size:7px;font-weight:900;padding:2px 8px;border-radius:4px;letter-spacing:1px;">NEW</div>
        <div style="font-size:28px;margin-bottom:12px;">🪢</div>
        <div style="font-family:'Bebas Neue',sans-serif;font-size:18px;letter-spacing:1.5px;color:#f0fdf4;margin-bottom:6px;">HANGING CARD</div>
        <div style="font-size:12px;color:var(--muted);line-height:1.6;margin-bottom:14px;">Unique animated card that drops from the top-right of the screen on a string. Unmissable.</div>
        <div style="font-family:'Bebas Neue',sans-serif;font-size:28px;color:#f43f5e;">$17.99<span style="font-size:14px;opacity:0.6">/mo</span></div>
      </div>
      <div style="background:var(--s1);border:1.5px solid rgba(244,63,94,0.15);border-radius:16px;padding:22px;transition:all 0.2s;" onmouseover="this.style.borderColor='rgba(244,63,94,0.5)';this.style.transform='translateY(-3px)'" onmouseout="this.style.borderColor='rgba(244,63,94,0.15)';this.style.transform=''">
        <div style="font-size:28px;margin-bottom:12px;">🏠</div>
        <div style="font-family:'Bebas Neue',sans-serif;font-size:18px;letter-spacing:1.5px;color:#f0fdf4;margin-bottom:6px;">HOME HERO BANNER</div>
        <div style="font-size:12px;color:var(--muted);line-height:1.6;margin-bottom:14px;">Large banner in the Home dashboard. First thing members see when they log in.</div>
        <div style="font-family:'Bebas Neue',sans-serif;font-size:28px;color:#f43f5e;">$29.99<span style="font-size:14px;opacity:0.6">/mo</span></div>
      </div>
      <div style="background:var(--s1);border:1.5px solid rgba(244,63,94,0.15);border-radius:16px;padding:22px;transition:all 0.2s;" onmouseover="this.style.borderColor='rgba(244,63,94,0.5)';this.style.transform='translateY(-3px)'" onmouseout="this.style.borderColor='rgba(244,63,94,0.15)';this.style.transform=''">
        <div style="font-size:28px;margin-bottom:12px;">📲</div>
        <div style="font-family:'Bebas Neue',sans-serif;font-size:18px;letter-spacing:1.5px;color:#f0fdf4;margin-bottom:6px;">COMMUNITY PUSH BLAST</div>
        <div style="font-size:12px;color:var(--muted);line-height:1.6;margin-bottom:14px;">One-time notification sent instantly to all online members. Maximum reach in seconds.</div>
        <div style="font-family:'Bebas Neue',sans-serif;font-size:28px;color:#f43f5e;">$4.99<span style="font-size:14px;opacity:0.6"> once</span></div>
      </div>
      <div style="background:linear-gradient(135deg,rgba(244,63,94,0.1),rgba(190,18,60,0.05));border:2px solid rgba(244,63,94,0.4);border-radius:16px;padding:22px;transition:all 0.2s;position:relative;" onmouseover="this.style.borderColor='rgba(244,63,94,0.8)';this.style.transform='translateY(-3px)'" onmouseout="this.style.borderColor='rgba(244,63,94,0.4)';this.style.transform=''">
        <div style="position:absolute;top:-10px;left:50%;transform:translateX(-50%);background:linear-gradient(135deg,#f43f5e,#be123c);color:#fff;font-family:'DM Mono',monospace;font-size:8px;font-weight:900;padding:3px 14px;border-radius:4px;white-space:nowrap;letter-spacing:1px;">SAVE 40%</div>
        <div style="font-size:28px;margin-bottom:12px;">🔥</div>
        <div style="font-family:'Bebas Neue',sans-serif;font-size:18px;letter-spacing:1.5px;color:#f43f5e;margin-bottom:6px;">FULL PACKAGE</div>
        <div style="font-size:12px;color:var(--muted);line-height:1.6;margin-bottom:14px;">All 5 formats bundled. Maximum visibility across the entire platform.</div>
        <div style="font-family:'Bebas Neue',sans-serif;font-size:28px;color:#f43f5e;">$59.99<span style="font-size:14px;opacity:0.6">/mo</span></div>
      </div>
    </div>
  </div>

  <!-- Contact form -->
  <div style="background:var(--s1);border:1.5px solid rgba(244,63,94,0.2);border-radius:20px;padding:40px;max-width:580px;margin:0 auto;">
    <div style="font-family:'Bebas Neue',sans-serif;font-size:28px;letter-spacing:2px;color:#f0fdf4;margin-bottom:6px;">GET STARTED</div>
    <p style="font-size:13px;color:var(--muted);margin-bottom:28px;line-height:1.6;">Fill in the form below and we'll get back to you within 24h. Or <a href="#plans" onclick="openModal('signup-modal');return false;" style="color:#f43f5e;cursor:pointer;text-decoration:underline;">create an account</a> to launch your campaign directly.</p>
    <div style="display:flex;flex-direction:column;gap:14px;">
      <input type="text" id="adv-name" placeholder="Your name / company" style="width:100%;padding:12px 16px;background:rgba(244,63,94,0.05);border:1.5px solid rgba(244,63,94,0.15);border-radius:10px;color:#f0fdf4;font-size:13px;outline:none;box-sizing:border-box;" onfocus="this.style.borderColor='rgba(244,63,94,0.5)'" onblur="this.style.borderColor='rgba(244,63,94,0.15)'"/>
      <input type="email" id="adv-email" placeholder="Your email" style="width:100%;padding:12px 16px;background:rgba(244,63,94,0.05);border:1.5px solid rgba(244,63,94,0.15);border-radius:10px;color:#f0fdf4;font-size:13px;outline:none;box-sizing:border-box;" onfocus="this.style.borderColor='rgba(244,63,94,0.5)'" onblur="this.style.borderColor='rgba(244,63,94,0.15)'"/>
      <select id="adv-format" style="width:100%;padding:12px 16px;background:rgba(244,63,94,0.05);border:1.5px solid rgba(244,63,94,0.15);border-radius:10px;color:#f0fdf4;font-size:13px;outline:none;box-sizing:border-box;">
        <option value="">Format you're interested in…</option>
        <option>Feed Sponsored Post — $9.99/mo</option>
        <option>Popup Notification — $14.99/mo</option>
        <option>Hanging Card — $17.99/mo</option>
        <option>Home Hero Banner — $29.99/mo</option>
        <option>Push Blast — $4.99 once</option>
        <option>Full Package — $59.99/mo</option>
      </select>
      <textarea id="adv-msg" rows="3" placeholder="Tell us about your project…" style="width:100%;padding:12px 16px;background:rgba(244,63,94,0.05);border:1.5px solid rgba(244,63,94,0.15);border-radius:10px;color:#f0fdf4;font-size:13px;outline:none;resize:vertical;box-sizing:border-box;font-family:inherit;" onfocus="this.style.borderColor='rgba(244,63,94,0.5)'" onblur="this.style.borderColor='rgba(244,63,94,0.15)'"></textarea>
      <button onclick="submitAdvertiseForm()" style="width:100%;padding:14px;background:linear-gradient(135deg,#f43f5e,#be123c);border:none;border-radius:10px;font-family:'Bebas Neue',sans-serif;font-size:18px;letter-spacing:2px;color:#fff;cursor:pointer;transition:all 0.2s;box-shadow:0 0 24px rgba(244,63,94,0.3);" onmouseover="this.style.boxShadow='0 0 40px rgba(244,63,94,0.6)'" onmouseout="this.style.boxShadow='0 0 24px rgba(244,63,94,0.3)'">SEND INQUIRY →</button>
    </div>
  </div>
</section>

</div><!-- /landing -->


<!-- ══════════ APP ══════════ -->
<div id="app">
  <div class="app-bar">
    <div class="app-logo">VB</div>
    <div class="app-tabs">
      <button class="app-tab active" data-tab="home" data-color="#22c55e" onclick="showAppTab('home',this)"><span class="tab-icon" style="background:linear-gradient(135deg,#22c55e,#15803d)">🏠</span>Home</button>
      <button class="app-tab" data-tab="publish" data-color="#22c55e" onclick="showAppTab('publish',this)"><span class="tab-icon" style="background:linear-gradient(135deg,#22c55e,#15803d)">➕</span>Publish</button>
      <button class="app-tab" data-tab="big-campaign" data-color="#ff3c6e" onclick="showAppTab('big-campaign',this);bcRender()"><span class="tab-icon" style="background:linear-gradient(135deg,#be123c,#ff3c6e)">🔥</span>Big Campaign<span style="font-size:7px;background:linear-gradient(135deg,#ff3c6e,#ff8c00);color:#fff;border-radius:3px;padding:1px 5px;margin-left:4px;font-family:'DM Mono',monospace;letter-spacing:0.5px;font-weight:900">PRO</span></button>
      <button class="app-tab" data-tab="sponsor" data-color="#f43f5e" onclick="showSponsorTab(this)" id="tab-btn-sponsor"><span class="tab-icon" style="background:linear-gradient(135deg,#f43f5e,#be123c)">💼</span>Sponsor<span class="notif-dot" id="sponsor-notif" style="display:none"></span></button>
      <button class="app-tab" data-tab="pubcreator" data-color="#ffd700" onclick="showPubCreatorTab(this)" id="tab-btn-pubcreator"><span class="tab-icon" style="background:linear-gradient(135deg,#ffd700,#ff8c00)">AD</span>Ad Creator<span style="font-size:7px;background:linear-gradient(135deg,#ffd700,#ff8c00);color:#1a0a00;border-radius:3px;padding:1px 5px;margin-left:4px;font-family:'DM Mono',monospace;letter-spacing:0.5px;font-weight:900">ELITE</span></button>
      <button class="app-tab" data-tab="email-campaign" data-color="#0ea5e9" onclick="showAppTab('email-campaign',this)"><span class="tab-icon" style="background:linear-gradient(135deg,#0284c7,#0ea5e9)">✉</span>Email Camp.</button>
      <button class="app-tab" data-tab="live-studio" data-color="#ef4444" onclick="showAppTab('live-studio',this)"><span class="tab-icon" style="background:linear-gradient(135deg,#dc2626,#ef4444)">🔴</span>Go Live</button>
      <button class="app-tab" data-tab="video-creator" data-color="#6366f1" onclick="showAppTab('video-creator',this)"><span class="tab-icon" style="background:linear-gradient(135deg,#4f46e5,#6366f1)">🎬</span>Video Creator</button>
      <button class="app-tab" data-tab="campaign" data-color="#ff3c6e" onclick="showAppTab('campaign',this);campaignRender()"><span class="tab-icon" style="background:linear-gradient(135deg,#be123c,#ff3c6e)">🔥</span>Campaign Tools</button>
      <button class="app-tab" data-tab="feed" data-color="#34aadc" onclick="showAppTab('feed',this)"><span class="tab-icon" style="background:linear-gradient(135deg,#34aadc,#1a7bbf)">📰</span>Feed</button>
      <button class="app-tab" data-tab="chat-global" data-color="#4ade80" onclick="showAppTab('chat-global',this)" id="tab-btn-chat"><span class="tab-icon" style="background:linear-gradient(135deg,#22c55e,#16a34a)">💬</span>Chat<span class="notif-dot" id="chat-notif" style="display:none"></span></button>
      <button class="app-tab" data-tab="ia-boost" data-color="#22d3ee" onclick="showAppTab('ia-boost',this)"><span class="tab-icon" style="background:linear-gradient(135deg,#22d3ee,#0891b2)">🤖</span>IA Boost</button>
      <button class="app-tab" data-tab="collab" data-color="#fb923c" onclick="showAppTab('collab',this)"><span class="tab-icon" style="background:linear-gradient(135deg,#f97316,#ea580c)">🤝</span>Collabs</button>
      <button class="app-tab" data-tab="groups" data-color="#c084fc" onclick="showAppTab('groups',this)" id="tab-btn-groups"><span class="tab-icon" style="background:linear-gradient(135deg,#a855f7,#9333ea)">👥</span>Groups</button>
      <button class="app-tab" data-tab="stats" data-color="#22c55e" onclick="showAppTab('stats',this)"><span class="tab-icon" style="background:linear-gradient(135deg,#22c55e,#16a34a)">📊</span>Stats</button>
      <button class="app-tab" data-tab="leaderboard" data-color="#facc15" onclick="showAppTab('leaderboard',this)"><span class="tab-icon" style="background:linear-gradient(135deg,#facc15,#d97706)">🏆</span>Top</button>
      <button class="app-tab" data-tab="profile" data-color="#60a5fa" onclick="showAppTab('profile',this)"><span class="tab-icon" style="background:linear-gradient(135deg,#60a5fa,#2563eb)">👤</span>Profile</button>
      <button class="app-tab" data-tab="followers" data-color="#fb923c" onclick="showAppTab('followers',this)"><span class="tab-icon" style="background:linear-gradient(135deg,#f97316,#ea580c)">🔔</span>Followers</button>
      <button class="app-tab" data-tab="boost-credits" data-color="#ffd700" onclick="showAppTab('boost-credits',this)"><span class="tab-icon" style="background:linear-gradient(135deg,#f97316,#ea580c)">🛍️</span>Shop</button>
      <button class="app-tab" data-tab="videos" data-color="#8b5cf6" onclick="showAppTab('videos',this)"><span class="tab-icon" style="background:linear-gradient(135deg,#7c3aed,#8b5cf6)">📹</span>Videos</button>
      <button class="app-tab" data-tab="ab-test" data-color="#4ade80" onclick="showAppTab('ab-test',this)"><span class="tab-icon" style="background:linear-gradient(135deg,#4ade80,#16a34a)">🔬</span>A/B Test</button>
      <button class="app-tab" data-tab="calendrier" data-color="#60a5fa" onclick="showAppTab('calendrier',this)"><span class="tab-icon" style="background:linear-gradient(135deg,#60a5fa,#2563eb)">📅</span>Calendar</button>
      <button class="app-tab" data-tab="reviews" data-color="#facc15" onclick="showAppTab('reviews',this)"><span class="tab-icon" style="background:linear-gradient(135deg,#facc15,#d97706)">⭐</span>Reviews</button>
      <button class="app-tab" data-tab="crm" data-color="#14b8a6" onclick="showAppTab('crm',this)"><span class="tab-icon" style="background:linear-gradient(135deg,#0f766e,#14b8a6)">CRM</span>CRM</button>
      <button class="app-tab" data-tab="affiliate" data-color="#f59e0b" onclick="showAppTab('affiliate',this)"><span class="tab-icon" style="background:linear-gradient(135deg,#d97706,#f59e0b)">%</span>Affiliate</button>
      <button class="app-tab" data-tab="settings" data-color="#94a3b8" onclick="showAppTab('settings',this)"><span class="tab-icon" style="background:linear-gradient(135deg,#475569,#94a3b8)">⚙</span>Settings</button>
      <button class="app-tab" data-tab="help" data-color="#64748b" onclick="showAppTab('help',this)"><span class="tab-icon" style="background:linear-gradient(135deg,#334155,#64748b)">?</span>Help</button>
    </div>
    <div class="app-right">
      <span class="plan-chip" id="app-plan-chip">FREE</span>
      <button class="btn-out-g" onclick="showAppTab('boost-credits',null);switchCreditsTab('shop',document.getElementById('ctab-shop'))" style="border-color:rgba(255,215,0,0.3);color:var(--gold);display:flex;align-items:center;gap:5px;border-radius:7px;font-family:'DM Mono',monospace;font-weight:700;font-size:10px;letter-spacing:0.5px;">🛒 <span style="font-family:'DM Mono',monospace;font-size:11px;font-weight:700" id="header-credits">0</span><span style="font-size:9px;opacity:0.7">⚡</span></button>
      <button id="btn-wallpaper" class="btn-out-g" onclick="openWallpaperModal()" style="display:none">🖼️</button>
      <button id="btn-admin-dm" class="btn-out-g" onclick="openAdminDM()" style="display:none;border-color:rgba(255,215,0,0.3);color:var(--gold)">📩 Admin</button>
      <div id="app-username-chip" onclick="showAppTab('profile',null)" style="display:flex;align-items:center;gap:7px;background:rgba(11,26,13,0.85);border:1.5px solid rgba(34,197,94,0.18);border-radius:8px;padding:5px 12px;cursor:pointer;transition:all 0.2s;" onmouseover="this.style.borderColor='var(--g3)';this.style.background='rgba(22,163,74,0.1)'" onmouseout="this.style.borderColor='rgba(34,197,94,0.18)';this.style.background='rgba(11,26,13,0.85)'">
        <div style="width:22px;height:22px;border-radius:50%;background:linear-gradient(135deg,#15803d,#22c55e);display:flex;align-items:center;justify-content:center;font-size:10px;font-weight:800;color:#040a05;flex-shrink:0;">👤</div>
        <span id="app-user-name" style="font-family:'Bebas Neue',sans-serif;font-size:15px;letter-spacing:2px;color:var(--g3);line-height:1;transition:all 0.2s;">...</span>
      </div>
      <button class="btn-out-g" onclick="logout()" style="font-size:10px;letter-spacing:0.5px;padding:6px 11px;">Leave</button>
    </div>
  </div>

  <div style="max-width:1160px;margin:0 auto;padding:0 16px">

    <!-- ══════════ HOME ══════════ -->
    <div class="tpanel active" id="tab-home">
      <div style="max-width:720px;margin:0 auto;padding:20px 0 80px">

        <!-- LOGO HEADER -->
        <div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:20px;">
          <div style="display:flex;align-items:center;gap:10px;">
            <div style="width:38px;height:38px;border-radius:10px;background:linear-gradient(135deg,#15803d,#22c55e);display:flex;align-items:center;justify-content:center;box-shadow:0 0 18px rgba(34,197,94,0.35);flex-shrink:0;">
              <span style="font-family:'Bebas Neue',sans-serif;font-size:16px;color:#040a05;letter-spacing:1px;">VB</span>
            </div>
            <div>
              <div style="font-family:'Bebas Neue',sans-serif;font-size:20px;letter-spacing:3px;color:var(--g3);line-height:1;">VIRALBOOST</div>
              <div id="home-greeting" style="font-family:'DM Mono',monospace;font-size:8px;color:var(--muted);letter-spacing:1px;text-transform:uppercase;margin-top:1px;"></div>
            </div>
          </div>
        </div>

        <!-- CREATOR CARD SECTION (most important — shown first) -->
        <div id="home-creator-card-section" style="margin-bottom:22px;"></div>

        <!-- QUICK ACCESS: FEED + SHOWCASE + MESSAGES + PUBLISH -->
        <div style="display:grid;grid-template-columns:1fr 1fr 1fr 1fr;gap:10px;margin-bottom:22px;">
          <button onclick="bottomNavGo('feed',document.getElementById('bn-feed')||document.querySelector('.bn-item'))" style="background:linear-gradient(135deg,#060e07,#0b1a0d);border:1.5px solid rgba(34,197,94,0.3);border-radius:14px;padding:14px 10px;display:flex;flex-direction:column;align-items:center;gap:8px;cursor:pointer;transition:all 0.2s;" onmouseover="this.style.borderColor='rgba(34,197,94,0.7)';this.style.transform='translateY(-2px)';this.style.boxShadow='0 8px 24px rgba(34,197,94,0.15)'" onmouseout="this.style.borderColor='rgba(34,197,94,0.3)';this.style.transform='';this.style.boxShadow=''">
            <div style="width:38px;height:38px;border-radius:10px;background:linear-gradient(135deg,#15803d,#22c55e);display:flex;align-items:center;justify-content:center;">
              <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="#040a05" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="M4 6h16M4 12h16M4 18h10"/></svg>
            </div>
            <div style="font-family:'Bebas Neue',sans-serif;font-size:12px;letter-spacing:1px;color:#f0fdf4;">FEED</div>
          </button>
          <button onclick="showAppTab('showcase',document.querySelector('[data-tab=showcase]'))" style="background:linear-gradient(135deg,#060e07,#0b1a0d);border:1.5px solid rgba(34,197,94,0.3);border-radius:14px;padding:14px 10px;display:flex;flex-direction:column;align-items:center;gap:8px;cursor:pointer;transition:all 0.2s;" onmouseover="this.style.borderColor='rgba(34,197,94,0.7)';this.style.transform='translateY(-2px)';this.style.boxShadow='0 8px 24px rgba(34,197,94,0.15)'" onmouseout="this.style.borderColor='rgba(34,197,94,0.3)';this.style.transform='';this.style.boxShadow=''">
            <div style="width:38px;height:38px;border-radius:10px;background:linear-gradient(135deg,#15803d,#22c55e);display:flex;align-items:center;justify-content:center;">
              <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="#040a05" stroke-width="2.2" stroke-linecap="round" stroke-linejoin="round"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></svg>
            </div>
            <div style="font-family:'Bebas Neue',sans-serif;font-size:12px;letter-spacing:1px;color:#f0fdf4;">SHOWCASE</div>
          </button>
          <button onclick="openMessagesPanel()" style="background:linear-gradient(135deg,#060e07,#0b1a0d);border:1.5px solid rgba(34,197,94,0.3);border-radius:14px;padding:14px 10px;display:flex;flex-direction:column;align-items:center;gap:8px;cursor:pointer;transition:all 0.2s;position:relative;" onmouseover="this.style.borderColor='rgba(34,197,94,0.7)';this.style.transform='translateY(-2px)';this.style.boxShadow='0 8px 24px rgba(34,197,94,0.15)'" onmouseout="this.style.borderColor='rgba(34,197,94,0.3)';this.style.transform='';this.style.boxShadow=''">
            <div style="width:38px;height:38px;border-radius:10px;background:linear-gradient(135deg,#15803d,#22c55e);display:flex;align-items:center;justify-content:center;">
              <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="#040a05" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"/></svg>
            </div>
            <div style="font-family:'Bebas Neue',sans-serif;font-size:12px;letter-spacing:1px;color:#f0fdf4;">MESSAGES</div>
            <div id="home-msg-badge" style="display:none;position:absolute;top:10px;right:10px;width:8px;height:8px;border-radius:50%;background:#22c55e;box-shadow:0 0 6px rgba(34,197,94,0.8);"></div>
          </button>
          <button onclick="bottomNavGo('publish',document.getElementById('bn-publish'))" style="background:linear-gradient(135deg,#060e07,#0b1a0d);border:1.5px solid rgba(34,197,94,0.3);border-radius:14px;padding:14px 10px;display:flex;flex-direction:column;align-items:center;gap:8px;cursor:pointer;transition:all 0.2s;" onmouseover="this.style.borderColor='rgba(34,197,94,0.7)';this.style.transform='translateY(-2px)';this.style.boxShadow='0 8px 24px rgba(34,197,94,0.15)'" onmouseout="this.style.borderColor='rgba(34,197,94,0.3)';this.style.transform='';this.style.boxShadow=''">
            <div style="width:38px;height:38px;border-radius:10px;background:linear-gradient(135deg,#15803d,#22c55e);display:flex;align-items:center;justify-content:center;">
              <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="#040a05" stroke-width="3" stroke-linecap="round"><line x1="12" y1="5" x2="12" y2="19"/><line x1="5" y1="12" x2="19" y2="12"/></svg>
            </div>
            <div style="font-family:'Bebas Neue',sans-serif;font-size:12px;letter-spacing:1px;color:#f0fdf4;">PUBLISH</div>
          </button>
        </div>

        <!-- BROWSE ADS SECTION -->
        <div style="margin-bottom:22px;">
          <div style="font-family:'DM Mono',monospace;font-size:9px;letter-spacing:2px;color:var(--muted);text-transform:uppercase;margin-bottom:10px;">Browse Ads & Content</div>
          <div style="display:grid;grid-template-columns:1fr 1fr;gap:8px;">
            <button onclick="showAppTab('campaign',document.querySelector('[data-tab=campaign]'));campaignRender()" style="background:linear-gradient(135deg,#1a0008,#2d0010);border:1.5px solid rgba(255,60,110,0.4);border-radius:12px;padding:14px 10px;display:flex;flex-direction:column;align-items:center;gap:7px;cursor:pointer;transition:all 0.2s;" onmouseover="this.style.borderColor='rgba(255,60,110,0.9)';this.style.transform='translateY(-2px)'" onmouseout="this.style.borderColor='rgba(255,60,110,0.4)';this.style.transform=''">
              <div style="width:36px;height:36px;border-radius:9px;background:linear-gradient(135deg,#be123c,#ff3c6e);display:flex;align-items:center;justify-content:center;">
                <svg width="17" height="17" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2.2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="3" width="7" height="7" rx="1"/><rect x="14" y="3" width="7" height="7" rx="1"/><rect x="3" y="14" width="7" height="7" rx="1"/><rect x="14" y="14" width="7" height="7" rx="1"/></svg>
              </div>
              <div style="font-family:'Bebas Neue',sans-serif;font-size:11px;letter-spacing:1px;color:#ff3c6e;">CAMPAIGN TOOLS</div>
            </button>
            <button onclick="showAppTab('videos',document.querySelector('[data-tab=videos]'))" style="background:linear-gradient(135deg,#05060f,#080a1c);border:1.5px solid rgba(99,102,241,0.4);border-radius:12px;padding:14px 10px;display:flex;flex-direction:column;align-items:center;gap:7px;cursor:pointer;transition:all 0.2s;" onmouseover="this.style.borderColor='rgba(99,102,241,0.9)';this.style.transform='translateY(-2px)'" onmouseout="this.style.borderColor='rgba(99,102,241,0.4)';this.style.transform=''">
              <div style="width:36px;height:36px;border-radius:9px;background:linear-gradient(135deg,#4f46e5,#6366f1);display:flex;align-items:center;justify-content:center;">
                <svg width="17" height="17" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2.2" stroke-linecap="round" stroke-linejoin="round"><polygon points="5 3 19 12 5 21 5 3"/></svg>
              </div>
              <div style="font-family:'Bebas Neue',sans-serif;font-size:11px;letter-spacing:1px;color:#818cf8;">VIDEOS</div>
            </button>
          </div>
        </div>

        <!-- MAIN MENU GRID -->
        <div style="display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-bottom:22px;">

          <!-- BIG CAMPAIGN — full width -->
          <button onclick="showAppTab('big-campaign',document.querySelector('[data-tab=big-campaign]'));bcRender()" style="background:linear-gradient(135deg,#1a0008,#2d0010);border:2px solid rgba(255,60,110,0.45);border-radius:14px;padding:18px 16px;display:flex;align-items:center;gap:14px;cursor:pointer;transition:all 0.2s;box-shadow:0 0 22px rgba(255,60,110,0.12);position:relative;overflow:hidden;grid-column:span 2;" onmouseover="this.style.borderColor='rgba(255,60,110,0.9)';this.style.transform='translateY(-2px)';this.style.boxShadow='0 0 36px rgba(255,60,110,0.3)'" onmouseout="this.style.borderColor='rgba(255,60,110,0.45)';this.style.transform='';this.style.boxShadow='0 0 22px rgba(255,60,110,0.12)'">
            <div style="position:absolute;top:10px;right:12px;background:linear-gradient(135deg,#ff3c6e,#ff8c00);color:#fff;font-family:'DM Mono',monospace;font-size:8px;font-weight:900;padding:2px 8px;border-radius:3px;letter-spacing:1px;">PREMIUM</div>
            <div style="width:46px;height:46px;border-radius:12px;background:linear-gradient(135deg,#be123c,#ff3c6e);display:flex;align-items:center;justify-content:center;flex-shrink:0;box-shadow:0 0 18px rgba(255,60,110,0.4);font-size:22px;">🔥</div>
            <div style="text-align:left;">
              <div style="font-family:'Bebas Neue',sans-serif;font-size:20px;letter-spacing:2px;color:#ff3c6e;line-height:1;">BIG CAMPAIGN</div>
              <div style="font-size:10px;color:#8a2040;margin-top:3px;line-height:1.5;">Mega-ad · 3+ photos · 100K+ impressions · Full-site takeover</div>
            </div>
          </button>

          <!-- EMAIL CAMPAIGN — full width -->
          <button onclick="showAppTab('email-campaign',document.querySelector('[data-tab=email-campaign]'))" style="background:linear-gradient(135deg,#020d14,#041825);border:2px solid rgba(14,165,233,0.35);border-radius:14px;padding:18px 16px;display:flex;align-items:center;gap:14px;cursor:pointer;transition:all 0.2s;grid-column:span 2;" onmouseover="this.style.borderColor='rgba(14,165,233,0.75)';this.style.transform='translateY(-2px)';this.style.boxShadow='0 0 24px rgba(14,165,233,0.15)'" onmouseout="this.style.borderColor='rgba(14,165,233,0.35)';this.style.transform='';this.style.boxShadow=''">
            <div style="width:42px;height:42px;border-radius:11px;background:linear-gradient(135deg,#0284c7,#0ea5e9);display:flex;align-items:center;justify-content:center;flex-shrink:0;box-shadow:0 0 14px rgba(14,165,233,0.3);">
              <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2" stroke-linecap="round"><rect x="2" y="4" width="20" height="16" rx="2"/><path d="M2 7l10 7 10-7"/></svg>
            </div>
            <div style="text-align:left;">
              <div style="font-family:'Bebas Neue',sans-serif;font-size:18px;letter-spacing:2px;color:#0ea5e9;line-height:1;">EMAIL CAMPAIGNS</div>
              <div style="font-size:10px;color:#2a5a75;margin-top:3px;">Create · Send · Track opens & clicks</div>
            </div>
          </button>

          <!-- AD CREATOR — full width -->
          <button onclick="showPubCreatorTab(document.getElementById('tab-btn-pubcreator'))" style="background:linear-gradient(135deg,#1c1200,#0e0a00);border:2px solid rgba(255,215,0,0.5);border-radius:14px;padding:18px 16px;display:flex;align-items:center;gap:14px;cursor:pointer;transition:all 0.2s;box-shadow:0 0 18px rgba(255,215,0,0.1);position:relative;overflow:hidden;grid-column:span 2;" onmouseover="this.style.borderColor='rgba(255,215,0,0.9)';this.style.transform='translateY(-2px)';this.style.boxShadow='0 0 32px rgba(255,215,0,0.25)'" onmouseout="this.style.borderColor='rgba(255,215,0,0.5)';this.style.transform='';this.style.boxShadow='0 0 18px rgba(255,215,0,0.1)'">
            <div style="position:absolute;top:10px;right:12px;background:linear-gradient(135deg,#ffd700,#ff8c00);color:#1a0a00;font-family:'DM Mono',monospace;font-size:8px;font-weight:900;padding:2px 8px;border-radius:3px;letter-spacing:1px;">ELITE</div>
            <div style="width:46px;height:46px;border-radius:12px;background:linear-gradient(135deg,#92700a,#ffd700);display:flex;align-items:center;justify-content:center;flex-shrink:0;box-shadow:0 0 16px rgba(255,215,0,0.35);font-size:22px;">🎯</div>
            <div style="text-align:left;">
              <div style="font-family:'Bebas Neue',sans-serif;font-size:20px;letter-spacing:2px;color:#ffd700;line-height:1;">AD CREATOR</div>
              <div style="font-size:10px;color:#8a7040;margin-top:3px;line-height:1.5;">Create professional ad campaigns · Deploy 5 ads at once · Full ad studio</div>
            </div>
          </button>

          <!-- SPONSOR PANEL — full width -->
          <button onclick="showSponsorTab(document.getElementById('tab-btn-sponsor'))" style="background:linear-gradient(135deg,#1a0e00,#120a00);border:2px solid rgba(249,115,22,0.45);border-radius:14px;padding:18px 16px;display:flex;align-items:center;gap:14px;cursor:pointer;transition:all 0.2s;box-shadow:0 0 16px rgba(249,115,22,0.1);position:relative;overflow:hidden;grid-column:span 2;" onmouseover="this.style.borderColor='rgba(249,115,22,0.9)';this.style.transform='translateY(-2px)';this.style.boxShadow='0 0 28px rgba(249,115,22,0.28)'" onmouseout="this.style.borderColor='rgba(249,115,22,0.45)';this.style.transform='';this.style.boxShadow='0 0 16px rgba(249,115,22,0.1)'">
            <div style="position:absolute;top:10px;right:12px;background:linear-gradient(135deg,#f97316,#ea580c);color:#fff;font-family:'DM Mono',monospace;font-size:8px;font-weight:900;padding:2px 8px;border-radius:3px;letter-spacing:1px;">SPONSOR</div>
            <div style="width:46px;height:46px;border-radius:12px;background:linear-gradient(135deg,#c2410c,#f97316);display:flex;align-items:center;justify-content:center;flex-shrink:0;box-shadow:0 0 16px rgba(249,115,22,0.35);font-size:22px;">💼</div>
            <div style="text-align:left;">
              <div style="font-family:'Bebas Neue',sans-serif;font-size:20px;letter-spacing:2px;color:#f97316;line-height:1;">SPONSOR PANEL</div>
              <div style="font-size:10px;color:#7a4510;margin-top:3px;line-height:1.5;">Buy ad slots · Sponsored posts · Banner placements · Reach the entire community</div>
            </div>
          </button>

          <!-- GO LIVE — full width with live list -->
          <div style="background:linear-gradient(135deg,#0e0000,#1a0000);border:2px solid rgba(220,38,38,0.5);border-radius:14px;overflow:hidden;grid-column:span 2;position:relative;box-shadow:0 0 18px rgba(220,38,38,0.1);">
            <!-- Header — clickable to go to Live Studio -->
            <button onclick="showAppTab('live-studio',document.querySelector('[data-tab=live-studio]'))" style="width:100%;background:none;border:none;padding:16px 18px 12px;display:flex;align-items:center;justify-content:space-between;cursor:pointer;transition:background 0.2s;" onmouseover="this.style.background='rgba(220,38,38,0.07)'" onmouseout="this.style.background='none'">
              <div style="display:flex;align-items:center;gap:10px;">
                <div style="width:34px;height:34px;border-radius:9px;background:linear-gradient(135deg,#991b1b,#dc2626);display:flex;align-items:center;justify-content:center;font-size:16px;box-shadow:0 0 14px rgba(220,38,38,0.5);">🔴</div>
                <div style="text-align:left;">
                  <div style="font-family:'Bebas Neue',sans-serif;font-size:18px;letter-spacing:2px;color:#dc2626;line-height:1;">GO LIVE</div>
                  <div style="font-size:10px;color:#6b2020;margin-top:1px;">Broadcast live to the entire community</div>
                </div>
              </div>
              <div style="display:flex;align-items:center;gap:8px;">
                <div id="home-live-count-badge" style="background:rgba(220,38,38,0.1);border:1px solid rgba(220,38,38,0.25);border-radius:20px;padding:3px 10px;font-family:'DM Mono',monospace;font-size:9px;color:rgba(220,38,38,0.6);letter-spacing:1px;">NO LIVE NOW</div>
                <span style="font-size:18px;color:#dc2626;opacity:0.6;">›</span>
              </div>
            </button>
            <!-- Live list — populated in real-time from active streams -->
            <div style="padding:0 14px 14px;display:flex;flex-direction:column;gap:8px;" id="home-live-list">
              <!-- Empty state — shown when no one is live -->
              <div id="home-live-empty" style="text-align:center;padding:22px 16px;background:rgba(239,68,68,0.04);border:1.5px dashed rgba(239,68,68,0.2);border-radius:10px;">
                <div style="font-size:28px;margin-bottom:8px;opacity:0.5;">📡</div>
                <div style="font-size:12px;font-weight:700;color:rgba(239,68,68,0.6);margin-bottom:4px;">No live streams right now</div>
                <div style="font-size:11px;color:var(--muted);line-height:1.5;">Be the first to go live — your followers will be notified instantly</div>
              </div>
              <!-- CTA -->
              <button onclick="showAppTab('live-studio',document.querySelector('[data-tab=live-studio]'))" style="width:100%;padding:10px;background:linear-gradient(135deg,#dc2626,#ef4444);border:none;border-radius:9px;font-family:'Plus Jakarta Sans',sans-serif;font-size:13px;font-weight:800;cursor:pointer;color:#fff;box-shadow:0 0 16px rgba(239,68,68,0.3);transition:all 0.2s;display:flex;align-items:center;justify-content:center;gap:7px;" onmouseover="this.style.boxShadow='0 0 28px rgba(239,68,68,0.55)';this.style.transform='translateY(-1px)'" onmouseout="this.style.boxShadow='0 0 16px rgba(239,68,68,0.3)';this.style.transform=''">
                <span style="width:8px;height:8px;border-radius:50%;background:#fff;animation:vb-pulse 1s ease-in-out infinite;display:inline-block;"></span>
                Start Your Live Now
              </button>
            </div>
          </div>

          <!-- VIDEO CREATOR — full width with recent videos -->
          <div style="background:linear-gradient(135deg,#05060f,#080a1c);border:2px solid rgba(99,102,241,0.4);border-radius:14px;overflow:hidden;grid-column:span 2;position:relative;box-shadow:0 0 18px rgba(99,102,241,0.07);">
            <!-- Header — clickable to go to Video Creator tab -->
            <button onclick="showAppTab('video-creator',document.querySelector('[data-tab=video-creator]'))" style="width:100%;background:none;border:none;padding:16px 18px 12px;display:flex;align-items:center;justify-content:space-between;cursor:pointer;transition:background 0.2s;" onmouseover="this.style.background='rgba(99,102,241,0.06)'" onmouseout="this.style.background='none'">
              <div style="display:flex;align-items:center;gap:10px;">
                <div style="width:34px;height:34px;border-radius:9px;background:linear-gradient(135deg,#4f46e5,#6366f1);display:flex;align-items:center;justify-content:center;font-size:16px;box-shadow:0 0 12px rgba(99,102,241,0.4);">🎬</div>
                <div style="text-align:left;">
                  <div style="font-family:'Bebas Neue',sans-serif;font-size:18px;letter-spacing:2px;color:#818cf8;line-height:1;">VIDEO CREATOR</div>
                  <div style="font-size:10px;color:#3a3870;margin-top:1px;">Publish a video (min. 3 min) · reach the whole community</div>
                </div>
              </div>
              <div style="display:flex;align-items:center;gap:8px;">
                <div style="background:rgba(99,102,241,0.08);border:1px solid rgba(99,102,241,0.2);border-radius:20px;padding:3px 10px;font-family:'DM Mono',monospace;font-size:9px;color:rgba(99,102,241,0.5);letter-spacing:1px;">
                  <span id="home-videos-num">0</span> VIDEOS
                </div>
                <span style="font-size:18px;color:#818cf8;opacity:0.6;">›</span>
              </div>
            </button>
            <!-- Recent videos — populated from real published videos (thumbnail required) -->
            <div style="padding:0 14px 6px;" id="home-video-list">
              <!-- Empty state — shown when no videos published yet -->
              <div id="home-video-empty" style="text-align:center;padding:22px 16px;background:rgba(99,102,241,0.04);border:1.5px dashed rgba(99,102,241,0.25);border-radius:10px;">
                <div style="font-size:28px;margin-bottom:8px;opacity:0.5;">🎬</div>
                <div style="font-size:12px;font-weight:700;color:rgba(99,102,241,0.6);margin-bottom:4px;">No videos published yet</div>
                <div style="font-size:11px;color:var(--muted);line-height:1.5;">Be the first to upload — a custom thumbnail is required for every video</div>
              </div>
            </div>
            <!-- View all + Upload -->
            <div style="padding:10px 14px 14px;display:flex;gap:8px;">
              <button onclick="showAppTab('videos',document.querySelector('[data-tab=videos]'))" style="flex:1;padding:9px;background:rgba(99,102,241,0.08);border:1.5px solid rgba(99,102,241,0.25);border-radius:9px;font-family:'Plus Jakarta Sans',sans-serif;font-size:12px;font-weight:700;cursor:pointer;color:#818cf8;transition:all 0.2s;" onmouseover="this.style.borderColor='rgba(99,102,241,0.55)';this.style.background='rgba(99,102,241,0.14)'" onmouseout="this.style.borderColor='rgba(99,102,241,0.25)';this.style.background='rgba(99,102,241,0.08)'">📹 See All Videos</button>
              <button onclick="showAppTab('video-creator',document.querySelector('[data-tab=video-creator]'))" style="flex:1;padding:9px;background:linear-gradient(135deg,#4f46e5,#6366f1);border:none;border-radius:9px;font-family:'Plus Jakarta Sans',sans-serif;font-size:12px;font-weight:800;cursor:pointer;color:#fff;box-shadow:0 0 14px rgba(99,102,241,0.3);transition:all 0.2s;" onmouseover="this.style.boxShadow='0 0 24px rgba(99,102,241,0.55)';this.style.transform='translateY(-1px)'" onmouseout="this.style.boxShadow='0 0 14px rgba(99,102,241,0.3)';this.style.transform=''">🎬 Upload Video</button>
            </div>
          </div>

        </div>


        <!-- FEATURED CREATORS CAROUSEL (VIP/Elite) -->
        <div style="margin-bottom:22px;">
          <div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:10px;">
            <div style="display:flex;align-items:center;gap:8px;">
              <span style="font-size:14px;">💎</span>
              <span style="font-family:'Bebas Neue',sans-serif;font-size:15px;letter-spacing:2px;color:#ffd700;">FEATURED CREATORS</span>
              <span style="font-family:'DM Mono',monospace;font-size:8px;color:#ffd700;background:rgba(255,215,0,0.1);border:1px solid rgba(255,215,0,0.3);border-radius:4px;padding:1px 6px;letter-spacing:1px;">SPONSORED</span>
            </div>
            <span style="font-family:'DM Mono',monospace;font-size:8px;color:var(--muted);letter-spacing:1px;">VIP · ELITE</span>
          </div>
          <div id="featured-creators-carousel" style="display:flex;gap:12px;overflow-x:auto;padding-bottom:6px;scrollbar-width:none;">
          </div>
        </div>

        <!-- INFO ACCORDIONS -->
        <div style="display:flex;flex-direction:column;gap:10px;margin-bottom:22px;" id="home-accordions">

          <!-- Accordion 2: How to make money -->
          <div class="home-accordion" id="acc-2" style="background:#0e0a00;border:1.5px solid rgba(255,215,0,0.25);border-radius:14px;overflow:hidden;transition:all 0.3s;">
            <button onclick="toggleAccordion('acc-2')" style="width:100%;padding:14px 16px;background:none;border:none;display:flex;align-items:center;justify-content:space-between;cursor:pointer;text-align:left;">
              <div style="display:flex;align-items:center;gap:10px;">
                <div style="width:32px;height:32px;border-radius:8px;background:linear-gradient(135deg,#b45309,#ffd700);display:flex;align-items:center;justify-content:center;font-size:15px;flex-shrink:0;">💰</div>
                <div>
                  <div style="font-family:'Bebas Neue',sans-serif;font-size:16px;letter-spacing:1.5px;color:#f0fdf4;line-height:1;">HOW TO MAKE MONEY?</div>
                  <div style="font-family:'DM Mono',monospace;font-size:8px;color:#8a7040;letter-spacing:1px;margin-top:1px;">5 proven methods</div>
                </div>
              </div>
              <div class="acc-chevron" id="acc-2-chev" style="color:#ffd700;font-size:14px;transition:transform 0.3s;flex-shrink:0;">▼</div>
            </button>
            <div class="acc-body" id="acc-2-body" style="max-height:0;overflow:hidden;transition:max-height 0.4s cubic-bezier(0.4,0,0.2,1);">
              <div style="padding:0 16px 16px;">
                <div style="height:1px;background:rgba(255,215,0,0.12);margin-bottom:14px;"></div>
                <p style="font-size:13px;color:#c4ad7a;line-height:1.7;margin:0 0 12px;">
                  ViralBoost gives you <span style="color:#ffd700;font-weight:800;">multiple revenue streams</span> you can activate starting today.
                </p>
                <div style="display:flex;flex-direction:column;gap:8px;">
                  <div style="display:flex;align-items:flex-start;gap:10px;background:rgba(255,215,0,0.05);border-radius:8px;padding:10px;border:1px solid rgba(255,215,0,0.1);">
                    <div style="font-family:'Bebas Neue',sans-serif;font-size:16px;color:#ffd700;width:22px;flex-shrink:0;">01</div>
                    <div><div style="font-size:12px;font-weight:700;color:#f0fdf4;margin-bottom:2px;">Sell your services</div><div style="font-size:11px;color:#8a7040;line-height:1.5;">Enable the <span style="color:#ffd700;font-weight:700;">Sales tab</span> on your profile and offer your expertise directly to the community. <span style="color:#ffd700;font-weight:700;">Zero commission</span> on your sales.</div></div>
                  </div>
                  <div style="display:flex;align-items:flex-start;gap:10px;background:rgba(255,215,0,0.05);border-radius:8px;padding:10px;border:1px solid rgba(255,215,0,0.1);">
                    <div style="font-family:'Bebas Neue',sans-serif;font-size:16px;color:#ffd700;width:22px;flex-shrink:0;">02</div>
                    <div><div style="font-size:12px;font-weight:700;color:#f0fdf4;margin-bottom:2px;">Affiliate program</div><div style="font-size:11px;color:#8a7040;line-height:1.5;">Invite friends = <span style="color:#ffd700;font-weight:700;">30% recurring commission</span> on every subscription from your referrals. For life.</div></div>
                  </div>
                  <div style="display:flex;align-items:flex-start;gap:10px;background:rgba(255,215,0,0.05);border-radius:8px;padding:10px;border:1px solid rgba(255,215,0,0.1);">
                    <div style="font-family:'Bebas Neue',sans-serif;font-size:16px;color:#ffd700;width:22px;flex-shrink:0;">03</div>
                    <div><div style="font-size:12px;font-weight:700;color:#f0fdf4;margin-bottom:2px;">Paid collaborations</div><div style="font-size:11px;color:#8a7040;line-height:1.5;">Our AI connects creators with <span style="color:#ffd700;font-weight:700;">brands and companies</span> looking for exactly your profile.</div></div>
                  </div>
                  <div style="display:flex;align-items:flex-start;gap:10px;background:rgba(255,215,0,0.05);border-radius:8px;padding:10px;border:1px solid rgba(255,215,0,0.1);">
                    <div style="font-family:'Bebas Neue',sans-serif;font-size:16px;color:#ffd700;width:22px;flex-shrink:0;">04</div>
                    <div><div style="font-size:12px;font-weight:700;color:#f0fdf4;margin-bottom:2px;">Monetize your audience</div><div style="font-size:11px;color:#8a7040;line-height:1.5;">With <span style="color:#ffd700;font-weight:700;">1000+ followers</span> you unlock Sales. Turn your followers into paying clients.</div></div>
                  </div>
                  <div style="display:flex;align-items:flex-start;gap:10px;background:rgba(255,215,0,0.05);border-radius:8px;padding:10px;border:1px solid rgba(255,215,0,0.1);">
                    <div style="font-family:'Bebas Neue',sans-serif;font-size:16px;color:#ffd700;width:22px;flex-shrink:0;">05</div>
                    <div><div style="font-size:12px;font-weight:700;color:#f0fdf4;margin-bottom:2px;">Resell Boost Credits</div><div style="font-size:11px;color:#8a7040;line-height:1.5;">Buy packs at the best price, <span style="color:#ffd700;font-weight:700;">resell to the community</span> for a margin. Internal marketplace in development.</div></div>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Accordion 3: Must-see highlights -->
          <div class="home-accordion" id="acc-3" style="background:#0a0520;border:1.5px solid rgba(192,132,252,0.25);border-radius:14px;overflow:hidden;transition:all 0.3s;">
            <button onclick="toggleAccordion('acc-3')" style="width:100%;padding:14px 16px;background:none;border:none;display:flex;align-items:center;justify-content:space-between;cursor:pointer;text-align:left;">
              <div style="display:flex;align-items:center;gap:10px;">
                <div style="width:32px;height:32px;border-radius:8px;background:linear-gradient(135deg,#7b1fa2,#c084fc);display:flex;align-items:center;justify-content:center;font-size:15px;flex-shrink:0;">✨</div>
                <div>
                  <div style="font-family:'Bebas Neue',sans-serif;font-size:16px;letter-spacing:1.5px;color:#f0fdf4;line-height:1;">MUST SEE</div>
                  <div style="font-family:'DM Mono',monospace;font-size:8px;color:#8060a0;letter-spacing:1px;margin-top:1px;">Essential news & updates</div>
                </div>
              </div>
              <div class="acc-chevron" id="acc-3-chev" style="color:#c084fc;font-size:14px;transition:transform 0.3s;flex-shrink:0;">▼</div>
            </button>
            <div class="acc-body" id="acc-3-body" style="max-height:0;overflow:hidden;transition:max-height 0.4s cubic-bezier(0.4,0,0.2,1);">
              <div style="padding:0 16px 16px;">
                <div style="height:1px;background:rgba(192,132,252,0.12);margin-bottom:14px;"></div>
                <div style="display:flex;flex-direction:column;gap:10px;">
                  <div style="background:rgba(192,132,252,0.06);border:1px solid rgba(192,132,252,0.15);border-radius:10px;padding:12px 14px;position:relative;overflow:hidden;">
                    <div style="position:absolute;top:8px;right:8px;background:#c084fc;color:#040a05;font-family:'DM Mono',monospace;font-size:7px;font-weight:900;padding:2px 7px;border-radius:3px;letter-spacing:1px;animation:blink 2s infinite;">🔥 HOT</div>
                    <div style="font-size:12px;font-weight:800;color:#f0fdf4;margin-bottom:4px;padding-right:50px;">Limited launch offer</div>
                    <div style="font-size:11px;color:#9a7ab8;line-height:1.5;">The <span style="color:#c084fc;font-weight:700;text-decoration:underline;">PRO plan is -50% off</span> this week only. <span style="color:#c084fc;font-weight:700;">Don't miss this chance</span> — regular price returns on Sunday.</div>
                  </div>
                  <div style="background:rgba(56,189,248,0.06);border:1px solid rgba(56,189,248,0.15);border-radius:10px;padding:12px 14px;">
                    <div style="font-size:12px;font-weight:800;color:#f0fdf4;margin-bottom:4px;">🆕 New feature</div>
                    <div style="font-size:11px;color:#7aadbe;line-height:1.5;"><span style="color:#38bdf8;font-weight:700;">Shareable Creator Card</span> now available! Share your creator card across all your social networks in 1 click.</div>
                  </div>
                  <div style="background:rgba(34,197,94,0.06);border:1px solid rgba(34,197,94,0.15);border-radius:10px;padding:12px 14px;">
                    <div style="font-size:12px;font-weight:800;color:#f0fdf4;margin-bottom:4px;">📊 Week stats</div>
                    <div style="font-size:11px;color:#6a9978;line-height:1.5;"><span style="color:#22c55e;font-weight:700;">+847 new creators</span> this week · <span style="color:#22c55e;font-weight:700;">2,340 collabs</span> initiated · <span style="color:#22c55e;font-weight:700;">$18,200</span> in revenue generated by the community</div>
                  </div>
                  <div style="background:rgba(249,115,22,0.06);border:1px solid rgba(249,115,22,0.15);border-radius:10px;padding:12px 14px;">
                    <div style="font-size:12px;font-weight:800;color:#f0fdf4;margin-bottom:4px;">⏰ Important reminder</div>
                    <div style="font-size:11px;color:#9a7050;line-height:1.5;">Daily missions <span style="color:#fb923c;font-weight:700;">reset at midnight</span>. Complete them every day to maximize your <span style="color:#fb923c;font-weight:700;">XP score and ranking</span>.</div>
                  </div>
                  <div style="background:rgba(255,215,0,0.06);border:1px solid rgba(255,215,0,0.15);border-radius:10px;padding:12px 14px;">
                    <div style="font-size:12px;font-weight:800;color:#f0fdf4;margin-bottom:4px;">💡 Pro tip</div>
                    <div style="font-size:11px;color:#9a8a40;line-height:1.5;">Posts with an <span style="color:#ffd700;font-weight:700;">image + detailed description</span> get <span style="color:#ffd700;font-weight:700;">3x more votes</span> and appear <span style="color:#ffd700;font-weight:700;">first in the feed</span>.</div>
                  </div>
                </div>
              </div>
            </div>
          </div>

        </div>

        <!-- EXCLUSIVE OFFERS -->
        <div style="margin-bottom:24px;">
          <div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:14px;">
            <div style="display:flex;align-items:center;gap:7px;">
              <div style="width:7px;height:7px;border-radius:50%;background:#22c55e;box-shadow:0 0 7px #22c55e;animation:blink 1.8s infinite;flex-shrink:0;"></div>
              <div style="font-family:'Bebas Neue',sans-serif;font-size:18px;letter-spacing:2px;color:#f0fdf4;">EXCLUSIVE OFFERS</div>
              <div style="font-family:'DM Mono',monospace;font-size:7px;color:#22c55e;background:rgba(34,197,94,0.1);border:1px solid rgba(34,197,94,0.2);border-radius:3px;padding:2px 6px;letter-spacing:1px;">LIMITED</div>
            </div>
          </div>
          <div style="display:flex;flex-direction:column;gap:12px;">

            <!-- OFFER 1 — ViralBoost PRO -->
            <div style="border-radius:16px;overflow:hidden;position:relative;background:linear-gradient(135deg,#064e3b 0%,#022c22 50%,#052e16 100%);border:1.5px solid rgba(34,197,94,0.4);box-shadow:0 6px 28px rgba(0,0,0,0.5),0 0 18px rgba(34,197,94,0.08);">
              <div style="position:absolute;top:10px;left:10px;background:#22c55e;color:#040a05;font-family:'DM Mono',monospace;font-size:8px;font-weight:900;padding:3px 9px;border-radius:4px;letter-spacing:1px;z-index:2;">-50% TODAY</div>
              <div style="position:absolute;top:10px;right:10px;background:rgba(0,0,0,0.5);border:1px solid rgba(34,197,94,0.4);color:#22c55e;font-family:'DM Mono',monospace;font-size:7px;padding:3px 7px;border-radius:3px;letter-spacing:1px;z-index:2;">LIMITED OFFER</div>
              <div style="padding:52px 18px 8px;display:flex;align-items:center;gap:14px;">
                <div style="font-size:44px;filter:drop-shadow(0 0 16px rgba(34,197,94,0.7));flex-shrink:0;">⚡</div>
                <div style="flex:1;">
                  <div style="font-family:'Bebas Neue',sans-serif;font-size:22px;letter-spacing:2px;color:#f0fdf4;line-height:1;margin-bottom:4px;">VIRALBOOST PRO</div>
                  <div style="font-size:11px;color:#6aaa80;line-height:1.5;margin-bottom:10px;">Unlock your full creator potential with unlimited publishing power and advanced analytics.</div>
                </div>
              </div>
              <div style="padding:0 18px 8px;display:grid;grid-template-columns:1fr 1fr;gap:8px;">
                <div style="background:rgba(34,197,94,0.07);border:1px solid rgba(34,197,94,0.15);border-radius:8px;padding:9px 10px;">
                  <div style="font-size:14px;margin-bottom:2px;">📢</div>
                  <div style="font-size:11px;font-weight:700;color:#f0fdf4;margin-bottom:1px;">Unlimited Posts</div>
                  <div style="font-size:10px;color:#6aaa80;">Publish as many ads & offers as you want, no daily cap</div>
                </div>
                <div style="background:rgba(34,197,94,0.07);border:1px solid rgba(34,197,94,0.15);border-radius:8px;padding:9px 10px;">
                  <div style="font-size:14px;margin-bottom:2px;">📊</div>
                  <div style="font-size:11px;font-weight:700;color:#f0fdf4;margin-bottom:1px;">Advanced Analytics</div>
                  <div style="font-size:10px;color:#6aaa80;">Views, votes, click-through rates & revenue tracking</div>
                </div>
                <div style="background:rgba(34,197,94,0.07);border:1px solid rgba(34,197,94,0.15);border-radius:8px;padding:9px 10px;">
                  <div style="font-size:14px;margin-bottom:2px;">🔥</div>
                  <div style="font-size:11px;font-weight:700;color:#f0fdf4;margin-bottom:1px;">Priority in Feed</div>
                  <div style="font-size:10px;color:#6aaa80;">Your posts displayed first to thousands of active creators</div>
                </div>
                <div style="background:rgba(34,197,94,0.07);border:1px solid rgba(34,197,94,0.15);border-radius:8px;padding:9px 10px;">
                  <div style="font-size:14px;margin-bottom:2px;">✅</div>
                  <div style="font-size:11px;font-weight:700;color:#f0fdf4;margin-bottom:1px;">PRO Badge</div>
                  <div style="font-size:10px;color:#6aaa80;">Verified PRO badge on all your posts & profile</div>
                </div>
              </div>
              <div style="padding:10px 18px 16px;">
                <div style="display:flex;align-items:center;gap:10px;margin-bottom:10px;">
                  <span style="font-family:'DM Mono',monospace;font-size:11px;color:#4a7a58;text-decoration:line-through;">$19.99/mo</span>
                  <span style="font-family:'Bebas Neue',sans-serif;font-size:32px;color:#22c55e;line-height:1;">$9.99</span>
                  <span style="font-size:10px;color:#6aaa80;">/month · cancel anytime</span>
                </div>
                <button onclick="payDeal('ViralBoost PRO','9.99')" style="width:100%;padding:13px;background:linear-gradient(135deg,#15803d,#22c55e);border:none;border-radius:10px;font-family:'Bebas Neue',sans-serif;font-size:18px;letter-spacing:1.5px;color:#040a05;cursor:pointer;font-weight:900;transition:all 0.2s;box-shadow:0 3px 14px rgba(34,197,94,0.4);" onmouseover="this.style.boxShadow='0 6px 24px rgba(34,197,94,0.6)';this.style.transform='translateY(-1px)'" onmouseout="this.style.boxShadow='0 3px 14px rgba(34,197,94,0.4)';this.style.transform=''">💳 GET PRO — $9.99/mo</button>
              </div>
            </div>

            <!-- OFFER 2 — Pack Collab Premium -->
            <div style="border-radius:16px;overflow:hidden;position:relative;background:linear-gradient(135deg,#2d1300 0%,#1a0a00 50%,#2e0a00 100%);border:1.5px solid rgba(251,146,60,0.4);box-shadow:0 6px 28px rgba(0,0,0,0.5),0 0 18px rgba(251,146,60,0.07);">
              <div style="position:absolute;top:10px;left:10px;background:#fb923c;color:#040a05;font-family:'DM Mono',monospace;font-size:8px;font-weight:900;padding:3px 9px;border-radius:4px;letter-spacing:1px;z-index:2;">-50% TODAY</div>
              <div style="position:absolute;top:10px;right:10px;background:rgba(0,0,0,0.5);border:1px solid rgba(251,146,60,0.4);color:#fb923c;font-family:'DM Mono',monospace;font-size:7px;padding:3px 7px;border-radius:3px;letter-spacing:1px;z-index:2;">BEST DEAL</div>
              <div style="padding:52px 18px 8px;display:flex;align-items:center;gap:14px;">
                <div style="font-size:44px;filter:drop-shadow(0 0 16px rgba(251,146,60,0.7));flex-shrink:0;">🎯</div>
                <div style="flex:1;">
                  <div style="font-family:'Bebas Neue',sans-serif;font-size:22px;letter-spacing:2px;color:#f0fdf4;line-height:1;margin-bottom:4px;">PACK COLLAB PREMIUM</div>
                  <div style="font-size:11px;color:#9a6a40;line-height:1.5;margin-bottom:10px;">Supercharge your collaborations with AI-powered matching and get connected with the right people instantly.</div>
                </div>
              </div>
              <div style="padding:0 18px 8px;display:grid;grid-template-columns:1fr 1fr;gap:8px;">
                <div style="background:rgba(251,146,60,0.07);border:1px solid rgba(251,146,60,0.15);border-radius:8px;padding:9px 10px;">
                  <div style="font-size:14px;margin-bottom:2px;">🤖</div>
                  <div style="font-size:11px;font-weight:700;color:#f0fdf4;margin-bottom:1px;">AI Priority Matching</div>
                  <div style="font-size:10px;color:#9a6a40;">Our AI finds the perfect collab partners for your niche in seconds</div>
                </div>
                <div style="background:rgba(251,146,60,0.07);border:1px solid rgba(251,146,60,0.15);border-radius:8px;padding:9px 10px;">
                  <div style="font-size:14px;margin-bottom:2px;">📅</div>
                  <div style="font-size:11px;font-weight:700;color:#f0fdf4;margin-bottom:1px;">3 Months Full Access</div>
                  <div style="font-size:10px;color:#9a6a40;">90 days of premium collab features, no interruption</div>
                </div>
                <div style="background:rgba(251,146,60,0.07);border:1px solid rgba(251,146,60,0.15);border-radius:8px;padding:9px 10px;">
                  <div style="font-size:14px;margin-bottom:2px;">⭐</div>
                  <div style="font-size:11px;font-weight:700;color:#f0fdf4;margin-bottom:1px;">Verified Profile Boost</div>
                  <div style="font-size:10px;color:#9a6a40;">Your profile shown first to brands & companies looking for creators</div>
                </div>
                <div style="background:rgba(251,146,60,0.07);border:1px solid rgba(251,146,60,0.15);border-radius:8px;padding:9px 10px;">
                  <div style="font-size:14px;margin-bottom:2px;">💬</div>
                  <div style="font-size:11px;font-weight:700;color:#f0fdf4;margin-bottom:1px;">Direct Messages Unlocked</div>
                  <div style="font-size:10px;color:#9a6a40;">Contact any creator directly without request limits</div>
                </div>
              </div>
              <div style="padding:10px 18px 16px;">
                <div style="display:flex;align-items:center;gap:10px;margin-bottom:10px;">
                  <span style="font-family:'DM Mono',monospace;font-size:11px;color:#4a7a58;text-decoration:line-through;">$29.99</span>
                  <span style="font-family:'Bebas Neue',sans-serif;font-size:32px;color:#fb923c;line-height:1;">$14.99</span>
                  <span style="font-size:10px;color:#9a6a40;">for 3 months · one-time payment</span>
                </div>
                <button onclick="payDeal('Pack Collab Premium','14.99')" style="width:100%;padding:13px;background:linear-gradient(135deg,#c2410c,#fb923c);border:none;border-radius:10px;font-family:'Bebas Neue',sans-serif;font-size:18px;letter-spacing:1.5px;color:#040a05;cursor:pointer;font-weight:900;transition:all 0.2s;box-shadow:0 3px 14px rgba(251,146,60,0.4);" onmouseover="this.style.boxShadow='0 6px 24px rgba(251,146,60,0.6)';this.style.transform='translateY(-1px)'" onmouseout="this.style.boxShadow='0 3px 14px rgba(251,146,60,0.4)';this.style.transform=''">💳 GET COLLAB PACK — $14.99</button>
              </div>
            </div>

          </div>
        </div>

      </div>
    </div>
    <!-- FEED -->
    <div class="tpanel" id="tab-feed">
      <div id="stories-bar-container"></div>
      <div style="max-width:660px;margin:0 auto;padding:22px 0">
        <!-- INTRO COMPOSER -->
        <div class="composer-intro">
          <div class="composer-intro-label" data-i18n="comp_label">✦ COMMUNITY FEED</div>
          <h2 class="composer-intro-title" data-i18n="comp_title">Share with the community</h2>
          <p class="composer-intro-sub" data-i18n="comp_sub">Projects, ideas, questions — your voice matters here.</p>
        </div>

        <!-- TWEET-STYLE COMPOSER -->
        <div class="publish-box" id="publish-box">
          <div class="publish-top">
            <div class="pub-ava" id="feed-pub-ava">?</div>
            <div class="pub-input-wrap">
              <textarea class="pub-text" id="feed-text" placeholder="Share your project with the community…" rows="2" oninput="updateCharCount(this);autoGrowTA(this)"></textarea>
              <!-- Type pills (hidden by default, visible on focus) -->
              <div class="pub-type-row" id="pub-type-row">
                <button class="pub-type-pill active" onclick="selectPubType(this,'')" data-type="">💬 Post</button>
                <button class="pub-type-pill" onclick="selectPubType(this,'site')" data-type="site">🌐 Site</button>
                <button class="pub-type-pill" onclick="selectPubType(this,'app')" data-type="app">📱 App</button>
                <button class="pub-type-pill" onclick="selectPubType(this,'saas')" data-type="saas">🚀 SaaS</button>
                <button class="pub-type-pill" onclick="selectPubType(this,'tiktok')" data-type="tiktok">🎵 TikTok</button>
                <button class="pub-type-pill" onclick="selectPubType(this,'instagram')" data-type="instagram">📸 Insta</button>
                <button class="pub-type-pill" onclick="selectPubType(this,'ecommerce')" data-type="ecommerce">🛍️ Shop</button>
              </div>
              <!-- Project field (visible if type selected) -->
              <div class="pub-proj-wrap" id="pub-proj-wrap" style="display:none">
                <input type="text" id="feed-proj-name" placeholder="Project name (optional)"/>
              </div>
              <!-- URL trigger button -->
              <button class="pub-url-trigger" id="pub-url-trigger" onclick="toggleUrlField()" type="button" data-i18n="btn_addlink">🔗 Add a link</button>
              <!-- URL field hidden by default -->
              <div class="pub-url-wrap" id="pub-url-wrap" style="display:none">
                <div class="pub-url-inner">
                  <span class="pub-url-icon">🔗</span>
                  <input type="url" id="feed-url" placeholder="https://your-site.com" autocomplete="off" spellcheck="false"/>
                  <button class="pub-url-close" onclick="closeUrlField()" type="button">✕</button>
                </div>
              </div>
            </div>
          </div>
          <select id="feed-proj-type" style="display:none"><option value="">No project</option><option value="site">🌐 Website</option><option value="app">📱 App</option><option value="saas">🚀 SaaS</option><option value="tiktok">🎵 TikTok</option><option value="instagram">📸 Instagram</option><option value="ecommerce">🛍️ E-commerce</option></select>
          <div id="feed-media-preview" class="media-preview-row" style="display:none;padding:0 16px;margin-left:50px"></div>
          <div class="pub-divider"></div>
          <div class="pub-actions">
            <div class="pub-right">
              <span class="pub-char-count" id="pub-char-count" style="opacity:0">0/500</span>
              <span class="pub-limit" id="feed-limit-info">FREE · 1/h</span>
              <button class="btn-publish" onclick="publishPost()" data-i18n="btn_publish">Publish</button>
            </div>
          </div>
        </div>
        <div class="feed-tabs">
          <button class="feed-tab active" onclick="switchFeed('all',this)" data-i18n="tab_all">All</button>
          <button class="feed-tab" onclick="switchFeed('following',this)" data-i18n="tab_following">Following</button>
          <button class="feed-tab" onclick="switchFeed('top',this)" data-i18n="tab_top">Top of the day</button>
        </div>
        <div id="trending-widget-container"></div>
      <div id="feed-list"></div>
      </div>
    </div>

    <!-- CAMPAIGN TAB -->
    <div class="tpanel" id="tab-campaign">
      <div style="max-width:960px;margin:0 auto;padding:28px 20px 80px;">

        <!-- Header -->
        <div style="text-align:center;margin-bottom:32px;">
          <div style="display:inline-flex;align-items:center;gap:8px;background:rgba(255,60,110,0.08);border:1px solid rgba(255,60,110,0.25);border-radius:30px;padding:6px 18px;margin-bottom:14px;">
            <span style="font-family:'DM Mono',monospace;font-size:10px;letter-spacing:2px;color:#ff3c6e;text-transform:uppercase;font-weight:700;">🔥 Premium Advertising</span>
          </div>
          <h2 style="font-family:'Bebas Neue',sans-serif;font-size:44px;letter-spacing:3px;color:var(--white);line-height:1;margin-bottom:8px;">BIG CAMPAIGNS</h2>
          <p style="font-size:13px;color:var(--muted);max-width:480px;margin:0 auto;">The most powerful ads on the network. Ultra-boosted visibility, full-site exposure, real impact.</p>
        </div>

        <!-- Filter bar -->
        <div style="display:flex;gap:8px;margin-bottom:24px;flex-wrap:wrap;align-items:center;justify-content:space-between;">
          <div style="display:flex;gap:8px;flex-wrap:wrap;">
            <button onclick="campaignFilter('all',this)" class="camp-filter-btn active" style="padding:7px 16px;border-radius:20px;border:1.5px solid rgba(255,60,110,0.4);background:rgba(255,60,110,0.08);font-family:'DM Mono',monospace;font-size:10px;font-weight:700;color:#ff3c6e;cursor:pointer;letter-spacing:1px;">ALL</button>
            <button onclick="campaignFilter('active',this)" class="camp-filter-btn" style="padding:7px 16px;border-radius:20px;border:1.5px solid var(--border);background:transparent;font-family:'DM Mono',monospace;font-size:10px;font-weight:700;color:var(--muted);cursor:pointer;letter-spacing:1px;">ACTIVE</button>
            <button onclick="campaignFilter('elite',this)" class="camp-filter-btn" style="padding:7px 16px;border-radius:20px;border:1.5px solid rgba(255,215,0,0.3);background:transparent;font-family:'DM Mono',monospace;font-size:10px;font-weight:700;color:#ffd700;cursor:pointer;letter-spacing:1px;">ELITE</button>
          </div>
          <button onclick="showAppTab('big-campaign',document.querySelector('[data-tab=big-campaign]'));bcRender()" style="padding:9px 20px;background:linear-gradient(135deg,#be123c,#ff3c6e);border:none;border-radius:8px;font-family:'Plus Jakarta Sans',sans-serif;font-size:12px;font-weight:800;color:#fff;cursor:pointer;box-shadow:0 0 16px rgba(255,60,110,0.3);">🔥 Launch My Campaign</button>
        </div>

        <!-- Campaign list -->
        <div id="campaign-tab-list"></div>
      </div>
    </div>

    <!-- SHOWCASE APP -->
    <div class="tpanel" id="tab-showcase">
      <div style="padding:22px 0">
        <div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:18px;flex-wrap:wrap;gap:10px">
          <div><h2 style="font-family:'Bebas Neue',sans-serif;font-size:30px;letter-spacing:2px;color:var(--g3);margin-bottom:2px">COMMUNITY SHOWCASE</h2><p style="font-size:12px;color:var(--muted)">Projects shared by the community</p></div>
          <div class="filters-row" style="margin:0">
            <button class="f-btn active" onclick="filterAppShowcase(this,'all')">All</button>
            <button class="f-btn" onclick="filterAppShowcase(this,'site')">🌐</button>
            <button class="f-btn" onclick="filterAppShowcase(this,'app')">📱</button>
            <button class="f-btn" onclick="filterAppShowcase(this,'tiktok')">🎵</button>
            <button class="f-btn" onclick="filterAppShowcase(this,'saas')">🚀</button>
          </div>
        </div>
        <div class="showcase-grid" id="app-showcase-grid"></div>
      </div>
    </div>

    <!-- PUBLISH -->
    <div class="tpanel" id="tab-publish">
      <div style="max-width:800px;margin:0 auto;padding:28px 0">

        <!-- TYPE CHOICE -->
        <div id="pub-type-chooser" style="margin-bottom:28px">
          <p style="font-size:13px;color:var(--muted);margin-bottom:16px;letter-spacing:0.5px">What do you want to publish?</p>

          <!-- INTRO CARD -->
          <div id="pub-page-intro" style="display:flex;align-items:flex-start;gap:14px;background:rgba(34,197,94,0.05);border:1px solid rgba(34,197,94,0.12);border-radius:14px;padding:16px 18px;margin-bottom:20px;animation:fadeUp 0.4s ease both">
            <div style="font-size:26px;line-height:1;flex-shrink:0">✨</div>
            <div>
              <div style="font-size:13px;font-weight:700;color:var(--g4);margin-bottom:4px">Post in 30 seconds</div>
              <div style="font-size:12px;color:var(--muted);line-height:1.6">Choose a format below, fill in the fields, and your post is visible to the entire community. <span style="color:var(--g3)">100% free.</span></div>
            </div>
            <button onclick="document.getElementById('pub-page-intro').style.display='none'" style="background:none;border:none;color:var(--muted2);font-size:18px;cursor:pointer;flex-shrink:0;padding:0;line-height:1;margin-left:4px">×</button>
          </div>

          <!-- MINI INTRO TOOLTIP -->
          <div id="pub-type-intro" style="display:none;margin-bottom:18px;padding:16px 18px;border-radius:14px;animation:fadeUp 0.25s ease both;transition:all 0.2s;position:relative">
            <div id="pub-intro-emoji" style="font-size:28px;margin-bottom:6px"></div>
            <div id="pub-intro-title" style="font-family:'Bebas Neue',sans-serif;font-size:22px;letter-spacing:2px;margin-bottom:4px"></div>
            <div id="pub-intro-text" style="font-size:12px;line-height:1.7;color:var(--g5);margin-bottom:12px"></div>
            <div id="pub-intro-tags" style="display:flex;gap:6px;flex-wrap:wrap;margin-bottom:14px"></div>
            <button id="pub-intro-confirm" style="width:100%;padding:11px;border:none;border-radius:9px;font-family:'Plus Jakarta Sans',sans-serif;font-size:13px;font-weight:800;cursor:pointer;color:#0a0a0a;transition:all 0.2s" onclick="confirmPubTypeChoice()">
              Let's go →
            </button>
          </div>

          <div id="pub-type-grid" style="display:grid;grid-template-columns:1fr 1fr;gap:10px">

            <!-- PUB — style simple vert -->
            <div onclick="previewPubType('pub')" class="pub-type-card ptc-pub" id="ptc-pub" style="border-color:rgba(34,197,94,0.25);flex-direction:column;align-items:flex-start;gap:8px;padding:16px;">
              <div style="display:flex;align-items:center;gap:10px;width:100%">
                <div class="ptc-icon" style="background:linear-gradient(135deg,rgba(34,197,94,0.2),rgba(34,197,94,0.05));font-size:22px">📢</div>
                <div class="ptc-name" style="font-size:15px">Ad</div>
                <div style="margin-left:auto;font-size:9px;background:rgba(34,197,94,0.1);color:var(--g4);border:1px solid rgba(34,197,94,0.2);border-radius:4px;padding:2px 7px;font-family:'DM Mono',monospace;letter-spacing:1px">SIMPLE</div>
              </div>
              <div class="ptc-desc" style="font-size:11px;line-height:1.5">Introduce your project to the community</div>
              <div class="ptc-fields">Name · Description · Link</div>
            </div>

            <!-- AD — flash/alert style -->
            <div onclick="previewPubType('ad')" class="pub-type-card ptc-ad" id="ptc-ad" style="border-color:rgba(74,222,128,0.3);background:linear-gradient(135deg,rgba(74,222,128,0.04),transparent);flex-direction:column;align-items:flex-start;gap:8px;padding:16px;">
              <div style="display:flex;align-items:center;gap:10px;width:100%">
                <div class="ptc-icon" style="background:linear-gradient(135deg,rgba(74,222,128,0.25),rgba(74,222,128,0.05));font-size:22px;animation:blink 2s infinite">📣</div>
                <div class="ptc-name" style="font-size:15px;color:#4ade80">News</div>
                <div style="margin-left:auto;font-size:9px;background:rgba(74,222,128,0.12);color:#4ade80;border:1px solid rgba(74,222,128,0.25);border-radius:4px;padding:2px 7px;font-family:'DM Mono',monospace;letter-spacing:1px">NEWS</div>
              </div>
              <div class="ptc-desc" style="font-size:11px;line-height:1.5">Inform the community about something new</div>
              <div class="ptc-fields">Title · Message · Link · Date</div>
            </div>

            <!-- SERVICE — shop/blue style -->
            <div onclick="previewPubType('service')" class="pub-type-card" id="ptc-service" style="border-color:rgba(59,130,246,0.3);background:linear-gradient(135deg,rgba(59,130,246,0.04),transparent);flex-direction:column;align-items:flex-start;gap:8px;padding:16px;">
              <div style="display:flex;align-items:center;gap:10px;width:100%">
                <div class="ptc-icon" style="background:linear-gradient(135deg,rgba(59,130,246,0.2),rgba(59,130,246,0.05));font-size:22px">🛍️</div>
                <div class="ptc-name" style="font-size:15px;color:#60a5fa">Service</div>
                <div style="margin-left:auto;font-size:9px;background:rgba(59,130,246,0.12);color:#93c5fd;border:1px solid rgba(59,130,246,0.25);border-radius:4px;padding:2px 7px;font-family:'DM Mono',monospace;letter-spacing:1px">VENTE</div>
              </div>
              <div class="ptc-desc" style="font-size:11px;line-height:1.5">Offer your skills or services</div>
              <div class="ptc-fields">Service · Rate · Deadline · Contact</div>
            </div>

            <!-- LAUNCH — style rocket/rouge -->
            <div onclick="previewPubType('launch')" class="pub-type-card" id="ptc-launch" style="border-color:rgba(239,68,68,0.35);background:linear-gradient(135deg,rgba(239,68,68,0.05),transparent);flex-direction:column;align-items:flex-start;gap:8px;padding:16px;">
              <div style="display:flex;align-items:center;gap:10px;width:100%">
                <div class="ptc-icon" style="background:linear-gradient(135deg,rgba(239,68,68,0.25),rgba(239,68,68,0.05));font-size:22px">🚀</div>
                <div class="ptc-name" style="font-size:15px;color:#f87171">Launch</div>
                <div style="margin-left:auto;font-size:9px;background:rgba(239,68,68,0.12);color:#fca5a5;border:1px solid rgba(239,68,68,0.3);border-radius:4px;padding:2px 7px;font-family:'DM Mono',monospace;letter-spacing:1px">🔥 HYPE</div>
              </div>
              <div class="ptc-desc" style="font-size:11px;line-height:1.5">Officially launch your product</div>
              <div class="ptc-fields">Product · Problem · Solution · Price</div>
            </div>

            <!-- COLLAB — network/purple style -->
            <div onclick="previewPubType('collab')" class="pub-type-card" id="ptc-collab" style="border-color:rgba(168,85,247,0.35);background:linear-gradient(135deg,rgba(168,85,247,0.05),transparent);flex-direction:column;align-items:flex-start;gap:8px;padding:16px;position:relative;overflow:hidden;">
              <div style="position:absolute;top:-10px;right:-10px;font-size:40px;opacity:0.06;pointer-events:none">🤝</div>
              <div style="display:flex;align-items:center;gap:10px;width:100%">
                <div class="ptc-icon" style="background:linear-gradient(135deg,rgba(168,85,247,0.25),rgba(168,85,247,0.05));font-size:22px">🤝</div>
                <div class="ptc-name" style="font-size:15px;color:#c084fc">Collab</div>
                <div style="margin-left:auto;font-size:9px;background:rgba(168,85,247,0.12);color:#d8b4fe;border:1px solid rgba(168,85,247,0.3);border-radius:4px;padding:2px 7px;font-family:'DM Mono',monospace;letter-spacing:1px">NETWORK</div>
              </div>
              <div class="ptc-desc" style="font-size:11px;line-height:1.5">Looking for a partner or co-founder</div>
              <div class="ptc-fields">Desired profile · Niche · Terms</div>
            </div>

            <!-- PROMO — deal/orange + countdown style -->
            <div onclick="previewPubType('promo')" class="pub-type-card" id="ptc-promo" style="border-color:rgba(245,158,11,0.4);background:linear-gradient(135deg,rgba(245,158,11,0.06),transparent);flex-direction:column;align-items:flex-start;gap:8px;padding:16px;position:relative;overflow:hidden;">
              <div style="position:absolute;top:0;right:0;background:rgba(245,158,11,0.12);border-bottom-left-radius:10px;padding:3px 10px;font-size:9px;font-family:'DM Mono',monospace;color:#fbbf24;letter-spacing:1px">LIMITED</div>
              <div style="display:flex;align-items:center;gap:10px;width:100%">
                <div class="ptc-icon" style="background:linear-gradient(135deg,rgba(245,158,11,0.25),rgba(245,158,11,0.05));font-size:22px">🏷️</div>
                <div class="ptc-name" style="font-size:15px;color:#fbbf24">Promo</div>
              </div>
              <div class="ptc-desc" style="font-size:11px;line-height:1.5">Promotion or limitd-time deal</div>
              <div class="ptc-fields">Offer · Crossed price · Code · Expiration</div>
            </div>

            <!-- POLL — vote/teal style -->
            <div onclick="previewPubType('poll')" class="pub-type-card" id="ptc-sondage" style="border-color:rgba(20,184,166,0.35);background:linear-gradient(135deg,rgba(20,184,166,0.05),transparent);flex-direction:column;align-items:flex-start;gap:8px;padding:16px;">
              <div style="display:flex;align-items:center;gap:10px;width:100%">
                <div class="ptc-icon" style="background:linear-gradient(135deg,rgba(20,184,166,0.25),rgba(20,184,166,0.05));font-size:22px">📊</div>
                <div class="ptc-name" style="font-size:15px;color:#2dd4bf">Poll</div>
                <div style="margin-left:auto;display:flex;gap:2px;align-items:flex-end;height:16px">
                  <div style="width:4px;height:6px;background:rgba(45,212,191,0.4);border-radius:2px"></div>
                  <div style="width:4px;height:10px;background:rgba(45,212,191,0.6);border-radius:2px"></div>
                  <div style="width:4px;height:16px;background:#2dd4bf;border-radius:2px"></div>
                  <div style="width:4px;height:8px;background:rgba(45,212,191,0.5);border-radius:2px"></div>
                </div>
              </div>
              <div class="ptc-desc" style="font-size:11px;line-height:1.5">Ask the community a question</div>
              <div class="ptc-fields">Question · 4 options · Vote duration</div>
            </div>

            <!-- TUTORIAL — academic/light green style -->
            <div onclick="previewPubType('tutorial')" class="pub-type-card" id="ptc-tutoriel" style="border-color:rgba(34,197,94,0.2);background:linear-gradient(160deg,rgba(11,26,13,0.8),rgba(15,35,18,0.4));flex-direction:column;align-items:flex-start;gap:8px;padding:16px;">
              <div style="display:flex;align-items:center;gap:10px;width:100%">
                <div class="ptc-icon" style="background:linear-gradient(135deg,rgba(34,197,94,0.15),rgba(34,197,94,0.03));font-size:22px">🎓</div>
                <div class="ptc-name" style="font-size:15px">Tutorial</div>
              </div>
              <div style="display:flex;gap:4px;margin-top:2px">
                <div style="flex:1;height:3px;background:var(--g3);border-radius:2px"></div>
                <div style="flex:1;height:3px;background:rgba(34,197,94,0.3);border-radius:2px"></div>
                <div style="flex:1;height:3px;background:rgba(34,197,94,0.15);border-radius:2px"></div>
              </div>
              <div class="ptc-desc" style="font-size:11px;line-height:1.5">Share a method or step-by-step guide</div>
              <div class="ptc-fields">Topic · Steps · Level · Duration</div>
            </div>

            <!-- SEARCH — magnify/indigo style -->
            <div onclick="previewPubType('search')" class="pub-type-card" id="ptc-search" style="border-color:rgba(99,102,241,0.35);background:linear-gradient(135deg,rgba(99,102,241,0.05),transparent);flex-direction:column;align-items:flex-start;gap:8px;padding:16px;">
              <div style="display:flex;align-items:center;gap:10px;width:100%">
                <div class="ptc-icon" style="background:linear-gradient(135deg,rgba(99,102,241,0.25),rgba(99,102,241,0.05));font-size:22px">🔍</div>
                <div class="ptc-name" style="font-size:15px;color:#a5b4fc">Search</div>
                <div style="margin-left:auto;font-size:9px;background:rgba(99,102,241,0.12);color:#c7d2fe;border:1px solid rgba(99,102,241,0.3);border-radius:4px;padding:2px 7px;font-family:'DM Mono',monospace;letter-spacing:1px">NEED</div>
              </div>
              <div class="ptc-desc" style="font-size:11px;line-height:1.5">Search for a freelancer, tool or resource</div>
              <div class="ptc-fields">Need · Budget · Deadline · Contact</div>
            </div>

            <!-- RESULT — trophy/subtle gold style -->
            <div onclick="previewPubType('result')" class="pub-type-card" id="ptc-resultat" style="border-color:rgba(255,215,0,0.2);background:linear-gradient(135deg,rgba(255,215,0,0.03),transparent);flex-direction:column;align-items:flex-start;gap:8px;padding:16px;">
              <div style="display:flex;align-items:center;gap:10px;width:100%">
                <div class="ptc-icon" style="background:linear-gradient(135deg,rgba(255,215,0,0.2),rgba(255,215,0,0.03));font-size:22px">🏆</div>
                <div class="ptc-name" style="font-size:15px;color:#fde68a">Result</div>
                <div style="margin-left:auto;font-size:18px;opacity:0.4">📈</div>
              </div>
              <div class="ptc-desc" style="font-size:11px;line-height:1.5">Share your stats and wins</div>
              <div class="ptc-fields">Figures · Period · Learnings</div>
            </div>

            <!-- CAMPAIGN — premium gold style -->
            <div onclick="previewPubType('campaign')" class="pub-type-card" id="ptc-campagne" style="border-color:rgba(255,215,0,0.4);background:linear-gradient(135deg,rgba(255,215,0,0.07),rgba(255,140,0,0.03));flex-direction:column;align-items:flex-start;gap:8px;padding:16px;position:relative;overflow:hidden;box-shadow:0 0 20px rgba(255,215,0,0.06)">
              <div style="position:absolute;inset:0;background:repeating-linear-gradient(45deg,transparent,transparent 10px,rgba(255,215,0,0.015) 10px,rgba(255,215,0,0.015) 11px);pointer-events:none"></div>
              <div style="display:flex;align-items:center;gap:10px;width:100%">
                <div class="ptc-icon" style="background:linear-gradient(135deg,rgba(255,215,0,0.3),rgba(255,140,0,0.1));font-size:22px">🎯</div>
                <div class="ptc-name" style="font-size:15px;color:#ffd700">Campaign</div>
                <span class="plan-elite-badge" style="margin-left:auto">MAX</span>
              </div>
              <div class="ptc-desc" style="font-size:11px;line-height:1.5;color:#fef3c7">Maximum visibility with a measurable goal</div>
              <div class="ptc-fields" style="color:rgba(255,215,0,0.5)">Goal · Video · FAQ · Top boost</div>
            </div>

            <!-- SERVICE PRO — style violet premium -->
            <div onclick="previewPubType('service-pro')" class="pub-type-card" id="ptc-service-pro" style="border-color:rgba(168,85,247,0.4);background:linear-gradient(135deg,rgba(168,85,247,0.07),rgba(109,40,217,0.03));flex-direction:column;align-items:flex-start;gap:8px;padding:16px;position:relative;overflow:hidden;">
              <div style="position:absolute;top:-20px;right:-20px;width:80px;height:80px;border-radius:50%;background:radial-gradient(circle,rgba(168,85,247,0.1),transparent);pointer-events:none"></div>
              <div style="display:flex;align-items:center;gap:10px;width:100%">
                <div class="ptc-icon" style="background:linear-gradient(135deg,rgba(168,85,247,0.3),rgba(168,85,247,0.05));font-size:22px">🔧</div>
                <div class="ptc-name" style="font-size:15px;color:#a855f7">Pro Service</div>
                <div style="margin-left:auto;font-size:9px;background:rgba(168,85,247,0.15);color:#d8b4fe;border:1px solid rgba(168,85,247,0.35);border-radius:4px;padding:2px 7px;font-family:'DM Mono',monospace;letter-spacing:1px">PRO</div>
              </div>
              <div class="ptc-desc" style="font-size:11px;line-height:1.5">Premium service with full portfolio</div>
              <div class="ptc-fields" style="color:rgba(168,85,247,0.5)">Portfolio · Rates · Testimonials · Booking</div>
            </div>

            <!-- AD GROUP — elite gold 5-cat style -->
            <div onclick="showPubCreatorTab(document.getElementById('tab-btn-pubcreator'))" class="pub-type-card" style="border-color:rgba(255,215,0,0.5);background:linear-gradient(135deg,rgba(255,215,0,0.09),rgba(255,140,0,0.04));flex-direction:column;align-items:flex-start;gap:8px;padding:16px;position:relative;overflow:hidden;box-shadow:0 0 18px rgba(255,215,0,0.08)">
              <div style="position:absolute;inset:0;background:repeating-linear-gradient(45deg,transparent,transparent 10px,rgba(255,215,0,0.012) 10px,rgba(255,215,0,0.012) 11px);pointer-events:none"></div>
              <div style="display:flex;align-items:center;gap:10px;width:100%">
                <div class="ptc-icon" style="background:linear-gradient(135deg,rgba(255,215,0,0.35),rgba(255,140,0,0.1));font-size:22px">🗂️</div>
                <div class="ptc-name" style="font-size:15px;color:#ffd700">Ad Group</div>
                <span class="plan-elite-badge" style="margin-left:auto">ELITE</span>
              </div>
              <div class="ptc-desc" style="font-size:11px;line-height:1.5;color:#fef3c7">Launch 5 category ads in one campaign — the Elite ad studio</div>
              <div class="ptc-fields" style="color:rgba(255,215,0,0.45)">5 categories · Campaign · Ad Creator Studio</div>
            </div>

            <!-- JOB — large/company blue style -->
            <div onclick="previewPubType('job')" class="pub-type-card" id="ptc-emploi" style="grid-column:span 2;border-color:rgba(59,130,246,0.35);background:linear-gradient(90deg,rgba(59,130,246,0.06),transparent);flex-direction:row;align-items:center;gap:14px;padding:16px 20px;position:relative;overflow:hidden;">
              <div style="position:absolute;right:20px;top:50%;transform:translateY(-50%);font-size:48px;opacity:0.05;pointer-events:none">💼</div>
              <div class="ptc-icon" style="background:linear-gradient(135deg,rgba(59,130,246,0.25),rgba(59,130,246,0.05));font-size:26px;width:50px;height:50px;border-radius:12px;flex-shrink:0">💼</div>
              <div style="flex:1">
                <div style="display:flex;align-items:center;gap:8px;margin-bottom:4px">
                  <div class="ptc-name" style="font-size:15px;color:#60a5fa">Job Offer</div>
                  <div style="font-size:9px;background:rgba(59,130,246,0.12);color:#93c5fd;border:1px solid rgba(59,130,246,0.25);border-radius:4px;padding:2px 7px;font-family:'DM Mono',monospace;letter-spacing:1px">RECRUITMENT</div>
                </div>
                <div class="ptc-desc" style="font-size:11px;line-height:1.5;margin-bottom:4px">Recruit for your team or project</div>
                <div class="ptc-fields">Position · Skills · Remote/On-site · Compensation · Application</div>
              </div>
            </div>

          </div>
        </div>

        <!-- WIZARD (hidden until type selected) -->
        <div id="pub-wizard-content" style="display:none">

        <!-- HEADER -->
        <div style="margin-bottom:22px;display:flex;align-items:center;justify-content:space-between;flex-wrap:wrap;gap:10px">
          <div>
            <div style="display:flex;align-items:center;gap:10px;margin-bottom:4px">
              <h2 id="wiz-main-title" style="font-family:'Bebas Neue',sans-serif;font-size:34px;letter-spacing:3px;color:var(--g3)">CREATE MY POST</h2>
              <span id="pub-type-badge" style="font-size:11px;background:rgba(34,197,94,0.1);color:var(--g3);border:1px solid rgba(34,197,94,0.3);border-radius:6px;padding:3px 10px;font-weight:700"></span>
            </div>
            <p id="wiz-main-sub" style="font-size:13px;color:var(--muted)">Follow the steps to create a post that converts.</p>
          </div>
          <div style="display:flex;gap:8px;align-items:center">
            <button onclick="backToPubTypeChooser()" style="background:rgba(255,255,255,0.04);border:1.5px solid var(--border);border-radius:8px;padding:8px 14px;font-size:12px;font-weight:700;color:var(--muted);cursor:pointer;font-family:'Plus Jakarta Sans',sans-serif">← Change</button>
            <button onclick="showPubGuide()" style="background:rgba(34,197,94,0.08);border:1.5px solid rgba(34,197,94,0.2);border-radius:8px;padding:8px 14px;font-size:12px;font-weight:700;color:var(--g4);cursor:pointer;font-family:'Plus Jakarta Sans',sans-serif">💡 Guide</button>
          </div>
        </div>

        <!-- STEPPER -->
        <div class="wiz-stepper" id="wiz-stepper">
          <div class="wiz-step-dot active" id="wdot-1" onclick="wizGoTo(1)">
            <div class="wiz-step-circle active" id="wcirc-1"><span>1</span></div>
            <div class="wiz-step-lbl" id="wlbl-1">Identity</div>
          </div>
          <div class="wiz-connector" id="wconn-1"></div>
          <div class="wiz-step-dot" id="wdot-2" onclick="wizGoTo(2)">
            <div class="wiz-step-circle" id="wcirc-2"><span>2</span></div>
            <div class="wiz-step-lbl" id="wlbl-2">Description</div>
          </div>
          <div class="wiz-connector" id="wconn-2"></div>
          <div class="wiz-step-dot" id="wdot-3" onclick="wizGoTo(3)">
            <div class="wiz-step-circle" id="wcirc-3"><span>3</span></div>
            <div class="wiz-step-lbl" id="wlbl-3">Details</div>
          </div>
          <div class="wiz-connector" id="wconn-3"></div>
          <div class="wiz-step-dot" id="wdot-4" onclick="wizGoTo(4)">
            <div class="wiz-step-circle" id="wcirc-4"><span>4</span></div>
            <div class="wiz-step-lbl" id="wlbl-4">Visual</div>
          </div>
          <div class="wiz-connector" id="wconn-4"></div>
          <div class="wiz-step-dot" id="wdot-5" onclick="wizGoTo(5)">
            <div class="wiz-step-circle" id="wcirc-5"><span>5</span></div>
            <div class="wiz-step-lbl" id="wlbl-5">Preview</div>
          </div>
        </div>

        <!-- PROGRESS BAR -->
        <div class="wiz-progress-bar">
          <div class="wiz-progress-fill" id="wiz-prog-fill" style="width:20%"></div>
        </div>

        <!-- ────────────────────────────────────
             STEP 1 — PROJECT IDENTITY
        ──────────────────────────────────── -->
        <!-- ────────────────────────────────────
             STEP 1 — IDENTITY (DYNAMIC)
        ──────────────────────────────────── -->
        <div class="wiz-panel active" id="wpanel-1">
          <!-- PHOTO UPLOAD — PREMIÈRE ÉTAPE -->
          <div class="wiz-group-card" style="margin-bottom:14px">
            <div class="wiz-group-title">
              <div class="wiz-group-icon">📸</div>
              <div>
                <div class="wiz-group-head">PHOTO DE COUVERTURE</div>
                <div class="wiz-group-sub">Les pubs avec image reçoivent <strong style="color:var(--g3)">3× plus de votes</strong></div>
              </div>
            </div>
            <div id="wiz-photo-area" style="display:flex;flex-direction:column;align-items:center;gap:12px">
              <!-- Preview -->
              <div id="wiz-photo-preview" style="display:none;width:100%;max-height:200px;border-radius:12px;overflow:hidden;position:relative">
                <img loading="lazy" id="wiz-photo-preview-img" alt="Photo preview" style="width:100%;height:200px;object-fit:cover;display:block"/>
                <button onclick="removeWizPhoto()" style="position:absolute;top:8px;right:8px;background:rgba(0,0,0,0.6);border:none;border-radius:50%;width:28px;height:28px;color:white;cursor:pointer;font-size:14px;display:flex;align-items:center;justify-content:center">✕</button>
              </div>
              <!-- Upload buttons -->
              <div id="wiz-photo-btns" style="display:flex;gap:10px;width:100%">
                <label style="flex:1;display:flex;flex-direction:column;align-items:center;gap:8px;padding:20px 12px;background:var(--s2);border:2px dashed var(--border);border-radius:12px;cursor:pointer;transition:all 0.2s;text-align:center" onmouseover="this.style.borderColor='var(--g3)';this.style.background='rgba(34,197,94,0.04)'" onmouseout="this.style.borderColor='var(--border)';this.style.background='var(--s2)'">
                  <svg width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="var(--g3)" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="3" width="18" height="18" rx="2"/><circle cx="8.5" cy="8.5" r="1.5"/><polyline points="21 15 16 10 5 21"/></svg>
                  <div style="font-size:12px;font-weight:700;color:var(--g4)">Depuis mes fichiers</div>
                  <div style="font-size:10px;color:var(--muted2)">JPG, PNG, GIF</div>
                  <input type="file" accept="image/*" style="display:none" onchange="handleWizPhoto(this)"/>
                </label>
                <label style="flex:1;display:flex;flex-direction:column;align-items:center;gap:8px;padding:20px 12px;background:var(--s2);border:2px dashed var(--border);border-radius:12px;cursor:pointer;transition:all 0.2s;text-align:center" onmouseover="this.style.borderColor='var(--g3)';this.style.background='rgba(34,197,94,0.04)'" onmouseout="this.style.borderColor='var(--border)';this.style.background='var(--s2)'">
                  <svg width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="var(--g3)" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"><path d="M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"/><circle cx="12" cy="13" r="4"/></svg>
                  <div style="font-size:12px;font-weight:700;color:var(--g4)">Appareil photo</div>
                  <div style="font-size:10px;color:var(--muted2)">Prendre une photo</div>
                  <input type="file" accept="image/*" capture="environment" style="display:none" onchange="handleWizPhoto(this)"/>
                </label>
              </div>
              <button onclick="skipWizPhoto()" style="background:none;border:none;font-size:11px;color:var(--muted);cursor:pointer;text-decoration:underline">Passer cette étape →</button>
            </div>
          </div>
          <div class="wiz-group-card" id="wpanel-1-card">
            <div class="wiz-group-title">
              <div class="wiz-group-icon" id="wiz-step1-icon">🚀</div>
              <div>
                <div class="wiz-group-head" id="wiz-step1-head">IDENTITY</div>
                <div class="wiz-group-sub" id="wiz-step1-sub">Main information</div>
              </div>
            </div>
            <div id="wiz-step1-fields" class="edit-grid" style="gap:14px"></div>
          </div>
          <div class="wiz-nav">
            <button class="btn-wiz-next" id="wiz-step1-next" onclick="wizNext(1)">Next <span>→</span></button>
          </div>
        </div>

        <!-- ────────────────────────────────────
             STEP 2 — CONTENT (DYNAMIC)
        ──────────────────────────────────── -->
        <div class="wiz-panel" id="wpanel-2">
          <div class="wiz-group-card">
            <div class="wiz-group-title">
              <div class="wiz-group-icon" id="wiz-step2-icon">✍️</div>
              <div>
                <div class="wiz-group-head" id="wiz-step2-head">CONTENT</div>
                <div class="wiz-group-sub" id="wiz-step2-sub">Describe your post</div>
              </div>
            </div>
            <div id="wiz-step2-fields" style="display:flex;flex-direction:column;gap:14px"></div>
          </div>
          <div class="wiz-nav">
            <button class="btn-wiz-back" onclick="wizPrev(2)">← Back</button>
            <button class="btn-wiz-next" id="wiz-step2-next" onclick="wizNext(2)">Next <span>→</span></button>
          </div>
        </div>

        <!-- ────────────────────────────────────
             STEP 3 — DETAILS (DYNAMIC)
        ──────────────────────────────────── -->
        <div class="wiz-panel" id="wpanel-3">
          <div class="wiz-group-card">
            <div class="wiz-group-title">
              <div class="wiz-group-icon" id="wiz-step3-icon">🎯</div>
              <div>
                <div class="wiz-group-head" id="wiz-step3-head">DETAILS</div>
                <div class="wiz-group-sub" id="wiz-step3-sub">Additional information</div>
              </div>
            </div>
            <div id="wiz-step3-fields" class="edit-grid" style="gap:14px"></div>
          </div>
          <div class="wiz-nav">
            <button class="btn-wiz-back" onclick="wizPrev(3)">← Back</button>
            <button class="btn-wiz-next" id="wiz-step3-next" onclick="wizNext(3)">Next — Visual <span>→</span></button>
          </div>
        </div>

        <!-- ────────────────────────────────────
             STEP 4 — VISUAL
        ──────────────────────────────────── -->
        <div class="wiz-panel" id="wpanel-4">
          <div class="wiz-group-card">
            <div class="wiz-group-title">
              <div class="wiz-group-icon">🖼️</div>
              <div>
                <div class="wiz-group-head">YOUR AD VISUAL</div>
                <div class="wiz-group-sub">Listings with images get <strong style="color:var(--g3)">3× more votes</strong> — highly recommended</div>
              </div>
            </div>
            <label style="display:flex;flex-direction:column;align-items:center;justify-content:center;gap:12px;cursor:pointer;background:var(--s2);border:2px dashed var(--border);border-radius:14px;padding:40px 20px;font-size:13px;color:var(--muted);transition:all 0.2s;text-align:center" id="pub-media-drop" onmouseover="this.style.borderColor='var(--g3)';this.style.background='rgba(34,197,94,0.04)'" onmouseout="this.style.borderColor='var(--border)';this.style.background='var(--s2)'">
              <span style="font-size:44px">🖼️</span>
              <div>
                <div style="font-weight:700;color:var(--g4);margin-bottom:4px">Click to add your image or video</div>
                <div style="font-size:11px;color:var(--muted2)">PNG, JPG, GIF, MP4 · Max 10MB</div>
              </div>
              <input type="file" id="pub-media-input" accept="image/*,video/*" style="display:none" onchange="handlePubMediaUpload(this);updatePubCompletion()"/>
            </label>
            <div id="pub-media-preview" style="margin-top:12px"></div>
            <div style="background:rgba(255,215,0,0.04);border:1px solid rgba(255,215,0,0.15);border-radius:10px;padding:12px 14px;margin-top:14px;font-size:11px;color:var(--muted);line-height:1.9">
              ✅ Cover image → <strong style="color:var(--g4)">3× more votes</strong><br>
              ✅ Description 100+ chars. → <strong style="color:var(--g4)">+60% clicks</strong><br>
              ✅ Precise tags → <strong style="color:var(--g4)">AI matching activated</strong>
            </div>
          </div>
          <div class="wiz-nav">
            <button class="btn-wiz-back" onclick="wizPrev(4)">← Back</button>
            <button class="btn-wiz-next" onclick="wizNext(4)">Next — Final preview <span>→</span></button>
          </div>
        </div>

        <!-- ────────────────────────────────────
             STEP 5 — PREVIEW & PUBLISH
        ──────────────────────────────────── -->
        <div class="wiz-panel" id="wpanel-5">
          <div class="wiz-group-card">
            <div class="wiz-group-title">
              <div class="wiz-group-icon">👁️</div>
              <div>
                <div class="wiz-group-head">PREVIEW & PUBLISH</div>
                <div class="wiz-group-sub">Here is exactly how your ad will be seen by the community</div>
              </div>
            </div>

            <!-- SHOWCASE PREVIEW -->
            <div id="wiz-showcase-preview" class="wiz-preview-card">
              <div class="wiz-preview-banner" id="wiz-prev-banner">
                <span id="wiz-prev-emoji">🚀</span>
                <img loading="lazy" id="wiz-prev-img" alt="Preview image" style="display:none;position:absolute;inset:0;width:100%;height:100%;object-fit:cover"/>
              </div>
              <div class="wiz-preview-body">
                <div class="wiz-preview-name" id="wiz-prev-name">Project name</div>
                <div class="wiz-preview-hook" id="wiz-prev-hook" style="display:none"></div>
                <div class="wiz-preview-desc" id="wiz-prev-desc">Your description will appear here...</div>
                <div class="wiz-preview-tags" id="wiz-prev-tags"></div>
                <div class="wiz-preview-footer">
                  <div style="display:flex;gap:10px">
                    <span>❤️ 0</span>
                    <span>💬 0</span>
                    <span id="wiz-prev-collab" style="display:none;font-size:10px;background:rgba(22,163,74,0.15);border:1px solid rgba(22,163,74,0.3);border-radius:4px;padding:1px 6px;color:var(--g4)"></span>
                  </div>
                  <div id="wiz-prev-author" style="font-family:'DM Mono',monospace;font-size:10px;color:var(--muted2)"></div>
                </div>
              </div>
            </div>

            <!-- SUMMARY CHECKLIST -->
            <div id="wiz-checklist" style="background:var(--s2);border:1.5px solid var(--border2);border-radius:10px;padding:14px 16px;margin-bottom:4px">
              <div style="font-family:'DM Mono',monospace;font-size:9px;color:var(--g3);letter-spacing:2px;margin-bottom:10px">LISTING STRENGTH</div>
              <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:8px">
                <span style="font-family:'DM Mono',monospace;font-size:11px;color:var(--muted2)">Completion</span>
                <span style="font-family:'DM Mono',monospace;font-size:14px;color:var(--gold);font-weight:700" id="wiz-completion-pct">0%</span>
              </div>
              <div style="height:6px;background:var(--s3);border-radius:3px;overflow:hidden;margin-bottom:12px">
                <div id="wiz-completion-bar" style="height:100%;width:0%;background:linear-gradient(90deg,var(--g2),var(--g3));border-radius:3px;transition:width 0.4s"></div>
              </div>
              <div style="display:flex;gap:8px;flex-wrap:wrap" id="wiz-hints"></div>
            </div>

            <!-- SHOWCASE DURATION -->
            <div style="background:rgba(22,163,74,0.04);border:1px solid rgba(22,163,74,0.1);border-radius:8px;padding:10px 14px;font-size:11px;color:var(--muted);margin-top:10px">
              ⏱ Showcase duration: <strong style="color:var(--g3)">FREE = 24h</strong> · Starter = 7d · Pro = 30d · Elite = Permanent
              <span id="pub-plan-label" style="float:right;color:var(--g4);font-weight:600"></span>
            </div>
          </div>

          <div class="wiz-nav">
            <button class="btn-wiz-back" onclick="wizPrev(5)">← Edit</button>
            <button class="btn-wiz-publish" onclick="publishProject()">🚀 Publish to showcase!</button>
          </div>

          <div style="display:none" id="pub-strategy" style="margin-top:14px;background:var(--s1);border:1.5px solid var(--border);border-radius:10px;padding:16px;font-size:13px;line-height:1.8;color:#7a9a82;white-space:pre-wrap"></div>
        </div>

      </div>
    </div>

        </div><!-- /pub-wizard-content -->
    <!-- CHAT MONDIAL -->
    <div class="tpanel" id="tab-chat-global">
      <div class="chat-panel-container">
        <div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:18px;flex-wrap:wrap;gap:10px">
          <div>
            <h2 style="font-family:'Bebas Neue',sans-serif;font-size:30px;letter-spacing:2px;color:var(--g3);margin-bottom:2px">CHAT MONDIAL</h2>
            <div style="font-family:'DM Mono',monospace;font-size:10px;color:var(--g4);display:flex;align-items:center;gap:6px"><span style="width:6px;height:6px;border-radius:50%;background:var(--g3);box-shadow:0 0 5px var(--g3);display:inline-block"></span><span id="world-online-count">0 online</span></div>
          </div>
          <div style="font-family:'DM Mono',monospace;font-size:10px;color:var(--muted);background:var(--s1);border:1px solid var(--border2);border-radius:6px;padding:7px 12px">Messages restants : <span id="chat-msgs-left" style="color:var(--g3);font-weight:700">3</span></div>
        </div>
        <div class="chat-box">
          <div class="chat-msgs-area" id="world-chat-msgs"></div>
          <div class="chat-input-row">
            <input type="text" id="world-chat-in" class="chat-input-field" placeholder="Write your message to the community..." onkeydown="if(event.key==='Enter')sendWorldChat()"/>
            <button class="btn-send" onclick="sendWorldChat()">→</button>
          </div>
        </div>
        <div id="world-chat-upgrade" style="display:none" class="upgrade-strip">
          <div><h4>Daily messages exhausted</h4><p>Starter ($4.99/month) = 10 messages/day</p></div>
          <button class="btn-g btn-solid-g" onclick="startPayment('starter')">Upgrade →</button>
        </div>
      </div>
    </div>

    <!-- PROFILE -->
    <div class="tpanel" id="tab-profile">
      <div style="max-width:760px;margin:0 auto;padding:22px 0" id="my-profile-view"></div>
    </div>

    <!-- FOLLOWERS -->
    <div class="tpanel" id="tab-abonnes">
      <div style="max-width:640px;margin:0 auto;padding:22px 0">
        <h2 style="font-family:'Bebas Neue',sans-serif;font-size:30px;letter-spacing:2px;color:var(--g3);margin-bottom:3px">FOLLOWERS & SUBSCRIPTIONS</h2>
        <div class="feed-tabs" style="margin-bottom:20px">
          <button class="feed-tab active" onclick="switchFollowTab('followers',this)">Followers (<span id="followers-count">0</span>)</button>
          <button class="feed-tab" onclick="switchFollowTab('following',this)">Following (<span id="following-count">0</span>)</button>
          <button class="feed-tab" onclick="switchFollowTab('discover',this)">Discover</button>
        </div>
        <div id="follow-list-container" class="follow-list"></div>
      </div>
    </div>

    <!-- GROUPES -->
    <div class="tpanel" id="tab-groups">
      <div style="max-width:860px;margin:0 auto;padding:22px 0">
        <div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:18px;flex-wrap:wrap;gap:10px">
          <div>
            <h2 style="font-family:'Bebas Neue',sans-serif;font-size:30px;letter-spacing:2px;color:var(--g3);margin-bottom:2px">GROUPES DE DISCUSSION</h2>
            <p style="font-size:12px;color:var(--muted)">Join or create themed groups</p>
          </div>
          <button class="btn-publish" onclick="openCreateGroup()" id="btn-create-group" style="display:none">+ Create a group</button>
        </div>
        <div id="groups-list"></div>
      </div>
    </div>

    <!-- IA BOOST -->
    <div class="tpanel" id="tab-ia-boost">
      <div style="max-width:660px;margin:0 auto;padding:22px 0">
        <h2 style="font-family:'Bebas Neue',sans-serif;font-size:30px;letter-spacing:2px;color:var(--g3);margin-bottom:3px">IA BOOST</h2>
        <p style="font-size:12px;color:var(--muted);margin-bottom:20px">Complete promotion strategy generated in 10 seconds</p>
        <div class="edit-section" style="margin-bottom:12px">
          <h3>Strategy type</h3>
          <div class="boost-type-grid">
            <div class="boost-type-card selected" onclick="selectBoostType(this,'social')">📱<span>TikTok/Instagram</span></div>
            <div class="boost-type-card" onclick="selectBoostType(this,'seo')">🔍<span>SEO Google</span></div>
            <div class="boost-type-card" onclick="selectBoostType(this,'ads')">🎨<span>Ads</span></div>
            <div class="boost-type-card" onclick="selectBoostType(this,'email')">📧<span>Email marketing</span></div>
            <div class="boost-type-card" onclick="selectBoostType(this,'strategy')">📊<span>90-day strategy</span></div>
            <div class="boost-type-card" onclick="selectBoostType(this,'coach')">🤖<span>Coach IA</span></div>
          </div>
        </div>
        <div class="edit-section" style="margin-bottom:12px">
          <h3>My project</h3>
          <div class="edit-grid">
            <div class="fg"><label>Name</label><input type="text" id="boost-name" placeholder="My awesome project"/></div>
            <div class="fg"><label>Type</label><select id="boost-proj-type"><option>Website</option><option>Application</option><option>SaaS</option><option>TikTok</option><option>Instagram</option></select></div>
            <div class="fg"><label>Target</label><input type="text" id="boost-target" placeholder="Creators 18-30"/></div>
            <div class="fg"><label>Goal</label><input type="text" id="boost-goal" placeholder="1000 followers in 30 days"/></div>
          </div>
          <div class="fg"><label>Description</label><textarea id="boost-desc" rows="2" placeholder="Describe your project..."></textarea></div>
        </div>
        <button class="btn-publish" style="width:100%;padding:13px;font-size:14px" id="btn-ia-boost" onclick="runIABoost()">⚡ Generate my strategy</button>
        <div id="boost-output-box" style="display:none;margin-top:14px;background:var(--s1);border:1.5px solid var(--border);border-radius:12px;padding:18px">
          <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:10px">
            <span style="font-family:'DM Mono',monospace;font-size:10px;color:var(--g3);letter-spacing:1px">STRATEGY GENERATED</span>
            <button onclick="navigator.clipboard.writeText(document.getElementById('boost-output-text').textContent).then(()=>toast('📋 Copied!'))" style="background:transparent;border:1px solid var(--border);border-radius:4px;padding:3px 10px;font-size:11px;color:var(--muted);cursor:pointer;font-family:'Plus Jakarta Sans',sans-serif">Copy</button>
          </div>
          <div id="boost-output-text" style="font-size:13px;line-height:1.9;color:#7a9a82;white-space:pre-wrap"></div>
        </div>
      </div>
    </div>

    <!-- GROUPES DISCUSSION -->
    <div class="tpanel" id="tab-groups">
      <div style="max-width:900px;margin:0 auto;padding:22px 0">
        <div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:18px;flex-wrap:wrap;gap:10px">
          <div>
            <h2 style="font-family:'Bebas Neue',sans-serif;font-size:30px;letter-spacing:2px;color:var(--g3);margin-bottom:2px">GROUPES DE DISCUSSION</h2>
            <p style="font-size:12px;color:var(--muted)">Join or create themed groups (create = ELITE plan)</p>
          </div>
          <button class="btn-publish" id="btn-create-group" onclick="openCreateGroup()" style="display:none">🏛️ Create a group</button>
        </div>
        <div id="groups-list" style="display:grid;grid-template-columns:repeat(auto-fill,minmax(280px,1fr));gap:14px"></div>
      </div>
    </div>

    <!-- ══ STATS & ANALYTICS ══ -->
    <div class="tpanel" id="tab-stats">
      <div style="max-width:960px;margin:0 auto;padding:22px 0" id="revenue-dashboard-root">
      </div>
    </div>

    <!-- ══ BOOST CREDITS ══ -->
    <div class="tpanel" id="tab-boost-credits">
      <div style="max-width:700px;margin:0 auto;padding:22px 0">
        <h2 style="font-family:'Bebas Neue',sans-serif;font-size:30px;letter-spacing:2px;color:var(--gold);margin-bottom:3px">⚡ VIRAL CREDITS</h2>
        <p style="font-size:12px;color:var(--muted);margin-bottom:16px">Earn credits via missions and badges — spend them to boost your content</p>

        <!-- CREDITS BAR -->
        <div class="credits-bar-v2">
          <div>
            <div class="credits-big" id="user-credits">0</div>
            <div class="credits-sub">⚡ VIRALCREDITS AVAILABLE</div>
          </div>
          <div class="credits-actions">
            <button class="btn-buy-credits" onclick="switchCreditsTab('missions',this)">🎯 Missions</button>
            <button class="btn-buy-credits" onclick="switchCreditsTab('shop',this)" style="background:rgba(22,163,74,0.1);border-color:rgba(22,163,74,0.4);color:var(--g3)">🛒 Shop</button>
            <button class="btn-buy-credits" onclick="switchCreditsTab('packs',this)">💳 Buy</button>
          </div>
        </div>

        <!-- TABS -->
        <div class="credits-tabs">
          <button class="credits-tab active" id="ctab-missions" onclick="switchCreditsTab('missions',this)">🎯 Missions</button>
          <button class="credits-tab" id="ctab-shop" onclick="switchCreditsTab('shop',this)">🛒 Shop</button>
          <button class="credits-tab" id="ctab-plans" onclick="switchCreditsTab('plans',this)">🎁 Plans</button>
          <button class="credits-tab" id="ctab-boost" onclick="switchCreditsTab('boost',this)">🚀 Booster</button>
          <button class="credits-tab" id="ctab-packs" onclick="switchCreditsTab('packs',this)">💳 Buy</button>
        </div>

        <!-- MISSIONS -->
        <div class="cpanel active" id="cpanel-missions">
          <div class="missions-reset" id="missions-reset-timer">Reset in <span id="missions-countdown">--:--:--</span></div>
          <div id="missions-list"></div>
          <div style="margin-top:20px;background:rgba(255,215,0,0.04);border:1.5px solid rgba(255,215,0,0.15);border-radius:10px;padding:14px 16px;">
            <div style="font-family:'DM Mono',monospace;font-size:10px;color:var(--gold);letter-spacing:2px;margin-bottom:10px">🏅 BADGES → CREDITS</div>
            <div style="font-size:12px;color:var(--muted);line-height:1.8">
              Each unlocked badge automatically gives credits.<br>
              <span style="color:var(--g4)">📝 Premiers badges</span> → <b style="color:var(--gold)">+5 to +15⚡</b> &nbsp;|&nbsp;
              <span style="color:var(--g4)">🟢 Starter/Pro</span> → <b style="color:var(--gold)">+20 to +50⚡</b> &nbsp;|&nbsp;
              <span style="color:var(--gold)">👑 Special badges</span> → <b style="color:var(--gold)">+100 to +200⚡</b>
            </div>
          </div>
        </div>

        <!-- SHOP -->
        <div class="cpanel" id="cpanel-shop">
          <!-- ── BUY A PLAN WITH CREDITS ── -->
          <div style="background:linear-gradient(135deg,rgba(22,163,74,0.08),rgba(74,222,128,0.04));border:2px solid rgba(22,163,74,0.3);border-radius:14px;padding:18px 20px;margin-bottom:20px">
            <div style="display:flex;align-items:center;gap:10px;margin-bottom:14px">
              <span style="font-size:28px">🎁</span>
              <div>
                <div style="font-family:'Bebas Neue',sans-serif;font-size:20px;letter-spacing:2px;color:var(--g3)">PAY YOUR PLAN WITH CREDITS</div>
                <div style="font-size:11px;color:var(--muted)">Earn credits and upgrade without a credit card</div>
              </div>
            </div>
            <div style="display:grid;grid-template-columns:repeat(3,1fr);gap:10px">
              <div style="background:var(--s1);border:1.5px solid var(--border2);border-radius:10px;padding:14px;text-align:center;cursor:pointer;transition:all 0.2s" onclick="buyPlanWithCredits('starter')" onmouseover="this.style.borderColor='var(--g3)'" onmouseout="this.style.borderColor='rgba(34,197,94,0.08)'">
                <div style="font-family:'Bebas Neue',sans-serif;font-size:18px;color:var(--g3);letter-spacing:1px">STARTER</div>
                <div style="font-family:'DM Mono',monospace;font-size:22px;color:var(--gold);font-weight:700;margin:6px 0">800<span style="font-size:12px">⚡</span></div>
                <div style="font-size:10px;color:var(--muted)">= 3$ · 1 mois</div>
                <button style="margin-top:10px;width:100%;padding:7px;background:var(--g2);border:none;border-radius:6px;font-size:12px;font-weight:700;cursor:pointer;color:var(--bg)">Buy</button>
              </div>
              <div style="background:var(--s1);border:2px solid rgba(22,163,74,0.3);border-radius:10px;padding:14px;text-align:center;cursor:pointer;transition:all 0.2s;position:relative" onclick="buyPlanWithCredits('pro')" onmouseover="this.style.borderColor='var(--g3)'" onmouseout="this.style.borderColor='rgba(22,163,74,0.3)'">
                <div style="position:absolute;top:-8px;left:50%;transform:translateX(-50%);background:var(--g2);color:var(--bg);font-size:8px;font-weight:800;padding:2px 8px;border-radius:3px;letter-spacing:1px;white-space:nowrap">⭐ POPULAR</div>
                <div style="font-family:'Bebas Neue',sans-serif;font-size:18px;color:var(--g3);letter-spacing:1px">PRO</div>
                <div style="font-family:'DM Mono',monospace;font-size:22px;color:var(--gold);font-weight:700;margin:6px 0">3500<span style="font-size:12px">⚡</span></div>
                <div style="font-size:10px;color:var(--muted)">= 14,99$ · 1 mois</div>
                <button style="margin-top:10px;width:100%;padding:7px;background:var(--g2);border:none;border-radius:6px;font-size:12px;font-weight:700;cursor:pointer;color:var(--bg)">Buy</button>
              </div>
              <div style="background:rgba(255,215,0,0.04);border:1.5px solid rgba(255,215,0,0.25);border-radius:10px;padding:14px;text-align:center;cursor:pointer;transition:all 0.2s" onclick="buyPlanWithCredits('elite')" onmouseover="this.style.borderColor='var(--gold)'" onmouseout="this.style.borderColor='rgba(255,215,0,0.25)'">
                <div style="font-family:'Bebas Neue',sans-serif;font-size:18px;color:var(--gold);letter-spacing:1px">ELITE</div>
                <div style="font-family:'DM Mono',monospace;font-size:22px;color:var(--gold);font-weight:700;margin:6px 0">9000<span style="font-size:12px">⚡</span></div>
                <div style="font-size:10px;color:var(--muted)">= 39,99$ · 1 mois</div>
                <button style="margin-top:10px;width:100%;padding:7px;background:linear-gradient(135deg,#ffd700,#ff8c00);border:none;border-radius:6px;font-size:12px;font-weight:700;cursor:pointer;color:#1a0a00">Buy</button>
              </div>
            </div>
            <div style="text-align:center;margin-top:10px;font-size:10px;color:var(--muted2);font-family:'DM Mono',monospace">✓ No credit card · ✓ Instant activation · ✓ 1 month free</div>
          </div>
          <!-- BOOST PUB CARD $2.49 -->
          <div onclick="buyBoostPub()" style="cursor:pointer;background:linear-gradient(135deg,rgba(255,215,0,0.08),rgba(249,115,22,0.06));border:2px solid rgba(255,215,0,0.5);border-radius:14px;padding:18px 20px;margin-bottom:20px;position:relative;transition:all 0.2s;box-shadow:0 0 24px rgba(255,215,0,0.12);" onmouseover="this.style.borderColor='rgba(255,215,0,0.8)';this.style.boxShadow='0 0 36px rgba(255,215,0,0.22)'" onmouseout="this.style.borderColor='rgba(255,215,0,0.5)';this.style.boxShadow='0 0 24px rgba(255,215,0,0.12)'">
            <div style="position:absolute;top:-10px;left:20px;background:linear-gradient(135deg,#b45309,#ffd700);color:#1a0a00;font-family:'DM Mono',monospace;font-size:9px;font-weight:700;padding:3px 12px;border-radius:4px;letter-spacing:1px;">&#9889; BEST VALUE</div>
            <div style="display:flex;align-items:center;gap:14px;">
              <div style="font-size:42px;line-height:1;flex-shrink:0;">&#128640;</div>
              <div style="flex:1;">
                <div style="font-family:'Bebas Neue',sans-serif;font-size:22px;letter-spacing:2px;color:#ffd700;margin-bottom:2px;">BOOST PUB — $2.49</div>
                <div style="font-size:12px;color:#c4d9cb;line-height:1.6;margin-bottom:8px;">Propulse ta pub au <strong style="color:#ffd700;">maximum de visibilité</strong> pendant 48h — peu importe ton abonnement. Top du feed, showcase prioritaire, notif communauté.</div>
                <div style="display:flex;gap:8px;flex-wrap:wrap;">
                  <span style="font-family:'DM Mono',monospace;font-size:9px;background:rgba(255,215,0,0.12);border:1px solid rgba(255,215,0,0.3);border-radius:3px;padding:2px 8px;color:#ffd700;">&#9650; Top Feed 48h</span>
                  <span style="font-family:'DM Mono',monospace;font-size:9px;background:rgba(255,215,0,0.12);border:1px solid rgba(255,215,0,0.3);border-radius:3px;padding:2px 8px;color:#ffd700;">&#10024; Showcase #1</span>
                  <span style="font-family:'DM Mono',monospace;font-size:9px;background:rgba(255,215,0,0.12);border:1px solid rgba(255,215,0,0.3);border-radius:3px;padding:2px 8px;color:#ffd700;">&#128276; Push Notif</span>
                </div>
              </div>
              <div style="text-align:center;flex-shrink:0;">
                <div style="font-family:'Bebas Neue',sans-serif;font-size:32px;color:#ffd700;line-height:1;text-shadow:0 0 16px rgba(255,215,0,0.5);">$2.49</div>
                <div style="font-size:9px;color:var(--muted);font-family:'DM Mono',monospace;">one-time</div>
              </div>
            </div>
          </div>
          <div class="shop-section-title">🚀 BOOST DE PUBLICATION</div>
          <div class="shop-grid">
            <div class="shop-item" onclick="shopBuy('top-feed',10)">
              <div class="shop-item-emoji">🔝</div>
              <div class="shop-item-name">Top of Feed</div>
              <div class="shop-item-desc">Your ad at the top of the feed for 2h</div>
              <div class="shop-item-price">⚡ 10</div>
            </div>
            <div class="shop-item" onclick="shopBuy('showcase-24h',25)">
              <div class="shop-item-emoji">✨</div>
              <div class="shop-item-name">Showcase 24h</div>
              <div class="shop-item-desc">Pinned in showcase for one day</div>
              <div class="shop-item-price">⚡ 25</div>
            </div>
            <div class="shop-item" onclick="shopBuy('notif-push',50)">
              <div class="shop-item-emoji">🔔</div>
              <div class="shop-item-name">Notif Push</div>
              <div class="shop-item-desc">Notification to entire community</div>
              <div class="shop-item-price">⚡ 50</div>
            </div>
            <div class="shop-item premium" onclick="shopBuy('boost-7j',80)">
              <div class="shop-item-badge">PREMIUM</div>
              <div class="shop-item-emoji">🏆</div>
              <div class="shop-item-name">7-Day Boost</div>
              <div class="shop-item-desc">Featured for one week</div>
              <div class="shop-item-price">⚡ 80</div>
            </div>
          </div>
          <div class="shop-section-title">🎨 PROFILE CUSTOMIZATION</div>
          <div class="shop-grid">
            <div class="shop-item" onclick="shopBuy('cadre-or',30)">
              <div class="shop-item-emoji">🖼️</div>
              <div class="shop-item-name">Golden Frame</div>
              <div class="shop-item-desc">Avatar with animated golden border</div>
              <div class="shop-item-price">⚡ 30</div>
            </div>
            <div class="shop-item premium" onclick="shopBuy('badge-feu',45)">
              <div class="shop-item-badge">RARE</div>
              <div class="shop-item-emoji">🔥</div>
              <div class="shop-item-name">Badge Feu</div>
              <div class="shop-item-desc">Animated flame on your profile</div>
              <div class="shop-item-price">⚡ 45</div>
            </div>
            <div class="shop-item" onclick="shopBuy('emoji-pack',20)">
              <div class="shop-item-emoji">🎭</div>
              <div class="shop-item-name">Pack Emojis+</div>
              <div class="shop-item-desc">15 exclusive emojis for your posts</div>
              <div class="shop-item-price">⚡ 20</div>
            </div>
            <div class="shop-item premium" onclick="shopBuy('title-vip',60)">
              <div class="shop-item-badge">VIP</div>
              <div class="shop-item-emoji">💎</div>
              <div class="shop-item-name">Title VIP</div>
              <div class="shop-item-desc">"VIP" golden badge under your name</div>
              <div class="shop-item-price">⚡ 60</div>
            </div>
          </div>
          <div class="shop-section-title">🤖 AI & TOOLS</div>
          <div class="shop-grid">
            <div class="shop-item" onclick="shopBuy('ia-analysis',15)">
              <div class="shop-item-emoji">🔬</div>
              <div class="shop-item-name">AI Analysis</div>
              <div class="shop-item-desc">Detailed analysis of your ad</div>
              <div class="shop-item-price">⚡ 15</div>
            </div>
            <div class="shop-item" onclick="shopBuy('ia-hashtags',10)">
              <div class="shop-item-emoji">📌</div>
              <div class="shop-item-name">Hashtags IA</div>
              <div class="shop-item-desc">30 viral hashtags generated by AI</div>
              <div class="shop-item-price">⚡ 10</div>
            </div>
            <div class="shop-item premium" onclick="shopBuy('ia-strategie',35)">
              <div class="shop-item-emoji">🗺️</div>
              <div class="shop-item-name">AI Strategy</div>
              <div class="shop-item-desc">Complete 30-day marketing plan</div>
              <div class="shop-item-price">⚡ 35</div>
            </div>
          </div>
          <div id="shop-boost-select-wrap" style="display:none;margin-top:14px;background:var(--s1);border:1.5px solid var(--border2);border-radius:10px;padding:14px;">
            <div style="font-size:12px;font-weight:700;margin-bottom:8px">Choose the post to boost:</div>
            <select id="boost-post-select" style="margin-bottom:10px"><option value="">Choose...</option></select>
            <button class="btn-modal-g" onclick="confirmShopBoost()" style="margin-top:0;padding:9px">⚡ Confirmer le boost</button>
          </div>
        </div>

        <!-- PLANS WITH CREDITS -->
        <div class="cpanel" id="cpanel-plans">
          <div style="text-align:center;margin-bottom:20px">
            <div style="font-family:'Bebas Neue',sans-serif;font-size:24px;letter-spacing:2px;color:var(--g3)">UPGRADE WITH YOUR CREDITS</div>
            <div style="font-size:12px;color:var(--muted);margin-top:4px">Earn credits via missions & badges → upgrade your plan without a credit card</div>
          </div>
          <div style="background:rgba(255,215,0,0.05);border:1.5px solid rgba(255,215,0,0.2);border-radius:12px;padding:14px 18px;margin-bottom:20px;display:flex;align-items:center;justify-content:space-between;flex-wrap:wrap;gap:10px">
            <div><div style="font-size:11px;color:var(--muted);font-family:'DM Mono',monospace;letter-spacing:1px">YOUR CURRENT CREDITS</div><div style="font-family:'Bebas Neue',sans-serif;font-size:42px;color:var(--gold);line-height:1" id="plans-credits-display">0</div></div>
            <div style="text-align:right"><div style="font-size:11px;color:var(--muted)">Your current plan</div><div style="font-family:'Bebas Neue',sans-serif;font-size:22px;color:var(--g3)" id="plans-current-plan">FREE</div></div>
          </div>
          <div style="display:grid;grid-template-columns:1fr;gap:12px" id="credits-plans-grid">

            <!-- STARTER -->
            <div style="background:rgba(34,197,94,0.06);border:1.5px solid rgba(34,197,94,0.3);border-radius:12px;padding:16px 18px;display:flex;align-items:center;justify-content:space-between;gap:16px;flex-wrap:wrap;">
              <div>
                <div style="font-family:'Bebas Neue',sans-serif;font-size:20px;color:#4ade80;letter-spacing:1px;margin-bottom:3px">🚀 STARTER — 800⚡</div>
                <div style="font-size:11px;color:var(--muted);margin-bottom:6px">10 posts/day · Showcase 7 jours · AI Coach 20 req · +200 crédits/mois</div>
                <div style="width:200px;max-width:100%"><div style="height:5px;background:var(--s3);border-radius:3px;overflow:hidden"><div id="starter-progress-bar" style="height:100%;background:#4ade80;border-radius:3px;transition:width 0.4s;width:0%"></div></div><div id="starter-progress-txt" style="font-size:10px;color:var(--muted);margin-top:3px;font-family:'DM Mono',monospace"></div></div>
              </div>
              <button onclick="buyPlanWithCredits('starter')" style="padding:10px 22px;background:#16a34a;border:none;border-radius:8px;font-family:'Plus Jakarta Sans',sans-serif;font-size:13px;font-weight:800;cursor:pointer;color:#fff;white-space:nowrap;flex-shrink:0">Buy →</button>
            </div>

            <!-- PRO -->
            <div style="background:rgba(59,130,246,0.07);border:2px solid rgba(59,130,246,0.4);border-radius:12px;padding:16px 18px;display:flex;align-items:center;justify-content:space-between;gap:16px;flex-wrap:wrap;position:relative;">
              <div style="position:absolute;top:-10px;left:16px;background:linear-gradient(135deg,#1d4ed8,#3b82f6);color:#fff;font-size:9px;font-weight:800;padding:3px 10px;border-radius:3px;letter-spacing:1px">⭐ POPULAIRE</div>
              <div>
                <div style="font-family:'Bebas Neue',sans-serif;font-size:20px;color:#60a5fa;letter-spacing:1px;margin-bottom:3px">⚡ PRO — 3 500⚡</div>
                <div style="font-size:11px;color:var(--muted);margin-bottom:6px">Posts illimités · IA Boost illimité · Stats avancées · +500 crédits/mois</div>
                <div style="width:200px;max-width:100%"><div style="height:5px;background:var(--s3);border-radius:3px;overflow:hidden"><div id="pro-progress-bar" style="height:100%;background:#3b82f6;border-radius:3px;transition:width 0.4s;width:0%"></div></div><div id="pro-progress-txt" style="font-size:10px;color:var(--muted);margin-top:3px;font-family:'DM Mono',monospace"></div></div>
              </div>
              <button onclick="buyPlanWithCredits('pro')" style="padding:10px 22px;background:linear-gradient(135deg,#1d4ed8,#3b82f6);border:none;border-radius:8px;font-family:'Plus Jakarta Sans',sans-serif;font-size:13px;font-weight:800;cursor:pointer;color:#fff;white-space:nowrap;flex-shrink:0">Buy →</button>
            </div>

            <!-- ELITE -->
            <div style="background:rgba(168,85,247,0.07);border:1.5px solid rgba(168,85,247,0.4);border-radius:12px;padding:16px 18px;display:flex;align-items:center;justify-content:space-between;gap:16px;flex-wrap:wrap;">
              <div>
                <div style="font-family:'Bebas Neue',sans-serif;font-size:20px;color:#c084fc;letter-spacing:1px;margin-bottom:3px">👑 ELITE — 9 000⚡</div>
                <div style="font-size:11px;color:var(--muted);margin-bottom:6px">Showcase permanent · 1 call stratégie/mois · Matching prioritaire · +1500 crédits/mois</div>
                <div style="width:200px;max-width:100%"><div style="height:5px;background:var(--s3);border-radius:3px;overflow:hidden"><div id="elite-progress-bar" style="height:100%;background:#a855f7;border-radius:3px;transition:width 0.4s;width:0%"></div></div><div id="elite-progress-txt" style="font-size:10px;color:var(--muted);margin-top:3px;font-family:'DM Mono',monospace"></div></div>
              </div>
              <button onclick="buyPlanWithCredits('elite')" style="padding:10px 22px;background:linear-gradient(135deg,#7c3aed,#a855f7);border:none;border-radius:8px;font-family:'Plus Jakarta Sans',sans-serif;font-size:13px;font-weight:800;cursor:pointer;color:#fff;white-space:nowrap;flex-shrink:0">Buy →</button>
            </div>

            <!-- LEGEND -->
            <div style="background:rgba(249,115,22,0.07);border:1.5px solid rgba(249,115,22,0.45);border-radius:12px;padding:16px 18px;display:flex;align-items:center;justify-content:space-between;gap:16px;flex-wrap:wrap;position:relative;">
              <div style="position:absolute;top:-10px;left:16px;background:linear-gradient(135deg,#c2410c,#f97316);color:#fff;font-size:9px;font-weight:800;padding:3px 10px;border-radius:3px;letter-spacing:1px">🔥 TOP SELLER</div>
              <div>
                <div style="font-family:'Bebas Neue',sans-serif;font-size:20px;color:#fb923c;letter-spacing:1px;margin-bottom:3px">🔥 LEGEND — 18 000⚡</div>
                <div style="font-size:11px;color:var(--muted);margin-bottom:6px">Top 3 showcase garanti · Newsletter hebdo · Account manager · +3000 crédits/mois</div>
                <div style="width:200px;max-width:100%"><div style="height:5px;background:var(--s3);border-radius:3px;overflow:hidden"><div id="legend-progress-bar" style="height:100%;background:#f97316;border-radius:3px;transition:width 0.4s;width:0%"></div></div><div id="legend-progress-txt" style="font-size:10px;color:var(--muted);margin-top:3px;font-family:'DM Mono',monospace"></div></div>
              </div>
              <button onclick="buyPlanWithCredits('legend')" style="padding:10px 22px;background:linear-gradient(135deg,#c2410c,#f97316);border:none;border-radius:8px;font-family:'Plus Jakarta Sans',sans-serif;font-size:13px;font-weight:800;cursor:pointer;color:#fff;white-space:nowrap;flex-shrink:0">Buy →</button>
            </div>

            <!-- VIP -->
            <div style="background:linear-gradient(135deg,rgba(255,215,0,0.08),rgba(255,140,0,0.05));border:2px solid rgba(255,215,0,0.5);border-radius:12px;padding:16px 18px;display:flex;align-items:center;justify-content:space-between;gap:16px;flex-wrap:wrap;box-shadow:0 0 20px rgba(255,215,0,0.1);">
              <div>
                <div style="font-family:'Bebas Neue',sans-serif;font-size:20px;color:#ffd700;letter-spacing:1px;margin-bottom:3px;text-shadow:0 0 12px rgba(255,215,0,0.4)">💎 VIP — 40 000⚡</div>
                <div style="font-size:11px;color:var(--muted);margin-bottom:6px">Showcase #1 permanent · Communauté VIP · Call hebdo · Hotline équipe · +10 000 crédits/mois</div>
                <div style="width:200px;max-width:100%"><div style="height:5px;background:var(--s3);border-radius:3px;overflow:hidden"><div id="vip-progress-bar" style="height:100%;background:linear-gradient(90deg,#ffd700,#ff8c00);border-radius:3px;transition:width 0.4s;width:0%"></div></div><div id="vip-progress-txt" style="font-size:10px;color:var(--muted);margin-top:3px;font-family:'DM Mono',monospace"></div></div>
              </div>
              <button onclick="buyPlanWithCredits('vip')" style="padding:10px 22px;background:linear-gradient(135deg,#b45309,#ffd700);border:none;border-radius:8px;font-family:'Plus Jakarta Sans',sans-serif;font-size:13px;font-weight:800;cursor:pointer;color:#1a0a00;white-space:nowrap;flex-shrink:0">Buy →</button>
            </div>

          </div>
          <div style="margin-top:16px;text-align:center;font-size:11px;color:var(--muted2);font-family:'DM Mono',monospace">
            💡 Earn credits via daily missions and badges to upgrade for free!
          </div>
        </div>

        <!-- BOOST MY AD (shortcut) -->
        <div class="cpanel" id="cpanel-boost">
          <div style="font-family:'DM Mono',monospace;font-size:10px;color:var(--muted);letter-spacing:2px;text-transform:uppercase;margin-bottom:12px">Que veux-tu faire ?</div>
          <div class="boost-options">
            <div class="boost-opt selected" onclick="selectBoostOpt(this,'top-feed')">
              <div class="boost-opt-icon">🔝</div>
              <div class="boost-opt-name">Top of feed</div>
              <div class="boost-opt-cost">⚡ 10 credits</div>
              <div class="boost-opt-desc">Your ad at the top for 2h</div>
            </div>
            <div class="boost-opt" onclick="selectBoostOpt(this,'showcase-24h')">
              <div class="boost-opt-icon">✨</div>
              <div class="boost-opt-name">Showcase 24h</div>
              <div class="boost-opt-cost">⚡ 25 credits</div>
              <div class="boost-opt-desc">Pinned in showcase for one day</div>
            </div>
            <div class="boost-opt" onclick="selectBoostOpt(this,'notif-push')">
              <div class="boost-opt-icon">🔔</div>
              <div class="boost-opt-name">Notification push</div>
              <div class="boost-opt-cost">⚡ 50 credits</div>
              <div class="boost-opt-desc">Notify entire community</div>
            </div>
          </div>
          <div style="margin-bottom:12px">
            <label>Post to boost</label>
            <select id="boost-post-select2" style="margin-top:4px"><option value="">Choose a post...</option></select>
          </div>
          <button class="btn-publish" onclick="applyBoost()" style="width:100%;padding:13px">⚡ Activer le boost</button>
        </div>

        <!-- BUY CREDITS -->
        <div class="cpanel" id="cpanel-packs">
          <div class="shop-section-title">💳 CREDIT PACKS</div>
          <div style="display:grid;grid-template-columns:repeat(3,1fr);gap:10px">
            <div onclick="buyCredits(50,4.99)" style="background:var(--s1);border:1.5px solid var(--border2);border-radius:10px;padding:18px;text-align:center;cursor:pointer;transition:all 0.2s" onmouseover="this.style.borderColor='rgba(34,197,94,0.3)'" onmouseout="this.style.borderColor='var(--border2)'">
              <div style="font-family:'Bebas Neue',sans-serif;font-size:36px;color:var(--g3)">50</div>
              <div style="font-size:10px;color:var(--muted);font-family:'DM Mono',monospace">credits</div>
              <div style="font-size:15px;font-weight:700;margin-top:8px">4,99$</div>
              <div style="font-size:10px;color:var(--muted);margin-top:3px">$0.10/credit</div>
            </div>
            <div onclick="buyCredits(150,12.99)" style="background:var(--s2);border:1.5px solid rgba(34,197,94,0.3);border-radius:10px;padding:18px;text-align:center;cursor:pointer;transition:all 0.2s;position:relative" onmouseover="this.style.borderColor='var(--g3)'" onmouseout="this.style.borderColor='rgba(34,197,94,0.3)'">
              <div style="position:absolute;top:-8px;left:50%;transform:translateX(-50%);background:var(--g2);color:var(--bg);font-size:8px;font-weight:700;padding:2px 8px;border-radius:3px;white-space:nowrap">⭐ POPULAIRE</div>
              <div style="font-family:'Bebas Neue',sans-serif;font-size:36px;color:var(--g3)">150</div>
              <div style="font-size:10px;color:var(--muted);font-family:'DM Mono',monospace">credits</div>
              <div style="font-size:15px;font-weight:700;margin-top:8px">12,99$</div>
              <div style="font-size:10px;color:var(--g4);margin-top:3px">-13% moins cher</div>
            </div>
            <div onclick="buyCredits(400,29.99)" style="background:var(--s1);border:1.5px solid rgba(255,215,0,0.25);border-radius:10px;padding:18px;text-align:center;cursor:pointer;transition:all 0.2s;position:relative" onmouseover="this.style.borderColor='rgba(255,215,0,0.5)'" onmouseout="this.style.borderColor='rgba(255,215,0,0.25)'">
              <div style="position:absolute;top:-8px;left:50%;transform:translateX(-50%);background:linear-gradient(135deg,#ffd700,#ff8c00);color:#1a0a00;font-size:8px;font-weight:700;padding:2px 8px;border-radius:3px;white-space:nowrap">👑 BEST VALUE</div>
              <div style="font-family:'Bebas Neue',sans-serif;font-size:36px;color:var(--gold)">400</div>
              <div style="font-size:10px;color:var(--muted);font-family:'DM Mono',monospace">credits</div>
              <div style="font-size:15px;font-weight:700;margin-top:8px">29,99$</div>
              <div style="font-size:10px;color:var(--gold);margin-top:3px">-25% moins cher</div>
            </div>
          </div>
          <div style="margin-top:14px;background:rgba(34,197,94,0.05);border:1px solid rgba(34,197,94,0.15);border-radius:8px;padding:12px 14px;font-size:11px;color:var(--muted);line-height:1.7">
            💡 <b style="color:var(--g4)">Tip:</b> You can also earn free credits by completing <span style="color:var(--g3);cursor:pointer" onclick="switchCreditsTab('missions',document.getElementById('ctab-missions'))">daily missions</span> and unlocking badges!
          </div>
        </div>

      </div>
    </div>

    <!-- ══ LEADERBOARD ══ -->
    <div class="tpanel" id="tab-leaderboard">
      <div style="max-width:660px;margin:0 auto;padding:22px 0">
        <h2 style="font-family:'Bebas Neue',sans-serif;font-size:30px;letter-spacing:2px;color:var(--g3);margin-bottom:3px">CLASSEMENT</h2>
        <p style="font-size:12px;color:var(--muted);margin-bottom:20px">Top viral posts this week</p>
        <div class="feed-tabs" style="margin-bottom:18px">
          <button class="feed-tab active" onclick="switchLeaderboard('pubs',this)">📢 Viral ads</button>
          <button class="feed-tab" onclick="switchLeaderboard('creators',this)">👤 Creators</button>
          <button class="feed-tab" onclick="switchLeaderboard('showcase',this)">✨ Showcase</button>
        </div>
        <div class="leaderboard-list" id="leaderboard-list"></div>
      </div>
    </div>

    <!-- ══ COLLABS ══ -->
    <div class="tpanel" id="tab-collab">
      <div style="max-width:760px;margin:0 auto;padding:22px 0">
        <h2 style="font-family:'Bebas Neue',sans-serif;font-size:30px;letter-spacing:2px;color:var(--g3);margin-bottom:3px">COLLABORATIONS</h2>
        <p style="font-size:12px;color:var(--muted);margin-bottom:20px">Creators compatible with your profile — AI matched</p>
        <div style="background:rgba(34,197,94,0.05);border:1.5px solid rgba(34,197,94,0.15);border-radius:10px;padding:14px 18px;margin-bottom:20px;display:flex;align-items:center;gap:12px">
          <div style="font-size:24px">🤖</div>
          <div>
            <div style="font-size:13px;font-weight:700;color:var(--g4);margin-bottom:2px">AI Matching enabled</div>
            <div style="font-size:11px;color:var(--muted)">Based on your niche, goals and skills</div>
          </div>
          <button onclick="loadCollabs()" style="margin-left:auto;background:var(--g2);border:none;border-radius:6px;padding:7px 14px;font-size:12px;font-weight:700;cursor:pointer;color:var(--bg)">Refresh</button>
        </div>
        <div id="collab-list">
          <div style="text-align:center;padding:32px;color:var(--muted)">Loading suggestions...</div>
        </div>
      </div>
    </div>

    <!-- ══ EDITORIAL CALENDAR ══ -->
    <div class="tpanel" id="tab-calendrier">
      <div style="max-width:860px;margin:0 auto;padding:22px 0">
        <div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:20px;flex-wrap:wrap;gap:10px">
          <div>
            <h2 style="font-family:'Bebas Neue',sans-serif;font-size:30px;letter-spacing:2px;color:var(--g3);margin-bottom:3px">EDITORIAL CALENDAR</h2>
            <p style="font-size:12px;color:var(--muted)">Plan and visualize your posts</p>
          </div>
          <div style="display:flex;gap:8px">
            <button onclick="calNav(-1)" style="background:var(--s1);border:1.5px solid var(--border2);border-radius:6px;padding:7px 12px;font-size:12px;cursor:pointer;color:var(--muted)">←</button>
            <span id="cal-month-label" style="font-family:'DM Mono',monospace;font-size:12px;color:var(--g4);padding:7px 14px;background:var(--s1);border:1.5px solid var(--border2);border-radius:6px"></span>
            <button onclick="calNav(1)" style="background:var(--s1);border:1.5px solid var(--border2);border-radius:6px;padding:7px 12px;font-size:12px;cursor:pointer;color:var(--muted)">→</button>
          </div>
        </div>
        <div class="cal-header-days">
          <span>MON</span><span>TUE</span><span>WED</span><span>THU</span><span>FRI</span><span>SAT</span><span>SUN</span>
        </div>
        <div class="cal-grid" id="cal-grid"></div>
        <div style="margin-top:20px">
          <div style="font-family:'DM Mono',monospace;font-size:10px;color:var(--g4);letter-spacing:2px;text-transform:uppercase;margin-bottom:10px">🤖 AI-SUGGESTED OPTIMAL TIME SLOTS</div>
          <div id="optimal-slots" style="display:flex;flex-wrap:wrap;gap:6px"></div>
        </div>
      </div>
    </div>

    <!-- ══ A/B TEST IA ══ -->
    <div class="tpanel" id="tab-ab-test">
      <div style="max-width:760px;margin:0 auto;padding:22px 0">
        <h2 style="font-family:'Bebas Neue',sans-serif;font-size:30px;letter-spacing:2px;color:var(--g3);margin-bottom:3px">AI A/B TEST</h2>
        <p style="font-size:12px;color:var(--muted);margin-bottom:20px">AI analyzes your 2 versions and predicts which will convert better</p>
        <div class="ab-compare">
          <div class="ab-side">
            <div class="ab-side-label a">VERSION A</div>
            <textarea id="ab-text-a" rows="4" placeholder="First version of your ad..." style="width:100%;resize:none"></textarea>
          </div>
          <div class="ab-side">
            <div class="ab-side-label b">VERSION B</div>
            <textarea id="ab-text-b" rows="4" placeholder="Second version of your ad..." style="width:100%;resize:none"></textarea>
          </div>
        </div>
        <div class="fg"><label>Ad objective</label><select id="ab-goal"><option value="clicks">Generate clicks</option><option value="followers">Gain followers</option><option value="ventes">Convert to sales</option><option value="notoriete">Brand awareness / Views</option></select></div>
        <button class="btn-publish" onclick="runABTest()" id="btn-ab" style="width:100%;padding:13px;font-size:14px;margin-top:4px">🔬 Analyze with AI</button>
        <div id="ab-result" style="display:none;margin-top:16px" class="ab-result">
          <div class="ab-winner" id="ab-winner-text">Version A wins</div>
          <div class="ab-analysis" id="ab-analysis-text"></div>
        </div>
      </div>
    </div>

    <!-- ══ REVIEWS ══ -->
    <div class="tpanel" id="tab-reviews">
      <div style="max-width:760px;margin:0 auto;padding:22px 0">

        <!-- Header + score global -->
        <div style="display:flex;align-items:center;justify-content:space-between;flex-wrap:wrap;gap:16px;margin-bottom:28px;">
          <div>
            <h2 style="font-family:'Bebas Neue',sans-serif;font-size:30px;letter-spacing:2px;color:var(--white);margin-bottom:3px;">Community Reviews</h2>
            <p style="font-size:12px;color:var(--muted);">Real feedback from verified members of the platform.</p>
          </div>
          <div style="text-align:center;background:var(--s1);border:1.5px solid var(--border2);border-radius:14px;padding:16px 24px;">
            <div style="font-family:'Bebas Neue',sans-serif;font-size:52px;color:var(--g3);line-height:1;text-shadow:0 0 20px rgba(34,197,94,0.3);" id="rv-global-score">4.8</div>
            <div style="color:#facc15;font-size:16px;letter-spacing:3px;margin:4px 0;">★★★★★</div>
            <div style="font-family:'DM Mono',monospace;font-size:10px;color:var(--muted);" id="rv-total-count">0 reviews</div>
          </div>
        </div>

        <!-- Barres de distribution -->
        <div style="background:var(--s1);border:1.5px solid var(--border2);border-radius:12px;padding:18px 20px;margin-bottom:24px;" id="rv-distribution">
          <div style="font-family:'DM Mono',monospace;font-size:10px;color:var(--g3);letter-spacing:2px;text-transform:uppercase;margin-bottom:14px;">RATING BREAKDOWN</div>
          <div id="rv-bars"></div>
        </div>

        <!-- Bouton laisser un avis -->
        <div style="margin-bottom:24px;" id="rv-write-section">
          <button onclick="openWriteReview()" style="width:100%;padding:14px;background:linear-gradient(135deg,var(--g1),var(--g2));border:none;border-radius:10px;font-family:'Plus Jakarta Sans',sans-serif;font-size:14px;font-weight:800;cursor:pointer;color:var(--bg);box-shadow:0 0 20px rgba(34,197,94,0.3);transition:all 0.2s;" onmouseover="this.style.boxShadow='0 0 36px rgba(34,197,94,0.5)'" onmouseout="this.style.boxShadow='0 0 20px rgba(34,197,94,0.3)'">
            ⭐ Leave a review
          </button>
        </div>

        <!-- Formulaire avis (caché par défaut) -->
        <div id="rv-form-box" style="display:none;background:var(--s1);border:1.5px solid rgba(34,197,94,0.3);border-radius:14px;padding:22px;margin-bottom:24px;animation:fadeUp 0.3s ease;">
          <div style="font-family:'Bebas Neue',sans-serif;font-size:20px;letter-spacing:1.5px;color:var(--white);margin-bottom:16px;">YOUR REVIEW</div>
          <!-- Étoiles cliquables -->
          <div style="margin-bottom:16px;">
            <div style="font-family:'DM Mono',monospace;font-size:10px;color:var(--g4);letter-spacing:1.5px;text-transform:uppercase;margin-bottom:8px;">RATING *</div>
            <div id="rv-star-picker" style="display:flex;gap:6px;">
              ${[1,2,3,4,5].map(i=>`<span onclick="setReviewStar(${i})" data-star="${i}" style="font-size:28px;cursor:pointer;transition:transform 0.15s;opacity:0.35;" onmouseover="hoverStar(${i})" onmouseout="unhoverStar()">★</span>`).join('')}
            </div>
          </div>
          <div style="margin-bottom:14px;">
            <div style="font-family:'DM Mono',monospace;font-size:10px;color:var(--g4);letter-spacing:1.5px;text-transform:uppercase;margin-bottom:6px;">YOUR COMMENT *</div>
            <textarea id="rv-comment-input" rows="4" placeholder="Share your experience with ViralBoost — what worked, what you found, what you'd recommend..." style="width:100%;padding:12px 14px;background:rgba(4,10,5,0.85);border:1.5px solid var(--border2);border-radius:10px;font-family:'Plus Jakarta Sans',sans-serif;font-size:13px;color:var(--white);outline:none;resize:vertical;" onfocus="this.style.borderColor='rgba(34,197,94,0.5)'" onblur="this.style.borderColor='var(--border2)'"></textarea>
          </div>
          <div style="display:flex;gap:10px;">
            <button onclick="submitReview()" style="flex:3;padding:13px;background:linear-gradient(135deg,var(--g1),var(--g2));border:none;border-radius:9px;font-family:'Plus Jakarta Sans',sans-serif;font-size:14px;font-weight:800;cursor:pointer;color:var(--bg);">✅ Publish my review</button>
            <button onclick="closeWriteReview()" style="flex:1;padding:13px;background:transparent;border:1.5px solid var(--border);border-radius:9px;font-family:'Plus Jakarta Sans',sans-serif;font-size:13px;font-weight:600;cursor:pointer;color:var(--muted);">Cancel</button>
          </div>
        </div>

        <!-- Liste des avis -->
        <div id="rv-list"></div>
      </div>
    </div>

    <!-- ══ PUBCREATOR — ELITE AD STUDIO ══ -->
    <div class="tpanel" id="tab-pubcreator">
      <div style="max-width:860px;margin:0 auto;padding:22px 0 80px">

        <!-- ELITE LOCK BANNER (shown if not elite) -->
        <div id="pc-elite-lock" style="display:none;text-align:center;padding:60px 20px">
          <div style="font-size:64px;margin-bottom:16px">🔒</div>
          <div style="font-family:'Bebas Neue',sans-serif;font-size:36px;letter-spacing:3px;color:var(--gold);margin-bottom:8px">ELITE FEATURE</div>
          <p style="font-size:14px;color:var(--muted);margin-bottom:28px;max-width:380px;margin-left:auto;margin-right:auto;line-height:1.7">Ad Creator is exclusively available to Elite members. Upgrade now to unlock the full ad creation studio.</p>
          <button onclick="startPayment('elite')" style="padding:14px 40px;background:linear-gradient(135deg,#ffd700,#ff8c00);border:none;border-radius:10px;font-family:'Plus Jakarta Sans',sans-serif;font-size:15px;font-weight:800;cursor:pointer;color:#1a0a00;box-shadow:0 0 28px rgba(255,215,0,0.4)">⭐ Upgrade to Elite →</button>
        </div>

        <!-- MAIN PUBCREATOR UI -->
        <div id="pc-main">
          <!-- Header -->
          <div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:24px;flex-wrap:wrap;gap:12px">
            <div>
              <div style="display:flex;align-items:center;gap:10px;margin-bottom:4px">
                <div style="width:40px;height:40px;border-radius:10px;background:linear-gradient(135deg,#ffd700,#ff8c00);display:flex;align-items:center;justify-content:center;font-size:20px;box-shadow:0 0 16px rgba(255,215,0,0.35)">🎨</div>
                <div>
                  <div style="font-family:'Bebas Neue',sans-serif;font-size:28px;letter-spacing:3px;color:#ffd700;line-height:1">AD CREATOR</div>
                  <div style="font-family:'DM Mono',monospace;font-size:8px;color:rgba(255,215,0,0.5);letter-spacing:2px">ELITE AD STUDIO · PROFESSIONAL</div>
                </div>
                <div style="background:linear-gradient(135deg,#ffd700,#ff8c00);color:#1a0a00;font-family:'DM Mono',monospace;font-size:8px;font-weight:900;padding:3px 10px;border-radius:4px;letter-spacing:1px;align-self:flex-start">ELITE</div>
              </div>
            </div>
            <div style="display:flex;gap:8px;flex-wrap:wrap">
              <button onclick="pcSwitchMode('single')" id="pc-mode-single" style="padding:8px 16px;border-radius:7px;font-family:'DM Mono',monospace;font-size:10px;font-weight:700;letter-spacing:1px;cursor:pointer;border:1.5px solid rgba(255,215,0,0.5);background:rgba(255,215,0,0.12);color:#ffd700;transition:all 0.2s">📢 SINGLE AD</button>
              <button onclick="pcSwitchMode('group')" id="pc-mode-group" style="padding:8px 16px;border-radius:7px;font-family:'DM Mono',monospace;font-size:10px;font-weight:700;letter-spacing:1px;cursor:pointer;border:1.5px solid rgba(255,215,0,0.2);background:transparent;color:rgba(255,215,0,0.5);transition:all 0.2s">🗂️ AD GROUP (5 CATS)</button>
            </div>
          </div>

          <!-- SINGLE AD MODE -->
          <div id="pc-panel-single">
            <!-- Step indicator -->
            <div style="display:flex;gap:0;margin-bottom:24px;background:var(--s1);border:1.5px solid rgba(255,215,0,0.1);border-radius:12px;overflow:hidden">
              <div class="pc-step-item active" id="pcs-1" style="flex:1;padding:12px 8px;text-align:center;cursor:pointer;transition:all 0.2s;border-right:1px solid rgba(255,215,0,0.08)" onclick="pcGoStep(1)">
                <div style="font-size:16px;margin-bottom:3px">⚙️</div>
                <div style="font-family:'DM Mono',monospace;font-size:8px;letter-spacing:1px;color:#ffd700">SETUP</div>
              </div>
              <div class="pc-step-item" id="pcs-2" style="flex:1;padding:12px 8px;text-align:center;cursor:pointer;transition:all 0.2s;border-right:1px solid rgba(255,215,0,0.08);opacity:0.4" onclick="pcGoStep(2)">
                <div style="font-size:16px;margin-bottom:3px">✍️</div>
                <div style="font-family:'DM Mono',monospace;font-size:8px;letter-spacing:1px;color:#ffd700">CONTENT</div>
              </div>
              <div class="pc-step-item" id="pcs-3" style="flex:1;padding:12px 8px;text-align:center;cursor:pointer;transition:all 0.2s;border-right:1px solid rgba(255,215,0,0.08);opacity:0.4" onclick="pcGoStep(3)">
                <div style="font-size:16px;margin-bottom:3px">🎨</div>
                <div style="font-family:'DM Mono',monospace;font-size:8px;letter-spacing:1px;color:#ffd700">VISUAL</div>
              </div>
              <div class="pc-step-item" id="pcs-4" style="flex:1;padding:12px 8px;text-align:center;cursor:pointer;transition:all 0.2s;opacity:0.4" onclick="pcGoStep(4)">
                <div style="font-size:16px;margin-bottom:3px">🚀</div>
                <div style="font-family:'DM Mono',monospace;font-size:8px;letter-spacing:1px;color:#ffd700">LAUNCH</div>
              </div>
            </div>

            <!-- Step 1: Setup -->
            <div id="pcstep-1" class="pc-step-panel" style="animation:fadeUp 0.3s ease">
              <div style="background:var(--s1);border:1.5px solid rgba(255,215,0,0.15);border-radius:14px;padding:22px">
                <div style="font-family:'Bebas Neue',sans-serif;font-size:20px;letter-spacing:2px;color:#ffd700;margin-bottom:16px">⚙️ AD SETUP</div>
                <div style="display:grid;grid-template-columns:1fr 1fr;gap:14px">
                  <div class="fg"><label style="color:rgba(255,215,0,0.7);font-size:11px;font-family:'DM Mono',monospace;letter-spacing:1px">AD NAME *</label><input type="text" id="pc-ad-name" placeholder="e.g. Summer Sale 2025" style="border-color:rgba(255,215,0,0.2)"/></div>
                  <div class="fg"><label style="color:rgba(255,215,0,0.7);font-size:11px;font-family:'DM Mono',monospace;letter-spacing:1px">CATEGORY *</label>
                    <select id="pc-ad-cat" style="border-color:rgba(255,215,0,0.2)">
                      <option value="">Select category…</option>
                      <option>🛍️ E-commerce / Product</option>
                      <option>🚀 SaaS / App</option>
                      <option>💻 Freelance / Service</option>
                      <option>📚 Course / Formation</option>
                      <option>🤝 Collab / Partnership</option>
                      <option>🎯 Campaign / Event</option>
                      <option>💡 Other</option>
                    </select>
                  </div>
                  <div class="fg"><label style="color:rgba(255,215,0,0.7);font-size:11px;font-family:'DM Mono',monospace;letter-spacing:1px">TARGET AUDIENCE</label><input type="text" id="pc-ad-target" placeholder="e.g. Entrepreneurs 25-40"/></div>
                  <div class="fg"><label style="color:rgba(255,215,0,0.7);font-size:11px;font-family:'DM Mono',monospace;letter-spacing:1px">OBJECTIVE</label>
                    <select id="pc-ad-objective" style="border-color:rgba(255,215,0,0.2)">
                      <option>🔗 Drive traffic to website</option>
                      <option>👥 Grow followers/community</option>
                      <option>💰 Generate direct sales</option>
                      <option>📧 Collect leads / emails</option>
                      <option>🤝 Find collaborators</option>
                      <option>🏷️ Brand awareness</option>
                    </select>
                  </div>
                  <div class="fg" style="grid-column:span 2"><label style="color:rgba(255,215,0,0.7);font-size:11px;font-family:'DM Mono',monospace;letter-spacing:1px">WEBSITE / LINK</label><input type="url" id="pc-ad-url" placeholder="https://yoursite.com"/></div>
                </div>
                <div style="display:flex;gap:8px;flex-wrap:wrap;margin-top:6px">
                  <span style="font-family:'DM Mono',monospace;font-size:9px;background:rgba(255,215,0,0.06);border:1px solid rgba(255,215,0,0.15);border-radius:3px;padding:3px 10px;color:rgba(255,215,0,0.5)">🏅 Elite = permanent showcase</span>
                  <span style="font-family:'DM Mono',monospace;font-size:9px;background:rgba(255,215,0,0.06);border:1px solid rgba(255,215,0,0.15);border-radius:3px;padding:3px 10px;color:rgba(255,215,0,0.5)">📊 Full analytics included</span>
                  <span style="font-family:'DM Mono',monospace;font-size:9px;background:rgba(255,215,0,0.06);border:1px solid rgba(255,215,0,0.15);border-radius:3px;padding:3px 10px;color:rgba(255,215,0,0.5)">🎯 Priority feed placement</span>
                </div>
              </div>
              <div style="display:flex;justify-content:flex-end;margin-top:14px">
                <button onclick="pcNextStep(1)" style="padding:12px 32px;background:linear-gradient(135deg,#ffd700,#ff8c00);border:none;border-radius:8px;font-family:'Plus Jakarta Sans',sans-serif;font-size:13px;font-weight:800;cursor:pointer;color:#1a0a00;box-shadow:0 0 16px rgba(255,215,0,0.3)">Next — Content →</button>
              </div>
            </div>

            <!-- Step 2: Content -->
            <div id="pcstep-2" class="pc-step-panel" style="display:none;animation:fadeUp 0.3s ease">
              <div style="background:var(--s1);border:1.5px solid rgba(255,215,0,0.15);border-radius:14px;padding:22px">
                <div style="font-family:'Bebas Neue',sans-serif;font-size:20px;letter-spacing:2px;color:#ffd700;margin-bottom:16px">✍️ AD CONTENT</div>
                <div style="display:flex;flex-direction:column;gap:14px">
                  <div class="fg"><label style="color:rgba(255,215,0,0.7);font-size:11px;font-family:'DM Mono',monospace;letter-spacing:1px">HEADLINE *</label><input type="text" id="pc-ad-headline" placeholder="Your powerful, attention-grabbing headline"/></div>
                  <div class="fg"><label style="color:rgba(255,215,0,0.7);font-size:11px;font-family:'DM Mono',monospace;letter-spacing:1px">HOOK / TAGLINE</label><input type="text" id="pc-ad-hook" placeholder="Short punchy line that hooks them in"/></div>
                  <div class="fg"><label style="color:rgba(255,215,0,0.7);font-size:11px;font-family:'DM Mono',monospace;letter-spacing:1px">MAIN BODY *</label><textarea id="pc-ad-body" rows="5" placeholder="Full description of your offer, service, or product. Include key benefits, pricing, and a clear call-to-action." style="border-color:rgba(255,215,0,0.2)"></textarea></div>
                  <div style="display:grid;grid-template-columns:1fr 1fr;gap:14px">
                    <div class="fg"><label style="color:rgba(255,215,0,0.7);font-size:11px;font-family:'DM Mono',monospace;letter-spacing:1px">CTA BUTTON TEXT</label><input type="text" id="pc-ad-cta" placeholder="e.g. Get started, Learn more, Grab deal…"/></div>
                    <div class="fg"><label style="color:rgba(255,215,0,0.7);font-size:11px;font-family:'DM Mono',monospace;letter-spacing:1px">TAGS (comma-separated)</label><input type="text" id="pc-ad-tags" placeholder="marketing, saas, growth"/></div>
                  </div>
                </div>
                <!-- AI Assist -->
                <div style="margin-top:16px;background:rgba(255,215,0,0.04);border:1px solid rgba(255,215,0,0.12);border-radius:10px;padding:14px">
                  <div style="font-family:'DM Mono',monospace;font-size:9px;color:#ffd700;letter-spacing:1.5px;margin-bottom:8px">🤖 AI COPYWRITER ASSIST</div>
                  <div style="display:flex;gap:8px;flex-wrap:wrap">
                    <button onclick="pcAIAssist('headline')" style="padding:6px 14px;background:rgba(255,215,0,0.08);border:1px solid rgba(255,215,0,0.2);border-radius:5px;font-size:10px;color:#ffd700;cursor:pointer;font-family:'DM Mono',monospace;letter-spacing:0.5px">✨ Generate headline</button>
                    <button onclick="pcAIAssist('hook')" style="padding:6px 14px;background:rgba(255,215,0,0.08);border:1px solid rgba(255,215,0,0.2);border-radius:5px;font-size:10px;color:#ffd700;cursor:pointer;font-family:'DM Mono',monospace;letter-spacing:0.5px">⚡ Generate hook</button>
                    <button onclick="pcAIAssist('body')" style="padding:6px 14px;background:rgba(255,215,0,0.08);border:1px solid rgba(255,215,0,0.2);border-radius:5px;font-size:10px;color:#ffd700;cursor:pointer;font-family:'DM Mono',monospace;letter-spacing:0.5px">📝 Write body copy</button>
                    <button onclick="pcAIAssist('full')" style="padding:6px 14px;background:linear-gradient(135deg,rgba(255,215,0,0.15),rgba(255,140,0,0.1));border:1px solid rgba(255,215,0,0.35);border-radius:5px;font-size:10px;color:#ffd700;cursor:pointer;font-family:'DM Mono',monospace;letter-spacing:0.5px;font-weight:700">🚀 Generate full ad</button>
                  </div>
                  <div id="pc-ai-loading" style="display:none;margin-top:10px;font-family:'DM Mono',monospace;font-size:10px;color:rgba(255,215,0,0.6);animation:blink 1s infinite">⏳ Generating with AI...</div>
                </div>
              </div>
              <div style="display:flex;gap:10px;justify-content:space-between;margin-top:14px">
                <button onclick="pcPrevStep(2)" style="padding:12px 24px;background:transparent;border:1.5px solid rgba(255,215,0,0.2);border-radius:8px;font-size:13px;font-weight:700;cursor:pointer;color:rgba(255,215,0,0.5)">← Back</button>
                <button onclick="pcNextStep(2)" style="padding:12px 32px;background:linear-gradient(135deg,#ffd700,#ff8c00);border:none;border-radius:8px;font-family:'Plus Jakarta Sans',sans-serif;font-size:13px;font-weight:800;cursor:pointer;color:#1a0a00;box-shadow:0 0 16px rgba(255,215,0,0.3)">Next — Visual →</button>
              </div>
            </div>

            <!-- Step 3: Visual -->
            <div id="pcstep-3" class="pc-step-panel" style="display:none;animation:fadeUp 0.3s ease">
              <div style="background:var(--s1);border:1.5px solid rgba(255,215,0,0.15);border-radius:14px;padding:22px">
                <div style="font-family:'Bebas Neue',sans-serif;font-size:20px;letter-spacing:2px;color:#ffd700;margin-bottom:16px">🎨 VISUAL & STYLING</div>
                <div style="display:grid;grid-template-columns:1fr 1fr;gap:14px;margin-bottom:16px">
                  <div>
                    <div style="font-family:'DM Mono',monospace;font-size:9px;color:rgba(255,215,0,0.6);letter-spacing:1px;margin-bottom:8px">AD EMOJI / ICON</div>
                    <div style="display:flex;gap:8px;flex-wrap:wrap">
                      <span id="pc-emoji-selected" style="font-size:28px;cursor:pointer;background:var(--s2);border:1.5px solid rgba(255,215,0,0.3);border-radius:8px;padding:6px 12px;display:inline-flex;align-items:center" onclick="pcOpenEmojiPicker()">🚀</span>
                      <input type="text" id="pc-emoji-input" placeholder="or type one" style="flex:1;border-color:rgba(255,215,0,0.2);font-size:18px" maxlength="2" oninput="document.getElementById('pc-emoji-selected').textContent=this.value||'🚀'"/>
                    </div>
                  </div>
                  <div>
                    <div style="font-family:'DM Mono',monospace;font-size:9px;color:rgba(255,215,0,0.6);letter-spacing:1px;margin-bottom:8px">COLOR ACCENT</div>
                    <div style="display:flex;gap:6px;flex-wrap:wrap" id="pc-color-picker">
                      <div onclick="pcSelectColor('#22c55e')" style="width:32px;height:32px;border-radius:6px;background:#22c55e;cursor:pointer;border:2px solid transparent;transition:all 0.2s" onmouseover="this.style.transform='scale(1.1)'" onmouseout="this.style.transform=''"></div>
                      <div onclick="pcSelectColor('#ffd700')" style="width:32px;height:32px;border-radius:6px;background:#ffd700;cursor:pointer;border:2px solid #ffd700;transition:all 0.2s" onmouseover="this.style.transform='scale(1.1)'" onmouseout="this.style.transform=''"></div>
                      <div onclick="pcSelectColor('#a855f7')" style="width:32px;height:32px;border-radius:6px;background:#a855f7;cursor:pointer;border:2px solid transparent;transition:all 0.2s" onmouseover="this.style.transform='scale(1.1)'" onmouseout="this.style.transform=''"></div>
                      <div onclick="pcSelectColor('#f97316')" style="width:32px;height:32px;border-radius:6px;background:#f97316;cursor:pointer;border:2px solid transparent;transition:all 0.2s" onmouseover="this.style.transform='scale(1.1)'" onmouseout="this.style.transform=''"></div>
                      <div onclick="pcSelectColor('#38bdf8')" style="width:32px;height:32px;border-radius:6px;background:#38bdf8;cursor:pointer;border:2px solid transparent;transition:all 0.2s" onmouseover="this.style.transform='scale(1.1)'" onmouseout="this.style.transform=''"></div>
                      <div onclick="pcSelectColor('#f43f5e')" style="width:32px;height:32px;border-radius:6px;background:#f43f5e;cursor:pointer;border:2px solid transparent;transition:all 0.2s" onmouseover="this.style.transform='scale(1.1)'" onmouseout="this.style.transform=''"></div>
                    </div>
                  </div>
                </div>
                <div>
                  <div style="font-family:'DM Mono',monospace;font-size:9px;color:rgba(255,215,0,0.6);letter-spacing:1px;margin-bottom:8px">UPLOAD BANNER IMAGE</div>
                  <label style="display:flex;align-items:center;gap:12px;background:var(--s2);border:2px dashed rgba(255,215,0,0.2);border-radius:10px;padding:16px;cursor:pointer;transition:all 0.2s" id="pc-banner-drop" onmouseover="this.style.borderColor='rgba(255,215,0,0.5)'" onmouseout="this.style.borderColor='rgba(255,215,0,0.2)'">
                    <span style="font-size:28px">🖼️</span>
                    <div>
                      <div style="font-size:12px;font-weight:700;color:rgba(255,215,0,0.7)">Click to upload banner (optional)</div>
                      <div style="font-size:10px;color:var(--muted2)">PNG, JPG · 16:9 recommended · Max 5MB</div>
                    </div>
                    <input type="file" id="pc-banner-input" accept="image/*" style="display:none" onchange="pcHandleBanner(this)"/>
                  </label>
                  <div id="pc-banner-preview" style="margin-top:10px"></div>
                </div>
                <!-- Live preview -->
                <div style="margin-top:20px">
                  <div style="font-family:'DM Mono',monospace;font-size:9px;color:rgba(255,215,0,0.6);letter-spacing:1px;margin-bottom:10px">👁️ LIVE PREVIEW</div>
                  <div id="pc-live-preview" style="background:linear-gradient(135deg,var(--s1),var(--s2));border:2px solid rgba(255,215,0,0.3);border-radius:14px;overflow:hidden;box-shadow:0 8px 32px rgba(0,0,0,0.5)">
                    <div id="pc-preview-banner" style="height:80px;background:linear-gradient(135deg,#1c1200,#0e0800);display:flex;align-items:center;justify-content:center;font-size:36px;position:relative">
                      <span id="pc-preview-emoji">🚀</span>
                      <div style="position:absolute;top:8px;right:10px;font-family:'DM Mono',monospace;font-size:8px;background:linear-gradient(135deg,#ffd700,#ff8c00);color:#1a0a00;padding:2px 8px;border-radius:3px;font-weight:700">⭐ ELITE</div>
                    </div>
                    <div style="padding:14px 16px">
                      <div id="pc-preview-headline" style="font-family:'Bebas Neue',sans-serif;font-size:18px;letter-spacing:1px;color:#f0fdf4;margin-bottom:4px">Your headline here…</div>
                      <div id="pc-preview-hook" style="font-size:11px;color:#ffd700;font-weight:700;margin-bottom:8px">Your hook here…</div>
                      <div id="pc-preview-body" style="font-size:11px;color:var(--muted);line-height:1.6">Your ad body will appear here…</div>
                    </div>
                  </div>
                </div>
              </div>
              <div style="display:flex;gap:10px;justify-content:space-between;margin-top:14px">
                <button onclick="pcPrevStep(3)" style="padding:12px 24px;background:transparent;border:1.5px solid rgba(255,215,0,0.2);border-radius:8px;font-size:13px;font-weight:700;cursor:pointer;color:rgba(255,215,0,0.5)">← Back</button>
                <button onclick="pcNextStep(3)" style="padding:12px 32px;background:linear-gradient(135deg,#ffd700,#ff8c00);border:none;border-radius:8px;font-family:'Plus Jakarta Sans',sans-serif;font-size:13px;font-weight:800;cursor:pointer;color:#1a0a00;box-shadow:0 0 16px rgba(255,215,0,0.3)">Next — Launch →</button>
              </div>
            </div>

            <!-- Step 4: Launch -->
            <div id="pcstep-4" class="pc-step-panel" style="display:none;animation:fadeUp 0.3s ease">
              <div style="background:var(--s1);border:2px solid rgba(255,215,0,0.3);border-radius:14px;padding:22px">
                <div style="font-family:'Bebas Neue',sans-serif;font-size:20px;letter-spacing:2px;color:#ffd700;margin-bottom:16px">🚀 LAUNCH & DISTRIBUTION</div>
                <div style="display:grid;grid-template-columns:1fr 1fr;gap:12px;margin-bottom:18px">
                  <label style="display:flex;align-items:center;gap:10px;background:rgba(34,197,94,0.06);border:1.5px solid rgba(34,197,94,0.2);border-radius:10px;padding:12px;cursor:pointer">
                    <input type="checkbox" id="pc-launch-feed" checked style="width:16px;height:16px;accent-color:var(--g3)"/>
                    <div><div style="font-size:12px;font-weight:700;color:var(--g4)">📰 Publish to Feed</div><div style="font-size:10px;color:var(--muted)">Visible to all community members</div></div>
                  </label>
                  <label style="display:flex;align-items:center;gap:10px;background:rgba(168,85,247,0.06);border:1.5px solid rgba(168,85,247,0.2);border-radius:10px;padding:12px;cursor:pointer">
                    <input type="checkbox" id="pc-launch-showcase" checked style="width:16px;height:16px;accent-color:#a855f7"/>
                    <div><div style="font-size:12px;font-weight:700;color:#c084fc">✨ Add to Showcase</div><div style="font-size:10px;color:var(--muted)">Elite = permanent listing</div></div>
                  </label>
                  <label style="display:flex;align-items:center;gap:10px;background:rgba(255,215,0,0.06);border:1.5px solid rgba(255,215,0,0.2);border-radius:10px;padding:12px;cursor:pointer">
                    <input type="checkbox" id="pc-launch-top" style="width:16px;height:16px;accent-color:#ffd700"/>
                    <div><div style="font-size:12px;font-weight:700;color:#ffd700">⭐ Pin to Top Feed</div><div style="font-size:10px;color:var(--muted)">48h priority · costs 50⚡</div></div>
                  </label>
                  <label style="display:flex;align-items:center;gap:10px;background:rgba(251,146,60,0.06);border:1.5px solid rgba(251,146,60,0.2);border-radius:10px;padding:12px;cursor:pointer">
                    <input type="checkbox" id="pc-launch-notif" style="width:16px;height:16px;accent-color:#fb923c"/>
                    <div><div style="font-size:12px;font-weight:700;color:#fb923c">🔔 Push Notification</div><div style="font-size:10px;color:var(--muted)">Alert community · costs 50⚡</div></div>
                  </label>
                </div>
                <!-- Final ad summary -->
                <div style="background:var(--s2);border:1px solid rgba(255,215,0,0.12);border-radius:10px;padding:14px;margin-bottom:16px">
                  <div style="font-family:'DM Mono',monospace;font-size:9px;color:rgba(255,215,0,0.5);letter-spacing:1px;margin-bottom:10px">📋 FINAL SUMMARY</div>
                  <div id="pc-launch-summary" style="font-size:12px;color:var(--muted);line-height:2"></div>
                </div>
              </div>
              <div style="display:flex;gap:10px;justify-content:space-between;margin-top:14px">
                <button onclick="pcPrevStep(4)" style="padding:12px 24px;background:transparent;border:1.5px solid rgba(255,215,0,0.2);border-radius:8px;font-size:13px;font-weight:700;cursor:pointer;color:rgba(255,215,0,0.5)">← Back</button>
                <button onclick="pcLaunchSingle()" style="padding:13px 40px;background:linear-gradient(135deg,#ffd700,#ff8c00);border:none;border-radius:9px;font-family:'Plus Jakarta Sans',sans-serif;font-size:15px;font-weight:800;cursor:pointer;color:#1a0a00;box-shadow:0 0 24px rgba(255,215,0,0.45);display:flex;align-items:center;gap:8px">🚀 Launch Ad Now!</button>
              </div>
            </div>
          </div><!-- /pc-panel-single -->

          <!-- ══ AD GROUP MODE — 5 CATEGORY ADS ══ -->
          <div id="pc-panel-group" style="display:none">
            <div style="background:linear-gradient(135deg,rgba(255,215,0,0.08),rgba(255,140,0,0.04));border:2px solid rgba(255,215,0,0.3);border-radius:14px;padding:20px;margin-bottom:20px">
              <div style="display:flex;align-items:center;gap:12px;margin-bottom:6px">
                <div style="font-size:28px">🗂️</div>
                <div>
                  <div style="font-family:'Bebas Neue',sans-serif;font-size:22px;letter-spacing:2px;color:#ffd700">AD GROUP CREATOR</div>
                  <div style="font-size:12px;color:rgba(255,215,0,0.5)">Define a campaign name, then configure 5 individual category ads that launch together</div>
                </div>
              </div>
            </div>

            <!-- Campaign name -->
            <div style="background:var(--s1);border:1.5px solid rgba(255,215,0,0.15);border-radius:12px;padding:18px;margin-bottom:18px">
              <div style="font-family:'DM Mono',monospace;font-size:9px;color:rgba(255,215,0,0.6);letter-spacing:1.5px;margin-bottom:10px">CAMPAIGN NAME</div>
              <input type="text" id="pcg-campaign-name" placeholder="e.g. My Brand Launch — Spring 2025" style="border-color:rgba(255,215,0,0.25);font-size:15px;font-weight:600"/>
            </div>

            <!-- 5 Category Ad Cards -->
            <div id="pcg-ads-container" style="display:flex;flex-direction:column;gap:14px;margin-bottom:22px"></div>

            <!-- Launch all button -->
            <div style="background:linear-gradient(135deg,rgba(255,215,0,0.06),rgba(255,140,0,0.03));border:2px solid rgba(255,215,0,0.25);border-radius:12px;padding:18px;text-align:center">
              <div style="font-size:13px;color:rgba(255,215,0,0.6);margin-bottom:14px;font-family:'DM Mono',monospace;letter-spacing:0.5px">5 ads will be published simultaneously across feed, showcase &amp; community</div>
              <button onclick="pcLaunchGroup()" style="padding:14px 48px;background:linear-gradient(135deg,#ffd700,#ff8c00);border:none;border-radius:10px;font-family:'Plus Jakarta Sans',sans-serif;font-size:16px;font-weight:900;cursor:pointer;color:#1a0a00;box-shadow:0 0 32px rgba(255,215,0,0.5),0 4px 16px rgba(0,0,0,0.4);letter-spacing:0.5px">🚀 Launch All 5 Ads Now!</button>
            </div>
          </div><!-- /pc-panel-group -->

        </div><!-- /pc-main -->
      </div>
    </div><!-- /tab-pubcreator -->

    <!-- ══ SPONSOR PANEL ══ -->
    <div class="tpanel" id="tab-sponsor">
      <div style="max-width:900px;margin:0 auto;padding:22px 0 80px">

        <!-- HEADER -->
        <div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:28px;flex-wrap:wrap;gap:12px">
          <div style="display:flex;align-items:center;gap:12px">
            <div style="width:46px;height:46px;border-radius:12px;background:linear-gradient(135deg,#f43f5e,#be123c);display:flex;align-items:center;justify-content:center;font-size:22px;box-shadow:0 0 20px rgba(244,63,94,0.4);flex-shrink:0">💼</div>
            <div>
              <div style="font-family:'Bebas Neue',sans-serif;font-size:30px;letter-spacing:3px;color:#f43f5e;line-height:1">SPONSOR PANEL</div>
              <div style="font-family:'DM Mono',monospace;font-size:9px;color:rgba(244,63,94,0.5);letter-spacing:2px">ADVERTISE TO THE ENTIRE COMMUNITY</div>
            </div>
          </div>
          <!-- Budget indicator -->
          <div style="background:rgba(244,63,94,0.07);border:1.5px solid rgba(244,63,94,0.2);border-radius:10px;padding:10px 16px;text-align:center">
            <div style="font-family:'DM Mono',monospace;font-size:8px;color:rgba(244,63,94,0.5);letter-spacing:1.5px;margin-bottom:2px">YOUR SPONSOR BALANCE</div>
            <div style="font-family:'Bebas Neue',sans-serif;font-size:26px;color:#f43f5e;line-height:1" id="sp-balance">$0.00</div>
            <button onclick="spTopUp()" style="margin-top:6px;padding:4px 14px;background:linear-gradient(135deg,#f43f5e,#be123c);border:none;border-radius:5px;font-size:10px;font-weight:700;cursor:pointer;color:#fff;font-family:'DM Mono',monospace;letter-spacing:0.5px">+ Top Up</button>
          </div>
        </div>

        <!-- TABS -->
        <div style="display:flex;gap:0;background:var(--s1);border:1.5px solid rgba(244,63,94,0.12);border-radius:12px;overflow:hidden;margin-bottom:22px">
          <button class="sp-tab active" id="sptab-slots" onclick="spSwitchTab('slots',this)" style="flex:1;padding:12px 8px;background:rgba(244,63,94,0.1);border:none;font-family:'DM Mono',monospace;font-size:10px;font-weight:700;letter-spacing:1px;color:#f43f5e;cursor:pointer;border-right:1px solid rgba(244,63,94,0.1);transition:all 0.2s">📍 AD SLOTS</button>
          <button class="sp-tab" id="sptab-create" onclick="spSwitchTab('create',this)" style="flex:1;padding:12px 8px;background:transparent;border:none;font-family:'DM Mono',monospace;font-size:10px;font-weight:700;letter-spacing:1px;color:rgba(244,63,94,0.4);cursor:pointer;border-right:1px solid rgba(244,63,94,0.1);transition:all 0.2s">✏️ CREATE AD</button>
          <button class="sp-tab" id="sptab-active" onclick="spSwitchTab('active',this)" style="flex:1;padding:12px 8px;background:transparent;border:none;font-family:'DM Mono',monospace;font-size:10px;font-weight:700;letter-spacing:1px;color:rgba(244,63,94,0.4);cursor:pointer;border-right:1px solid rgba(244,63,94,0.1);transition:all 0.2s">📊 MY CAMPAIGNS</button>
          <button class="sp-tab" id="sptab-stats" onclick="spSwitchTab('stats',this)" style="flex:1;padding:12px 8px;background:transparent;border:none;font-family:'DM Mono',monospace;font-size:10px;font-weight:700;letter-spacing:1px;color:rgba(244,63,94,0.4);cursor:pointer;transition:all 0.2s">📈 ANALYTICS</button>
        </div>

        <!-- ── PANEL: AD SLOTS ── -->
        <div id="sppanel-slots" class="sp-panel" style="display:block">
          <div style="font-family:'DM Mono',monospace;font-size:9px;color:rgba(244,63,94,0.6);letter-spacing:2px;margin-bottom:16px">AVAILABLE PLACEMENTS ON VIRALBOOST</div>

          <!-- Slot grid -->
          <div style="display:grid;grid-template-columns:repeat(auto-fill,minmax(270px,1fr));gap:14px;margin-bottom:28px">

            <!-- Slot 1: Feed Banner -->
            <div class="sp-slot-card" style="background:var(--s1);border:1.5px solid rgba(244,63,94,0.2);border-radius:14px;overflow:hidden;transition:all 0.25s;cursor:pointer" onmouseover="this.style.borderColor='rgba(244,63,94,0.6)';this.style.transform='translateY(-3px)';this.style.boxShadow='0 8px 28px rgba(244,63,94,0.12)'" onmouseout="this.style.borderColor='rgba(244,63,94,0.2)';this.style.transform='';this.style.boxShadow=''" onclick="spSelectSlot('feed-banner')">
              <div style="height:80px;background:linear-gradient(135deg,#2d0010,#1a0008);display:flex;align-items:center;justify-content:center;gap:12px;position:relative">
                <span style="font-size:32px">📰</span>
                <div style="position:absolute;top:8px;right:10px;background:#f43f5e;color:#fff;font-family:'DM Mono',monospace;font-size:7px;font-weight:700;padding:2px 7px;border-radius:3px;letter-spacing:1px">🔥 POPULAR</div>
              </div>
              <div style="padding:14px 16px">
                <div style="font-family:'Bebas Neue',sans-serif;font-size:17px;letter-spacing:1.5px;color:#f0fdf4;margin-bottom:4px">FEED SPONSORED POST</div>
                <div style="font-size:11px;color:var(--muted);line-height:1.6;margin-bottom:10px">Your ad appears as a native sponsored post in the main community feed. Seen by every active member.</div>
                <div style="display:flex;gap:6px;flex-wrap:wrap;margin-bottom:12px">
                  <span style="font-family:'DM Mono',monospace;font-size:8px;background:rgba(244,63,94,0.1);border:1px solid rgba(244,63,94,0.2);border-radius:3px;padding:2px 7px;color:#f87171">👁 ~240,000 views/month</span>
                  <span style="font-family:'DM Mono',monospace;font-size:8px;background:rgba(244,63,94,0.1);border:1px solid rgba(244,63,94,0.2);border-radius:3px;padding:2px 7px;color:#f87171">⏱ Every 5 posts</span>
                </div>
                <div style="display:flex;align-items:flex-end;justify-content:space-between">
                  <div><div style="font-family:'DM Mono',monospace;font-size:8px;color:rgba(244,63,94,0.5);letter-spacing:1px;margin-bottom:2px">FROM</div><div style="font-family:'Bebas Neue',sans-serif;font-size:26px;color:#f43f5e;line-height:1">$9.99<span style="font-size:13px;opacity:0.6">/month</span></div></div>
                  <button onclick="spSelectSlot('feed-banner');event.stopPropagation()" style="padding:8px 18px;background:linear-gradient(135deg,#f43f5e,#be123c);border:none;border-radius:7px;font-size:11px;font-weight:700;cursor:pointer;color:#fff">Book →</button>
                </div>
              </div>
            </div>

            <!-- Slot 2: Popup Banner -->
            <div class="sp-slot-card" style="background:var(--s1);border:1.5px solid rgba(244,63,94,0.2);border-radius:14px;overflow:hidden;transition:all 0.25s;cursor:pointer" onmouseover="this.style.borderColor='rgba(244,63,94,0.6)';this.style.transform='translateY(-3px)';this.style.boxShadow='0 8px 28px rgba(244,63,94,0.12)'" onmouseout="this.style.borderColor='rgba(244,63,94,0.2)';this.style.transform='';this.style.boxShadow=''" onclick="spSelectSlot('popup-banner')">
              <div style="height:80px;background:linear-gradient(135deg,#1a001a,#0e000e);display:flex;align-items:center;justify-content:center;gap:12px;position:relative">
                <span style="font-size:32px">🔔</span>
                <div style="position:absolute;top:8px;right:10px;background:linear-gradient(135deg,#a855f7,#7c3aed);color:#fff;font-family:'DM Mono',monospace;font-size:7px;font-weight:700;padding:2px 7px;border-radius:3px;letter-spacing:1px">⚡ HIGH CTR</div>
              </div>
              <div style="padding:14px 16px">
                <div style="font-family:'Bebas Neue',sans-serif;font-size:17px;letter-spacing:1.5px;color:#f0fdf4;margin-bottom:4px">POPUP NOTIFICATION AD</div>
                <div style="font-size:11px;color:var(--muted);line-height:1.6;margin-bottom:10px">Floating banner appearing at the bottom of the screen — impossible to miss. Auto-dismiss after 8s.</div>
                <div style="display:flex;gap:6px;flex-wrap:wrap;margin-bottom:12px">
                  <span style="font-family:'DM Mono',monospace;font-size:8px;background:rgba(168,85,247,0.1);border:1px solid rgba(168,85,247,0.2);border-radius:3px;padding:2px 7px;color:#c084fc">👁 ~150,000 views/month</span>
                  <span style="font-family:'DM Mono',monospace;font-size:8px;background:rgba(168,85,247,0.1);border:1px solid rgba(168,85,247,0.2);border-radius:3px;padding:2px 7px;color:#c084fc">🎯 CTR ~12%</span>
                </div>
                <div style="display:flex;align-items:flex-end;justify-content:space-between">
                  <div><div style="font-family:'DM Mono',monospace;font-size:8px;color:rgba(244,63,94,0.5);letter-spacing:1px;margin-bottom:2px">FROM</div><div style="font-family:'Bebas Neue',sans-serif;font-size:26px;color:#f43f5e;line-height:1">$14.99<span style="font-size:13px;opacity:0.6">/month</span></div></div>
                  <button onclick="spSelectSlot('popup-banner');event.stopPropagation()" style="padding:8px 18px;background:linear-gradient(135deg,#f43f5e,#be123c);border:none;border-radius:7px;font-size:11px;font-weight:700;cursor:pointer;color:#fff">Book →</button>
                </div>
              </div>
            </div>

            <!-- Slot 3: Showcase Top -->
            <div class="sp-slot-card" style="background:var(--s1);border:1.5px solid rgba(244,63,94,0.2);border-radius:14px;overflow:hidden;transition:all 0.25s;cursor:pointer" onmouseover="this.style.borderColor='rgba(244,63,94,0.6)';this.style.transform='translateY(-3px)';this.style.boxShadow='0 8px 28px rgba(244,63,94,0.12)'" onmouseout="this.style.borderColor='rgba(244,63,94,0.2)';this.style.transform='';this.style.boxShadow=''" onclick="spSelectSlot('showcase-top')">
              <div style="height:80px;background:linear-gradient(135deg,#0a001a,#050010);display:flex;align-items:center;justify-content:center;gap:12px;position:relative">
                <span style="font-size:32px">✨</span>
                <div style="position:absolute;top:8px;right:10px;background:linear-gradient(135deg,#ffd700,#ff8c00);color:#1a0a00;font-family:'DM Mono',monospace;font-size:7px;font-weight:700;padding:2px 7px;border-radius:3px;letter-spacing:1px">👑 PREMIUM</div>
              </div>
              <div style="padding:14px 16px">
                <div style="font-family:'Bebas Neue',sans-serif;font-size:17px;letter-spacing:1.5px;color:#f0fdf4;margin-bottom:4px">SHOWCASE PINNED TOP</div>
                <div style="font-size:11px;color:var(--muted);line-height:1.6;margin-bottom:10px">Your project pinned at the very top of the Showcase tab with a "Sponsored" gold badge. Permanent visibility.</div>
                <div style="display:flex;gap:6px;flex-wrap:wrap;margin-bottom:12px">
                  <span style="font-family:'DM Mono',monospace;font-size:8px;background:rgba(255,215,0,0.1);border:1px solid rgba(255,215,0,0.2);border-radius:3px;padding:2px 7px;color:#ffd700">👁 ~105,000 views/month</span>
                  <span style="font-family:'DM Mono',monospace;font-size:8px;background:rgba(255,215,0,0.1);border:1px solid rgba(255,215,0,0.2);border-radius:3px;padding:2px 7px;color:#ffd700">🏆 #1 position</span>
                </div>
                <div style="display:flex;align-items:flex-end;justify-content:space-between">
                  <div><div style="font-family:'DM Mono',monospace;font-size:8px;color:rgba(244,63,94,0.5);letter-spacing:1px;margin-bottom:2px">FROM</div><div style="font-family:'Bebas Neue',sans-serif;font-size:26px;color:#f43f5e;line-height:1">$19.99<span style="font-size:13px;opacity:0.6">/month</span></div></div>
                  <button onclick="spSelectSlot('showcase-top');event.stopPropagation()" style="padding:8px 18px;background:linear-gradient(135deg,#f43f5e,#be123c);border:none;border-radius:7px;font-size:11px;font-weight:700;cursor:pointer;color:#fff">Book →</button>
                </div>
              </div>
            </div>

            <!-- Slot 4: Home Hero Banner -->
            <div class="sp-slot-card" style="background:var(--s1);border:1.5px solid rgba(244,63,94,0.2);border-radius:14px;overflow:hidden;transition:all 0.25s;cursor:pointer" onmouseover="this.style.borderColor='rgba(244,63,94,0.6)';this.style.transform='translateY(-3px)';this.style.boxShadow='0 8px 28px rgba(244,63,94,0.12)'" onmouseout="this.style.borderColor='rgba(244,63,94,0.2)';this.style.transform='';this.style.boxShadow=''" onclick="spSelectSlot('home-hero')">
              <div style="height:80px;background:linear-gradient(135deg,#001a10,#000e08);display:flex;align-items:center;justify-content:center;gap:12px;position:relative">
                <span style="font-size:32px">🏠</span>
              </div>
              <div style="padding:14px 16px">
                <div style="font-family:'Bebas Neue',sans-serif;font-size:17px;letter-spacing:1.5px;color:#f0fdf4;margin-bottom:4px">HOME TAB BANNER</div>
                <div style="font-size:11px;color:var(--muted);line-height:1.6;margin-bottom:10px">Large banner card displayed in the Home dashboard seen by every member when they log in. Maximum brand exposure.</div>
                <div style="display:flex;gap:6px;flex-wrap:wrap;margin-bottom:12px">
                  <span style="font-family:'DM Mono',monospace;font-size:8px;background:rgba(34,197,94,0.1);border:1px solid rgba(34,197,94,0.2);border-radius:3px;padding:2px 7px;color:var(--g4)">👁 ~360,000 views/month</span>
                  <span style="font-family:'DM Mono',monospace;font-size:8px;background:rgba(34,197,94,0.1);border:1px solid rgba(34,197,94,0.2);border-radius:3px;padding:2px 7px;color:var(--g4)">🎯 Direct action CTA</span>
                </div>
                <div style="display:flex;align-items:flex-end;justify-content:space-between">
                  <div><div style="font-family:'DM Mono',monospace;font-size:8px;color:rgba(244,63,94,0.5);letter-spacing:1px;margin-bottom:2px">FROM</div><div style="font-family:'Bebas Neue',sans-serif;font-size:26px;color:#f43f5e;line-height:1">$29.99<span style="font-size:13px;opacity:0.6">/month</span></div></div>
                  <button onclick="spSelectSlot('home-hero');event.stopPropagation()" style="padding:8px 18px;background:linear-gradient(135deg,#f43f5e,#be123c);border:none;border-radius:7px;font-size:11px;font-weight:700;cursor:pointer;color:#fff">Book →</button>
                </div>
              </div>
            </div>

            <!-- Slot 5: Push Notification -->
            <div class="sp-slot-card" style="background:var(--s1);border:1.5px solid rgba(244,63,94,0.2);border-radius:14px;overflow:hidden;transition:all 0.25s;cursor:pointer" onmouseover="this.style.borderColor='rgba(244,63,94,0.6)';this.style.transform='translateY(-3px)';this.style.boxShadow='0 8px 28px rgba(244,63,94,0.12)'" onmouseout="this.style.borderColor='rgba(244,63,94,0.2)';this.style.transform='';this.style.boxShadow=''" onclick="spSelectSlot('push-notif')">
              <div style="height:80px;background:linear-gradient(135deg,#1a0a00,#0e0500);display:flex;align-items:center;justify-content:center;gap:12px;position:relative">
                <span style="font-size:32px">📲</span>
                <div style="position:absolute;top:8px;right:10px;background:linear-gradient(135deg,#fb923c,#ea580c);color:#fff;font-family:'DM Mono',monospace;font-size:7px;font-weight:700;padding:2px 7px;border-radius:3px;letter-spacing:1px">⚡ INSTANT</div>
              </div>
              <div style="padding:14px 16px">
                <div style="font-family:'Bebas Neue',sans-serif;font-size:17px;letter-spacing:1.5px;color:#f0fdf4;margin-bottom:4px">COMMUNITY PUSH BLAST</div>
                <div style="font-size:11px;color:var(--muted);line-height:1.6;margin-bottom:10px">One-time push notification sent to all online members. Your message delivered directly to their screen in real time.</div>
                <div style="display:flex;gap:6px;flex-wrap:wrap;margin-bottom:12px">
                  <span style="font-family:'DM Mono',monospace;font-size:8px;background:rgba(251,146,60,0.1);border:1px solid rgba(251,146,60,0.2);border-radius:3px;padding:2px 7px;color:#fb923c">📢 Full community</span>
                  <span style="font-family:'DM Mono',monospace;font-size:8px;background:rgba(251,146,60,0.1);border:1px solid rgba(251,146,60,0.2);border-radius:3px;padding:2px 7px;color:#fb923c">🕐 Instant delivery</span>
                </div>
                <div style="display:flex;align-items:flex-end;justify-content:space-between">
                  <div><div style="font-family:'DM Mono',monospace;font-size:8px;color:rgba(244,63,94,0.5);letter-spacing:1px;margin-bottom:2px">ONE-TIME</div><div style="font-family:'Bebas Neue',sans-serif;font-size:26px;color:#f43f5e;line-height:1">$9.99</div></div>
                  <button onclick="spSelectSlot('push-notif');event.stopPropagation()" style="padding:8px 18px;background:linear-gradient(135deg,#f43f5e,#be123c);border:none;border-radius:7px;font-size:11px;font-weight:700;cursor:pointer;color:#fff">Book →</button>
                </div>
              </div>
            </div>

            <!-- Slot 6: Full Package -->
            <div class="sp-slot-card" style="background:linear-gradient(135deg,rgba(244,63,94,0.08),rgba(190,18,60,0.04));border:2px solid rgba(244,63,94,0.45);border-radius:14px;overflow:hidden;transition:all 0.25s;cursor:pointer;position:relative;box-shadow:0 0 24px rgba(244,63,94,0.08)" onmouseover="this.style.borderColor='rgba(244,63,94,0.8)';this.style.transform='translateY(-3px)';this.style.boxShadow='0 8px 32px rgba(244,63,94,0.2)'" onmouseout="this.style.borderColor='rgba(244,63,94,0.45)';this.style.transform='';this.style.boxShadow='0 0 24px rgba(244,63,94,0.08)'" onclick="spSelectSlot('full-package')">
              <div style="position:absolute;top:-1px;left:50%;transform:translateX(-50%);background:linear-gradient(135deg,#f43f5e,#be123c);color:#fff;font-family:'DM Mono',monospace;font-size:8px;font-weight:900;padding:3px 16px;border-radius:0 0 8px 8px;letter-spacing:1.5px;white-space:nowrap">🔥 BEST VALUE — SAVE 40%</div>
              <div style="height:80px;background:linear-gradient(135deg,#2d0010,#200008);display:flex;align-items:center;justify-content:center;gap:8px;padding-top:14px">
                <span style="font-size:22px">📰</span><span style="font-size:22px">🔔</span><span style="font-size:22px">✨</span><span style="font-size:22px">📲</span>
              </div>
              <div style="padding:14px 16px">
                <div style="font-family:'Bebas Neue',sans-serif;font-size:17px;letter-spacing:1.5px;color:#f43f5e;margin-bottom:4px">FULL SPONSOR PACKAGE</div>
                <div style="font-size:11px;color:var(--muted);line-height:1.6;margin-bottom:10px">All 5 placements bundled: Feed + Popup + Showcase + Home Banner + Push Blast. Maximum visibility across the entire platform.</div>
                <div style="display:flex;gap:6px;flex-wrap:wrap;margin-bottom:12px">
                  <span style="font-family:'DM Mono',monospace;font-size:8px;background:rgba(244,63,94,0.12);border:1px solid rgba(244,63,94,0.25);border-radius:3px;padding:2px 7px;color:#f87171">🚀 All placements</span>
                  <span style="font-family:'DM Mono',monospace;font-size:8px;background:rgba(244,63,94,0.12);border:1px solid rgba(244,63,94,0.25);border-radius:3px;padding:2px 7px;color:#f87171">📊 Full analytics</span>
                </div>
                <div style="display:flex;align-items:flex-end;justify-content:space-between">
                  <div>
                    <div style="font-family:'DM Mono',monospace;font-size:8px;color:rgba(244,63,94,0.5);letter-spacing:1px;margin-bottom:2px">7-DAY PACK</div>
                    <div style="display:flex;align-items:baseline;gap:8px">
                      <div style="font-family:'Bebas Neue',sans-serif;font-size:14px;color:rgba(244,63,94,0.4);text-decoration:line-through">$99</div>
                      <div style="font-family:'Bebas Neue',sans-serif;font-size:28px;color:#f43f5e;line-height:1">$59.99</div>
                    </div>
                  </div>
                  <button onclick="spSelectSlot('full-package');event.stopPropagation()" style="padding:9px 20px;background:linear-gradient(135deg,#f43f5e,#be123c);border:none;border-radius:8px;font-size:12px;font-weight:800;cursor:pointer;color:#fff;box-shadow:0 0 16px rgba(244,63,94,0.4)">Book All →</button>
                </div>
              </div>
            </div>

            <!-- Slot 7: Hanging Card -->
            <div class="sp-slot-card" style="background:var(--s1);border:2px solid rgba(244,63,94,0.3);border-radius:14px;overflow:hidden;transition:all 0.25s;cursor:pointer;position:relative" onmouseover="this.style.borderColor='rgba(244,63,94,0.7)';this.style.transform='translateY(-3px)';this.style.boxShadow='0 8px 28px rgba(244,63,94,0.15)'" onmouseout="this.style.borderColor='rgba(244,63,94,0.3)';this.style.transform='';this.style.boxShadow=''" onclick="spSelectSlot('hanging-card')">
              <div style="position:absolute;top:-1px;right:14px;background:linear-gradient(135deg,#f43f5e,#be123c);color:#fff;font-family:'DM Mono',monospace;font-size:7px;font-weight:900;padding:3px 12px;border-radius:0 0 8px 8px;letter-spacing:1px;">✨ NEW FORMAT</div>
              <div style="height:80px;background:linear-gradient(135deg,#1a0008,#2d0010);display:flex;align-items:center;justify-content:center;gap:16px;position:relative;overflow:hidden;">
                <div style="display:flex;flex-direction:column;align-items:center;gap:0;">
                  <div style="width:2px;height:22px;background:linear-gradient(180deg,rgba(255,255,255,0.5),rgba(200,160,60,0.7));border-radius:2px;"></div>
                  <div style="width:56px;padding:7px 10px;background:linear-gradient(135deg,#2d0010,#1a0008);border:1.5px solid rgba(244,63,94,0.5);border-radius:10px;font-family:'DM Mono',monospace;font-size:7px;color:#f43f5e;text-align:center;font-weight:700;letter-spacing:0.5px;transform:rotate(-2deg);box-shadow:0 4px 12px rgba(0,0,0,0.4);">YOUR AD</div>
                </div>
              </div>
              <div style="padding:14px 16px">
                <div style="font-family:'Bebas Neue',sans-serif;font-size:17px;letter-spacing:1.5px;color:#f0fdf4;margin-bottom:4px">HANGING CARD AD</div>
                <div style="font-size:11px;color:var(--muted);line-height:1.6;margin-bottom:10px">A card that drops from the top-right on a string, every 3 minutes. Unique, animated, unmissable — no other platform offers this.</div>
                <div style="display:flex;gap:6px;flex-wrap:wrap;margin-bottom:12px">
                  <span style="font-family:'DM Mono',monospace;font-size:8px;background:rgba(244,63,94,0.1);border:1px solid rgba(244,63,94,0.2);border-radius:3px;padding:2px 7px;color:#f87171">🪢 Unique animation</span>
                  <span style="font-family:'DM Mono',monospace;font-size:8px;background:rgba(244,63,94,0.1);border:1px solid rgba(244,63,94,0.2);border-radius:3px;padding:2px 7px;color:#f87171">👁 ~180,000 views/month</span>
                </div>
                <div style="display:flex;align-items:flex-end;justify-content:space-between">
                  <div><div style="font-family:'DM Mono',monospace;font-size:8px;color:rgba(244,63,94,0.5);letter-spacing:1px;margin-bottom:2px">FROM</div><div style="font-family:'Bebas Neue',sans-serif;font-size:26px;color:#f43f5e;line-height:1">$17.99<span style="font-size:13px;opacity:0.6">/month</span></div></div>
                  <button onclick="spSelectSlot('hanging-card');event.stopPropagation()" style="padding:8px 18px;background:linear-gradient(135deg,#f43f5e,#be123c);border:none;border-radius:7px;font-size:11px;font-weight:700;cursor:pointer;color:#fff">Book →</button>
                </div>
              </div>
            </div>

          </div><!-- /slot grid -->

          <!-- Audience stats -->
          <div style="background:var(--s1);border:1.5px solid rgba(244,63,94,0.1);border-radius:14px;padding:20px 22px">
            <div style="font-family:'DM Mono',monospace;font-size:9px;color:rgba(244,63,94,0.5);letter-spacing:2px;margin-bottom:16px">📊 PLATFORM AUDIENCE — LIVE</div>
            <div style="display:grid;grid-template-columns:repeat(4,1fr);gap:12px">
              <div style="text-align:center;background:rgba(244,63,94,0.05);border-radius:10px;padding:14px">
                <div style="font-family:'Bebas Neue',sans-serif;font-size:26px;color:#f43f5e;line-height:1">12K+</div>
                <div style="font-size:10px;color:var(--muted);margin-top:3px">Active Members</div>
              </div>
              <div style="text-align:center;background:rgba(244,63,94,0.05);border-radius:10px;padding:14px">
                <div style="font-family:'Bebas Neue',sans-serif;font-size:26px;color:#f43f5e;line-height:1">84K</div>
                <div style="font-size:10px;color:var(--muted);margin-top:3px">Daily Impressions</div>
              </div>
              <div style="text-align:center;background:rgba(244,63,94,0.05);border-radius:10px;padding:14px">
                <div style="font-family:'Bebas Neue',sans-serif;font-size:26px;color:#f43f5e;line-height:1">7.4%</div>
                <div style="font-size:10px;color:var(--muted);margin-top:3px">Avg. CTR</div>
              </div>
              <div style="text-align:center;background:rgba(244,63,94,0.05);border-radius:10px;padding:14px">
                <div style="font-family:'Bebas Neue',sans-serif;font-size:26px;color:#f43f5e;line-height:1">68%</div>
                <div style="font-size:10px;color:var(--muted);margin-top:3px">Creators / Founders</div>
              </div>
            </div>
          </div>
        </div><!-- /sppanel-slots -->

        <!-- ── PANEL: CREATE AD ── -->
        <div id="sppanel-create" class="sp-panel" style="display:none">
          <div style="background:var(--s1);border:1.5px solid rgba(244,63,94,0.15);border-radius:14px;padding:22px;margin-bottom:16px">
            <div style="font-family:'Bebas Neue',sans-serif;font-size:20px;letter-spacing:2px;color:#f43f5e;margin-bottom:18px">✏️ CONFIGURE YOUR SPONSORED AD</div>

            <!-- Placement select -->
            <div style="margin-bottom:18px">
              <div style="font-family:'DM Mono',monospace;font-size:9px;color:rgba(244,63,94,0.6);letter-spacing:1.5px;margin-bottom:10px">PLACEMENT *</div>
              <div style="display:grid;grid-template-columns:repeat(3,1fr);gap:8px" id="sp-placement-grid">
                <label class="sp-place-opt selected" id="sppl-feed-banner" style="display:flex;flex-direction:column;align-items:center;gap:6px;background:rgba(244,63,94,0.1);border:2px solid rgba(244,63,94,0.5);border-radius:10px;padding:12px 8px;cursor:pointer;transition:all 0.2s;text-align:center">
                  <input type="radio" name="sp-placement" value="feed-banner" checked style="display:none"/>
                  <span style="font-size:20px">📰</span>
                  <div style="font-family:'DM Mono',monospace;font-size:8px;font-weight:700;color:#f43f5e;letter-spacing:0.5px">FEED POST</div>
                  <div style="font-size:9px;color:var(--muted)">$9.99/month</div>
                </label>
                <label class="sp-place-opt" id="sppl-popup-banner" style="display:flex;flex-direction:column;align-items:center;gap:6px;background:transparent;border:1.5px solid rgba(244,63,94,0.15);border-radius:10px;padding:12px 8px;cursor:pointer;transition:all 0.2s;text-align:center" onclick="spTogglePlacement('popup-banner',this)">
                  <input type="radio" name="sp-placement" value="popup-banner" style="display:none"/>
                  <span style="font-size:20px">🔔</span>
                  <div style="font-family:'DM Mono',monospace;font-size:8px;font-weight:700;color:rgba(244,63,94,0.5);letter-spacing:0.5px">POPUP AD</div>
                  <div style="font-size:9px;color:var(--muted)">$14.99/month</div>
                </label>
                <label class="sp-place-opt" id="sppl-showcase-top" style="display:flex;flex-direction:column;align-items:center;gap:6px;background:transparent;border:1.5px solid rgba(244,63,94,0.15);border-radius:10px;padding:12px 8px;cursor:pointer;transition:all 0.2s;text-align:center" onclick="spTogglePlacement('showcase-top',this)">
                  <input type="radio" name="sp-placement" value="showcase-top" style="display:none"/>
                  <span style="font-size:20px">✨</span>
                  <div style="font-family:'DM Mono',monospace;font-size:8px;font-weight:700;color:rgba(244,63,94,0.5);letter-spacing:0.5px">SHOWCASE TOP</div>
                  <div style="font-size:9px;color:var(--muted)">$19.99/month</div>
                </label>
                <label class="sp-place-opt" id="sppl-home-hero" style="display:flex;flex-direction:column;align-items:center;gap:6px;background:transparent;border:1.5px solid rgba(244,63,94,0.15);border-radius:10px;padding:12px 8px;cursor:pointer;transition:all 0.2s;text-align:center" onclick="spTogglePlacement('home-hero',this)">
                  <input type="radio" name="sp-placement" value="home-hero" style="display:none"/>
                  <span style="font-size:20px">🏠</span>
                  <div style="font-family:'DM Mono',monospace;font-size:8px;font-weight:700;color:rgba(244,63,94,0.5);letter-spacing:0.5px">HOME BANNER</div>
                  <div style="font-size:9px;color:var(--muted)">$29.99/month</div>
                </label>
                <label class="sp-place-opt" id="sppl-push-notif" style="display:flex;flex-direction:column;align-items:center;gap:6px;background:transparent;border:1.5px solid rgba(244,63,94,0.15);border-radius:10px;padding:12px 8px;cursor:pointer;transition:all 0.2s;text-align:center" onclick="spTogglePlacement('push-notif',this)">
                  <input type="radio" name="sp-placement" value="push-notif" style="display:none"/>
                  <span style="font-size:20px">📲</span>
                  <div style="font-family:'DM Mono',monospace;font-size:8px;font-weight:700;color:rgba(244,63,94,0.5);letter-spacing:0.5px">PUSH BLAST</div>
                  <div style="font-size:9px;color:var(--muted)">$4.99 one-time</div>
                </label>
                <label class="sp-place-opt" id="sppl-full-package" style="display:flex;flex-direction:column;align-items:center;gap:6px;background:rgba(244,63,94,0.04);border:1.5px solid rgba(244,63,94,0.3);border-radius:10px;padding:12px 8px;cursor:pointer;transition:all 0.2s;text-align:center;position:relative" onclick="spTogglePlacement('full-package',this)">
                  <input type="radio" name="sp-placement" value="full-package" style="display:none"/>
                  <div style="position:absolute;top:-7px;left:50%;transform:translateX(-50%);background:#f43f5e;color:#fff;font-size:7px;font-weight:900;padding:1px 8px;border-radius:3px;white-space:nowrap;font-family:'DM Mono',monospace">BEST VALUE</div>
                  <span style="font-size:20px">🔥</span>
                  <div style="font-family:'DM Mono',monospace;font-size:8px;font-weight:700;color:rgba(244,63,94,0.7);letter-spacing:0.5px">FULL PACK</div>
                  <div style="font-size:9px;color:var(--muted)">$59.99/month</div>
                </label>
                <label class="sp-place-opt" id="sppl-hanging-card" style="display:flex;flex-direction:column;align-items:center;gap:6px;background:transparent;border:1.5px solid rgba(244,63,94,0.15);border-radius:10px;padding:12px 8px;cursor:pointer;transition:all 0.2s;text-align:center;position:relative" onclick="spTogglePlacement('hanging-card',this)">
                  <input type="radio" name="sp-placement" value="hanging-card" style="display:none"/>
                  <div style="position:absolute;top:-7px;left:50%;transform:translateX(-50%);background:linear-gradient(135deg,#f43f5e,#be123c);color:#fff;font-size:7px;font-weight:900;padding:1px 8px;border-radius:3px;white-space:nowrap;font-family:'DM Mono',monospace">✨ NEW</div>
                  <span style="font-size:20px">🪢</span>
                  <div style="font-family:'DM Mono',monospace;font-size:8px;font-weight:700;color:rgba(244,63,94,0.5);letter-spacing:0.5px">HANGING CARD</div>
                  <div style="font-size:9px;color:var(--muted)">$17.99/month</div>
                </label>
              </div>
            </div>

            <!-- Ad content -->
            <div style="display:grid;grid-template-columns:1fr 1fr;gap:14px;margin-bottom:14px">
              <div class="fg"><label style="color:rgba(244,63,94,0.7);font-size:11px;font-family:'DM Mono',monospace;letter-spacing:1px">BRAND / AD NAME *</label><input type="text" id="sp-ad-brand" placeholder="e.g. My Startup, My Course…" style="border-color:rgba(244,63,94,0.2)"/></div>
              <div class="fg"><label style="color:rgba(244,63,94,0.7);font-size:11px;font-family:'DM Mono',monospace;letter-spacing:1px">NICHE / CATEGORY</label>
                <select id="sp-ad-niche" style="border-color:rgba(244,63,94,0.2)">
                  <option>🛍️ E-commerce / Product</option>
                  <option>🚀 SaaS / App</option>
                  <option>💻 Service / Freelance</option>
                  <option>📚 Course / Training</option>
                  <option>🤝 Collab / Recruiting</option>
                  <option>💡 Other</option>
                </select>
              </div>
            </div>
            <div class="fg" style="margin-bottom:14px"><label style="color:rgba(244,63,94,0.7);font-size:11px;font-family:'DM Mono',monospace;letter-spacing:1px">AD HEADLINE *</label><input type="text" id="sp-ad-headline" placeholder="Short, impactful headline (max 80 chars)" maxlength="80" style="border-color:rgba(244,63,94,0.2)"/></div>
            <div class="fg" style="margin-bottom:14px"><label style="color:rgba(244,63,94,0.7);font-size:11px;font-family:'DM Mono',monospace;letter-spacing:1px">AD BODY TEXT *</label><textarea id="sp-ad-body" rows="3" placeholder="What are you offering? Be clear, compelling, and include a call-to-action." style="border-color:rgba(244,63,94,0.2)"></textarea></div>
            <div style="display:grid;grid-template-columns:1fr 1fr;gap:14px;margin-bottom:14px">
              <div class="fg"><label style="color:rgba(244,63,94,0.7);font-size:11px;font-family:'DM Mono',monospace;letter-spacing:1px">CTA BUTTON TEXT</label><input type="text" id="sp-ad-cta" placeholder="e.g. Discover, Get it, Start free" style="border-color:rgba(244,63,94,0.2)"/></div>
              <div class="fg"><label style="color:rgba(244,63,94,0.7);font-size:11px;font-family:'DM Mono',monospace;letter-spacing:1px">DESTINATION URL *</label><input type="url" id="sp-ad-url" placeholder="https://…" style="border-color:rgba(244,63,94,0.2)"/></div>
            </div>
            <!-- Duration + budget calc -->
            <div style="display:grid;grid-template-columns:1fr 1fr;gap:14px;margin-bottom:18px">
              <div>
                <div style="font-family:'DM Mono',monospace;font-size:9px;color:rgba(244,63,94,0.6);letter-spacing:1.5px;margin-bottom:8px">DURATION (DAYS)</div>
                <div style="display:flex;gap:6px">
                  <button onclick="spSetDays(1)" class="sp-day-btn active" id="spd-1" style="flex:1;padding:8px 0;background:rgba(244,63,94,0.12);border:1.5px solid rgba(244,63,94,0.4);border-radius:7px;font-family:'DM Mono',monospace;font-size:10px;font-weight:700;color:#f43f5e;cursor:pointer">1d</button>
                  <button onclick="spSetDays(3)" class="sp-day-btn" id="spd-3" style="flex:1;padding:8px 0;background:transparent;border:1.5px solid rgba(244,63,94,0.15);border-radius:7px;font-family:'DM Mono',monospace;font-size:10px;font-weight:700;color:rgba(244,63,94,0.4);cursor:pointer">3d</button>
                  <button onclick="spSetDays(7)" class="sp-day-btn" id="spd-7" style="flex:1;padding:8px 0;background:transparent;border:1.5px solid rgba(244,63,94,0.15);border-radius:7px;font-family:'DM Mono',monospace;font-size:10px;font-weight:700;color:rgba(244,63,94,0.4);cursor:pointer">7d</button>
                  <button onclick="spSetDays(30)" class="sp-day-btn" id="spd-30" style="flex:1;padding:8px 0;background:transparent;border:1.5px solid rgba(244,63,94,0.15);border-radius:7px;font-family:'DM Mono',monospace;font-size:10px;font-weight:700;color:rgba(244,63,94,0.4);cursor:pointer">30d</button>
                </div>
              </div>
              <div style="background:rgba(244,63,94,0.06);border:1.5px solid rgba(244,63,94,0.15);border-radius:10px;padding:12px 16px">
                <div style="font-family:'DM Mono',monospace;font-size:9px;color:rgba(244,63,94,0.5);letter-spacing:1px;margin-bottom:6px">ESTIMATED BUDGET</div>
                <div style="font-family:'Bebas Neue',sans-serif;font-size:28px;color:#f43f5e;line-height:1" id="sp-budget-total">$9.99</div>
                <div style="font-size:10px;color:var(--muted);margin-top:3px" id="sp-budget-reach">~240,000 impressions/month</div>
              </div>
            </div>
            <!-- Live preview -->
            <div>
              <div style="font-family:'DM Mono',monospace;font-size:9px;color:rgba(244,63,94,0.5);letter-spacing:1.5px;margin-bottom:10px">👁️ LIVE PREVIEW</div>
              <div id="sp-ad-preview" style="background:linear-gradient(135deg,#1a0008,#0e0005);border:1.5px solid rgba(244,63,94,0.3);border-radius:12px;padding:14px 16px;display:flex;align-items:center;gap:12px">
                <div style="width:42px;height:42px;border-radius:50%;background:linear-gradient(135deg,#f43f5e,#be123c);display:flex;align-items:center;justify-content:center;font-size:18px;flex-shrink:0">💼</div>
                <div style="flex:1;min-width:0">
                  <div style="font-family:'DM Mono',monospace;font-size:8px;color:rgba(244,63,94,0.6);letter-spacing:1px;margin-bottom:3px">SPONSORED</div>
                  <div id="sp-preview-headline" style="font-size:13px;font-weight:700;color:#f0fdf4;line-height:1.3;margin-bottom:3px">Your headline will appear here</div>
                  <div id="sp-preview-body" style="font-size:11px;color:var(--muted);white-space:nowrap;overflow:hidden;text-overflow:ellipsis">Your ad description…</div>
                </div>
                <button id="sp-preview-cta" style="flex-shrink:0;padding:7px 14px;background:rgba(244,63,94,0.2);border:1.5px solid rgba(244,63,94,0.5);border-radius:7px;font-family:'DM Mono',monospace;font-size:9px;font-weight:700;color:#f43f5e;cursor:default;letter-spacing:0.5px;white-space:nowrap">Learn more →</button>
              </div>
            </div>
          </div>
          <button onclick="spSubmitAd()" style="width:100%;padding:14px;background:linear-gradient(135deg,#f43f5e,#be123c);border:none;border-radius:10px;font-family:'Plus Jakarta Sans',sans-serif;font-size:15px;font-weight:800;cursor:pointer;color:#fff;box-shadow:0 0 24px rgba(244,63,94,0.4);transition:all 0.2s" onmouseover="this.style.transform='translateY(-2px)';this.style.boxShadow='0 0 36px rgba(244,63,94,0.6)'" onmouseout="this.style.transform='';this.style.boxShadow='0 0 24px rgba(244,63,94,0.4)'">💼 Submit Sponsored Ad →</button>
        </div><!-- /sppanel-create -->

        <!-- ── PANEL: MY CAMPAIGNS ── -->
        <div id="sppanel-active" class="sp-panel" style="display:none">
          <div id="sp-campaigns-list">
            <div style="text-align:center;padding:60px 20px;color:var(--muted)">
              <div style="font-size:48px;margin-bottom:12px">📊</div>
              <div style="font-family:'Bebas Neue',sans-serif;font-size:22px;letter-spacing:2px;color:rgba(244,63,94,0.5);margin-bottom:8px">NO ACTIVE CAMPAIGNS</div>
              <p style="font-size:13px;line-height:1.7">You haven't launched any sponsored campaigns yet.<br>Go to <strong style="color:#f43f5e">Ad Slots</strong> or <strong style="color:#f43f5e">Create Ad</strong> to get started.</p>
            </div>
          </div>
        </div><!-- /sppanel-active -->

        <!-- ── PANEL: ANALYTICS ── -->
        <div id="sppanel-stats" class="sp-panel" style="display:none">
          <div style="display:grid;grid-template-columns:repeat(2,1fr);gap:12px;margin-bottom:20px">
            <div style="background:var(--s1);border:1.5px solid rgba(244,63,94,0.15);border-radius:12px;padding:18px">
              <div style="font-family:'DM Mono',monospace;font-size:9px;color:rgba(244,63,94,0.5);letter-spacing:1.5px;margin-bottom:8px">TOTAL IMPRESSIONS</div>
              <div style="font-family:'Bebas Neue',sans-serif;font-size:36px;color:#f43f5e;line-height:1" id="sp-stat-impressions">0</div>
              <div style="font-size:10px;color:var(--muted);margin-top:4px">across all campaigns</div>
            </div>
            <div style="background:var(--s1);border:1.5px solid rgba(244,63,94,0.15);border-radius:12px;padding:18px">
              <div style="font-family:'DM Mono',monospace;font-size:9px;color:rgba(244,63,94,0.5);letter-spacing:1.5px;margin-bottom:8px">TOTAL CLICKS</div>
              <div style="font-family:'Bebas Neue',sans-serif;font-size:36px;color:#f43f5e;line-height:1" id="sp-stat-clicks">0</div>
              <div style="font-size:10px;color:var(--muted);margin-top:4px">across all campaigns</div>
            </div>
            <div style="background:var(--s1);border:1.5px solid rgba(244,63,94,0.15);border-radius:12px;padding:18px">
              <div style="font-family:'DM Mono',monospace;font-size:9px;color:rgba(244,63,94,0.5);letter-spacing:1.5px;margin-bottom:8px">AVG CTR</div>
              <div style="font-family:'Bebas Neue',sans-serif;font-size:36px;color:#f43f5e;line-height:1" id="sp-stat-ctr">—</div>
              <div style="font-size:10px;color:var(--muted);margin-top:4px">click-through rate</div>
            </div>
            <div style="background:var(--s1);border:1.5px solid rgba(244,63,94,0.15);border-radius:12px;padding:18px">
              <div style="font-family:'DM Mono',monospace;font-size:9px;color:rgba(244,63,94,0.5);letter-spacing:1.5px;margin-bottom:8px">TOTAL SPENT</div>
              <div style="font-family:'Bebas Neue',sans-serif;font-size:36px;color:#f43f5e;line-height:1" id="sp-stat-spent">$0</div>
              <div style="font-size:10px;color:var(--muted);margin-top:4px">all time</div>
            </div>
          </div>
          <!-- Placeholder chart -->
          <div style="background:var(--s1);border:1.5px solid rgba(244,63,94,0.1);border-radius:12px;padding:20px;text-align:center">
            <div style="font-family:'DM Mono',monospace;font-size:9px;color:rgba(244,63,94,0.5);letter-spacing:2px;margin-bottom:16px">IMPRESSIONS OVER TIME</div>
            <div style="display:flex;align-items:flex-end;justify-content:center;gap:6px;height:80px" id="sp-chart-bars">
              <div style="flex:1;max-width:28px;background:rgba(244,63,94,0.1);border-radius:3px 3px 0 0;height:20%"></div>
              <div style="flex:1;max-width:28px;background:rgba(244,63,94,0.2);border-radius:3px 3px 0 0;height:35%"></div>
              <div style="flex:1;max-width:28px;background:rgba(244,63,94,0.15);border-radius:3px 3px 0 0;height:25%"></div>
              <div style="flex:1;max-width:28px;background:rgba(244,63,94,0.3);border-radius:3px 3px 0 0;height:55%"></div>
              <div style="flex:1;max-width:28px;background:rgba(244,63,94,0.2);border-radius:3px 3px 0 0;height:40%"></div>
              <div style="flex:1;max-width:28px;background:rgba(244,63,94,0.4);border-radius:3px 3px 0 0;height:70%"></div>
              <div style="flex:1;max-width:28px;background:rgba(244,63,94,0.1);border-radius:3px 3px 0 0;height:15%"></div>
            </div>
            <div style="font-size:11px;color:var(--muted2);margin-top:10px;font-family:'DM Mono',monospace">Launch your first campaign to see real analytics</div>
          </div>
        </div><!-- /sppanel-stats -->

      </div>
    </div><!-- /tab-sponsor -->

    <!-- ══════════ LIVE STUDIO ══════════ -->
    <div class="tpanel" id="tab-live-studio">
      <div style="max-width:760px;margin:0 auto;padding:22px 0 80px;">
        <!-- Header -->
        <div style="display:flex;align-items:center;gap:14px;margin-bottom:24px;">
          <div style="width:46px;height:46px;border-radius:12px;background:linear-gradient(135deg,#dc2626,#ef4444);display:flex;align-items:center;justify-content:center;font-size:22px;box-shadow:0 0 20px rgba(239,68,68,0.4);">🔴</div>
          <div>
            <h2 style="font-family:'Bebas Neue',sans-serif;font-size:30px;letter-spacing:2px;color:#ef4444;line-height:1;margin:0;">GO LIVE</h2>
            <p style="font-size:12px;color:var(--muted);margin:2px 0 0;">Broadcast live to the entire ViralBoost community</p>
          </div>
          <div id="live-status-badge" style="margin-left:auto;display:none;background:rgba(239,68,68,0.15);border:1.5px solid rgba(239,68,68,0.5);border-radius:20px;padding:5px 14px;font-family:'DM Mono',monospace;font-size:10px;color:#ef4444;letter-spacing:1px;display:flex;align-items:center;gap:6px;">
            <span style="width:8px;height:8px;border-radius:50%;background:#ef4444;animation:vb-pulse 1s ease-in-out infinite;display:inline-block;"></span>
            LIVE
          </div>
        </div>

        <!-- Live Setup Card -->
        <div id="live-setup-card" style="background:linear-gradient(135deg,var(--s1),var(--s2));border:1.5px solid rgba(239,68,68,0.25);border-radius:16px;padding:24px;margin-bottom:18px;">
          <div style="font-family:'DM Mono',monospace;font-size:10px;color:rgba(239,68,68,0.7);letter-spacing:2px;margin-bottom:16px;">LIVE SETUP</div>
          <div style="display:flex;flex-direction:column;gap:12px;">
            <div>
              <label style="font-family:'DM Mono',monospace;font-size:10px;color:var(--g4);letter-spacing:1.5px;text-transform:uppercase;display:block;margin-bottom:5px;">Stream Title</label>
              <input id="live-title" type="text" placeholder="What is your live about?" style="width:100%;padding:11px 14px;background:rgba(4,10,5,0.9);border:1.5px solid var(--border2);border-radius:9px;font-family:'Plus Jakarta Sans',sans-serif;font-size:14px;color:var(--white);outline:none;transition:border-color 0.2s;" onfocus="this.style.borderColor='rgba(239,68,68,0.5)'" onblur="this.style.borderColor='var(--border2)'"/>
            </div>
            <div>
              <label style="font-family:'DM Mono',monospace;font-size:10px;color:var(--g4);letter-spacing:1.5px;text-transform:uppercase;display:block;margin-bottom:5px;">Category</label>
              <select id="live-category" style="width:100%;padding:11px 14px;background:rgba(4,10,5,0.9);border:1.5px solid var(--border2);border-radius:9px;font-family:'Plus Jakarta Sans',sans-serif;font-size:13px;color:var(--white);outline:none;">
                <option value="">Select a category…</option>
                <option>🚀 Startup & Entrepreneurship</option>
                <option>💻 Tech & Development</option>
                <option>🎨 Design & Creativity</option>
                <option>📈 Marketing & Growth</option>
                <option>💰 Finance & Investing</option>
                <option>🎙️ Podcast & Talk</option>
                <option>🎓 Tutorial & Education</option>
                <option>💬 Community Q&A</option>
                <option>🎮 Gaming & Entertainment</option>
                <option>🌐 Other</option>
              </select>
            </div>
            <div>
              <label style="font-family:'DM Mono',monospace;font-size:10px;color:var(--g4);letter-spacing:1.5px;text-transform:uppercase;display:block;margin-bottom:5px;">Description (optional)</label>
              <textarea id="live-desc" rows="3" placeholder="Tell viewers what to expect..." style="width:100%;padding:11px 14px;background:rgba(4,10,5,0.9);border:1.5px solid var(--border2);border-radius:9px;font-family:'Plus Jakarta Sans',sans-serif;font-size:13px;color:var(--white);outline:none;resize:none;" onfocus="this.style.borderColor='rgba(239,68,68,0.5)'" onblur="this.style.borderColor='var(--border2)'"></textarea>
            </div>
            <!-- Thumbnail -->
            <div>
              <label style="font-family:'DM Mono',monospace;font-size:10px;color:var(--g4);letter-spacing:1.5px;text-transform:uppercase;display:block;margin-bottom:5px;">Thumbnail</label>
              <div id="live-thumb-area" onclick="document.getElementById('live-thumb-input').click()" style="border:2px dashed rgba(239,68,68,0.3);border-radius:10px;padding:18px;text-align:center;cursor:pointer;transition:all 0.2s;" onmouseover="this.style.borderColor='rgba(239,68,68,0.6)';this.style.background='rgba(239,68,68,0.04)'" onmouseout="this.style.borderColor='rgba(239,68,68,0.3)';this.style.background=''">
                <div style="font-size:28px;margin-bottom:6px;">🖼️</div>
                <div style="font-size:12px;color:var(--muted);">Click to upload a thumbnail</div>
                <div style="font-size:10px;color:var(--muted2);margin-top:2px;font-family:'DM Mono',monospace;">JPG, PNG · 1280×720 recommended</div>
                <input type="file" id="live-thumb-input" accept="image/*" style="display:none;" onchange="previewLiveThumb(this)"/>
              </div>
            </div>
            <!-- Audience options -->
            <div style="display:grid;grid-template-columns:1fr 1fr;gap:10px;">
              <div style="background:rgba(239,68,68,0.04);border:1.5px solid rgba(239,68,68,0.15);border-radius:10px;padding:12px 14px;">
                <div style="font-size:11px;font-weight:700;color:var(--white);margin-bottom:3px;">👥 Audience</div>
                <select id="live-audience" style="width:100%;background:transparent;border:none;outline:none;font-size:12px;color:var(--muted);font-family:'Plus Jakarta Sans',sans-serif;">
                  <option>🌍 Public — Everyone</option>
                  <option>👥 Followers only</option>
                  <option>💎 Paid members only</option>
                </select>
              </div>
              <div style="background:rgba(239,68,68,0.04);border:1.5px solid rgba(239,68,68,0.15);border-radius:10px;padding:12px 14px;">
                <div style="font-size:11px;font-weight:700;color:var(--white);margin-bottom:3px;">💬 Chat</div>
                <select id="live-chat-mode" style="width:100%;background:transparent;border:none;outline:none;font-size:12px;color:var(--muted);font-family:'Plus Jakarta Sans',sans-serif;">
                  <option>✅ Enabled</option>
                  <option>🔒 Followers only</option>
                  <option>❌ Disabled</option>
                </select>
              </div>
            </div>
          </div>
        </div>

        <!-- Camera preview area -->
        <div style="background:var(--s1);border:1.5px solid rgba(239,68,68,0.2);border-radius:16px;overflow:hidden;margin-bottom:18px;">
          <div style="position:relative;background:#000;aspect-ratio:16/9;display:flex;align-items:center;justify-content:center;min-height:200px;">
            <video id="live-camera-preview" autoplay muted playsinline style="width:100%;height:100%;object-fit:cover;display:none;"></video>
            <div id="live-camera-placeholder" style="text-align:center;padding:32px;">
              <div style="font-size:52px;margin-bottom:10px;">📷</div>
              <div style="font-size:14px;font-weight:700;color:var(--white);margin-bottom:4px;">Camera not yet active</div>
              <div style="font-size:11px;color:var(--muted);">Click "Start Camera" to preview before going live</div>
            </div>
            <!-- Live indicator overlay -->
            <div id="live-on-air" style="display:none;position:absolute;top:14px;left:14px;background:rgba(239,68,68,0.9);border-radius:6px;padding:4px 10px;font-family:'DM Mono',monospace;font-size:11px;font-weight:700;color:#fff;letter-spacing:1px;display:flex;align-items:center;gap:5px;">
              <span style="width:7px;height:7px;border-radius:50%;background:#fff;animation:vb-pulse 1s ease-in-out infinite;display:inline-block;"></span>
              LIVE
            </div>
            <!-- Viewer count -->
            <div id="live-viewer-count" style="display:none;position:absolute;top:14px;right:14px;background:rgba(0,0,0,0.7);border-radius:6px;padding:4px 10px;font-family:'DM Mono',monospace;font-size:11px;color:#fff;">👁 <span id="live-viewers-num">0</span> viewers</div>
          </div>
          <!-- Controls bar -->
          <div style="padding:14px 18px;display:flex;align-items:center;gap:10px;flex-wrap:wrap;border-top:1px solid rgba(239,68,68,0.1);">
            <button id="live-cam-btn" onclick="startLiveCamera()" style="display:flex;align-items:center;gap:6px;background:rgba(239,68,68,0.1);border:1.5px solid rgba(239,68,68,0.3);border-radius:8px;padding:8px 16px;font-size:12px;font-weight:700;cursor:pointer;color:#ef4444;transition:all 0.2s;" onmouseover="this.style.background='rgba(239,68,68,0.2)'" onmouseout="this.style.background='rgba(239,68,68,0.1)'">📷 Start Camera</button>
            <button id="live-mic-btn" onclick="toggleLiveMic()" style="display:flex;align-items:center;gap:6px;background:rgba(239,68,68,0.1);border:1.5px solid rgba(239,68,68,0.3);border-radius:8px;padding:8px 16px;font-size:12px;font-weight:700;cursor:pointer;color:#ef4444;transition:all 0.2s;" onmouseover="this.style.background='rgba(239,68,68,0.2)'" onmouseout="this.style.background='rgba(239,68,68,0.1)'">🎙️ Mic ON</button>
            <button id="live-screen-btn" onclick="startScreenShare()" style="display:flex;align-items:center;gap:6px;background:transparent;border:1.5px solid var(--border2);border-radius:8px;padding:8px 16px;font-size:12px;font-weight:700;cursor:pointer;color:var(--muted);transition:all 0.2s;" onmouseover="this.style.borderColor='rgba(239,68,68,0.4)';this.style.color='#ef4444'" onmouseout="this.style.borderColor='var(--border2)';this.style.color='var(--muted)'">🖥️ Share Screen</button>
            <button id="btn-go-live" onclick="startLiveBroadcast()" style="margin-left:auto;display:flex;align-items:center;gap:7px;background:linear-gradient(135deg,#dc2626,#ef4444);border:none;border-radius:10px;padding:11px 24px;font-family:'Plus Jakarta Sans',sans-serif;font-size:14px;font-weight:800;cursor:pointer;color:#fff;box-shadow:0 0 20px rgba(239,68,68,0.35);transition:all 0.2s;" onmouseover="this.style.boxShadow='0 0 36px rgba(239,68,68,0.6)';this.style.transform='translateY(-1px)'" onmouseout="this.style.boxShadow='0 0 20px rgba(239,68,68,0.35)';this.style.transform=''">
              <span style="width:8px;height:8px;border-radius:50%;background:#fff;animation:vb-pulse 1s ease-in-out infinite;display:inline-block;"></span>
              START LIVE
            </button>
            <button id="btn-end-live" onclick="endLiveBroadcast()" style="display:none;background:rgba(239,68,68,0.1);border:1.5px solid rgba(239,68,68,0.4);border-radius:10px;padding:11px 20px;font-family:'Plus Jakarta Sans',sans-serif;font-size:13px;font-weight:700;cursor:pointer;color:#ef4444;transition:all 0.2s;">⏹ End Live</button>
          </div>
        </div>

        <!-- Live chat (shown during live) -->
        <div id="live-chat-box" style="background:var(--s1);border:1.5px solid rgba(239,68,68,0.2);border-radius:16px;overflow:hidden;margin-bottom:18px;">
          <div style="padding:12px 18px;border-bottom:1px solid rgba(239,68,68,0.1);display:flex;align-items:center;gap:8px;">
            <span style="font-size:14px;">💬</span>
            <span style="font-family:'Bebas Neue',sans-serif;font-size:16px;letter-spacing:1.5px;color:var(--white);">LIVE CHAT</span>
            <span id="live-chat-count" style="font-family:'DM Mono',monospace;font-size:9px;color:var(--muted);margin-left:auto;letter-spacing:1px;">0 messages</span>
          </div>
          <div id="live-chat-msgs" style="height:220px;overflow-y:auto;padding:14px 16px;display:flex;flex-direction:column;gap:8px;">
            <div style="text-align:center;padding:24px;color:var(--muted2);font-size:12px;">💬 Chat messages will appear here when you go live</div>
          </div>
          <div style="padding:10px 14px;border-top:1px solid rgba(239,68,68,0.1);display:flex;gap:8px;">
            <input id="live-chat-input" type="text" placeholder="Say something to your viewers..." style="flex:1;background:var(--s2);border:1.5px solid var(--border2);border-radius:7px;padding:8px 12px;font-family:'Plus Jakarta Sans',sans-serif;font-size:12px;color:var(--white);outline:none;" onfocus="this.style.borderColor='rgba(239,68,68,0.4)'" onblur="this.style.borderColor='var(--border2)'" onkeydown="if(event.key==='Enter')sendLiveChatMsg()"/>
            <button onclick="sendLiveChatMsg()" style="background:linear-gradient(135deg,#dc2626,#ef4444);border:none;border-radius:7px;width:36px;height:36px;display:flex;align-items:center;justify-content:center;font-size:14px;cursor:pointer;color:#fff;flex-shrink:0;">→</button>
          </div>
        </div>

        <!-- Tips row -->
        <div style="display:grid;grid-template-columns:repeat(3,1fr);gap:10px;">
          <div style="background:rgba(239,68,68,0.04);border:1px solid rgba(239,68,68,0.12);border-radius:10px;padding:14px;text-align:center;">
            <div style="font-size:22px;margin-bottom:6px;">📢</div>
            <div style="font-size:11px;font-weight:700;color:var(--white);margin-bottom:3px;">Notify followers</div>
            <div style="font-size:10px;color:var(--muted);line-height:1.5;">Your followers get a push notification when you go live</div>
          </div>
          <div style="background:rgba(239,68,68,0.04);border:1px solid rgba(239,68,68,0.12);border-radius:10px;padding:14px;text-align:center;">
            <div style="font-size:22px;margin-bottom:6px;">💰</div>
            <div style="font-size:11px;font-weight:700;color:var(--white);margin-bottom:3px;">Earn credits</div>
            <div style="font-size:10px;color:var(--muted);line-height:1.5;">Earn ⚡50 credits per live + viewer tips</div>
          </div>
          <div style="background:rgba(239,68,68,0.04);border:1px solid rgba(239,68,68,0.12);border-radius:10px;padding:14px;text-align:center;">
            <div style="font-size:22px;margin-bottom:6px;">📹</div>
            <div style="font-size:11px;font-weight:700;color:var(--white);margin-bottom:3px;">Auto-save replay</div>
            <div style="font-size:10px;color:var(--muted);line-height:1.5;">Your live is saved and available in the Videos tab</div>
          </div>
        </div>
      </div>
    </div><!-- /tab-live-studio -->

    <!-- ══════════ VIDEO CREATOR ══════════ -->
    <div class="tpanel" id="tab-video-creator">
      <div style="max-width:800px;margin:0 auto;padding:22px 0 80px;">
        <!-- Header -->
        <div style="display:flex;align-items:center;gap:14px;margin-bottom:24px;">
          <div style="width:46px;height:46px;border-radius:12px;background:linear-gradient(135deg,#4f46e5,#6366f1);display:flex;align-items:center;justify-content:center;font-size:22px;box-shadow:0 0 20px rgba(99,102,241,0.4);">🎬</div>
          <div>
            <h2 style="font-family:'Bebas Neue',sans-serif;font-size:30px;letter-spacing:2px;color:#818cf8;line-height:1;margin:0;">VIDEO CREATOR</h2>
            <p style="font-size:12px;color:var(--muted);margin:2px 0 0;">Publish a video (min. 3 minutes) to reach the entire community</p>
          </div>
        </div>

        <!-- Upload zone -->
        <div id="vc-upload-zone" onclick="document.getElementById('vc-file-input').click()" style="background:linear-gradient(135deg,var(--s1),var(--s2));border:2px dashed rgba(99,102,241,0.4);border-radius:16px;padding:40px 24px;text-align:center;cursor:pointer;transition:all 0.3s;margin-bottom:20px;" onmouseover="this.style.borderColor='rgba(99,102,241,0.8)';this.style.background='rgba(99,102,241,0.04)'" onmouseout="this.style.borderColor='rgba(99,102,241,0.4)';this.style.background='linear-gradient(135deg,var(--s1),var(--s2))'">
          <input type="file" id="vc-file-input" accept="video/*" style="display:none;" onchange="handleVideoUpload(this)"/>
          <div id="vc-upload-idle">
            <div style="font-size:52px;margin-bottom:14px;">🎬</div>
            <div style="font-family:'Bebas Neue',sans-serif;font-size:20px;letter-spacing:2px;color:var(--white);margin-bottom:6px;">DROP YOUR VIDEO HERE</div>
            <div style="font-size:12px;color:var(--muted);margin-bottom:10px;">or click to browse · MP4, MOV, AVI · Max 2GB</div>
            <div style="display:inline-flex;align-items:center;gap:6px;background:rgba(99,102,241,0.1);border:1px solid rgba(99,102,241,0.3);border-radius:20px;padding:5px 14px;font-family:'DM Mono',monospace;font-size:10px;color:#818cf8;letter-spacing:1px;">⏱ Minimum 3 minutes required</div>
          </div>
          <div id="vc-upload-preview" style="display:none;">
            <video id="vc-video-preview" controls style="width:100%;max-height:300px;border-radius:10px;background:#000;"></video>
            <div id="vc-video-info" style="margin-top:10px;font-family:'DM Mono',monospace;font-size:11px;color:var(--g4);"></div>
          </div>
        </div>

        <!-- Video details form -->
        <div style="background:var(--s1);border:1.5px solid rgba(99,102,241,0.2);border-radius:16px;padding:22px;margin-bottom:18px;">
          <div style="font-family:'DM Mono',monospace;font-size:10px;color:rgba(99,102,241,0.7);letter-spacing:2px;margin-bottom:16px;">VIDEO DETAILS</div>
          <div style="display:flex;flex-direction:column;gap:12px;">
            <div>
              <label style="font-family:'DM Mono',monospace;font-size:10px;color:var(--g4);letter-spacing:1.5px;text-transform:uppercase;display:block;margin-bottom:5px;">Video Title *</label>
              <input id="vc-title" type="text" placeholder="Give your video a compelling title" style="width:100%;padding:11px 14px;background:rgba(4,10,5,0.9);border:1.5px solid var(--border2);border-radius:9px;font-family:'Plus Jakarta Sans',sans-serif;font-size:14px;color:var(--white);outline:none;transition:border-color 0.2s;" onfocus="this.style.borderColor='rgba(99,102,241,0.5)'" onblur="this.style.borderColor='var(--border2)'"/>
            </div>
            <div>
              <label style="font-family:'DM Mono',monospace;font-size:10px;color:var(--g4);letter-spacing:1.5px;text-transform:uppercase;display:block;margin-bottom:5px;">Description *</label>
              <textarea id="vc-description" rows="4" placeholder="Describe your video content, target audience, key points..." style="width:100%;padding:11px 14px;background:rgba(4,10,5,0.9);border:1.5px solid var(--border2);border-radius:9px;font-family:'Plus Jakarta Sans',sans-serif;font-size:13px;color:var(--white);outline:none;resize:none;" onfocus="this.style.borderColor='rgba(99,102,241,0.5)'" onblur="this.style.borderColor='var(--border2)'"></textarea>
            </div>
            <div style="display:grid;grid-template-columns:1fr 1fr;gap:10px;">
              <div>
                <label style="font-family:'DM Mono',monospace;font-size:10px;color:var(--g4);letter-spacing:1.5px;text-transform:uppercase;display:block;margin-bottom:5px;">Category</label>
                <select id="vc-category" style="width:100%;padding:11px 14px;background:rgba(4,10,5,0.9);border:1.5px solid var(--border2);border-radius:9px;font-family:'Plus Jakarta Sans',sans-serif;font-size:13px;color:var(--white);outline:none;">
                  <option value="">Choose…</option>
                  <option>🚀 Startup</option>
                  <option>💻 Tech</option>
                  <option>📈 Marketing</option>
                  <option>🎨 Design</option>
                  <option>💰 Finance</option>
                  <option>🎓 Tutorial</option>
                  <option>💬 Interview</option>
                  <option>🌐 Other</option>
                </select>
              </div>
              <div>
                <label style="font-family:'DM Mono',monospace;font-size:10px;color:var(--g4);letter-spacing:1.5px;text-transform:uppercase;display:block;margin-bottom:5px;">Tags (comma separated)</label>
                <input id="vc-tags" type="text" placeholder="startup, growth, ai…" style="width:100%;padding:11px 14px;background:rgba(4,10,5,0.9);border:1.5px solid var(--border2);border-radius:9px;font-family:'Plus Jakarta Sans',sans-serif;font-size:13px;color:var(--white);outline:none;" onfocus="this.style.borderColor='rgba(99,102,241,0.5)'" onblur="this.style.borderColor='var(--border2)'"/>
              </div>
            </div>
            <!-- Thumbnail upload -->
            <div>
              <label style="font-family:'DM Mono',monospace;font-size:10px;color:var(--g4);letter-spacing:1.5px;text-transform:uppercase;display:block;margin-bottom:5px;">Custom Thumbnail</label>
              <div onclick="document.getElementById('vc-thumb-input').click()" style="border:2px dashed rgba(99,102,241,0.3);border-radius:10px;padding:14px;text-align:center;cursor:pointer;transition:all 0.2s;" onmouseover="this.style.borderColor='rgba(99,102,241,0.6)'" onmouseout="this.style.borderColor='rgba(99,102,241,0.3)'">
                <div id="vc-thumb-preview" style="font-size:12px;color:var(--muted);">🖼️ Click to upload a custom thumbnail</div>
                <input type="file" id="vc-thumb-input" accept="image/*" style="display:none;" onchange="previewVideoThumb(this)"/>
              </div>
            </div>
            <!-- Visibility -->
            <div style="display:grid;grid-template-columns:1fr 1fr;gap:10px;">
              <div>
                <label style="font-family:'DM Mono',monospace;font-size:10px;color:var(--g4);letter-spacing:1.5px;text-transform:uppercase;display:block;margin-bottom:5px;">Visibility</label>
                <select id="vc-visibility" style="width:100%;padding:11px 14px;background:rgba(4,10,5,0.9);border:1.5px solid var(--border2);border-radius:9px;font-family:'Plus Jakarta Sans',sans-serif;font-size:13px;color:var(--white);outline:none;">
                  <option>🌍 Public</option>
                  <option>👥 Followers only</option>
                  <option>🔒 Private (link only)</option>
                </select>
              </div>
              <div>
                <label style="font-family:'DM Mono',monospace;font-size:10px;color:var(--g4);letter-spacing:1.5px;text-transform:uppercase;display:block;margin-bottom:5px;">Allow Comments</label>
                <select id="vc-comments" style="width:100%;padding:11px 14px;background:rgba(4,10,5,0.9);border:1.5px solid var(--border2);border-radius:9px;font-family:'Plus Jakarta Sans',sans-serif;font-size:13px;color:var(--white);outline:none;">
                  <option>✅ Yes — enabled</option>
                  <option>🔒 Followers only</option>
                  <option>❌ No</option>
                </select>
              </div>
            </div>
          </div>
        </div>

        <!-- Duration warning banner -->
        <div id="vc-duration-warning" style="display:none;background:rgba(251,146,60,0.08);border:1.5px solid rgba(251,146,60,0.35);border-radius:10px;padding:12px 16px;margin-bottom:16px;display:flex;align-items:center;gap:10px;">
          <span style="font-size:20px;">⚠️</span>
          <div>
            <div style="font-size:12px;font-weight:700;color:#fb923c;">Video too short</div>
            <div style="font-size:11px;color:var(--muted);">Minimum duration is <strong style="color:#fb923c;">3 minutes</strong>. Your video is <span id="vc-duration-val">0s</span>.</div>
          </div>
        </div>

        <!-- Publish button -->
        <button id="btn-publish-video" onclick="publishVideo()" style="width:100%;padding:16px;background:linear-gradient(135deg,#4f46e5,#6366f1);border:none;border-radius:12px;font-family:'Plus Jakarta Sans',sans-serif;font-size:15px;font-weight:800;cursor:pointer;color:#fff;box-shadow:0 0 28px rgba(99,102,241,0.35);transition:all 0.2s;display:flex;align-items:center;justify-content:center;gap:10px;" onmouseover="this.style.boxShadow='0 0 44px rgba(99,102,241,0.55)';this.style.transform='translateY(-2px)'" onmouseout="this.style.boxShadow='0 0 28px rgba(99,102,241,0.35)';this.style.transform=''">
          🎬 Publish Video
        </button>
        <div style="text-align:center;margin-top:10px;font-size:11px;color:var(--muted2);font-family:'DM Mono',monospace;">Videos appear in the Videos tab after publication</div>
      </div>
    </div><!-- /tab-video-creator -->

    <!-- ══════════ VIDEOS (video ads feed) ══════════ -->
    <div class="tpanel" id="tab-videos">
      <div style="max-width:900px;margin:0 auto;padding:22px 0 80px;">
        <!-- Header -->
        <div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:20px;flex-wrap:wrap;gap:12px;">
          <div style="display:flex;align-items:center;gap:14px;">
            <div style="width:46px;height:46px;border-radius:12px;background:linear-gradient(135deg,#7c3aed,#8b5cf6);display:flex;align-items:center;justify-content:center;font-size:22px;box-shadow:0 0 20px rgba(139,92,246,0.4);">📹</div>
            <div>
              <h2 style="font-family:'Bebas Neue',sans-serif;font-size:30px;letter-spacing:2px;color:#a78bfa;line-height:1;margin:0;">VIDEOS</h2>
              <p style="font-size:12px;color:var(--muted);margin:2px 0 0;">Community videos & sponsored video ads</p>
            </div>
          </div>
          <button onclick="showAppTab('video-creator',document.querySelector('[data-tab=video-creator]'))" style="display:flex;align-items:center;gap:7px;background:linear-gradient(135deg,#4f46e5,#6366f1);border:none;border-radius:10px;padding:10px 20px;font-family:'Plus Jakarta Sans',sans-serif;font-size:13px;font-weight:700;cursor:pointer;color:#fff;box-shadow:0 0 16px rgba(99,102,241,0.3);transition:all 0.2s;" onmouseover="this.style.boxShadow='0 0 28px rgba(99,102,241,0.5)';this.style.transform='translateY(-1px)'" onmouseout="this.style.boxShadow='0 0 16px rgba(99,102,241,0.3)';this.style.transform=''">
            + Upload Video
          </button>
        </div>

        <!-- Filters -->
        <div class="feed-tabs" style="margin-bottom:20px;">
          <button class="feed-tab active" onclick="filterVideos('all',this)">🎬 All Videos</button>
          <button class="feed-tab" onclick="filterVideos('sponsored',this)">💼 Sponsored Ads</button>
          <button class="feed-tab" onclick="filterVideos('live-replays',this)">🔴 Live Replays</button>
          <button class="feed-tab" onclick="filterVideos('trending',this)">🔥 Trending</button>
        </div>

        <!-- Search bar -->
        <div style="position:relative;margin-bottom:20px;">
          <input id="videos-search" type="text" placeholder="Search videos by title, creator or tag..." oninput="searchVideos(this.value)" style="width:100%;padding:11px 14px 11px 40px;background:var(--s1);border:1.5px solid var(--border2);border-radius:10px;font-family:'Plus Jakarta Sans',sans-serif;font-size:13px;color:var(--white);outline:none;transition:border-color 0.2s;" onfocus="this.style.borderColor='rgba(139,92,246,0.5)'" onblur="this.style.borderColor='var(--border2)'"/>
          <span style="position:absolute;left:13px;top:50%;transform:translateY(-50%);font-size:15px;pointer-events:none;">🔍</span>
        </div>

        <!-- Sponsored video banner (top slot) -->
        <div id="videos-sponsored-slot" style="background:linear-gradient(135deg,rgba(99,102,241,0.1),rgba(139,92,246,0.06));border:1.5px solid rgba(99,102,241,0.3);border-radius:14px;padding:16px 18px;margin-bottom:20px;display:flex;align-items:center;gap:14px;position:relative;overflow:hidden;">
          <div style="position:absolute;top:8px;right:10px;background:linear-gradient(135deg,#4f46e5,#6366f1);color:#fff;font-family:'DM Mono',monospace;font-size:7px;font-weight:900;padding:2px 8px;border-radius:3px;letter-spacing:1px;">SPONSORED</div>
          <div style="width:90px;height:56px;border-radius:8px;background:linear-gradient(135deg,#1e1b4b,#312e81);display:flex;align-items:center;justify-content:center;font-size:28px;flex-shrink:0;">📺</div>
          <div style="flex:1;min-width:0;">
            <div style="font-size:13px;font-weight:800;color:var(--white);margin-bottom:2px;">Advertise here — Video Slot</div>
            <div style="font-size:11px;color:var(--muted);line-height:1.5;">Place your sponsored video ad in the #1 position. Seen by every member visiting the Videos tab.</div>
          </div>
          <button onclick="showSponsorTab(document.getElementById('tab-btn-sponsor'))" style="flex-shrink:0;background:linear-gradient(135deg,#4f46e5,#6366f1);border:none;border-radius:8px;padding:9px 16px;font-family:'Plus Jakarta Sans',sans-serif;font-size:12px;font-weight:700;color:#fff;cursor:pointer;white-space:nowrap;">Get Slot →</button>
        </div>

        <!-- Video grid — populated from real published videos -->
        <div id="videos-grid" style="display:grid;grid-template-columns:repeat(auto-fill,minmax(260px,1fr));gap:16px;">

          <!-- Empty state shown when no videos exist yet -->
          <div id="videos-empty-state" style="grid-column:1/-1;text-align:center;padding:60px 20px;background:rgba(99,102,241,0.03);border:2px dashed rgba(99,102,241,0.2);border-radius:16px;">
            <div style="font-size:52px;margin-bottom:16px;opacity:0.4;">🎬</div>
            <div style="font-family:'Bebas Neue',sans-serif;font-size:22px;letter-spacing:2px;color:rgba(99,102,241,0.5);margin-bottom:8px;">NO VIDEOS YET</div>
            <div style="font-size:12px;color:var(--muted);line-height:1.7;max-width:360px;margin:0 auto 24px;">
              Be the first to publish a video.<br>
              <strong style="color:#818cf8;">A custom thumbnail is required</strong> for every video — no thumbnail, no publish.
            </div>
            <button onclick="showAppTab('video-creator',document.querySelector('[data-tab=video-creator]'))" style="padding:12px 32px;background:linear-gradient(135deg,#4f46e5,#6366f1);border:none;border-radius:10px;font-family:'Plus Jakarta Sans',sans-serif;font-size:13px;font-weight:800;cursor:pointer;color:#fff;box-shadow:0 0 20px rgba(99,102,241,0.3);transition:all 0.2s;" onmouseover="this.style.boxShadow='0 0 32px rgba(99,102,241,0.55)';this.style.transform='translateY(-1px)'" onmouseout="this.style.boxShadow='0 0 20px rgba(99,102,241,0.3)';this.style.transform=''">
              🎬 Upload the First Video
            </button>
          </div>

        </div>
      </div>
    </div><!-- /tab-videos -->


<!-- ══════════ EMAIL CAMPAIGNS ══════════ -->
<div class="tpanel" id="tab-email-campaign">
  <div style="max-width:900px;margin:0 auto;padding:32px 20px;">
    <div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:28px;flex-wrap:wrap;gap:12px;">
      <div>
        <div style="font-family:'DM Mono',monospace;font-size:10px;letter-spacing:2px;color:#0ea5e9;text-transform:uppercase;margin-bottom:6px;">Email Marketing</div>
        <h2 style="font-family:'Bebas Neue',sans-serif;font-size:32px;letter-spacing:2px;color:var(--white);">Campaigns</h2>
      </div>
      <button onclick="ecOpenNewModal()" style="padding:11px 22px;background:linear-gradient(135deg,#0284c7,#0ea5e9);border:none;border-radius:8px;font-family:'Plus Jakarta Sans',sans-serif;font-size:13px;font-weight:700;color:#fff;cursor:pointer;">+ New Campaign</button>
    </div>
    <!-- Stats -->
    <div style="display:grid;grid-template-columns:repeat(4,1fr);gap:12px;margin-bottom:28px;">
      <div style="background:var(--s1);border:1px solid var(--border2);border-radius:10px;padding:18px 16px;">
        <div style="font-size:10px;font-family:'DM Mono',monospace;color:var(--muted);letter-spacing:1px;text-transform:uppercase;margin-bottom:8px;">Total Sent</div>
        <div id="ec-stat-sent" style="font-family:'Bebas Neue',sans-serif;font-size:30px;color:#0ea5e9;">0</div>
      </div>
      <div style="background:var(--s1);border:1px solid var(--border2);border-radius:10px;padding:18px 16px;">
        <div style="font-size:10px;font-family:'DM Mono',monospace;color:var(--muted);letter-spacing:1px;text-transform:uppercase;margin-bottom:8px;">Campaigns</div>
        <div id="ec-stat-total" style="font-family:'Bebas Neue',sans-serif;font-size:30px;color:#0ea5e9;">0</div>
      </div>
      <div style="background:var(--s1);border:1px solid var(--border2);border-radius:10px;padding:18px 16px;">
        <div style="font-size:10px;font-family:'DM Mono',monospace;color:var(--muted);letter-spacing:1px;text-transform:uppercase;margin-bottom:8px;">Drafts</div>
        <div id="ec-stat-draft" style="font-family:'Bebas Neue',sans-serif;font-size:30px;color:#0ea5e9;">0</div>
      </div>
      <div style="background:var(--s1);border:1px solid var(--border2);border-radius:10px;padding:18px 16px;">
        <div style="font-size:10px;font-family:'DM Mono',monospace;color:var(--muted);letter-spacing:1px;text-transform:uppercase;margin-bottom:8px;">Subscribers</div>
        <div id="ec-stat-subs" style="font-family:'Bebas Neue',sans-serif;font-size:30px;color:#0ea5e9;">0</div>
      </div>
    </div>
    <!-- Campaigns list -->
    <div id="ec-list-wrap"></div>
  </div>
</div>

<!-- EMAIL CAMPAIGN MODAL -->
<div id="ec-modal" style="display:none;position:fixed;inset:0;background:rgba(0,0,0,0.75);z-index:10000;align-items:center;justify-content:center;padding:20px;">
  <div style="background:var(--s1);border:1.5px solid var(--border);border-radius:16px;padding:32px;width:100%;max-width:540px;max-height:90vh;overflow-y:auto;position:relative;">
    <button onclick="ecCloseModal()" style="position:absolute;top:14px;right:16px;background:transparent;border:none;color:var(--muted);font-size:20px;cursor:pointer;">✕</button>
    <div style="font-family:'DM Mono',monospace;font-size:10px;letter-spacing:2px;color:#0ea5e9;margin-bottom:6px;">EMAIL MARKETING</div>
    <h3 id="ec-modal-title" style="font-family:'Bebas Neue',sans-serif;font-size:26px;color:var(--white);margin-bottom:20px;">New Campaign</h3>
    <div style="display:flex;flex-direction:column;gap:14px;">
      <div>
        <label style="font-size:11px;font-family:'DM Mono',monospace;color:var(--muted);letter-spacing:1px;text-transform:uppercase;margin-bottom:6px;display:block;">Campaign Name *</label>
        <input id="ec-name" type="text" placeholder="Ex: Welcome Series, Product Launch..." style="width:100%;padding:11px 14px;background:var(--bg);border:1.5px solid var(--border);border-radius:8px;font-family:'Plus Jakarta Sans',sans-serif;font-size:14px;color:var(--white);outline:none;" onfocus="this.style.borderColor='#0ea5e9'" onblur="this.style.borderColor='var(--border)'"/>
      </div>
      <div>
        <label style="font-size:11px;font-family:'DM Mono',monospace;color:var(--muted);letter-spacing:1px;text-transform:uppercase;margin-bottom:6px;display:block;">Subject Line *</label>
        <input id="ec-subject" type="text" placeholder="Your email subject..." style="width:100%;padding:11px 14px;background:var(--bg);border:1.5px solid var(--border);border-radius:8px;font-family:'Plus Jakarta Sans',sans-serif;font-size:14px;color:var(--white);outline:none;" onfocus="this.style.borderColor='#0ea5e9'" onblur="this.style.borderColor='var(--border)'"/>
      </div>
      <div>
        <label style="font-size:11px;font-family:'DM Mono',monospace;color:var(--muted);letter-spacing:1px;text-transform:uppercase;margin-bottom:6px;display:block;">From Name</label>
        <input id="ec-from" type="text" placeholder="Your name or brand..." style="width:100%;padding:11px 14px;background:var(--bg);border:1.5px solid var(--border);border-radius:8px;font-family:'Plus Jakarta Sans',sans-serif;font-size:14px;color:var(--white);outline:none;" onfocus="this.style.borderColor='#0ea5e9'" onblur="this.style.borderColor='var(--border)'"/>
      </div>
      <div>
        <label style="font-size:11px;font-family:'DM Mono',monospace;color:var(--muted);letter-spacing:1px;text-transform:uppercase;margin-bottom:6px;display:block;">Recipients (emails, comma separated)</label>
        <input id="ec-recipients" type="text" placeholder="email1@ex.com, email2@ex.com..." style="width:100%;padding:11px 14px;background:var(--bg);border:1.5px solid var(--border);border-radius:8px;font-family:'Plus Jakarta Sans',sans-serif;font-size:14px;color:var(--white);outline:none;" onfocus="this.style.borderColor='#0ea5e9'" onblur="this.style.borderColor='var(--border)'"/>
      </div>
      <div>
        <label style="font-size:11px;font-family:'DM Mono',monospace;color:var(--muted);letter-spacing:1px;text-transform:uppercase;margin-bottom:6px;display:block;">Email Body *</label>
        <textarea id="ec-body" rows="6" placeholder="Write your email content here..." style="width:100%;padding:11px 14px;background:var(--bg);border:1.5px solid var(--border);border-radius:8px;font-family:'Plus Jakarta Sans',sans-serif;font-size:14px;color:var(--white);outline:none;resize:vertical;" onfocus="this.style.borderColor='#0ea5e9'" onblur="this.style.borderColor='var(--border)'"></textarea>
      </div>
      <div>
        <label style="font-size:11px;font-family:'DM Mono',monospace;color:var(--muted);letter-spacing:1px;text-transform:uppercase;margin-bottom:6px;display:block;">Schedule (optional)</label>
        <input id="ec-schedule" type="datetime-local" style="width:100%;padding:11px 14px;background:var(--bg);border:1.5px solid var(--border);border-radius:8px;font-family:'Plus Jakarta Sans',sans-serif;font-size:14px;color:var(--white);outline:none;" onfocus="this.style.borderColor='#0ea5e9'" onblur="this.style.borderColor='var(--border)'"/>
      </div>
      <input type="hidden" id="ec-edit-id"/>
      <div style="display:flex;gap:10px;margin-top:6px;">
        <button onclick="ecSaveCampaign('draft')" style="flex:1;padding:12px;background:var(--s2);border:1.5px solid var(--border);border-radius:8px;font-family:'Plus Jakarta Sans',sans-serif;font-size:13px;font-weight:700;color:var(--white);cursor:pointer;">Save Draft</button>
        <button onclick="ecSaveCampaign('sent')" style="flex:2;padding:12px;background:linear-gradient(135deg,#0284c7,#0ea5e9);border:none;border-radius:8px;font-family:'Plus Jakarta Sans',sans-serif;font-size:13px;font-weight:700;color:#fff;cursor:pointer;">Send Campaign →</button>
      </div>
    </div>
  </div>
</div>

<script>
// ═══ EMAIL CAMPAIGN ENGINE ═══
function ecGetAll(){ try{ return JSON.parse(localStorage.getItem('vb_campaigns')||'[]'); }catch(e){ return []; } }
function ecSaveAll(arr){ localStorage.setItem('vb_campaigns', JSON.stringify(arr)); }

function ecOpenNewModal(){ 
  document.getElementById('ec-name').value=''; document.getElementById('ec-subject').value='';
  document.getElementById('ec-from').value=''; document.getElementById('ec-recipients').value='';
  document.getElementById('ec-body').value=''; document.getElementById('ec-schedule').value='';
  document.getElementById('ec-edit-id').value='';
  document.getElementById('ec-modal-title').textContent='New Campaign';
  document.getElementById('ec-modal').style.display='flex'; 
}
function ecCloseModal(){ document.getElementById('ec-modal').style.display='none'; }
document.getElementById('ec-modal').addEventListener('click',function(e){ if(e.target===this) ecCloseModal(); });

function ecSaveCampaign(status){
  var name=document.getElementById('ec-name').value.trim();
  var subject=document.getElementById('ec-subject').value.trim();
  var body=document.getElementById('ec-body').value.trim();
  if(!name||!subject||!body){ toast('⚠️ Name, subject and body are required.'); return; }
  var recipients=document.getElementById('ec-recipients').value.split(',').map(e=>e.trim()).filter(e=>e);
  var schedule=document.getElementById('ec-schedule').value;
  var editId=document.getElementById('ec-edit-id').value;
  var campaigns=ecGetAll();
  if(editId){
    var idx=campaigns.findIndex(c=>c.id===editId);
    if(idx>-1){ campaigns[idx]={...campaigns[idx],name,subject,body,from:document.getElementById('ec-from').value.trim(),recipients,schedule,status,updatedAt:new Date().toISOString()}; }
  } else {
    campaigns.push({id:'ec_'+Date.now(),name,subject,body,from:document.getElementById('ec-from').value.trim(),recipients,schedule,status,createdAt:new Date().toISOString(),sentCount:status==='sent'?recipients.length:0});
  }
  ecSaveAll(campaigns);
  ecCloseModal();
  ecRender();
  toast(status==='sent'?'✅ Campaign sent to '+recipients.length+' recipient(s)!':'💾 Draft saved!');
}

function ecEditCampaign(id){
  var c=ecGetAll().find(c=>c.id===id); if(!c) return;
  document.getElementById('ec-name').value=c.name||'';
  document.getElementById('ec-subject').value=c.subject||'';
  document.getElementById('ec-from').value=c.from||'';
  document.getElementById('ec-recipients').value=(c.recipients||[]).join(', ');
  document.getElementById('ec-body').value=c.body||'';
  document.getElementById('ec-schedule').value=c.schedule||'';
  document.getElementById('ec-edit-id').value=c.id;
  document.getElementById('ec-modal-title').textContent='Edit Campaign';
  document.getElementById('ec-modal').style.display='flex';
}

function ecDeleteCampaign(id){
  var campaigns=ecGetAll().filter(c=>c.id!==id); ecSaveAll(campaigns); ecRender(); toast('🗑️ Campaign deleted.');
}

function ecRender(){
  var campaigns=ecGetAll();
  var sent=campaigns.filter(c=>c.status==='sent');
  var drafts=campaigns.filter(c=>c.status==='draft');
  var totalRecipients=sent.reduce((a,c)=>a+(c.recipients||[]).length,0);
  document.getElementById('ec-stat-sent').textContent=totalRecipients;
  document.getElementById('ec-stat-total').textContent=campaigns.length;
  document.getElementById('ec-stat-draft').textContent=drafts.length;
  // count CRM contacts as subscribers
  try{ var crm=JSON.parse(localStorage.getItem('vb_crm')||'[]'); document.getElementById('ec-stat-subs').textContent=crm.length; }catch(e){}
  var wrap=document.getElementById('ec-list-wrap');
  if(!campaigns.length){
    wrap.innerHTML='<div style="background:var(--s1);border:1px solid var(--border2);border-radius:12px;padding:56px 32px;text-align:center;"><div style="width:52px;height:52px;border-radius:12px;background:rgba(14,165,233,0.1);border:1px solid rgba(14,165,233,0.2);display:flex;align-items:center;justify-content:center;margin:0 auto 16px;"><svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="#0ea5e9" stroke-width="1.5"><rect x="2" y="4" width="20" height="16" rx="2"/><path d="M2 7l10 7 10-7"/></svg></div><div style="font-size:15px;font-weight:700;color:var(--white);margin-bottom:8px;">No campaigns yet</div><div style="font-size:13px;color:var(--muted);margin-bottom:20px;">Create your first email campaign to reach your audience.</div><button onclick="ecOpenNewModal()" style="padding:11px 24px;background:linear-gradient(135deg,#0284c7,#0ea5e9);border:none;border-radius:8px;font-family:\'Plus Jakarta Sans\',sans-serif;font-size:13px;font-weight:700;color:#fff;cursor:pointer;">Create my first campaign</button></div>';
    return;
  }
  wrap.innerHTML='<div style="display:flex;flex-direction:column;gap:10px;">'+campaigns.map(c=>{
    var statusColor=c.status==='sent'?'#22c55e':'#f59e0b';
    var statusLabel=c.status==='sent'?'✅ Sent':'📝 Draft';
    var recCount=(c.recipients||[]).length;
    var date=c.createdAt?new Date(c.createdAt).toLocaleDateString('en-US',{month:'short',day:'numeric',year:'numeric'}):'';
    return '<div style="background:var(--s1);border:1px solid var(--border2);border-radius:12px;padding:18px 20px;display:flex;align-items:center;justify-content:space-between;flex-wrap:wrap;gap:12px;">'
      +'<div style="flex:1;min-width:200px;">'
      +'<div style="display:flex;align-items:center;gap:10px;margin-bottom:6px;">'
      +'<span style="font-size:10px;font-family:\'DM Mono\',monospace;color:'+statusColor+';background:'+statusColor+'18;border:1px solid '+statusColor+'44;border-radius:4px;padding:2px 8px;letter-spacing:1px;">'+statusLabel+'</span>'
      +'<span style="font-size:11px;color:var(--muted);">'+date+'</span></div>'
      +'<div style="font-size:15px;font-weight:700;color:var(--white);margin-bottom:2px;">'+c.name+'</div>'
      +'<div style="font-size:12px;color:var(--muted);">Subject: '+c.subject+'</div>'
      +'<div style="font-size:11px;color:var(--muted2);margin-top:4px;">'+recCount+' recipient(s) · '+(c.from||'—')+'</div>'
      +'</div>'
      +'<div style="display:flex;gap:8px;">'
      +'<button onclick="ecEditCampaign(\''+c.id+'\')" style="padding:8px 14px;background:var(--s2);border:1px solid var(--border);border-radius:7px;font-size:12px;font-weight:600;color:var(--white);cursor:pointer;">Edit</button>'
      +'<button onclick="ecDeleteCampaign(\''+c.id+'\')" style="padding:8px 14px;background:rgba(239,68,68,0.08);border:1px solid rgba(239,68,68,0.2);border-radius:7px;font-size:12px;font-weight:600;color:#ef4444;cursor:pointer;">Delete</button>'
      +'</div></div>';
  }).join('')+'</div>';
}

// Render when tab is activated
document.querySelector('[data-tab="email-campaign"]')?.addEventListener('click', function(){ setTimeout(ecRender,50); });
document.addEventListener('DOMContentLoaded', ecRender);
</script>

<!-- ══════════ CRM ══════════ -->
<div class="tpanel" id="tab-crm">
  <div style="max-width:900px;margin:0 auto;padding:32px 20px;">
    <div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:20px;flex-wrap:wrap;gap:12px;">
      <div>
        <div style="font-family:'DM Mono',monospace;font-size:10px;letter-spacing:2px;color:#14b8a6;text-transform:uppercase;margin-bottom:6px;">Contact Management</div>
        <h2 style="font-family:'Bebas Neue',sans-serif;font-size:32px;letter-spacing:2px;color:var(--white);">CRM</h2>
      </div>
      <div style="display:flex;gap:8px;flex-wrap:wrap;">
        <button onclick="crmImportCSV()" style="padding:10px 16px;background:var(--s2);border:1.5px solid var(--border);border-radius:8px;font-family:'Plus Jakarta Sans',sans-serif;font-size:13px;font-weight:600;color:var(--white);cursor:pointer;">📂 Import CSV</button>
        <button onclick="crmOpenModal()" style="padding:11px 22px;background:linear-gradient(135deg,#0f766e,#14b8a6);border:none;border-radius:8px;font-family:'Plus Jakarta Sans',sans-serif;font-size:13px;font-weight:700;color:#fff;cursor:pointer;">+ Add Contact</button>
      </div>
    </div>
    <!-- Search + filter -->
    <div style="display:flex;gap:10px;margin-bottom:20px;flex-wrap:wrap;">
      <input id="crm-search" type="text" placeholder="🔍 Search contacts..." oninput="crmRender()" style="flex:1;min-width:180px;padding:10px 14px;background:var(--s1);border:1.5px solid var(--border);border-radius:8px;font-family:'Plus Jakarta Sans',sans-serif;font-size:13px;color:var(--white);outline:none;"/>
      <select id="crm-filter" onchange="crmRender()" style="padding:10px 14px;background:var(--s1);border:1.5px solid var(--border);border-radius:8px;font-family:'Plus Jakarta Sans',sans-serif;font-size:13px;color:var(--white);outline:none;">
        <option value="">All stages</option>
        <option value="lead">Leads</option>
        <option value="contacted">Contacted</option>
        <option value="inprogress">In Progress</option>
        <option value="closed">Closed</option>
      </select>
    </div>
    <!-- Pipeline summary -->
    <div id="crm-pipeline" style="display:grid;grid-template-columns:repeat(4,1fr);gap:10px;margin-bottom:24px;"></div>
    <!-- Contacts table -->
    <div id="crm-table-wrap"></div>
    <!-- Hidden CSV input -->
    <input type="file" id="crm-csv-input" accept=".csv" style="display:none;" onchange="crmHandleCSV(this)"/>
  </div>
</div>

<!-- CRM MODAL -->
<div id="crm-modal" style="display:none;position:fixed;inset:0;background:rgba(0,0,0,0.75);z-index:10000;align-items:center;justify-content:center;padding:20px;">
  <div style="background:var(--s1);border:1.5px solid var(--border);border-radius:16px;padding:32px;width:100%;max-width:480px;max-height:90vh;overflow-y:auto;position:relative;">
    <button onclick="crmCloseModal()" style="position:absolute;top:14px;right:16px;background:transparent;border:none;color:var(--muted);font-size:20px;cursor:pointer;">✕</button>
    <div style="font-family:'DM Mono',monospace;font-size:10px;letter-spacing:2px;color:#14b8a6;margin-bottom:6px;">CRM</div>
    <h3 id="crm-modal-title" style="font-family:'Bebas Neue',sans-serif;font-size:26px;color:var(--white);margin-bottom:20px;">Add Contact</h3>
    <div style="display:flex;flex-direction:column;gap:12px;">
      <div>
        <label style="font-size:11px;font-family:'DM Mono',monospace;color:var(--muted);letter-spacing:1px;text-transform:uppercase;margin-bottom:5px;display:block;">Full Name *</label>
        <input id="crm-n" type="text" placeholder="John Doe" style="width:100%;padding:11px 14px;background:var(--bg);border:1.5px solid var(--border);border-radius:8px;font-family:'Plus Jakarta Sans',sans-serif;font-size:14px;color:var(--white);outline:none;" onfocus="this.style.borderColor='#14b8a6'" onblur="this.style.borderColor='var(--border)'"/>
      </div>
      <div>
        <label style="font-size:11px;font-family:'DM Mono',monospace;color:var(--muted);letter-spacing:1px;text-transform:uppercase;margin-bottom:5px;display:block;">Email</label>
        <input id="crm-e" type="email" placeholder="john@example.com" style="width:100%;padding:11px 14px;background:var(--bg);border:1.5px solid var(--border);border-radius:8px;font-family:'Plus Jakarta Sans',sans-serif;font-size:14px;color:var(--white);outline:none;" onfocus="this.style.borderColor='#14b8a6'" onblur="this.style.borderColor='var(--border)'"/>
      </div>
      <div>
        <label style="font-size:11px;font-family:'DM Mono',monospace;color:var(--muted);letter-spacing:1px;text-transform:uppercase;margin-bottom:5px;display:block;">Company</label>
        <input id="crm-c" type="text" placeholder="Company name" style="width:100%;padding:11px 14px;background:var(--bg);border:1.5px solid var(--border);border-radius:8px;font-family:'Plus Jakarta Sans',sans-serif;font-size:14px;color:var(--white);outline:none;" onfocus="this.style.borderColor='#14b8a6'" onblur="this.style.borderColor='var(--border)'"/>
      </div>
      <div>
        <label style="font-size:11px;font-family:'DM Mono',monospace;color:var(--muted);letter-spacing:1px;text-transform:uppercase;margin-bottom:5px;display:block;">Username (ViralBoost)</label>
        <input id="crm-p" type="text" placeholder="@username on ViralBoost" style="width:100%;padding:11px 14px;background:var(--bg);border:1.5px solid var(--border);border-radius:8px;font-family:'Plus Jakarta Sans',sans-serif;font-size:14px;color:var(--white);outline:none;" onfocus="this.style.borderColor='#14b8a6'" onblur="this.style.borderColor='var(--border)'"/>
      </div>
      <div>
        <label style="font-size:11px;font-family:'DM Mono',monospace;color:var(--muted);letter-spacing:1px;text-transform:uppercase;margin-bottom:5px;display:block;">Stage</label>
        <select id="crm-s" style="width:100%;padding:11px 14px;background:var(--bg);border:1.5px solid var(--border);border-radius:8px;font-family:'Plus Jakarta Sans',sans-serif;font-size:14px;color:var(--white);outline:none;">
          <option value="lead">🔵 Lead</option>
          <option value="contacted">🟡 Contacted</option>
          <option value="inprogress">🟠 In Progress</option>
          <option value="closed">🟢 Closed</option>
        </select>
      </div>
      <div>
        <label style="font-size:11px;font-family:'DM Mono',monospace;color:var(--muted);letter-spacing:1px;text-transform:uppercase;margin-bottom:5px;display:block;">Notes</label>
        <textarea id="crm-notes" rows="3" placeholder="Any notes about this contact..." style="width:100%;padding:11px 14px;background:var(--bg);border:1.5px solid var(--border);border-radius:8px;font-family:'Plus Jakarta Sans',sans-serif;font-size:14px;color:var(--white);outline:none;resize:vertical;" onfocus="this.style.borderColor='#14b8a6'" onblur="this.style.borderColor='var(--border)'"></textarea>
      </div>
      <input type="hidden" id="crm-edit-id"/>
      <button onclick="crmSaveContact()" style="width:100%;padding:13px;background:linear-gradient(135deg,#0f766e,#14b8a6);border:none;border-radius:8px;font-family:'Plus Jakarta Sans',sans-serif;font-size:14px;font-weight:700;color:#fff;cursor:pointer;margin-top:4px;">Save Contact</button>
    </div>
  </div>
</div>

<script>
// ═══ CRM ENGINE ═══
function crmGetAll(){ try{ return JSON.parse(localStorage.getItem('vb_crm')||'[]'); }catch(e){ return []; } }
function crmSaveAll(arr){ localStorage.setItem('vb_crm', JSON.stringify(arr)); }

var CRM_STAGES={ lead:{label:'Leads',color:'#3b82f6'}, contacted:{label:'Contacted',color:'#f59e0b'}, inprogress:{label:'In Progress',color:'#f97316'}, closed:{label:'Closed',color:'#22c55e'} };

function crmOpenModal(id){
  var fields=['n','e','c','p','notes'];
  fields.forEach(f=>{ var el=document.getElementById('crm-'+f); if(el) el.value=''; });
  document.getElementById('crm-s').value='lead';
  document.getElementById('crm-edit-id').value='';
  document.getElementById('crm-modal-title').textContent='Add Contact';
  if(id){
    var ct=crmGetAll().find(c=>c.id===id); if(!ct) return;
    document.getElementById('crm-n').value=ct.name||'';
    document.getElementById('crm-e').value=ct.email||'';
    document.getElementById('crm-c').value=ct.company||'';
    document.getElementById('crm-p').value=ct.phone||'';
    document.getElementById('crm-s').value=ct.stage||'lead';
    document.getElementById('crm-notes').value=ct.notes||'';
    document.getElementById('crm-edit-id').value=ct.id;
    document.getElementById('crm-modal-title').textContent='Edit Contact';
  }
  document.getElementById('crm-modal').style.display='flex';
}
function crmCloseModal(){ document.getElementById('crm-modal').style.display='none'; }
document.getElementById('crm-modal').addEventListener('click',function(e){ if(e.target===this) crmCloseModal(); });

function crmSaveContact(){
  var name=document.getElementById('crm-n').value.trim();
  if(!name){ toast('⚠️ Name is required.'); return; }
  var contacts=crmGetAll();
  var editId=document.getElementById('crm-edit-id').value;
  var obj={ name, email:document.getElementById('crm-e').value.trim(), company:document.getElementById('crm-c').value.trim(), phone:document.getElementById('crm-p').value.trim(), stage:document.getElementById('crm-s').value, notes:document.getElementById('crm-notes').value.trim(), updatedAt:new Date().toISOString() };
  if(editId){
    var idx=contacts.findIndex(c=>c.id===editId);
    if(idx>-1) contacts[idx]={...contacts[idx],...obj};
  } else {
    obj.id='crm_'+Date.now(); obj.createdAt=new Date().toISOString();
    contacts.push(obj);
  }
  crmSaveAll(contacts); crmCloseModal(); crmRender();
  toast(editId?'✅ Contact updated!':'✅ Contact added!');
}

function crmDeleteContact(id){
  crmSaveAll(crmGetAll().filter(c=>c.id!==id)); crmRender(); toast('🗑️ Contact deleted.');
}

function crmMoveStage(id, stage){
  var contacts=crmGetAll(); var idx=contacts.findIndex(c=>c.id===id);
  if(idx>-1){ contacts[idx].stage=stage; contacts[idx].updatedAt=new Date().toISOString(); }
  crmSaveAll(contacts); crmRender();
}

function crmImportCSV(){ document.getElementById('crm-csv-input').click(); }

function crmHandleCSV(input){
  var file=input.files[0]; if(!file) return;
  var reader=new FileReader();
  reader.onload=function(e){
    var lines=e.target.result.split('\n').filter(l=>l.trim());
    var contacts=crmGetAll(); var added=0;
    lines.forEach(function(line,i){
      if(i===0 && line.toLowerCase().includes('name')) return; // skip header
      var cols=line.split(',').map(s=>s.replace(/"/g,'').trim());
      if(!cols[0]) return;
      contacts.push({ id:'crm_'+Date.now()+'_'+i, name:cols[0]||'', email:cols[1]||'', company:cols[2]||'', phone:cols[3]||'', stage:'lead', notes:'', createdAt:new Date().toISOString() });
      added++;
    });
    crmSaveAll(contacts); crmRender();
    toast('✅ '+added+' contact(s) imported!');
  };
  reader.readAsText(file);
  input.value='';
}

function crmRender(){
  var all=crmGetAll();
  var search=(document.getElementById('crm-search')?.value||'').toLowerCase();
  var filter=document.getElementById('crm-filter')?.value||'';
  var filtered=all.filter(c=>{
    var matchSearch=!search||(c.name+c.email+c.company).toLowerCase().includes(search);
    var matchFilter=!filter||c.stage===filter;
    return matchSearch&&matchFilter;
  });
  // Pipeline
  var pipeline=document.getElementById('crm-pipeline');
  if(pipeline){
    pipeline.innerHTML=Object.entries(CRM_STAGES).map(([key,s])=>{
      var cnt=all.filter(c=>c.stage===key).length;
      return '<div style="background:var(--s1);border:1px solid var(--border2);border-radius:10px;padding:14px 16px;">'
        +'<div style="display:flex;align-items:center;gap:6px;margin-bottom:8px;">'
        +'<span style="width:8px;height:8px;border-radius:50%;background:'+s.color+';display:inline-block;"></span>'
        +'<span style="font-size:10px;font-family:\'DM Mono\',monospace;color:var(--muted);letter-spacing:1px;text-transform:uppercase;">'+s.label+'</span></div>'
        +'<div style="font-family:\'Bebas Neue\',sans-serif;font-size:32px;color:'+s.color+';">'+cnt+'</div>'
        +'</div>';
    }).join('');
  }
  // Table
  var wrap=document.getElementById('crm-table-wrap');
  if(!filtered.length){
    wrap.innerHTML='<div style="background:var(--s1);border:1px solid var(--border2);border-radius:12px;padding:48px 32px;text-align:center;">'
      +'<div style="font-size:32px;margin-bottom:12px;">👥</div>'
      +'<div style="font-size:15px;font-weight:700;color:var(--white);margin-bottom:8px;">'+(all.length?'No results':'No contacts yet')+'</div>'
      +'<div style="font-size:13px;color:var(--muted);margin-bottom:20px;">'+(all.length?'Try a different search.':'Add your first contact or import a CSV.')+'</div>'
      +(all.length?'':'<div style="display:flex;gap:10px;justify-content:center;">'
        +'<button onclick="crmImportCSV()" style="padding:10px 20px;background:var(--s2);border:1px solid var(--border);border-radius:8px;font-family:\'Plus Jakarta Sans\',sans-serif;font-size:13px;font-weight:600;color:var(--white);cursor:pointer;">Import CSV</button>'
        +'<button onclick="crmOpenModal()" style="padding:10px 20px;background:linear-gradient(135deg,#0f766e,#14b8a6);border:none;border-radius:8px;font-family:\'Plus Jakarta Sans\',sans-serif;font-size:13px;font-weight:700;color:#fff;cursor:pointer;">Add manually</button>'
        +'</div>')
      +'</div>';
    return;
  }
  var stageOptions=Object.entries(CRM_STAGES).map(([k,s])=>'<option value="'+k+'">'+s.label+'</option>').join('');
  wrap.innerHTML='<div style="background:var(--s1);border:1px solid var(--border2);border-radius:12px;overflow:hidden;">'
    +'<table style="width:100%;border-collapse:collapse;">'
    +'<thead><tr style="border-bottom:1px solid var(--border2);">'
    +'<th style="padding:12px 16px;text-align:left;font-size:10px;font-family:\'DM Mono\',monospace;color:var(--muted);letter-spacing:1px;text-transform:uppercase;">Name / @Username</th>'
    +'<th style="padding:12px 16px;text-align:left;font-size:10px;font-family:\'DM Mono\',monospace;color:var(--muted);letter-spacing:1px;text-transform:uppercase;">Email</th>'
    +'<th style="padding:12px 16px;text-align:left;font-size:10px;font-family:\'DM Mono\',monospace;color:var(--muted);letter-spacing:1px;text-transform:uppercase;">Company</th>'
    +'<th style="padding:12px 16px;text-align:left;font-size:10px;font-family:\'DM Mono\',monospace;color:var(--muted);letter-spacing:1px;text-transform:uppercase;">Stage</th>'
    +'<th style="padding:12px 16px;text-align:right;font-size:10px;font-family:\'DM Mono\',monospace;color:var(--muted);letter-spacing:1px;text-transform:uppercase;">Actions</th>'
    +'</tr></thead><tbody>'
    +filtered.map(c=>{
      var s=CRM_STAGES[c.stage]||CRM_STAGES.lead;
      return '<tr style="border-bottom:1px solid var(--border2);">'
        +'<td style="padding:12px 16px;"><span style="font-size:14px;font-weight:600;color:var(--white);">'+c.name+'</span>'+(c.phone?'<div style="font-size:11px;color:#14b8a6;margin-top:2px;">@'+c.phone.replace(/^@/,'')+'</div>':'')+'</td>'
        +'<td style="padding:12px 16px;font-size:13px;color:var(--muted);">'+(c.email||'—')+'</td>'
        +'<td style="padding:12px 16px;font-size:13px;color:var(--muted);">'+(c.company||'—')+'</td>'
        +'<td style="padding:12px 16px;">'
        +'<select onchange="crmMoveStage(\''+c.id+'\',this.value)" style="padding:5px 8px;background:'+s.color+'18;border:1px solid '+s.color+'55;border-radius:6px;font-size:11px;font-family:\'DM Mono\',monospace;color:'+s.color+';outline:none;cursor:pointer;">'+Object.entries(CRM_STAGES).map(([k,st])=>'<option value="'+k+'"'+(c.stage===k?' selected':'')+'>'+st.label+'</option>').join('')+'</select>'
        +'</td>'
        +'<td style="padding:12px 16px;text-align:right;">'
        +'<button onclick="crmOpenModal(\''+c.id+'\')" style="padding:6px 12px;background:var(--s2);border:1px solid var(--border);border-radius:6px;font-size:11px;font-weight:600;color:var(--white);cursor:pointer;margin-right:6px;">Edit</button>'
        +'<button onclick="crmDeleteContact(\''+c.id+'\')" style="padding:6px 12px;background:rgba(239,68,68,0.08);border:1px solid rgba(239,68,68,0.2);border-radius:6px;font-size:11px;font-weight:600;color:#ef4444;cursor:pointer;">Delete</button>'
        +'</td></tr>';
    }).join('')
    +'</tbody></table></div>';
}

document.querySelector('[data-tab="crm"]')?.addEventListener('click', function(){ setTimeout(crmRender,50); });
document.addEventListener('DOMContentLoaded', crmRender);
</script>

<!-- ══════════ BIG CAMPAIGN ══════════ -->
<div class="tpanel" id="tab-big-campaign">
  <div style="max-width:960px;margin:0 auto;padding:32px 20px;">

    <!-- HEADER -->
    <div style="text-align:center;margin-bottom:36px;">
      <div style="display:inline-flex;align-items:center;gap:8px;background:rgba(255,60,110,0.08);border:1px solid rgba(255,60,110,0.25);border-radius:30px;padding:6px 18px;margin-bottom:16px;">
        <span style="font-size:16px;">🔥</span>
        <span style="font-family:'DM Mono',monospace;font-size:10px;letter-spacing:2px;color:#ff3c6e;text-transform:uppercase;font-weight:700;">Premium Advertising</span>
      </div>
      <h2 style="font-family:'Bebas Neue',sans-serif;font-size:52px;letter-spacing:3px;color:var(--white);line-height:1;margin-bottom:10px;">BIG CAMPAIGN</h2>
      <p style="font-size:14px;color:var(--muted);max-width:500px;margin:0 auto;">Ultra-powered ad placement — Maximum visibility across the entire ViralBoost network. Your brand, front and center.</p>
    </div>

    <!-- MY CAMPAIGNS -->
    <div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:16px;">
      <div style="font-family:'Bebas Neue',sans-serif;font-size:22px;letter-spacing:2px;color:var(--white);">My Big Campaigns</div>
      <button onclick="bcOpenModal()" style="padding:11px 24px;background:linear-gradient(135deg,#be123c,#ff3c6e);border:none;border-radius:8px;font-family:'Plus Jakarta Sans',sans-serif;font-size:13px;font-weight:800;color:#fff;cursor:pointer;box-shadow:0 0 24px rgba(255,60,110,0.35);">🔥 Launch New Campaign</button>
    </div>
    <div id="bc-list"></div>

    <!-- PLANS -->
    <div style="margin-top:48px;">
      <div style="text-align:center;margin-bottom:24px;">
        <div style="font-family:'DM Mono',monospace;font-size:10px;letter-spacing:2px;color:#ff3c6e;text-transform:uppercase;margin-bottom:8px;">Boost Levels</div>
        <div style="font-family:'Bebas Neue',sans-serif;font-size:32px;letter-spacing:2px;color:var(--white);">Choose Your Power</div>
      </div>
      <div style="display:grid;grid-template-columns:repeat(3,1fr);gap:16px;">
        <!-- STARTER -->
        <div style="background:var(--s1);border:1.5px solid var(--border);border-radius:16px;padding:28px 24px;position:relative;overflow:hidden;">
          <div style="font-family:'Bebas Neue',sans-serif;font-size:22px;letter-spacing:2px;color:var(--white);margin-bottom:4px;">🚀 Starter</div>
          <div style="font-family:'Bebas Neue',sans-serif;font-size:40px;color:#ff3c6e;line-height:1;margin-bottom:4px;">$19<span style="font-size:14px;color:var(--muted)">/campaign</span></div>
          <div style="font-size:11px;color:var(--muted);margin-bottom:20px;">Perfect to launch your first mega-ad</div>
          <div style="display:flex;flex-direction:column;gap:8px;margin-bottom:24px;">
            <div style="font-size:12px;color:var(--g5);">✅ 3 photos required</div>
            <div style="font-size:12px;color:var(--g5);">✅ 1 thumbnail</div>
            <div style="font-size:12px;color:var(--g5);">✅ Featured in feed 24h</div>
            <div style="font-size:12px;color:var(--g5);">✅ 5,000 impressions</div>
            <div style="font-size:12px;color:var(--g5);">✅ Homepage banner slot</div>
          </div>
          <button onclick="bcOpenModal('starter')" style="width:100%;padding:11px;background:var(--s2);border:1.5px solid rgba(255,60,110,0.3);border-radius:8px;font-family:'Plus Jakarta Sans',sans-serif;font-size:13px;font-weight:700;color:#ff3c6e;cursor:pointer;">Select Starter →</button>
        </div>
        <!-- PRO -->
        <div style="background:linear-gradient(160deg,rgba(255,60,110,0.06),rgba(255,140,0,0.04));border:2px solid rgba(255,60,110,0.45);border-radius:16px;padding:28px 24px;position:relative;overflow:hidden;transform:scale(1.02);box-shadow:0 0 40px rgba(255,60,110,0.15);">
          <div style="position:absolute;top:14px;right:14px;background:linear-gradient(135deg,#ff3c6e,#ff8c00);color:#fff;font-family:'DM Mono',monospace;font-size:8px;font-weight:900;padding:3px 10px;border-radius:4px;letter-spacing:1px;">MOST POPULAR</div>
          <div style="font-family:'Bebas Neue',sans-serif;font-size:22px;letter-spacing:2px;color:var(--white);margin-bottom:4px;">⚡ Pro Blast</div>
          <div style="font-family:'Bebas Neue',sans-serif;font-size:40px;color:#ff3c6e;line-height:1;margin-bottom:4px;">$49<span style="font-size:14px;color:var(--muted)">/campaign</span></div>
          <div style="font-size:11px;color:var(--muted);margin-bottom:20px;">Maximum exposure for serious creators</div>
          <div style="display:flex;flex-direction:column;gap:8px;margin-bottom:24px;">
            <div style="font-size:12px;color:var(--g5);">✅ 5 photos + video</div>
            <div style="font-size:12px;color:var(--g5);">✅ Custom thumbnail</div>
            <div style="font-size:12px;color:var(--g5);">✅ Featured 7 days</div>
            <div style="font-size:12px;color:var(--g5);">✅ 25,000 impressions</div>
            <div style="font-size:12px;color:var(--g5);">✅ Top of feed priority</div>
            <div style="font-size:12px;color:var(--g5);">✅ Push notification blast</div>
            <div style="font-size:12px;color:var(--g5);">✅ Analytics dashboard</div>
          </div>
          <button onclick="bcOpenModal('pro')" style="width:100%;padding:11px;background:linear-gradient(135deg,#be123c,#ff3c6e);border:none;border-radius:8px;font-family:'Plus Jakarta Sans',sans-serif;font-size:13px;font-weight:800;color:#fff;cursor:pointer;box-shadow:0 0 20px rgba(255,60,110,0.3);">Select Pro Blast →</button>
        </div>
        <!-- ELITE -->
        <div style="background:linear-gradient(160deg,rgba(255,215,0,0.05),rgba(255,140,0,0.03));border:1.5px solid rgba(255,215,0,0.3);border-radius:16px;padding:28px 24px;position:relative;overflow:hidden;">
          <div style="font-family:'Bebas Neue',sans-serif;font-size:22px;letter-spacing:2px;color:var(--white);margin-bottom:4px;">👑 Elite Takeover</div>
          <div style="font-family:'Bebas Neue',sans-serif;font-size:40px;color:#ffd700;line-height:1;margin-bottom:4px;">$99<span style="font-size:14px;color:var(--muted)">/campaign</span></div>
          <div style="font-size:11px;color:var(--muted);margin-bottom:20px;">Full-site takeover. Unmissable.</div>
          <div style="display:flex;flex-direction:column;gap:8px;margin-bottom:24px;">
            <div style="font-size:12px;color:var(--g5);">✅ Unlimited photos + video</div>
            <div style="font-size:12px;color:var(--g5);">✅ Animated thumbnail</div>
            <div style="font-size:12px;color:var(--g5);">✅ Featured 30 days</div>
            <div style="font-size:12px;color:var(--g5);">✅ 100,000+ impressions</div>
            <div style="font-size:12px;color:var(--g5);">✅ Full-site banner takeover</div>
            <div style="font-size:12px;color:var(--g5);">✅ Email blast to all users</div>
            <div style="font-size:12px;color:var(--g5);">✅ Dedicated landing page</div>
            <div style="font-size:12px;color:var(--g5);">✅ Priority support</div>
          </div>
          <button onclick="bcOpenModal('elite')" style="width:100%;padding:11px;background:linear-gradient(135deg,#92700a,#ffd700);border:none;border-radius:8px;font-family:'Plus Jakarta Sans',sans-serif;font-size:13px;font-weight:800;color:#1a0a00;cursor:pointer;box-shadow:0 0 20px rgba(255,215,0,0.2);">Select Elite Takeover →</button>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- BIG CAMPAIGN MODAL -->
<div id="bc-modal" style="display:none;position:fixed;inset:0;background:rgba(0,0,0,0.85);z-index:10000;align-items:flex-start;justify-content:center;padding:20px;overflow-y:auto;">
  <div style="background:var(--s1);border:2px solid rgba(255,60,110,0.3);border-radius:20px;padding:36px;width:100%;max-width:620px;position:relative;margin:auto;">
    <button onclick="bcCloseModal()" style="position:absolute;top:14px;right:16px;background:transparent;border:none;color:var(--muted);font-size:22px;cursor:pointer;">✕</button>

    <div style="display:flex;align-items:center;gap:12px;margin-bottom:6px;">
      <span style="font-size:28px;">🔥</span>
      <div>
        <div style="font-family:'DM Mono',monospace;font-size:10px;letter-spacing:2px;color:#ff3c6e;text-transform:uppercase;">Big Campaign Builder</div>
        <h3 id="bc-modal-plan-label" style="font-family:'Bebas Neue',sans-serif;font-size:28px;color:var(--white);line-height:1;margin-top:2px;">Launch Campaign</h3>
      </div>
    </div>
    <input type="hidden" id="bc-plan"/>
    <input type="hidden" id="bc-edit-id"/>

    <!-- Step 1 — Infos -->
    <div id="bc-step1">
      <div style="font-family:'DM Mono',monospace;font-size:9px;letter-spacing:2px;color:var(--muted);margin-bottom:20px;margin-top:4px;">STEP 1 OF 3 — CAMPAIGN INFO</div>
      <div style="display:flex;flex-direction:column;gap:14px;">
        <div>
          <label style="font-size:11px;font-family:'DM Mono',monospace;color:var(--muted);letter-spacing:1px;text-transform:uppercase;margin-bottom:6px;display:block;">Campaign Title *</label>
          <input id="bc-title" type="text" placeholder="Ex: Summer Collection 2025 Launch..." style="width:100%;padding:12px 14px;background:var(--bg);border:1.5px solid var(--border);border-radius:8px;font-family:'Plus Jakarta Sans',sans-serif;font-size:14px;color:var(--white);outline:none;" onfocus="this.style.borderColor='#ff3c6e'" onblur="this.style.borderColor='var(--border)'"/>
        </div>
        <div>
          <label style="font-size:11px;font-family:'DM Mono',monospace;color:var(--muted);letter-spacing:1px;text-transform:uppercase;margin-bottom:6px;display:block;">Headline / Slogan *</label>
          <input id="bc-headline" type="text" placeholder="Your bold tagline..." style="width:100%;padding:12px 14px;background:var(--bg);border:1.5px solid var(--border);border-radius:8px;font-family:'Plus Jakarta Sans',sans-serif;font-size:14px;color:var(--white);outline:none;" onfocus="this.style.borderColor='#ff3c6e'" onblur="this.style.borderColor='var(--border)'"/>
        </div>
        <div>
          <label style="font-size:11px;font-family:'DM Mono',monospace;color:var(--muted);letter-spacing:1px;text-transform:uppercase;margin-bottom:6px;display:block;">Campaign Description *</label>
          <textarea id="bc-desc" rows="4" placeholder="Describe your ad in detail — what you're promoting, who it's for, why they should care..." style="width:100%;padding:12px 14px;background:var(--bg);border:1.5px solid var(--border);border-radius:8px;font-family:'Plus Jakarta Sans',sans-serif;font-size:14px;color:var(--white);outline:none;resize:vertical;" onfocus="this.style.borderColor='#ff3c6e'" onblur="this.style.borderColor='var(--border)'"></textarea>
        </div>
        <div>
          <label style="font-size:11px;font-family:'DM Mono',monospace;color:var(--muted);letter-spacing:1px;text-transform:uppercase;margin-bottom:6px;display:block;">Call-to-Action Button Text</label>
          <input id="bc-cta" type="text" placeholder="Ex: Shop Now, Learn More, Book Now..." style="width:100%;padding:12px 14px;background:var(--bg);border:1.5px solid var(--border);border-radius:8px;font-family:'Plus Jakarta Sans',sans-serif;font-size:14px;color:var(--white);outline:none;" onfocus="this.style.borderColor='#ff3c6e'" onblur="this.style.borderColor='var(--border)'"/>
        </div>
        <div>
          <label style="font-size:11px;font-family:'DM Mono',monospace;color:var(--muted);letter-spacing:1px;text-transform:uppercase;margin-bottom:6px;display:block;">Destination URL</label>
          <input id="bc-url" type="url" placeholder="https://yoursite.com/promo" style="width:100%;padding:12px 14px;background:var(--bg);border:1.5px solid var(--border);border-radius:8px;font-family:'Plus Jakarta Sans',sans-serif;font-size:14px;color:var(--white);outline:none;" onfocus="this.style.borderColor='#ff3c6e'" onblur="this.style.borderColor='var(--border)'"/>
        </div>
        <div>
          <label style="font-size:11px;font-family:'DM Mono',monospace;color:var(--muted);letter-spacing:1px;text-transform:uppercase;margin-bottom:6px;display:block;">Target Audience</label>
          <select id="bc-audience" style="width:100%;padding:12px 14px;background:var(--bg);border:1.5px solid var(--border);border-radius:8px;font-family:'Plus Jakarta Sans',sans-serif;font-size:14px;color:var(--white);outline:none;">
            <option value="all">🌍 All Users</option>
            <option value="creators">🎨 Creators & Influencers</option>
            <option value="entrepreneurs">💼 Entrepreneurs</option>
            <option value="saas">⚡ SaaS & Tech</option>
            <option value="ecommerce">🛒 E-commerce</option>
            <option value="freelance">🖥️ Freelancers</option>
          </select>
        </div>
        <button onclick="bcGoStep2()" style="width:100%;padding:13px;background:linear-gradient(135deg,#be123c,#ff3c6e);border:none;border-radius:8px;font-family:'Plus Jakarta Sans',sans-serif;font-size:14px;font-weight:800;color:#fff;cursor:pointer;margin-top:4px;">Continue → Media Upload</button>
      </div>
    </div>

    <!-- Step 2 — Medias -->
    <div id="bc-step2" style="display:none;">
      <div style="display:flex;align-items:center;gap:10px;margin-bottom:20px;margin-top:4px;">
        <button onclick="bcGoStep1()" style="background:transparent;border:none;color:var(--muted);cursor:pointer;font-size:18px;">←</button>
        <div style="font-family:'DM Mono',monospace;font-size:9px;letter-spacing:2px;color:var(--muted);">STEP 2 OF 3 — MEDIA (3 PHOTOS MINIMUM)</div>
      </div>

      <!-- Thumbnail -->
      <div style="margin-bottom:20px;">
        <label style="font-size:11px;font-family:'DM Mono',monospace;color:#ff3c6e;letter-spacing:1px;text-transform:uppercase;margin-bottom:8px;display:block;">🖼️ Campaign Thumbnail * <span style="color:var(--muted);font-size:9px;">(Main cover image)</span></label>
        <div id="bc-thumb-preview" style="width:100%;height:160px;border:2px dashed rgba(255,60,110,0.4);border-radius:12px;display:flex;flex-direction:column;align-items:center;justify-content:center;cursor:pointer;transition:all 0.2s;background:rgba(255,60,110,0.03);" onclick="document.getElementById('bc-thumb-input').click()" onmouseover="this.style.borderColor='#ff3c6e';this.style.background='rgba(255,60,110,0.06)'" onmouseout="this.style.borderColor='rgba(255,60,110,0.4)';this.style.background='rgba(255,60,110,0.03)'">
          <div style="font-size:32px;margin-bottom:8px;">🖼️</div>
          <div style="font-size:13px;font-weight:700;color:var(--white);">Click to upload thumbnail</div>
          <div style="font-size:11px;color:var(--muted);margin-top:4px;">JPG, PNG, WebP — Recommended 1200×630px</div>
        </div>
        <input type="file" id="bc-thumb-input" accept="image/*" style="display:none;" onchange="bcPreviewThumb(this)"/>
      </div>

      <!-- Photos grid -->
      <div>
        <label style="font-size:11px;font-family:'DM Mono',monospace;color:#ff3c6e;letter-spacing:1px;text-transform:uppercase;margin-bottom:8px;display:block;">📸 Campaign Photos * <span style="color:var(--muted);font-size:9px;">(minimum 3 required)</span></label>
        <div id="bc-photos-grid" style="display:grid;grid-template-columns:repeat(3,1fr);gap:10px;margin-bottom:10px;"></div>
        <button onclick="document.getElementById('bc-photos-input').click()" style="width:100%;padding:11px;background:var(--s2);border:1.5px dashed var(--border);border-radius:8px;font-family:'Plus Jakarta Sans',sans-serif;font-size:13px;font-weight:600;color:var(--muted);cursor:pointer;" id="bc-add-photo-btn">+ Add Photos</button>
        <input type="file" id="bc-photos-input" accept="image/*" multiple style="display:none;" onchange="bcAddPhotos(this)"/>
        <div id="bc-photos-count" style="font-size:11px;color:var(--muted);margin-top:6px;text-align:center;">0 / 3 minimum photos</div>
        <div style="font-size:11px;color:rgba(255,60,110,0.5);text-align:center;margin-top:4px;font-family:'DM Mono',monospace;letter-spacing:0.5px;">⚠️ 3 photos minimum obligatoire pour publier</div>
      </div>

      <button onclick="bcGoStep3()" style="width:100%;padding:13px;background:linear-gradient(135deg,#be123c,#ff3c6e);border:none;border-radius:8px;font-family:'Plus Jakarta Sans',sans-serif;font-size:14px;font-weight:800;color:#fff;cursor:pointer;margin-top:20px;">Continue → Review & Pay</button>
    </div>

    <!-- Step 3 — Review + Pay -->
    <div id="bc-step3" style="display:none;">
      <div style="display:flex;align-items:center;gap:10px;margin-bottom:20px;margin-top:4px;">
        <button onclick="bcGoStep2()" style="background:transparent;border:none;color:var(--muted);cursor:pointer;font-size:18px;">←</button>
        <div style="font-family:'DM Mono',monospace;font-size:9px;letter-spacing:2px;color:var(--muted);">STEP 3 OF 3 — REVIEW & LAUNCH</div>
      </div>

      <div id="bc-review-content" style="background:var(--bg);border:1px solid var(--border2);border-radius:12px;padding:20px;margin-bottom:20px;"></div>

      <!-- Payment -->
      <div style="background:rgba(255,60,110,0.04);border:1.5px solid rgba(255,60,110,0.2);border-radius:12px;padding:20px;margin-bottom:20px;">
        <div style="font-family:'DM Mono',monospace;font-size:10px;letter-spacing:2px;color:#ff3c6e;text-transform:uppercase;margin-bottom:14px;">Payment</div>
        <div style="display:flex;flex-direction:column;gap:10px;">
          <div>
            <label style="font-size:11px;font-family:'DM Mono',monospace;color:var(--muted);letter-spacing:1px;text-transform:uppercase;margin-bottom:6px;display:block;">Card Number</label>
            <input id="bc-card" type="text" placeholder="4242 4242 4242 4242" maxlength="19" oninput="this.value=this.value.replace(/[^0-9]/g,'').replace(/(.{4})/g,'$1 ').trim()" style="width:100%;padding:11px 14px;background:var(--bg);border:1.5px solid var(--border);border-radius:8px;font-family:'DM Mono',monospace;font-size:14px;color:var(--white);outline:none;letter-spacing:2px;" onfocus="this.style.borderColor='#ff3c6e'" onblur="this.style.borderColor='var(--border)'"/>
          </div>
          <div style="display:grid;grid-template-columns:1fr 1fr;gap:10px;">
            <div>
              <label style="font-size:11px;font-family:'DM Mono',monospace;color:var(--muted);letter-spacing:1px;text-transform:uppercase;margin-bottom:6px;display:block;">Expiry</label>
              <input id="bc-expiry" type="text" placeholder="MM/YY" maxlength="5" oninput="var v=this.value.replace(/[^0-9]/g,'');if(v.length>=2)v=v.slice(0,2)+'/'+v.slice(2);this.value=v;" style="width:100%;padding:11px 14px;background:var(--bg);border:1.5px solid var(--border);border-radius:8px;font-family:'DM Mono',monospace;font-size:14px;color:var(--white);outline:none;" onfocus="this.style.borderColor='#ff3c6e'" onblur="this.style.borderColor='var(--border)'"/>
            </div>
            <div>
              <label style="font-size:11px;font-family:'DM Mono',monospace;color:var(--muted);letter-spacing:1px;text-transform:uppercase;margin-bottom:6px;display:block;">CVV</label>
              <input id="bc-cvv" type="text" placeholder="123" maxlength="4" style="width:100%;padding:11px 14px;background:var(--bg);border:1.5px solid var(--border);border-radius:8px;font-family:'DM Mono',monospace;font-size:14px;color:var(--white);outline:none;" onfocus="this.style.borderColor='#ff3c6e'" onblur="this.style.borderColor='var(--border)'"/>
            </div>
          </div>
        </div>
      </div>

      <div id="bc-total-box" style="display:flex;align-items:center;justify-content:space-between;background:rgba(255,60,110,0.06);border:1px solid rgba(255,60,110,0.2);border-radius:10px;padding:14px 18px;margin-bottom:20px;">
        <span style="font-size:13px;color:var(--muted);">Total due today</span>
        <span id="bc-total-price" style="font-family:'Bebas Neue',sans-serif;font-size:30px;color:#ff3c6e;"></span>
      </div>

      <button onclick="bcSubmit()" id="bc-pay-btn" style="width:100%;padding:15px;background:linear-gradient(135deg,#be123c,#ff3c6e);border:none;border-radius:10px;font-family:'Plus Jakarta Sans',sans-serif;font-size:15px;font-weight:900;color:#fff;cursor:pointer;box-shadow:0 0 32px rgba(255,60,110,0.35);letter-spacing:0.5px;">🔥 Launch Big Campaign →</button>
      <div style="text-align:center;font-size:11px;color:var(--muted2);margin-top:10px;">🔒 Secure payment · Money-back guarantee in 48h</div>
    </div>
  </div>
</div>

<script>
// ═══ BIG CAMPAIGN ENGINE ═══
var BC_PLANS = {
  starter:{ label:'🚀 Starter', price:'$19', priceNum:19, duration:'24h', impressions:'5,000', days:1 },
  pro:{ label:'⚡ Pro Blast', price:'$49', priceNum:49, duration:'7 days', impressions:'25,000', days:7 },
  elite:{ label:'👑 Elite Takeover', price:'$99', priceNum:99, duration:'30 days', impressions:'100,000+', days:30 }
};

var bcPhotosData = []; // base64 photos
var bcThumbData = null;

function bcGetAll(){ try{ return JSON.parse(localStorage.getItem('vb_bigcampaigns')||'[]'); }catch(e){ return []; } }
function bcSaveAll(arr){ localStorage.setItem('vb_bigcampaigns', JSON.stringify(arr)); }

function bcOpenModal(plan){
  plan = plan || 'pro';
  document.getElementById('bc-plan').value = plan;
  document.getElementById('bc-edit-id').value = '';
  ['bc-title','bc-headline','bc-desc','bc-cta','bc-url','bc-card','bc-expiry','bc-cvv'].forEach(id=>{ var el=document.getElementById(id); if(el) el.value=''; });
  document.getElementById('bc-audience').value = 'all';
  document.getElementById('bc-modal-plan-label').textContent = BC_PLANS[plan].label + ' — ' + BC_PLANS[plan].price;
  bcPhotosData = []; bcThumbData = null;
  bcUpdatePhotosGrid();
  document.getElementById('bc-thumb-preview').innerHTML = '<div style="font-size:32px;margin-bottom:8px;">🖼️</div><div style="font-size:13px;font-weight:700;color:var(--white);">Click to upload thumbnail</div><div style="font-size:11px;color:var(--muted);margin-top:4px;">JPG, PNG, WebP — Recommended 1200×630px</div>';
  bcShowStep(1);
  document.getElementById('bc-modal').style.display='flex';
}

function bcCloseModal(){ document.getElementById('bc-modal').style.display='none'; }
document.getElementById('bc-modal').addEventListener('click',function(e){ if(e.target===this) bcCloseModal(); });

function bcShowStep(n){
  ['bc-step1','bc-step2','bc-step3'].forEach((id,i)=>{ document.getElementById(id).style.display=(i+1===n)?'block':'none'; });
}
function bcGoStep1(){ bcShowStep(1); }
function bcGoStep2(){
  var title=document.getElementById('bc-title').value.trim();
  var headline=document.getElementById('bc-headline').value.trim();
  var desc=document.getElementById('bc-desc').value.trim();
  if(!title||!headline||!desc){ toast('⚠️ Please fill in title, headline and description.'); return; }
  bcShowStep(2);
}
function bcGoStep3(){
  if(!bcThumbData){ toast('⚠️ Please upload a thumbnail.'); return; }
  if(bcPhotosData.length<3){ toast('⚠️ Minimum 3 photos required ('+bcPhotosData.length+'/3)'); return; }
  var plan = document.getElementById('bc-plan').value;
  var p = BC_PLANS[plan]||BC_PLANS.pro;
  document.getElementById('bc-total-price').textContent = p.price;
  document.getElementById('bc-review-content').innerHTML =
    '<div style="display:flex;gap:12px;flex-wrap:wrap;">'
    +'<div style="flex:1;min-width:200px;">'
    +'<div style="font-size:11px;color:var(--muted);margin-bottom:4px;">Campaign</div>'
    +'<div style="font-size:15px;font-weight:700;color:var(--white);margin-bottom:10px;">'+document.getElementById('bc-title').value+'</div>'
    +'<div style="font-size:12px;color:#ff3c6e;margin-bottom:4px;">'+document.getElementById('bc-headline').value+'</div>'
    +'<div style="font-size:12px;color:var(--muted);margin-bottom:12px;">'+document.getElementById('bc-desc').value.substring(0,100)+'...</div>'
    +'<div style="display:flex;gap:8px;flex-wrap:wrap;">'
    +'<span style="background:rgba(255,60,110,0.08);border:1px solid rgba(255,60,110,0.2);border-radius:4px;padding:3px 9px;font-size:10px;font-family:\'DM Mono\',monospace;color:#ff3c6e;">'+p.label+'</span>'
    +'<span style="background:var(--s2);border-radius:4px;padding:3px 9px;font-size:10px;font-family:\'DM Mono\',monospace;color:var(--muted);">⏱ '+p.duration+'</span>'
    +'<span style="background:var(--s2);border-radius:4px;padding:3px 9px;font-size:10px;font-family:\'DM Mono\',monospace;color:var(--muted);">👁 '+p.impressions+'</span>'
    +'</div></div>'
    +'<img src="'+bcThumbData+'" alt="Campaign thumbnail" style="width:120px;height:80px;border-radius:8px;object-fit:cover;flex-shrink:0;border:1px solid var(--border);"/>'
    +'</div>'
    +'<div style="margin-top:12px;font-size:11px;color:var(--muted);">📸 '+bcPhotosData.length+' photo(s) · 🎯 '+document.getElementById('bc-audience').options[document.getElementById('bc-audience').selectedIndex].text+'</div>';
  bcShowStep(3);
}

function bcPreviewThumb(input){
  var file=input.files[0]; if(!file) return;
  var reader=new FileReader();
  reader.onload=function(e){
    bcThumbData=e.target.result;
    document.getElementById('bc-thumb-preview').innerHTML='<img src="'+bcThumbData+'" alt="Campaign thumbnail preview" style="width:100%;height:100%;object-fit:cover;border-radius:10px;"/>';
  };
  reader.readAsDataURL(file);
}

function bcAddPhotos(input){
  var files=Array.from(input.files);
  var remaining=files;
  var loaded=0;
  remaining.forEach(function(file){
    var reader=new FileReader();
    reader.onload=function(e){ bcPhotosData.push(e.target.result); loaded++; if(loaded===remaining.length) bcUpdatePhotosGrid(); };
    reader.readAsDataURL(file);
  });
  input.value='';
}

function bcUpdatePhotosGrid(){
  var grid=document.getElementById('bc-photos-grid');
  var count=document.getElementById('bc-photos-count');
  if(!grid) return;
  grid.innerHTML=bcPhotosData.map(function(src,i){
    return '<div style="position:relative;border-radius:8px;overflow:hidden;aspect-ratio:1;">'
      +'<img src="'+src+'" alt="Campaign photo" style="width:100%;height:100%;object-fit:cover;"/>'
      +'<button onclick="bcRemovePhoto('+i+')" style="position:absolute;top:4px;right:4px;background:rgba(0,0,0,0.6);border:none;color:#fff;border-radius:50%;width:22px;height:22px;font-size:12px;cursor:pointer;display:flex;align-items:center;justify-content:center;">✕</button>'
      +'</div>';
  }).join('');
  var minCount = 3;
  var col = bcPhotosData.length>=minCount ? '#22c55e' : '#ff3c6e';
  count.innerHTML='<span style="color:'+col+';font-weight:700;">'+bcPhotosData.length+'</span> / 3 minimum photos'+(bcPhotosData.length>=minCount?' ✅':'');
}
function bcRemovePhoto(idx){ bcPhotosData.splice(idx,1); bcUpdatePhotosGrid(); }

function bcSubmit(){
  var card=document.getElementById('bc-card').value.replace(/\s/g,'');
  var expiry=document.getElementById('bc-expiry').value;
  var cvv=document.getElementById('bc-cvv').value;
  if(card.length<16||!expiry||cvv.length<3){ toast('⚠️ Please fill in all payment details.'); return; }
  var btn=document.getElementById('bc-pay-btn');
  btn.textContent='⏳ Processing...'; btn.disabled=true;
  setTimeout(function(){
    var plan=document.getElementById('bc-plan').value;
    var p=BC_PLANS[plan]||BC_PLANS.pro;
    var campaigns=bcGetAll();
    campaigns.push({
      id:'bc_'+Date.now(), plan:plan, planLabel:p.label, price:p.price,
      title:document.getElementById('bc-title').value.trim(),
      headline:document.getElementById('bc-headline').value.trim(),
      desc:document.getElementById('bc-desc').value.trim(),
      cta:document.getElementById('bc-cta').value.trim()||'Learn More',
      url:document.getElementById('bc-url').value.trim(),
      audience:document.getElementById('bc-audience').value,
      thumbnail:bcThumbData, photos:bcPhotosData,
      impressions:p.impressions, duration:p.duration,
      status:'active', createdAt:new Date().toISOString()
    });
    bcSaveAll(campaigns);
    bcCloseModal(); bcRender();
    toast('🔥 Big Campaign launched! Your ad is now LIVE!');
    btn.textContent='🔥 Launch Big Campaign →'; btn.disabled=false;
  }, 1800);
}

function bcDeleteCampaign(id){ bcSaveAll(bcGetAll().filter(c=>c.id!==id)); bcRender(); toast('🗑️ Campaign deleted.'); }

function bcRender(){
  var campaigns=bcGetAll();
  var wrap=document.getElementById('bc-list');
  if(!wrap) return;
  if(!campaigns.length){
    wrap.innerHTML='<div style="background:var(--s1);border:1.5px dashed rgba(255,60,110,0.2);border-radius:14px;padding:48px 32px;text-align:center;margin-bottom:40px;">'
      +'<div style="font-size:40px;margin-bottom:12px;">🔥</div>'
      +'<div style="font-size:15px;font-weight:700;color:var(--white);margin-bottom:8px;">No Big Campaigns yet</div>'
      +'<div style="font-size:13px;color:var(--muted);margin-bottom:20px;">Launch your first mega-ad and explode your reach.</div>'
      +'<button onclick="bcOpenModal()" style="padding:12px 28px;background:linear-gradient(135deg,#be123c,#ff3c6e);border:none;border-radius:8px;font-family:\'Plus Jakarta Sans\',sans-serif;font-size:13px;font-weight:800;color:#fff;cursor:pointer;">🔥 Launch My First Campaign</button>'
      +'</div>';
    return;
  }
  wrap.innerHTML='<div style="display:flex;flex-direction:column;gap:14px;margin-bottom:40px;">'+campaigns.map(function(c){
    var p=BC_PLANS[c.plan]||BC_PLANS.pro;
    var statusColor='#22c55e';
    var date=c.createdAt?new Date(c.createdAt).toLocaleDateString('en-US',{month:'short',day:'numeric',year:'numeric'}):'';
    return '<div style="background:var(--s1);border:1.5px solid rgba(255,60,110,0.18);border-radius:14px;overflow:hidden;">'
      +'<div style="display:flex;flex-wrap:wrap;gap:0;">'
      +(c.thumbnail?'<img src="'+c.thumbnail+'" alt="Ad thumbnail" style="width:140px;height:100%;min-height:110px;object-fit:cover;flex-shrink:0;"/>':'<div style="width:140px;min-height:110px;background:var(--s2);display:flex;align-items:center;justify-content:center;font-size:32px;">🔥</div>')
      +'<div style="flex:1;padding:18px 20px;min-width:200px;">'
      +'<div style="display:flex;align-items:center;gap:8px;margin-bottom:8px;flex-wrap:wrap;">'
      +'<span style="background:rgba(255,60,110,0.1);border:1px solid rgba(255,60,110,0.3);border-radius:4px;padding:2px 10px;font-size:10px;font-family:\'DM Mono\',monospace;color:#ff3c6e;letter-spacing:1px;">'+c.planLabel+'</span>'
      +'<span style="background:rgba(34,197,94,0.08);border:1px solid rgba(34,197,94,0.2);border-radius:4px;padding:2px 8px;font-size:10px;font-family:\'DM Mono\',monospace;color:#22c55e;">● ACTIVE</span>'
      +'<span style="font-size:11px;color:var(--muted);">'+date+'</span>'
      +'</div>'
      +'<div style="font-size:16px;font-weight:800;color:var(--white);margin-bottom:2px;">'+c.title+'</div>'
      +'<div style="font-size:12px;color:#ff3c6e;margin-bottom:6px;">'+c.headline+'</div>'
      +'<div style="display:flex;gap:12px;flex-wrap:wrap;">'
      +'<span style="font-size:11px;color:var(--muted);">👁 '+c.impressions+'</span>'
      +'<span style="font-size:11px;color:var(--muted);">⏱ '+c.duration+'</span>'
      +'<span style="font-size:11px;color:var(--muted);">📸 '+((c.photos||[]).length)+' photos</span>'
      +'</div>'
      +'</div>'
      +'<div style="display:flex;flex-direction:column;gap:8px;padding:18px 14px;justify-content:center;border-left:1px solid var(--border2);">'
      +'<div style="font-family:\'Bebas Neue\',sans-serif;font-size:22px;color:#ff3c6e;text-align:center;">'+c.price+'</div>'
      +'<button onclick="bcDeleteCampaign(\''+c.id+'\')" style="padding:7px 14px;background:rgba(239,68,68,0.08);border:1px solid rgba(239,68,68,0.2);border-radius:7px;font-size:11px;font-weight:600;color:#ef4444;cursor:pointer;">Delete</button>'
      +'</div>'
      +'</div>'
      +(c.photos&&c.photos.length?'<div style="display:flex;gap:6px;padding:10px 14px;border-top:1px solid var(--border2);overflow-x:auto;">'+c.photos.map(function(ph){ return '<img src="'+ph+'" alt="Ad photo" style="width:52px;height:40px;border-radius:6px;object-fit:cover;flex-shrink:0;border:1px solid var(--border2);"/>'; }).join('')+'</div>':'')
      +'</div>';
  }).join('')+'</div>';
}

document.querySelector('[data-tab="big-campaign"]')?.addEventListener('click', function(){ setTimeout(bcRender,50); });

// ═══ CAMPAIGN TAB ENGINE ═══
var _campFilter = 'all';

function campaignFilter(filter, btn) {
  _campFilter = filter;
  document.querySelectorAll('.camp-filter-btn').forEach(b => {
    b.style.background = 'transparent';
    b.style.borderColor = 'var(--border)';
    b.style.color = 'var(--muted)';
    if (b.style.color === 'var(--muted)' && b.textContent.trim() === 'ELITE') {
      b.style.borderColor = 'rgba(255,215,0,0.3)';
      b.style.color = '#ffd700';
    }
  });
  if (btn) {
    btn.style.background = 'rgba(255,60,110,0.1)';
    btn.style.borderColor = 'rgba(255,60,110,0.5)';
    btn.style.color = '#ff3c6e';
  }
  campaignRender();
}

function campaignRender() {
  var wrap = document.getElementById('campaign-tab-list');
  if (!wrap) return;

  // Get user campaigns from localStorage
  var userCampaigns = bcGetAll ? bcGetAll() : [];

  // Merge with fake campaigns
  var all = [...FAKE_BIG_CAMPAIGNS, ...userCampaigns];

  // Apply filter
  var filtered = all;
  if (_campFilter === 'active') filtered = all.filter(c => c.status === 'active' || c._isBigCampaign);
  if (_campFilter === 'elite') filtered = all.filter(c => c.plan === 'elite');

  if (!filtered.length) {
    wrap.innerHTML = '<div style="text-align:center;padding:60px 20px;"><div style="font-size:40px;margin-bottom:12px;">🔥</div><div style="font-size:15px;font-weight:700;color:var(--white);margin-bottom:8px;">No campaigns yet</div><div style="font-size:13px;color:var(--muted);">Be the first to launch a Big Campaign!</div></div>';
    return;
  }

  wrap.innerHTML = filtered.map(function(c) {
    if (c._isBigCampaign) return renderBigCampaignCard(c);
    // User campaign card
    var p = BC_PLANS[c.plan] || BC_PLANS.pro;
    var thumb = c.thumbnail ? '<img src="'+c.thumbnail+'" alt="Project thumbnail" style="width:100%;height:100%;object-fit:cover;"/>' : '<div style="width:100%;height:100%;background:linear-gradient(135deg,#1a0010,#2d0020);display:flex;align-items:center;justify-content:center;font-size:40px;">🔥</div>';
    return '<div style="grid-column:1/-1;background:linear-gradient(160deg,#0e0005,#1a0010);border:2px solid rgba(255,60,110,0.35);border-radius:16px;overflow:hidden;margin-bottom:4px;display:flex;flex-wrap:wrap;">'
      + '<div style="width:180px;min-height:120px;flex-shrink:0;overflow:hidden;">'+thumb+'</div>'
      + '<div style="flex:1;padding:18px 20px;min-width:200px;">'
      + '<div style="display:flex;gap:8px;margin-bottom:8px;flex-wrap:wrap;">'
      + '<span style="background:rgba(255,60,110,0.1);border:1px solid rgba(255,60,110,0.3);border-radius:4px;padding:2px 10px;font-size:10px;font-family:\'DM Mono\',monospace;color:#ff3c6e;">'+p.label+'</span>'
      + '<span style="background:rgba(34,197,94,0.08);border:1px solid rgba(34,197,94,0.2);border-radius:4px;padding:2px 8px;font-size:10px;font-family:\'DM Mono\',monospace;color:#22c55e;">● ACTIVE</span>'
      + '</div>'
      + '<div style="font-size:16px;font-weight:800;color:var(--white);margin-bottom:4px;">'+(c.title||'Untitled')+'</div>'
      + '<div style="font-size:12px;color:#ff3c6e;margin-bottom:8px;">'+(c.headline||'')+'</div>'
      + '<div style="display:flex;gap:14px;">'
      + '<span style="font-size:11px;color:var(--muted);">👁 '+(c.impressions||p.impressions)+'</span>'
      + '<span style="font-size:11px;color:var(--muted);">⏱ '+(c.duration||p.duration)+'</span>'
      + '<span style="font-size:11px;color:var(--muted);">'+p.price+'</span>'
      + '</div></div></div>';
  }).join('');
}

document.addEventListener('DOMContentLoaded', function() {
  // Render campaign tab when clicked
  document.querySelector('[data-tab="campaign"]')?.addEventListener('click', function(){ setTimeout(campaignRender, 50); });
});
document.addEventListener('DOMContentLoaded', bcRender);
</script>

<!-- ══════════ AFFILIATE ══════════ -->
<div class="tpanel" id="tab-affiliate">
  <div style="max-width:900px;margin:0 auto;padding:32px 20px;">
    <div style="margin-bottom:28px;">
      <div style="font-family:'DM Mono',monospace;font-size:10px;letter-spacing:2px;color:#f59e0b;text-transform:uppercase;margin-bottom:6px;">Referral Program</div>
      <h2 style="font-family:'Bebas Neue',sans-serif;font-size:32px;letter-spacing:2px;color:var(--white);">Affiliate</h2>
    </div>
    <!-- Stats -->
    <div style="display:grid;grid-template-columns:repeat(3,1fr);gap:12px;margin-bottom:24px;">
      <div style="background:var(--s1);border:1px solid var(--border2);border-radius:10px;padding:20px 18px;">
        <div style="font-size:10px;font-family:'DM Mono',monospace;color:var(--muted);letter-spacing:1px;text-transform:uppercase;margin-bottom:8px;">Referrals</div>
        <div style="font-family:'Bebas Neue',sans-serif;font-size:36px;color:#f59e0b;line-height:1;">0</div>
        <div style="font-size:11px;color:var(--muted);margin-top:4px;">Friends invited</div>
      </div>
      <div style="background:var(--s1);border:1px solid var(--border2);border-radius:10px;padding:20px 18px;">
        <div style="font-size:10px;font-family:'DM Mono',monospace;color:var(--muted);letter-spacing:1px;text-transform:uppercase;margin-bottom:8px;">Conversions</div>
        <div style="font-family:'Bebas Neue',sans-serif;font-size:36px;color:#f59e0b;line-height:1;">0</div>
        <div style="font-size:11px;color:var(--muted);margin-top:4px;">Accounts created</div>
      </div>
      <div style="background:var(--s1);border:1px solid var(--border2);border-radius:10px;padding:20px 18px;">
        <div style="font-size:10px;font-family:'DM Mono',monospace;color:var(--muted);letter-spacing:1px;text-transform:uppercase;margin-bottom:8px;">Rewards</div>
        <div style="font-family:'Bebas Neue',sans-serif;font-size:36px;color:#f59e0b;line-height:1;">0</div>
        <div style="font-size:11px;color:var(--muted);margin-top:4px;">Months PRO earned</div>
      </div>
    </div>
    <!-- Referral link box -->
    <div style="background:var(--s1);border:1px solid rgba(245,158,11,0.2);border-radius:12px;padding:28px 24px;margin-bottom:16px;">
      <div style="font-size:13px;font-weight:700;color:var(--white);margin-bottom:6px;">Your referral link</div>
      <div style="font-size:12px;color:var(--muted);margin-bottom:16px;line-height:1.6;">Share this link — earn 1 month PRO for every 5 friends who sign up.</div>
      <div style="display:flex;gap:10px;align-items:center;">
        <div id="aff-link-display" style="flex:1;background:var(--s2);border:1px solid var(--border2);border-radius:8px;padding:11px 14px;font-family:'DM Mono',monospace;font-size:12px;color:var(--g4);overflow:hidden;text-overflow:ellipsis;white-space:nowrap;">viralboost.app/ref/—</div>
        <button onclick="var u=currentUser&&currentUser.username?currentUser.username:'you';navigator.clipboard.writeText('https://viralboost.app/ref/'+u);toast('Link copied!')" style="padding:11px 18px;background:linear-gradient(135deg,#d97706,#f59e0b);border:none;border-radius:8px;font-family:'Plus Jakarta Sans',sans-serif;font-size:13px;font-weight:700;color:#080808;cursor:pointer;white-space:nowrap;">Copy link</button>
      </div>
    </div>
    <!-- How it works -->
    <div style="background:var(--s1);border:1px solid var(--border2);border-radius:12px;padding:24px;">
      <div style="font-size:13px;font-weight:700;color:var(--white);margin-bottom:16px;">How it works</div>
      <div style="display:flex;flex-direction:column;gap:12px;">
        <div style="display:flex;align-items:center;gap:14px;">
          <div style="width:28px;height:28px;border-radius:50%;background:rgba(245,158,11,0.15);border:1px solid rgba(245,158,11,0.3);display:flex;align-items:center;justify-content:center;font-family:'DM Mono',monospace;font-size:11px;font-weight:700;color:#f59e0b;flex-shrink:0;">1</div>
          <div style="font-size:13px;color:var(--g5);">Copy your unique referral link above</div>
        </div>
        <div style="display:flex;align-items:center;gap:14px;">
          <div style="width:28px;height:28px;border-radius:50%;background:rgba(245,158,11,0.15);border:1px solid rgba(245,158,11,0.3);display:flex;align-items:center;justify-content:center;font-family:'DM Mono',monospace;font-size:11px;font-weight:700;color:#f59e0b;flex-shrink:0;">2</div>
          <div style="font-size:13px;color:var(--g5);">Share it with friends, colleagues or on social media</div>
        </div>
        <div style="display:flex;align-items:center;gap:14px;">
          <div style="width:28px;height:28px;border-radius:50%;background:rgba(245,158,11,0.15);border:1px solid rgba(245,158,11,0.3);display:flex;align-items:center;justify-content:center;font-family:'DM Mono',monospace;font-size:11px;font-weight:700;color:#f59e0b;flex-shrink:0;">3</div>
          <div style="font-size:13px;color:var(--g5);">Every 5 signups = 1 month PRO free credited to your account</div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- ══════════ SETTINGS ══════════ -->
<div class="tpanel" id="tab-settings">
  <div style="max-width:720px;margin:0 auto;padding:32px 20px;">
    <div style="margin-bottom:28px;">
      <div style="font-family:'DM Mono',monospace;font-size:10px;letter-spacing:2px;color:var(--muted);text-transform:uppercase;margin-bottom:6px;">Account</div>
      <h2 style="font-family:'Bebas Neue',sans-serif;font-size:32px;letter-spacing:2px;color:var(--white);">Settings</h2>
    </div>
    <!-- Profile section -->
    <div style="background:var(--s1);border:1px solid var(--border2);border-radius:12px;padding:24px;margin-bottom:16px;">
      <div style="font-size:12px;font-family:'DM Mono',monospace;letter-spacing:1px;text-transform:uppercase;color:var(--muted);margin-bottom:18px;">Profile</div>
      <div style="display:flex;flex-direction:column;gap:14px;">
        <div>
          <label style="font-size:11px;color:var(--muted);font-family:'DM Mono',monospace;letter-spacing:1px;text-transform:uppercase;display:block;margin-bottom:6px;">Display name</label>
          <input id="set-name" type="text" style="width:100%;padding:11px 14px;background:var(--s2);border:1px solid var(--border2);border-radius:8px;font-family:'Plus Jakarta Sans',sans-serif;font-size:13px;color:var(--white);outline:none;box-sizing:border-box;" placeholder="Your name" onfocus="this.style.borderColor='var(--g3)'" onblur="this.style.borderColor='var(--border2)'"/>
        </div>
        <div>
          <label style="font-size:11px;color:var(--muted);font-family:'DM Mono',monospace;letter-spacing:1px;text-transform:uppercase;display:block;margin-bottom:6px;">Username</label>
          <input id="set-username" type="text" style="width:100%;padding:11px 14px;background:var(--s2);border:1px solid var(--border2);border-radius:8px;font-family:'DM Mono',monospace;font-size:13px;color:var(--white);outline:none;box-sizing:border-box;" placeholder="@username" onfocus="this.style.borderColor='var(--g3)'" onblur="this.style.borderColor='var(--border2)'"/>
        </div>
        <div>
          <label style="font-size:11px;color:var(--muted);font-family:'DM Mono',monospace;letter-spacing:1px;text-transform:uppercase;display:block;margin-bottom:6px;">Bio</label>
          <textarea id="set-bio" rows="3" style="width:100%;padding:11px 14px;background:var(--s2);border:1px solid var(--border2);border-radius:8px;font-family:'Plus Jakarta Sans',sans-serif;font-size:13px;color:var(--white);outline:none;resize:none;box-sizing:border-box;" placeholder="Tell the community about yourself..." onfocus="this.style.borderColor='var(--g3)'" onblur="this.style.borderColor='var(--border2)'"></textarea>
        </div>
        <button onclick="var n=document.getElementById('set-name').value;var u=document.getElementById('set-username').value;var b=document.getElementById('set-bio').value;if(currentUser){if(n)currentUser.name=n;if(u)currentUser.username=u;if(b)currentUser.bio=b;localStorage.setItem('viralboost_user',JSON.stringify(currentUser));toast('Profile updated!')}" style="align-self:flex-start;padding:10px 22px;background:linear-gradient(135deg,var(--g1),var(--g2));border:none;border-radius:8px;font-family:'Plus Jakarta Sans',sans-serif;font-size:13px;font-weight:700;color:var(--bg);cursor:pointer;">Save changes</button>
      </div>
    </div>
    <!-- Notifications -->
    <div style="background:var(--s1);border:1px solid var(--border2);border-radius:12px;padding:24px;margin-bottom:16px;">
      <div style="font-size:12px;font-family:'DM Mono',monospace;letter-spacing:1px;text-transform:uppercase;color:var(--muted);margin-bottom:18px;">Notifications</div>
      <div style="display:flex;flex-direction:column;gap:16px;">
        <div style="display:flex;align-items:center;justify-content:space-between;">
          <div><div style="font-size:13px;font-weight:600;color:var(--white);">New collab requests</div><div style="font-size:11px;color:var(--muted);margin-top:2px;">Be notified when someone wants to collaborate</div></div>
          <label style="position:relative;width:40px;height:22px;cursor:pointer;"><input type="checkbox" checked style="opacity:0;width:0;height:0;"/><span onclick="this.style.background=this.style.background==='var(--g2)'?'var(--s3)':'var(--g2)'" style="position:absolute;inset:0;background:var(--g2);border-radius:11px;transition:0.2s;"></span></label>
        </div>
        <div style="display:flex;align-items:center;justify-content:space-between;">
          <div><div style="font-size:13px;font-weight:600;color:var(--white);">New votes on my ads</div><div style="font-size:11px;color:var(--muted);margin-top:2px;">Get notified on every new vote</div></div>
          <label style="position:relative;width:40px;height:22px;cursor:pointer;"><input type="checkbox" checked style="opacity:0;width:0;height:0;"/><span onclick="this.style.background=this.style.background==='var(--g2)'?'var(--s3)':'var(--g2)'" style="position:absolute;inset:0;background:var(--g2);border-radius:11px;transition:0.2s;"></span></label>
        </div>
        <div style="display:flex;align-items:center;justify-content:space-between;">
          <div><div style="font-size:13px;font-weight:600;color:var(--white);">Newsletter & product updates</div><div style="font-size:11px;color:var(--muted);margin-top:2px;">Tips and new features by email</div></div>
          <label style="position:relative;width:40px;height:22px;cursor:pointer;"><input type="checkbox" style="opacity:0;width:0;height:0;"/><span onclick="this.style.background=this.style.background==='var(--g2)'?'var(--s3)':'var(--g2)'" style="position:absolute;inset:0;background:var(--s3);border-radius:11px;transition:0.2s;"></span></label>
        </div>
      </div>
    </div>
    <!-- Danger zone -->
    <div style="background:var(--s1);border:1px solid rgba(239,68,68,0.2);border-radius:12px;padding:24px;">
      <div style="font-size:12px;font-family:'DM Mono',monospace;letter-spacing:1px;text-transform:uppercase;color:#ef4444;margin-bottom:14px;">Danger zone</div>
      <div style="display:flex;align-items:center;justify-content:space-between;flex-wrap:wrap;gap:12px;">
        <div><div style="font-size:13px;font-weight:600;color:var(--white);">Delete my account</div><div style="font-size:11px;color:var(--muted);margin-top:2px;">This action is permanent and irreversible</div></div>
        <button onclick="if(confirm('Delete your account? This cannot be undone.')){logout();toast('Account deleted')}" style="padding:9px 18px;background:transparent;border:1px solid rgba(239,68,68,0.4);border-radius:8px;font-family:'Plus Jakarta Sans',sans-serif;font-size:12px;font-weight:600;color:#ef4444;cursor:pointer;">Delete account</button>
      </div>
    </div>
  </div>
</div>

<!-- ══════════ HELP ══════════ -->
<div class="tpanel" id="tab-help">
  <div style="max-width:720px;margin:0 auto;padding:32px 20px;">
    <div style="margin-bottom:28px;">
      <div style="font-family:'DM Mono',monospace;font-size:10px;letter-spacing:2px;color:var(--muted);text-transform:uppercase;margin-bottom:6px;">Support</div>
      <h2 style="font-family:'Bebas Neue',sans-serif;font-size:32px;letter-spacing:2px;color:var(--white);">Help Center</h2>
    </div>
    <!-- Search -->
    <div style="position:relative;margin-bottom:28px;">
      <input type="text" placeholder="Search for an answer..." style="width:100%;padding:14px 16px 14px 44px;background:var(--s1);border:1px solid var(--border2);border-radius:10px;font-family:'Plus Jakarta Sans',sans-serif;font-size:14px;color:var(--white);outline:none;box-sizing:border-box;" onfocus="this.style.borderColor='var(--g3)'" onblur="this.style.borderColor='var(--border2)'"/>
      <svg style="position:absolute;left:14px;top:50%;transform:translateY(-50%);opacity:0.4;" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="var(--white)" stroke-width="2"><circle cx="11" cy="11" r="8"/><line x1="21" y1="21" x2="16.65" y2="16.65"/></svg>
    </div>
    <!-- FAQ -->
    <div style="display:flex;flex-direction:column;gap:8px;margin-bottom:28px;">
      <div style="font-size:12px;font-family:'DM Mono',monospace;letter-spacing:1px;text-transform:uppercase;color:var(--muted);margin-bottom:8px;">Frequently asked questions</div>
      <details style="background:var(--s1);border:1px solid var(--border2);border-radius:10px;overflow:hidden;">
        <summary style="padding:16px 18px;font-size:13px;font-weight:600;color:var(--white);cursor:pointer;list-style:none;display:flex;justify-content:space-between;align-items:center;">How do I publish my first ad? <span style="color:var(--muted);font-size:16px;">+</span></summary>
        <div style="padding:0 18px 16px;font-size:13px;color:var(--muted);line-height:1.7;border-top:1px solid var(--border2);">Go to the Publish tab, fill in your ad details and click Publish. Your ad goes live instantly to the entire community.</div>
      </details>
      <details style="background:var(--s1);border:1px solid var(--border2);border-radius:10px;overflow:hidden;">
        <summary style="padding:16px 18px;font-size:13px;font-weight:600;color:var(--white);cursor:pointer;list-style:none;display:flex;justify-content:space-between;align-items:center;">What is AI Matching? <span style="color:var(--muted);font-size:16px;">+</span></summary>
        <div style="padding:0 18px 16px;font-size:13px;color:var(--muted);line-height:1.7;border-top:1px solid var(--border2);">Our algorithm analyzes your profile and ads to connect you automatically with the most relevant collaborators and partners.</div>
      </details>
      <details style="background:var(--s1);border:1px solid var(--border2);border-radius:10px;overflow:hidden;">
        <summary style="padding:16px 18px;font-size:13px;font-weight:600;color:var(--white);cursor:pointer;list-style:none;display:flex;justify-content:space-between;align-items:center;">How does the free plan work? <span style="color:var(--muted);font-size:16px;">+</span></summary>
        <div style="padding:0 18px 16px;font-size:13px;color:var(--muted);line-height:1.7;border-top:1px solid var(--border2);">The free plan lets you publish ads, access the community and use basic features with no time limit. Upgrade anytime for premium tools.</div>
      </details>
      <details style="background:var(--s1);border:1px solid var(--border2);border-radius:10px;overflow:hidden;">
        <summary style="padding:16px 18px;font-size:13px;font-weight:600;color:var(--white);cursor:pointer;list-style:none;display:flex;justify-content:space-between;align-items:center;">How do I upgrade to PRO? <span style="color:var(--muted);font-size:16px;">+</span></summary>
        <div style="padding:0 18px 16px;font-size:13px;color:var(--muted);line-height:1.7;border-top:1px solid var(--border2);">Go to the Shop tab and choose a plan. Payment is processed securely via Stripe with no commitment.</div>
      </details>
      <details style="background:var(--s1);border:1px solid var(--border2);border-radius:10px;overflow:hidden;">
        <summary style="padding:16px 18px;font-size:13px;font-weight:600;color:var(--white);cursor:pointer;list-style:none;display:flex;justify-content:space-between;align-items:center;">Can I delete my ad? <span style="color:var(--muted);font-size:16px;">+</span></summary>
        <div style="padding:0 18px 16px;font-size:13px;color:var(--muted);line-height:1.7;border-top:1px solid var(--border2);">Yes — open your ad, click the options menu and select Delete. The ad is removed immediately.</div>
      </details>
    </div>
    <!-- Contact support -->
    <div style="background:var(--s1);border:1px solid var(--border2);border-radius:12px;padding:24px;">
      <div style="font-size:13px;font-weight:700;color:var(--white);margin-bottom:6px;">Contact support</div>
      <div style="font-size:12px;color:var(--muted);margin-bottom:16px;line-height:1.6;">Can't find your answer? Our team replies within 24 hours.</div>
      <textarea rows="4" placeholder="Describe your issue..." style="width:100%;padding:12px 14px;background:var(--s2);border:1px solid var(--border2);border-radius:8px;font-family:'Plus Jakarta Sans',sans-serif;font-size:13px;color:var(--white);outline:none;resize:none;box-sizing:border-box;margin-bottom:12px;" onfocus="this.style.borderColor='var(--g3)'" onblur="this.style.borderColor='var(--border2)'"></textarea>
      <button onclick="toast('Message sent — we\'ll reply within 24h')" style="padding:11px 24px;background:linear-gradient(135deg,var(--g1),var(--g2));border:none;border-radius:8px;font-family:'Plus Jakarta Sans',sans-serif;font-size:13px;font-weight:700;color:var(--bg);cursor:pointer;">Send message</button>
    </div>
  </div>
</div>



<!-- PAYMENT -->
<div class="modal-bg" id="payment-modal">
  <div class="modal">
    <button class="modal-close" onclick="closeModal('payment-modal')">✕</button>
    <h2>SUBSCRIPTION</h2>
    <div class="modal-sub">NO COMMITMENT · CANCEL ANYTIME</div>
    <div class="pay-sum">
      <div class="pay-plan" id="pay-plan-name">STARTER</div>
      <div class="pay-price" id="pay-plan-price">$4.99</div>
      <div class="pay-period">/month</div>
    </div>
    <div id="card-element"></div>
    <div id="card-errors"></div>
    <button class="btn-modal-g" id="btn-pay" onclick="processPayment()">🔒 Subscribe now</button>
    <div style="text-align:center;margin-top:7px;font-family:'DM Mono',monospace;font-size:9px;color:var(--muted)">ENCRYPTED · STRIPE · NO COMMITMENT</div>
  </div>
</div>

<!-- REPORT MODAL -->
<div class="modal-bg" id="report-modal">
  <div class="modal">
    <button class="modal-close" onclick="closeModal('report-modal')">✕</button>
    <h2>REPORT</h2>
    <div class="modal-sub" id="report-modal-sub">REPORT SENT TO ADMIN</div>
    <div class="report-reason">
      <label><input type="radio" name="report-reason" value="spam"/> Spam / Abusive advertising</label>
      <label><input type="radio" name="report-reason" value="harassment"/> Harassment</label>
      <label><input type="radio" name="report-reason" value="contenu_inapproprie"/> Inappropriate content</label>
      <label><input type="radio" name="report-reason" value="scam"/> Scam / Fraud</label>
      <label><input type="radio" name="report-reason" value="autre"/> Other</label>
    </div>
    <div class="fg"><label>Details (optional)</label><textarea id="report-details" rows="3" placeholder="Give more info..."></textarea></div>
    <button class="btn-modal-g" onclick="submitReport()">🚨 Send report</button>
  </div>
</div>

<!-- CREATE GROUP MODAL (ELITE) -->
<div class="modal-bg" id="create-group-modal">
  <div class="modal wide">
    <button class="modal-close" onclick="closeModal('create-group-modal')">✕</button>
    <h2>CREATE A GROUP</h2>
    <div class="modal-sub">ELITE MEMBERS ONLY 🏆</div>
    <div class="group-settings-section">
      <h3>Group information</h3>
      <div style="display:grid;grid-template-columns:1fr 1fr;gap:10px">
        <div class="fg"><label>Group name *</label><input type="text" id="cg-name" placeholder="Digital Marketing Pro"/></div>
        <div class="fg"><label>Icon emoji</label><input type="text" id="cg-emoji" placeholder="💼" maxlength="2"/></div>
        <div class="fg"><label>Theme / Category</label><select id="cg-cat"><option value="marketing">📢 Marketing / Ads</option><option value="saas">🚀 SaaS / Tech</option><option value="ecommerce">🛍️ E-commerce</option><option value="tiktok">🎵 TikTok / Creators</option><option value="business">💼 Business</option><option value="freelance">💻 Freelance</option><option value="other">📦 Other</option></select></div>
        <div class="fg"><label>Max members</label><select id="cg-max"><option value="50">50 members</option><option value="100">100 members</option><option value="500">500 members</option><option value="0">Unlimitd</option></select></div>
      </div>
      <div class="fg"><label>Description</label><textarea id="cg-desc" rows="2" placeholder="What is this group about? Who can join?"></textarea></div>
    </div>
    <div class="group-settings-section">
      <h3>🔧 Moderation settings</h3>
      <div class="toggle-row"><label>Allow photos in group</label><label class="toggle"><input type="checkbox" id="cg-allow-photos" checked/><span class="toggle-slider"></span></label></div>
      <div class="toggle-row"><label>Allow videos</label><label class="toggle"><input type="checkbox" id="cg-allow-videos" checked/><span class="toggle-slider"></span></label></div>
      <div class="toggle-row"><label>Allow files</label><label class="toggle"><input type="checkbox" id="cg-allow-files"/><span class="toggle-slider"></span></label></div>
      <div class="toggle-row"><label>Private group (invite only)</label><label class="toggle"><input type="checkbox" id="cg-private"/><span class="toggle-slider"></span></label></div>
      <div class="toggle-row"><label>Pre-moderate messages</label><label class="toggle"><input type="checkbox" id="cg-premod"/><span class="toggle-slider"></span></label></div>
      <div class="toggle-row"><label>Custom background for group</label><label class="toggle"><input type="checkbox" id="cg-wallpaper-enable"/><span class="toggle-slider"></span></label></div>
    </div>
    <button class="btn-modal-g" onclick="createGroup()" style="background:linear-gradient(135deg,#ffd700,#ff8c00);color:#1a0a00">🏆 Create group</button>
  </div>
</div>

<!-- WALLPAPER MODAL (ELITE) -->
<div class="modal-bg" id="wallpaper-modal">
  <div class="modal">
    <button class="modal-close" onclick="closeModal('wallpaper-modal')">✕</button>
    <h2>WALLPAPER</h2>
    <div class="modal-sub">CUSTOMIZE YOUR SPACE — ELITE ONLY 🏆</div>
    <div style="display:grid;grid-template-columns:repeat(3,1fr);gap:10px;margin-bottom:16px">
      <div onclick="setWallpaper('none')" style="height:70px;background:var(--bg);border:2px solid var(--border);border-radius:8px;cursor:pointer;display:flex;align-items:center;justify-content:center;font-size:11px;color:var(--muted)">None</div>
      <div onclick="setWallpaper('linear-gradient(135deg,#040a05,#0b2810)')" style="height:70px;background:linear-gradient(135deg,#040a05,#0b2810);border:2px solid var(--border);border-radius:8px;cursor:pointer"></div>
      <div onclick="setWallpaper('linear-gradient(135deg,#0a0014,#1a0028)')" style="height:70px;background:linear-gradient(135deg,#0a0014,#1a0028);border:2px solid var(--border);border-radius:8px;cursor:pointer"></div>
      <div onclick="setWallpaper('linear-gradient(135deg,#001a0a,#0a1f0a,#001210)')" style="height:70px;background:linear-gradient(135deg,#001a0a,#0a1f0a,#001210);border:2px solid var(--border);border-radius:8px;cursor:pointer"></div>
      <div onclick="setWallpaper('linear-gradient(135deg,#1a0a00,#2a1000)')" style="height:70px;background:linear-gradient(135deg,#1a0a00,#2a1000);border:2px solid var(--border);border-radius:8px;cursor:pointer"></div>
      <div onclick="setWallpaper('linear-gradient(135deg,#00101a,#001428)')" style="height:70px;background:linear-gradient(135deg,#00101a,#001428);border:2px solid var(--border);border-radius:8px;cursor:pointer"></div>
    </div>
    <div class="fg"><label>Or import an image</label><input type="file" id="wallpaper-file" accept="image/*" onchange="setWallpaperFromFeede(this)"/></div>
  </div>
</div>

<!-- DM ADMIN MODAL (ELITE) -->
<div class="modal-bg" id="dm-admin-modal">
  <div class="modal">
    <button class="modal-close" onclick="closeModal('dm-admin-modal')">✕</button>
    <h2>MESSAGE TO ADMIN</h2>
    <div class="modal-sub">PRIVATE MESSAGE — ELITE ONLY 🏆</div>
    <div class="dm-thread">
      <div class="dm-msgs" id="dm-admin-msgs"></div>
      <div class="dm-input-row">
        <input type="text" id="dm-admin-input" placeholder="Your message to admin..." onkeydown="if(event.key==='Enter')sendAdminDM()" style="flex:1"/>
        <button class="btn-publish" onclick="sendAdminDM()" style="padding:9px 18px">Send</button>
      </div>
    </div>
  </div>
</div>

<!-- GROUP CHAT MODAL -->
<div class="modal-bg" id="group-chat-modal">
  <div class="modal wide">
    <button class="modal-close" onclick="closeModal('group-chat-modal')">✕</button>
    <h2 id="group-chat-title">GROUPE</h2>
    <div class="modal-sub" id="group-chat-sub">GROUP DISCUSSION</div>
    <div style="display:flex;gap:12px">
      <div style="flex:1">
        <div class="chat-box" style="height:400px">
          <div class="chat-msgs-area" id="group-chat-msgs"></div>
          <div class="chat-input-row" style="align-items:center">
            <label id="group-media-upload-label" style="cursor:pointer;color:var(--g3);font-size:18px;flex-shrink:0;display:none" title="Add media">
              <input type="file" id="group-media-input" accept="image/*,video/*" style="display:none" onchange="sendGroupMedia(this)"/>📎
            </label>
            <input type="text" id="group-chat-in" class="chat-input-field" placeholder="Write your message..."/>
            <button class="btn-send" onclick="sendGroupMsg()">→</button>
          </div>
        </div>
      </div>
      <div id="group-members-sidebar" style="width:180px;background:var(--s1);border:1px solid var(--border2);border-radius:10px;padding:12px;max-height:430px;overflow-y:auto">
        <div style="font-family:'DM Mono',monospace;font-size:9px;color:var(--g3);letter-spacing:2px;margin-bottom:10px">MEMBERS</div>
        <div id="group-members-list" style="font-size:12px;color:var(--muted)"></div>
        <div id="group-admin-controls" style="display:none;margin-top:12px;border-top:1px solid var(--border2);padding-top:10px">
          <div style="font-family:'DM Mono',monospace;font-size:9px;color:var(--gold);letter-spacing:2px;margin-bottom:8px">MODERATION</div>
          <button onclick="openGroupSettings()" style="width:100%;padding:6px;background:transparent;border:1px solid rgba(255,215,0,0.2);border-radius:5px;font-size:11px;color:var(--gold);cursor:pointer;font-family:'Plus Jakarta Sans',sans-serif;margin-bottom:5px">⚙️ Settings</button>
          <button onclick="openModal('wallpaper-modal')" style="width:100%;padding:6px;background:transparent;border:1px solid var(--border);border-radius:5px;font-size:11px;color:var(--muted);cursor:pointer;font-family:'Plus Jakarta Sans',sans-serif">🖼️ Wallpaper</button>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- DM MODAL -->
<div class="modal-bg" id="dm-modal">
  <div class="modal" style="padding:0;overflow:hidden;max-width:480px;border-radius:20px;border:1.5px solid rgba(34,197,94,0.2);background:#040a05;">
    <!-- DM Header -->
    <div style="display:flex;align-items:center;gap:12px;padding:16px 20px;background:linear-gradient(135deg,#060e07,#0b1a0d);border-bottom:1px solid rgba(34,197,94,0.1);position:relative;">
      <div id="dm-modal-avatar" style="width:42px;height:42px;border-radius:50%;background:linear-gradient(135deg,#15803d,#22c55e);display:flex;align-items:center;justify-content:center;font-size:18px;font-weight:800;color:#040a05;font-family:'Bebas Neue',sans-serif;flex-shrink:0;border:2px solid rgba(34,197,94,0.4);">?</div>
      <div style="flex:1;min-width:0;">
        <div id="dm-modal-name" style="font-family:'Plus Jakarta Sans',sans-serif;font-size:15px;font-weight:800;color:#f0fdf4;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;">...</div>
        <div style="display:flex;align-items:center;gap:6px;margin-top:2px;">
          <span style="width:7px;height:7px;border-radius:50%;background:#22c55e;display:inline-block;box-shadow:0 0 6px rgba(34,197,94,0.8);"></span>
          <span style="font-family:'DM Mono',monospace;font-size:9px;color:var(--g4);letter-spacing:1px;">ONLINE · VIRALBOOST</span>
        </div>
      </div>
      <button class="modal-close" onclick="closeModal('dm-modal')" style="position:static;width:32px;height:32px;border-radius:50%;background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);color:rgba(255,255,255,0.5);font-size:14px;display:flex;align-items:center;justify-content:center;">✕</button>
    </div>
    <!-- Messages area -->
    <div class="dm-thread" style="height:340px;overflow-y:auto;padding:16px;display:flex;flex-direction:column;gap:10px;background:#040a05;" id="dm-msgs-list">
      <div style="text-align:center;padding:40px 20px;">
        <div style="width:56px;height:56px;border-radius:50%;background:linear-gradient(135deg,#0b1a0d,#142e17);border:2px solid rgba(34,197,94,0.2);display:flex;align-items:center;justify-content:center;font-size:24px;margin:0 auto 14px;">👋</div>
        <div style="font-family:'Plus Jakarta Sans',sans-serif;font-size:14px;font-weight:700;color:#f0fdf4;margin-bottom:6px;">Start a conversation</div>
        <div style="font-family:'DM Mono',monospace;font-size:10px;color:var(--muted);letter-spacing:0.5px;">Your messages are private and secure</div>
      </div>
    </div>
    <!-- Input area -->
    <div style="padding:12px 16px;background:#060e07;border-top:1px solid rgba(34,197,94,0.1);display:flex;align-items:center;gap:10px;">
      <div style="flex:1;background:rgba(11,26,13,0.8);border:1.5px solid rgba(34,197,94,0.15);border-radius:24px;display:flex;align-items:center;padding:0 16px;transition:border-color 0.2s;" onfocusin="this.style.borderColor='rgba(34,197,94,0.5)'" onfocusout="this.style.borderColor='rgba(34,197,94,0.15)'">
        <input type="text" id="dm-input" placeholder="Type a message..." onkeydown="if(event.key==='Enter')sendDM()" style="flex:1;background:none;border:none;outline:none;font-family:'Plus Jakarta Sans',sans-serif;font-size:13px;color:#f0fdf4;padding:11px 0;" autocomplete="off"/>
      </div>
      <button onclick="sendDM()" style="width:42px;height:42px;border-radius:50%;background:linear-gradient(135deg,#15803d,#22c55e);border:none;display:flex;align-items:center;justify-content:center;cursor:pointer;flex-shrink:0;box-shadow:0 0 14px rgba(34,197,94,0.3);transition:all 0.2s;" onmouseover="this.style.boxShadow='0 0 24px rgba(34,197,94,0.6)';this.style.transform='scale(1.08)'" onmouseout="this.style.boxShadow='0 0 14px rgba(34,197,94,0.3)';this.style.transform=''">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="#040a05" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><line x1="22" y1="2" x2="11" y2="13"/><polygon points="22 2 15 22 11 13 2 9 22 2"/></svg>
      </button>
    </div>
  </div>
</div>

<!-- MESSAGES PANEL -->
<div class="modal-bg" id="messages-panel-modal">
  <div class="modal" style="padding:0;overflow:hidden;max-width:480px;border-radius:20px;border:1.5px solid rgba(34,197,94,0.2);background:#040a05;max-height:85vh;display:flex;flex-direction:column;">
    <!-- Header -->
    <div style="display:flex;align-items:center;gap:12px;padding:18px 20px;background:linear-gradient(135deg,#060e07,#0b1a0d);border-bottom:1px solid rgba(34,197,94,0.1);flex-shrink:0;">
      <div style="flex:1;">
        <div style="font-family:'Bebas Neue',sans-serif;font-size:22px;letter-spacing:2px;color:#f0fdf4;">MESSAGES</div>
        <div style="font-family:'DM Mono',monospace;font-size:9px;color:var(--g4);letter-spacing:1px;margin-top:1px;">YOUR PRIVATE CONVERSATIONS</div>
      </div>
      <button onclick="closeModal('messages-panel-modal')" style="width:32px;height:32px;border-radius:50%;background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);color:rgba(255,255,255,0.5);font-size:14px;display:flex;align-items:center;justify-content:center;cursor:pointer;">✕</button>
    </div>
    <!-- Search -->
    <div style="padding:12px 16px;border-bottom:1px solid rgba(34,197,94,0.08);flex-shrink:0;">
      <div style="background:rgba(11,26,13,0.8);border:1.5px solid rgba(34,197,94,0.12);border-radius:10px;display:flex;align-items:center;gap:8px;padding:0 12px;">
        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="rgba(34,197,94,0.5)" stroke-width="2" stroke-linecap="round"><circle cx="11" cy="11" r="8"/><line x1="21" y1="21" x2="16.65" y2="16.65"/></svg>
        <input type="text" placeholder="Search conversations..." oninput="filterMessageThreads(this.value)" style="flex:1;background:none;border:none;outline:none;font-family:'Plus Jakarta Sans',sans-serif;font-size:13px;color:#f0fdf4;padding:10px 0;" autocomplete="off"/>
      </div>
    </div>
    <!-- Thread list -->
    <div id="messages-thread-list" style="flex:1;overflow-y:auto;padding:8px 0;min-height:200px;"></div>
    <!-- New message CTA -->
    <div style="padding:14px 16px;border-top:1px solid rgba(34,197,94,0.08);flex-shrink:0;">
      <button onclick="closeModal('messages-panel-modal');promptNewMessage()" style="width:100%;padding:12px;background:linear-gradient(135deg,#15803d,#22c55e);border:none;border-radius:10px;font-family:'Bebas Neue',sans-serif;font-size:15px;letter-spacing:1.5px;color:#040a05;cursor:pointer;font-weight:900;transition:all 0.2s;box-shadow:0 0 18px rgba(34,197,94,0.25);" onmouseover="this.style.boxShadow='0 0 32px rgba(34,197,94,0.5)'" onmouseout="this.style.boxShadow='0 0 18px rgba(34,197,94,0.25)'">+ NEW MESSAGE</button>
    </div>
  </div>
</div>

<!-- EDIT PROFILE -->
<div class="modal-bg" id="edit-profile-modal">
  <div class="modal wide">
    <button class="modal-close" onclick="closeModal('edit-profile-modal')">✕</button>
    <h2>MY PROFILE</h2>
    <div class="modal-sub">MORE COMPLETE THAN ANY OTHER PLATFORM</div>

    <div class="edit-section">
      <h3>Identity & Avatar</h3>
      <div class="edit-avatar-row">
        <div class="edit-avatar-big" id="edit-ava-preview" style="background:var(--g2)" onclick="document.getElementById('ava-file-input')?.click()" title="Click to upload a photo">
          <span id="edit-ava-emoji">🙂</span>
          <img loading="lazy" id="edit-ava-img" alt="Avatar preview" style="display:none;position:absolute;inset:0;width:100%;height:100%;object-fit:cover;border-radius:50%"/>
          <div class="ava-upload-overlay"></div>
          <input type="file" id="ava-file-input" accept="image/*" style="display:none;position:absolute" onchange="handleAvatarUpload(this)"/>
        </div>
        <div style="flex:1">
          <div style="font-size:11px;color:var(--muted);margin-bottom:8px">Click on the avatar to upload a photo · or choose an emoji</div>
          <div style="margin-bottom:6px;font-family:'DM Mono',monospace;font-size:9px;color:var(--g3);letter-spacing:1px">FREE</div>
          <div class="emoji-picker" style="margin-bottom:10px">
            <div class="emoji-opt" onclick="selectEmoji(this,'🙂')">🙂</div>
            <div class="emoji-opt" onclick="selectEmoji(this,'😎')">😎</div>
            <div class="emoji-opt" onclick="selectEmoji(this,'🤩')">🤩</div>
            <div class="emoji-opt" onclick="selectEmoji(this,'😏')">😏</div>
            <div class="emoji-opt" onclick="selectEmoji(this,'🧐')">🧐</div>
            <div class="emoji-opt" onclick="selectEmoji(this,'🚀')">🚀</div>
            <div class="emoji-opt" onclick="selectEmoji(this,'💡')">💡</div>
            <div class="emoji-opt" onclick="selectEmoji(this,'🎯')">🎯</div>
            <div class="emoji-opt" onclick="selectEmoji(this,'🔥')">🔥</div>
            <div class="emoji-opt" onclick="selectEmoji(this,'⚡')">⚡</div>
            <div class="emoji-opt" onclick="selectEmoji(this,'🌍')">🌍</div>
            <div class="emoji-opt" onclick="selectEmoji(this,'🧠')">🧠</div>
          </div>
          <div style="margin-bottom:6px;font-family:'DM Mono',monospace;font-size:9px;color:var(--gold);letter-spacing:1px">✨ PREMIUM (STARTER+)</div>
          <div class="emoji-picker">
            <div class="emoji-opt premium-emoji" onclick="selectEmojiPremium(this,'💎','starter')">💎</div>
            <div class="emoji-opt premium-emoji" onclick="selectEmojiPremium(this,'👑','pro')">👑</div>
            <div class="emoji-opt premium-emoji" onclick="selectEmojiPremium(this,'🦁','starter')">🦁</div>
            <div class="emoji-opt premium-emoji" onclick="selectEmojiPremium(this,'🐉','pro')">🐉</div>
            <div class="emoji-opt premium-emoji" onclick="selectEmojiPremium(this,'🌟','starter')">🌟</div>
            <div class="emoji-opt premium-emoji" onclick="selectEmojiPremium(this,'🏆','pro')">🏆</div>
            <div class="emoji-opt premium-emoji" onclick="selectEmojiPremium(this,'🦊','starter')">🦊</div>
            <div class="emoji-opt premium-emoji" onclick="selectEmojiPremium(this,'🤖','starter')">🤖</div>
            <div class="emoji-opt premium-emoji" onclick="selectEmojiPremium(this,'🦄','elite')">🦄</div>
            <div class="emoji-opt premium-emoji" onclick="selectEmojiPremium(this,'👾','pro')">👾</div>
            <div class="emoji-opt premium-emoji" onclick="selectEmojiPremium(this,'🧬','elite')">🧬</div>
            <div class="emoji-opt premium-emoji" onclick="selectEmojiPremium(this,'🔮','elite')">🔮</div>
          </div>
        </div>
      </div>
      <div style="display:grid;grid-template-columns:1fr 1fr;gap:10px">
        <div class="fg"><label>First name *</label><input type="text" id="ep-name" placeholder="Marie"/></div>
        <div class="fg"><label>Username *</label><input type="text" id="ep-username" placeholder="marie_creator"/></div>
        <div class="fg"><label>Title / Role</label><input type="text" id="ep-title" placeholder="Content creator · Indie developer"/></div>
        <div class="fg"><label>Location</label><input type="text" id="ep-location" placeholder="City, Country 🌍"/></div>
      </div>
      <div class="fg"><label>Bio</label><textarea id="ep-bio" rows="3" placeholder="Tell us who you are, what you create, what drives you..."></textarea></div>
    </div>

    <div class="edit-section">
      <h3>About (ultra-detailed)</h3>
      <div style="display:grid;grid-template-columns:1fr 1fr;gap:10px">
        <div class="fg"><label>Sector / Niche</label><input type="text" id="ep-niche" placeholder="Marketing digital, Tech, Fitness..."/></div>
        <div class="fg"><label>Experience</label><select id="ep-exp"><option>Beginner (0-1 yr)</option><option>Intermediate (1-3 yrs)</option><option>Confirmed (3-5 yrs)</option><option>Expert (5+ yrs)</option></select></div>
        <div class="fg"><label>Availability</label><select id="ep-dispo"><option>Open to collaborations</option><option>Available for projects</option><option>Looking for investor</option><option>Looking for partner</option><option>Just networking</option></select></div>
        <div class="fg"><label>Monthly revenue (optional)</label><select id="ep-revenue"><option value="">Not specified</option><option>0–500$</option><option>500–2 000$</option><option>2 000–5 000$</option><option>5 000–10 000$</option><option>$10,000+</option></select></div>
        <div class="fg"><label>Main goal</label><input type="text" id="ep-goal" placeholder="Reach 100K followers by 2025"/></div>
        <div class="fg"><label>Key skills</label><input type="text" id="ep-skills" placeholder="Video, Copywriting, SEO, Dev..."/></div>
        <div class="fg"><label>Tools used</label><input type="text" id="ep-tools" placeholder="CapCut, Canva, Notion, Figma..."/></div>
        <div class="fg"><label>Languages spoken</label><input type="text" id="ep-langs" placeholder="French, English, Spanish..."/></div>
      </div>
      <div class="fg"><label>What I'm looking for</label><textarea id="ep-looking" rows="2" placeholder="I'm looking for collaborators, a partner, clients, advice..."></textarea></div>
    </div>

    <div class="edit-section">
      <h3>Networks & Links</h3>
      <div style="display:grid;grid-template-columns:1fr 1fr;gap:10px">
        <div class="fg"><label>🌐 Website</label><input type="url" id="ep-website" placeholder="https://your-site.com"/></div>
        <div class="fg"><label>🎵 TikTok</label><input type="text" id="ep-tiktok" placeholder="@monaccount"/></div>
        <div class="fg"><label>📸 Instagram</label><input type="text" id="ep-instagram" placeholder="@monaccount"/></div>
        <div class="fg"><label>🐦 Twitter/X</label><input type="text" id="ep-twitter" placeholder="@monaccount"/></div>
        <div class="fg"><label>💼 LinkedIn</label><input type="url" id="ep-linkedin" placeholder="linkedin.com/in/..."/></div>
        <div class="fg"><label>▶️ YouTube</label><input type="text" id="ep-youtube" placeholder="@monaccount"/></div>
      </div>
    </div>

    <div class="edit-section">
      <h3>My numbers (optional)</h3>
      <div style="display:grid;grid-template-columns:repeat(4,1fr);gap:10px">
        <div class="fg"><label>TikTok followers</label><input type="text" id="ep-tiktok-count" placeholder="45 000"/></div>
        <div class="fg"><label>Instagram followers</label><input type="text" id="ep-ig-count" placeholder="12 000"/></div>
        <div class="fg"><label>Projects launched</label><input type="text" id="ep-projects-count" placeholder="3"/></div>
        <div class="fg"><label>Sales / Clients</label><input type="text" id="ep-sales" placeholder="150"/></div>
      </div>
    </div>

    <button class="btn-modal-g" onclick="saveProfile()">💾 Save profile</button>
  </div>
</div>

<!-- PUBLISH LANDING (before sign up) -->
<div class="modal-bg" id="publish-landing-modal">
  <div class="modal wide">
    <button class="modal-close" onclick="closeModal('publish-landing-modal')">✕</button>
    <h2>POST AN AD</h2>
    <div class="modal-sub">INSTANT DISTRIBUTION ON VIRALBOOST · NO ACCOUNT REQUIRED</div>
    <div class="fg"><label>Your ad title *</label><input type="text" id="pl-title" placeholder="Ex: ContentPro — The AI tool for creators"/></div>
    <div class="fg"><label>Ad message *</label><textarea id="pl-text" rows="4" placeholder="Describe your product, service, project... Make it catchy!"></textarea></div>
    <div class="edit-grid">
      <div class="fg"><label>Category</label><select id="pl-type"><option value="saas">🚀 SaaS / App</option><option value="site">🌐 Website</option><option value="ecommerce">🛍️ E-commerce</option><option value="service">💼 Service</option><option value="coaching">🎓 Coaching</option><option value="tiktok">🎵 TikTok</option><option value="instagram">📸 Instagram</option></select></div>
      <div class="fg"><label>URL (optional)</label><input type="url" id="pl-url" placeholder="https://..."/></div>
    </div>
    <div class="fg">
      <label>Image / Video (optional)</label>
      <label style="display:flex;align-items:center;gap:8px;cursor:pointer;background:var(--s2);border:1.5px dashed var(--border);border-radius:8px;padding:10px 14px;font-size:12px;color:var(--muted)">
        📎 Add a file
        <input type="file" id="pl-media" accept="image/*,video/*" style="display:none" onchange="handleLandingMediaUpload(this)"/>
      </label>
      <div id="pl-media-preview" style="margin-top:8px"></div>
    </div>
    <button class="btn-modal-g" onclick="publishLandingAd()">📢 Publish now</button>
    <div class="modal-switch">Already have an account? <a href="#plans" onclick="switchModal('publish-landing-modal','login-modal');return false;">Log in</a> · <a href="#plans" onclick="switchModal('publish-landing-modal','signup-modal');return false;">Sign up</a></div>
  </div>
</div>

<!-- CREATE GROUP (ELITE) -->
<div class="modal-bg" id="create-group-modal">
  <div class="modal wide">
    <button class="modal-close" onclick="closeModal('create-group-modal')">✕</button>
    <h2>CREATE A GROUP</h2>
    <div class="modal-sub">ELITE FEATURE — YOU ARE GROUP ADMIN</div>
    <div class="edit-grid">
      <div class="fg"><label>Group name *</label><input type="text" id="grp-name" placeholder="Ex: SaaS Builders FR"/></div>
      <div class="fg"><label>Emoji / Icon</label><input type="text" id="grp-emoji" placeholder="🚀" maxlength="2"/></div>
    </div>
    <div class="fg"><label>Description *</label><textarea id="grp-desc" rows="2" placeholder="What is this group about?"></textarea></div>
    <div class="edit-grid">
      <div class="fg"><label>Category</label><select id="grp-cat"><option>SaaS / Tech</option><option>Marketing</option><option>TikTok / Instagram</option><option>E-commerce</option><option>Coaching</option><option>Crypto / Finance</option><option>Other</option></select></div>
      <div class="fg"><label>Access</label><select id="grp-access"><option value="public">🌍 Public</option><option value="private">🔒 Private (by invitation)</option></select></div>
    </div>
    <div class="fg"><label>Background image (URL or upload)</label>
      <label style="display:flex;align-items:center;gap:8px;cursor:pointer;background:var(--s2);border:1.5px dashed var(--border);border-radius:8px;padding:10px 14px;font-size:12px;color:var(--muted)">
        🖼️ Group background
        <input type="file" id="grp-bg-input" accept="image/*" style="display:none" onchange="handleGroupBgUpload(this)"/>
      </label>
      <div id="grp-bg-preview" style="margin-top:8px"></div>
    </div>
    <div class="fg"><label>Group rules (optional)</label><textarea id="grp-rules" rows="2" placeholder="Ex: No spam. Topics related to SaaS only."></textarea></div>
    <div style="background:rgba(22,163,74,0.06);border:1px solid rgba(22,163,74,0.18);border-radius:8px;padding:12px;margin-bottom:14px;font-size:12px;color:var(--g5)">
      As admin, you can: edit the background, rules, allow/ban photos, remove members, report abuse.
    </div>
    <button class="btn-modal-g" onclick="createGroup()">🏛️ Create the group</button>
  </div>
</div>

<!-- SETTINGS GROUPE (ELITE admin) -->
<div class="modal-bg" id="group-settings-modal">
  <div class="modal wide">
    <button class="modal-close" onclick="closeModal('group-settings-modal')">✕</button>
    <h2>GROUP SETTINGS</h2>
    <div class="modal-sub">ADMINISTRATION — ELITE ONLY</div>
    <div class="fg"><label>Allow photos in this group</label>
      <select id="gs-allow-photos"><option value="1">✅ Yes, allowed</option><option value="0">❌ No, disabled</option></select>
    </div>
    <div class="fg"><label>New background (upload)</label>
      <label style="display:flex;align-items:center;gap:8px;cursor:pointer;background:var(--s2);border:1.5px dashed var(--border);border-radius:8px;padding:10px 14px;font-size:12px;color:var(--muted)">
        🖼️ Edit background
        <input type="file" id="gs-bg-input" accept="image/*" style="display:none" onchange="handleGroupSettingsBg(this)"/>
      </label>
    </div>
    <div class="fg"><label>Rules</label><textarea id="gs-rules" rows="2"></textarea></div>
    <div class="fg"><label>Private mode</label>
      <select id="gs-access"><option value="public">🌍 Public</option><option value="private">🔒 Private</option></select>
    </div>
    <button class="btn-modal-g" onclick="saveGroupSettings()">💾 Save</button>
  </div>
</div>

<!-- CHAT GROUPE -->
<div class="modal-bg" id="group-chat-modal">
  <div class="modal wide">
    <button class="modal-close" onclick="closeModal('group-chat-modal')">✕</button>
    <h2 id="group-chat-title">GROUPE</h2>
    <div style="display:flex;gap:8px;margin-bottom:8px" id="group-chat-actions"></div>
    <div class="chat-box" style="height:400px">
      <div class="chat-msgs-area" id="group-chat-msgs"></div>
      <div class="chat-input-row">
        <input type="text" id="group-chat-input" class="chat-input-field" placeholder="Message in the group..." onkeydown="if(event.key==='Enter')sendGroupMessage()"/>
        <label id="group-media-btn" style="display:none;cursor:pointer;background:var(--s2);border:1.5px solid var(--border2);border-radius:7px;width:38px;height:38px;display:flex;align-items:center;justify-content:center;font-size:14px;flex-shrink:0" title="Joindre un fichier">
          📎<input type="file" id="group-chat-file" accept="image/*,video/*" style="display:none" onchange="handleGroupChatFeede(this)"/>
        </label>
        <button class="btn-send" onclick="sendGroupMessage()">→</button>
      </div>
    </div>
  </div>
</div>

<!-- REPORT A USER -->
<div class="modal-bg" id="report-modal">
  <div class="modal">
    <button class="modal-close" onclick="closeModal('report-modal')">✕</button>
    <h2>REPORT</h2>
    <div class="modal-sub" id="report-modal-sub">REPORT SENT TO ADMIN</div>
    <div class="fg"><label>Reason for report *</label>
      <select id="report-reason">
        <option value="spam">🚫 Spam / Abusive advertising</option>
        <option value="harassment">⚠️ Harassment / Insults</option>
        <option value="contenu">🔞 Inappropriate content</option>
        <option value="scam">💸 Scam / Fraud</option>
        <option value="other">📝 Other</option>
      </select>
    </div>
    <div class="fg"><label>Details (optional)</label><textarea id="report-details" rows="3" placeholder="Explain what happened..."></textarea></div>
    <button class="btn-modal-g" onclick="submitReport()">🚨 Send report</button>
  </div>
</div>

<!-- CONTACT ADMIN (ELITE) -->
<div class="modal-bg" id="contact-admin-modal">
  <div class="modal">
    <button class="modal-close" onclick="closeModal('contact-admin-modal')">✕</button>
    <h2>MESSAGE TO ADMIN</h2>
    <div class="modal-sub">ELITE FEATURE — REPLY WITHIN 24H</div>
    <div class="fg"><label>Objet</label><input type="text" id="ca-subject" placeholder="Ex: Demande de partnership"/></div>
    <div class="fg"><label>Message *</label><textarea id="ca-message" rows="5" placeholder="Your message to the ViralBoos teamt..."></textarea></div>
    <button class="btn-modal-g" onclick="sendAdminMessage()">📩 Send</button>
  </div>
</div>
<script>


// ════════════════════════════════════════
// ── SYSTÈME I18N FR / EN
// ════════════════════════════════════════
let currentLang = localStorage.getItem('vb_lang') || 'en';

const i18n = {
  fr: {
    // Navbar
    nav_showcase: 'Showcase', nav_plans: 'Plans', nav_reviews: 'Reviews',
    nav_login: 'Log in', nav_join: 'Join →',
    mob_showcase: '📊 Showcase', mob_plans: '💎 Plans', mob_reviews: '⭐ Reviews',
    // Hero
    hero_line1: 'JOIN', hero_line2: 'VIRALBOOST.', hero_badge: '📢 THE #1 PLATFORM FOR DIGITAL ADVERTISING', hero_sub_new: "The platform where creators and entrepreneurs showcase their project, find partners and grow their audience.",
      hero_cta1: "⚡ Join for free →",
      hero_nocard: "No credit card · Immediate access",
      feat1_title: "Post your ad", feat1_sub: "Instantly visible to everyone",
      feat2_title: "Find collabs", feat2_sub: "Matching with creators",
      feat3_title: "Grow your audience", feat3_sub: "Votes, shares, visibility", feat4_title: "Community chat", feat4_sub: "Connect with other creators", feat5_title: "Project rankings", feat5_sub: "Top projects rise to the top", feat6_title: "Targeted audience", feat6_sub: "Creators, entrepreneurs, founders", mono_title: "From 1,000 followers — generate revenue", mono_sub: "Enable sales on your profile and monetize your community directly from the platform.",
      hero_form_title: "📢 POST YOUR AD IN 30 SECONDS",
      hero_form_btn: "📢 Publish my ad for free →",
      hero_form_note: "✓ Free · Instantly visible · No card required",
      hero_login_link: "Already signed up? Log in",
    hero_cta2: 'Log in',
    how1_title: 'Post your ad', how2_title: 'Find a partner', how3_title: "Boost with AI",
    // Sections
    sec_feed: 'Public feed', sec_showcase: 'Community showcase', sec_plans: 'Plans',
    // Bottom nav
    bn_feed: 'Feed', bn_showcase: 'Showcase', bn_profile: 'Profile',
    // Composer
    comp_label: '✦ COMMUNITY FEED', comp_title: 'Share with the community',
    comp_sub: 'Projects, ideas, questions — your voice matters here.',
    comp_placeholder: 'Share your project with the community…',
    // Feed tabs
    tab_all: 'All', tab_following: 'Following', tab_top: 'Top today',
    // Buttons
    btn_publish: 'Publish', btn_addlink: '🔗 Add a link',
    // Toast
    toast_published: '📢 Post published!',
    toast_write: 'Write something!',
    toast_limit_free: 'FREE plan: 1 post/hour. Upgrade for more!',
    toast_limit_day: "Daily post limit reached.",
    // App tabs
    apptab_feed: 'Feed', apptab_showcase: 'Showcase', apptab_publish: 'Publish',
    apptab_chat: 'Chat', apptab_profile: 'Profile',
    // Profile
    prof_edit: '✏️ Edit', prof_followers: 'Followers', prof_following: 'Following', prof_projects: 'Projects', prof_votes: 'Votes received',
    // Showcase
    vit_title: 'COMMUNITY SHOWCASE', vit_sub: 'Projects shared by the community',
    vit_empty: '🚀 No projects for this filter',
    vit_all: 'All',
    // Publish wizard
    wiz_title: 'CREATE MY AD',
    wiz_sub: 'Follow the 5 steps to create an ad that converts and attracts votes.',
    // No posts
    no_posts: "No posts yet.",
    // Login/signup modal
    login_title: 'LOG IN', signup_title: 'CREATE MY ACCOUNT',
    // Settings
    logout: 'Log out',
    // URL field
    url_placeholder: 'https://your-site.com',
    proj_placeholder: 'Project name (optional)',
  },
  en: {
    // Navbar
    nav_showcase: 'Showcase', nav_plans: 'Pricing', nav_reviews: 'Reviews',
    nav_login: 'Log in', nav_join: 'Join →',
    mob_showcase: '📊 Showcase', mob_plans: '💎 Pricing', mob_reviews: '⭐ Reviews',
    // Hero
    hero_line1: 'JOIN', hero_line2: 'VIRALBOOST.', hero_badge: '📢 #1 DIGITAL ADVERTISING PLATFORM', hero_sub_new: "The platform where creators and entrepreneurs showcase their project, find partners and grow their audience.",
      hero_cta1: "⚡ Join for free →",
      hero_nocard: "No credit card · Instant access",
      feat1_title: "Publish your ad", feat1_sub: "Visible immediately to all",
      feat2_title: "Find collabs", feat2_sub: "Matched with creators",
      feat3_title: "Grow your reach", feat3_sub: "Votes, shares, visibility", feat4_title: "Community chat", feat4_sub: "Talk with other creators", feat5_title: "Project ranking", feat5_sub: "Best projects rise to the top", feat6_title: "Targeted audience", feat6_sub: "Creators, entrepreneurs, founders", mono_title: "From 1,000 followers — generate revenue", mono_sub: "Enable sales on your profile and monetize your community directly from the platform.",
      hero_form_title: "📢 PUBLISH YOUR AD IN 30 SECONDS",
      hero_form_btn: "📢 Publish my ad for free →",
      hero_form_note: "✓ Free · Visible instantly · No card required",
      hero_login_link: "Already a member? Sign in",
    hero_cta2: 'Log in',
    how1_title: 'Post your ad', how2_title: 'Find a partner', how3_title: 'Boost with AI',
    // Sections
    sec_feed: 'Public feed', sec_showcase: 'Community Showcase', sec_plans: 'Pricing',
    // Bottom nav
    bn_feed: 'Feed', bn_showcase: 'Showcase', bn_profile: 'Profile',
    // Composer
    comp_label: '✦ COMMUNITY FEED', comp_title: 'Share with the community',
    comp_sub: 'Projects, ideas, questions — your voice matters here.',
    comp_placeholder: 'Share your project with the community…',
    // Feed tabs
    tab_all: 'All', tab_following: 'Following', tab_top: "Today's top",
    // Buttons
    btn_publish: 'Post', btn_addlink: '🔗 Add a link',
    // Toast
    toast_published: '📢 Post published!',
    toast_write: 'Write something!',
    toast_limit_free: 'FREE plan: 1 post/hour. Upgrade for more!',
    toast_limit_day: 'Daily post limit reached.',
    // App tabs
    apptab_feed: 'Feed', apptab_showcase: 'Showcase', apptab_publish: 'Publish',
    apptab_chat: 'Chat', apptab_profile: 'Profile',
    // Profile
    prof_edit: '✏️ Edit', prof_followers: 'Followers', prof_following: 'Following', prof_projects: 'Projects', prof_votes: 'Votes received',
    // Showcase
    vit_title: 'COMMUNITY SHOWCASE', vit_sub: 'Projects shared by the community',
    vit_empty: '🚀 No projects for this filter',
    vit_all: 'All',
    // Publish wizard
    wiz_title: 'CREATE MY AD',
    wiz_sub: 'Follow the 5 steps to create an ad that converts and attracts votes.',
    // No posts
    no_posts: 'No posts yet.',
    // Login/signup modal
    login_title: 'LOG IN', signup_title: 'CREATE MY ACCOUNT',
    // Settings
    logout: 'Log out',
    // URL field
    url_placeholder: 'https://your-website.com',
    proj_placeholder: 'Project name (optional)',
  }
};

function t(key) {
  return (i18n[currentLang] && i18n[currentLang][key]) || (i18n['en'][key]) || key;
}

function applyLang() {
  // Update all data-i18n elements
  // Use innerText only if the element has no complex HTML children
  document.querySelectorAll('[data-i18n]').forEach(el => {
    const key = el.getAttribute('data-i18n');
    const val = t(key);
    // If the element only has text (no child elements), replace directly
    if(el.children.length === 0) {
      el.textContent = val;
    } else {
      // Otherwise find a direct text node and update it
      for(let node of el.childNodes) {
        if(node.nodeType === 3 && node.textContent.trim()) {
          node.textContent = val;
          break;
        }
      }
    }
  });
  // Placeholders
  const ta = document.getElementById('feed-text');
  if(ta) ta.placeholder = t('comp_placeholder');
  const urlInp = document.getElementById('feed-url');
  if(urlInp) urlInp.placeholder = t('url_placeholder');
  const projInp = document.getElementById('feed-proj-name');
  if(projInp) projInp.placeholder = t('proj_placeholder');
  // Language button — shows the language you can switch TO
  const btn = document.getElementById('lang-btn');
  if(btn) btn.textContent = '🇺🇸 EN';
  // html lang + title
  document.documentElement.lang = currentLang;
  document.title = 'ViralBoost — Publish your ad, reach your audience';
  // Rebuild dynamic sections if app active
  if(document.getElementById('tab-showcase')?.classList.contains('active')) buildShowcaseGrid('app-showcase-grid');
  if(document.getElementById('tab-feed')?.classList.contains('active')) buildFeed();
}

function toggleLang() {
  currentLang = currentLang === 'en' ? 'fr' : 'en';
  localStorage.setItem('vb_lang', currentLang);
  applyLang();
}

// Apply on loading
document.addEventListener('DOMContentLoaded', () => { applyLang(); });

const PLANS = [
  { id:'free', name:'FREE', price:0, period:'', desc:'To discover ViralBoost',
    color:'#6b7280', glow:'rgba(107,114,128,0.3)', icon:'🌱',
    features:['5 posts / day','3 chat messages / day','Showcase 24h','Public profile','Community access','50 ViralCredits on signup'],
    limits:{pubsPerDay:5,chatMsgs:3,showcaseHours:24}
  },
  { id:'starter', name:'STARTER', price:4.99, period:'/month', desc:'To start boosting',
    color:'#22c55e', glow:'rgba(34,197,94,0.35)', icon:'🚀',
    features:['10 posts / day','10 chat messages / day','Showcase 7 days','AI Coach 20 req/month','Unlimited DMs','🟢 Starter badge','+200 ViralCredits/month'],
    limits:{pubsPerDay:10,chatMsgs:10,showcaseHours:168}
  },
  { id:'pro', name:'PRO', price:9.99, period:'/month', desc:'For serious creators', recommended:true,
    color:'#3b82f6', glow:'rgba(59,130,246,0.4)', icon:'⚡',
    features:['Unlimited posts','Unlimited global chat','Priority showcase 30d','Unlimited AI Boost','Advanced stats','✅ Verified Pro badge','Affiliation 30%','+500 ViralCredits/month'],
    limits:{pubsPerDay:999,chatMsgs:999,showcaseHours:720}
  },
  { id:'elite', name:'ELITE', price:19.99, period:'/month', desc:'To dominate your market',
    color:'#a855f7', glow:'rgba(168,85,247,0.4)', icon:'👑',
    features:['Everything in Pro','Permanent + pinned showcase','👑 Elite badge','Priority #1 AI matching','Create discussion groups','Monthly performance report','1 strategy call/month','+1500 ViralCredits/month'],
    limits:{pubsPerDay:999,chatMsgs:999,showcaseHours:9999999}
  },
  { id:'legend', name:'LEGEND', price:49.99, period:'/month', desc:'For top creators',
    color:'#f97316', glow:'rgba(249,115,22,0.45)', icon:'🔥',
    features:['Everything in Elite','Showcase always TOP 3','🔥 Legend animated badge','Featured in weekly newsletter','Priority DM to admin','Dedicated account manager','Affiliation 40%','+3000 ViralCredits/month'],
    limits:{pubsPerDay:999,chatMsgs:999,showcaseHours:9999999}
  },
  { id:'vip', name:'VIP', price:99.99, period:'/month', desc:'The absolute maximum',
    color:'#ffd700', glow:'rgba(255,215,0,0.5)', icon:'💎',
    features:['Everything in Legend','Showcase #1 permanent','💎 VIP diamond badge','Exclusive VIP community','Custom branded profile','Weekly strategy call','Direct hotline to team','Affiliation 50%','+10000 ViralCredits/month'],
    limits:{pubsPerDay:999,chatMsgs:999,showcaseHours:9999999}
  }
];


// ── BADGE SYSTEM ──
const BADGES = [
  // ── PUBLICATIONS ──
  { id:'first_post',    emoji:'📝', name:'First Post',      desc:'Publish your 1st post',             plan:null,    condition:u=>((u._postCount||0)>=1) },
  { id:'post5',         emoji:'🔥', name:'On Fire',            desc:'5 posts total',          plan:null,    condition:u=>((u._postCount||0)>=5) },
  { id:'post20',        emoji:'💥', name:'Post Machine',     desc:'20 posts total',         plan:null,    condition:u=>((u._postCount||0)>=20) },
  { id:'post50',        emoji:'🚀', name:'Rocket Publisher',  desc:'50 posts total',         plan:null,    condition:u=>((u._postCount||0)>=50) },
  { id:'post100',       emoji:'💯', name:'Centenaire',        desc:'100 posts total',        plan:'starter',condition:u=>((u._postCount||0)>=100) },
  { id:'post500',       emoji:'🌊', name:'Content Tsunami',desc:'500 posts total',        plan:'pro',   condition:u=>((u._postCount||0)>=500), special:true },
  // ── VOTES & POPULARITY ──
  { id:'first_vote',    emoji:'⚡', name:'First Vote',      desc:'Receive your 1st vote',             plan:null,    condition:u=>((u.totalVotes||0)>=1) },
  { id:'votes10',       emoji:'🎯', name:'Popular',         desc:'10 votes received',                  plan:null,    condition:u=>((u.totalVotes||0)>=10) },
  { id:'votes50',       emoji:'🏅', name:'Influencer',       desc:'50 votes received',                  plan:null,    condition:u=>((u.totalVotes||0)>=50) },
  { id:'votes100',      emoji:'🎖️', name:'Viral',             desc:'100 votes received',                 plan:'starter',condition:u=>((u.totalVotes||0)>=100) },
  { id:'votes500',      emoji:'🏆', name:'Phenomenon',         desc:'500 votes received',                 plan:'pro',   condition:u=>((u.totalVotes||0)>=500), special:true },
  { id:'votes1000',     emoji:'💎', name:'Icon Viral',        desc:'1000 votes received',                plan:'elite', condition:u=>((u.totalVotes||0)>=1000), special:true },
  // ── PROFILE & NETWORK ──
  { id:'bio',           emoji:'✍️', name:'Complete Profile',   desc:'Add your bio',                   plan:null,    condition:u=>!!(u.bio&&u.bio.length>10) },
  { id:'profile_links',  emoji:'🔗', name:'Well Connected',    desc:'Add 2 social networks',         plan:null,    condition:u=>([u.tiktok,u.instagram,u.twitter,u.youtube,u.linkedin].filter(Boolean).length>=2) },
  { id:'profile_full',   emoji:'⭐', name:'Gold Profile',      desc:'Profile 100% complete',             plan:'starter',condition:u=>!!(u.bio&&u.name&&u.title&&u.location&&u.skills) },
  { id:'follow1',       emoji:'🤝', name:'Connected',         desc:'Follow someone',                  plan:null,    condition:u=>((u.following||[]).length>=1) },
  { id:'follow10',      emoji:'🌐', name:'Networker',        desc:'10 subscriptions',                  plan:null,    condition:u=>((u.following||[]).length>=10) },
  { id:'follow50',      emoji:'🕸️', name:'Super Networker',  desc:'50 subscriptions',                  plan:'starter',condition:u=>((u.following||[]).length>=50) },
  { id:'follow100',     emoji:'🌍', name:'Global Network',   desc:'100 subscriptions',                 plan:'pro',   condition:u=>((u.following||[]).length>=100) },
  { id:'followers10',   emoji:'📣', name:'Opinion Leader',desc:'10 followers on your profile',        plan:null,    condition:u=>((u.followers||[]).length>=10) },
  { id:'followers50',   emoji:'📢', name:'Celebrity',        desc:'50 followers on your profile',        plan:'starter',condition:u=>((u.followers||[]).length>=50) },
  { id:'followers100',  emoji:'🌟', name:'Star VB',          desc:'100 followers on your profile',       plan:'pro',   condition:u=>((u.followers||[]).length>=100) },
  // ── MESSAGES & SOCIAL ──
  { id:'dm_king',       emoji:'💬', name:'DM King',          desc:'Send 5 private messages',         plan:'starter',condition:u=>(['starter','pro','elite'].includes(u.plan)&&(u._dmCount||0)>=5) },
  { id:'dm_master',     emoji:'📨', name:'DM Master',        desc:'Send 50 private messages',        plan:'pro',   condition:u=>((u._dmCount||0)>=50) },
  { id:'chat_pioneer',  emoji:'🗨️', name:'Chat Pioneer', desc:'Send 20 messages in chat',  plan:null,    condition:u=>((u._chatCount||0)>=20) },
  { id:'chat_legend',   emoji:'🎙️', name:'Community Voice', desc:'Send 200 messages in chat', plan:'starter',condition:u=>((u._chatCount||0)>=200) },
  { id:'group_member',  emoji:'👥', name:'Active Member',     desc:'Join 1 group',                 plan:null,    condition:u=>((u._groupCount||0)>=1) },
  { id:'group_chatter', emoji:'💭', name:'Big Talker',    desc:'50 messages in groups',     plan:'starter',condition:u=>((u._groupMsgs||0)>=50) },
  // ── IA & STRATÉGIE ──
  { id:'ia_first',      emoji:'🤖', name:'IA Explorer',      desc:'Use AI Boost 1 fois',          plan:null,    condition:u=>((u._iaCount||0)>=1) },
  { id:'ia_master',     emoji:'🧠', name:'IA Master',        desc:'Use AI Boost 10 fois',         plan:'pro',   condition:u=>(['pro','elite'].includes(u.plan)&&(u._iaCount||0)>=10) },
  { id:'ia_addict',     emoji:'🔮', name:'IA Addict',        desc:'Use AI Boost 50 fois',         plan:'pro',   condition:u=>((u._iaCount||0)>=50), special:true },
  { id:'ab_test',       emoji:'🔬', name:'Experimenter',  desc:'Launch an AI A/B test',             plan:'pro',   condition:u=>((u._abTests||0)>=1) },
  // ── SHOWCASE & PROJECTS ──
  { id:'first_showcase', emoji:'✨', name:'In Showcase',       desc:'Publish your 1st project in showcase', plan:null,    condition:u=>((u._projectCount||0)>=1) },
  { id:'showcase5',      emoji:'🖼️', name:'Gallery',          desc:'5 projects in showcase',             plan:'starter',condition:u=>((u._projectCount||0)>=5) },
  { id:'showcase10',     emoji:'🎭', name:'Portfolio Pro',    desc:'10 projects in showcase',            plan:'pro',   condition:u=>((u._projectCount||0)>=10) },
  // ── CREDITS & SHOP ──
  { id:'credits50',     emoji:'⚡', name:'Charged',           desc:'Accumulate 50 ViralCredits',         plan:null,    condition:u=>(userCredits>=50) },
  { id:'credits200',    emoji:'💸', name:'Rich Creator',     desc:'Accumulate 200 ViralCredits',        plan:'starter',condition:u=>(userCredits>=200) },
  { id:'credits1000',   emoji:'💰', name:'VB Millionaire',  desc:'Accumulate 1000 ViralCredits',       plan:'pro',   condition:u=>(userCredits>=1000), special:true },
  { id:'shop_first',    emoji:'🛒', name:'First Purchase',    desc:'Buy something in the shop', plan:null,    condition:u=>((u._shopBuys||0)>=1) },
  { id:'shop_power',    emoji:'🏪', name:'Big Spender',   desc:'10 shop purchases',            plan:'starter',condition:u=>((u._shopBuys||0)>=10) },
  // ── COLLABS & MATCHING ──
  { id:'first_collab',  emoji:'🤝', name:'First Collab',   desc:'Propose a collaboration',        plan:null,    condition:u=>((u._collabCount||0)>=1) },
  { id:'collab5',       emoji:'🏗️', name:'Builder',        desc:'5 collaborations proposed',       plan:'starter',condition:u=>((u._collabCount||0)>=5) },
  { id:'collab_master', emoji:'🌐', name:'Collab Master',    desc:'10 collaborations',                plan:'pro',   condition:u=>((u._collabCount||0)>=10), special:true },
  // ── RÉACTIONS ──
  { id:'first_react',   emoji:'😍', name:'Reactive',          desc:'Send 1 enriched reaction',       plan:null,    condition:u=>((u._reactCount||0)>=1) },
  { id:'react50',       emoji:'🎉', name:'Expressive',       desc:'50 reactions sent',            plan:null,    condition:u=>((u._reactCount||0)>=50) },
  { id:'react200',      emoji:'🎊', name:'Reaction King',desc:'200 reactions sent',           plan:'starter',condition:u=>((u._reactCount||0)>=200) },
  // ── LIKES ──
  { id:'like10',        emoji:'❤️', name:'Generous Heart',   desc:'Like 10 posts',             plan:null,    condition:u=>((u._likeCount||0)>=10) },
  { id:'like100',       emoji:'💝', name:'Fan Club',         desc:'100 likes given',                 plan:null,    condition:u=>((u._likeCount||0)>=100) },
  { id:'like500',       emoji:'💗', name:'Love Machine',     desc:'500 likes given',                 plan:'starter',condition:u=>((u._likeCount||0)>=500) },
  // ── COMMENTAIRES ──
  { id:'comment5',      emoji:'💡', name:'Commentateur',     desc:'Laisse 5 comments',            plan:null,    condition:u=>((u._commentCount||0)>=5) },
  { id:'comment20',     emoji:'📢', name:'Active Voice',      desc:'20 comments left',          plan:'starter',condition:u=>((u._commentCount||0)>=20) },
  // ── SHARES ──
  { id:'share5',        emoji:'📤', name:'Shareur',        desc:'Share 5 publications',           plan:null,    condition:u=>((u._shareCount||0)>=5) },
  { id:'share20',       emoji:'📡', name:'Ambassadeur',      desc:'Share 20 publications',          plan:'starter',condition:u=>((u._shareCount||0)>=20) },
  // ── SENIORITY ──
  { id:'early',         emoji:'🌱', name:'Pioneer',         desc:'Founding member 2025-2026',       plan:null,    condition:u=>!!(u.createdAt&&new Date(u.createdAt)<new Date('2026-06-01')) },
  { id:'week1',         emoji:'📅', name:'1 Week',        desc:'Member for 7 days',            plan:null,    condition:u=>!!(u.createdAt&&(Date.now()-new Date(u.createdAt).getTime())>=7*86400000) },
  { id:'month1',        emoji:'🗓️', name:'1 Month',           desc:'Member for 30 days',           plan:null,    condition:u=>!!(u.createdAt&&(Date.now()-new Date(u.createdAt).getTime())>=30*86400000) },
  { id:'month6',        emoji:'🎂', name:'6 Months',           desc:'Member for 6 months',             plan:'starter',condition:u=>!!(u.createdAt&&(Date.now()-new Date(u.createdAt).getTime())>=180*86400000) },
  { id:'year1',         emoji:'🎆', name:'1 Year',             desc:'Member for 1 year',               plan:'pro',   condition:u=>!!(u.createdAt&&(Date.now()-new Date(u.createdAt).getTime())>=365*86400000), special:true },
  // ── MISSIONS ──
  { id:'mission5',      emoji:'🎯', name:'Mission Hunter',desc:'Complete 5 missions',           plan:null,    condition:u=>((u._missionsCompleted||0)>=5) },
  { id:'mission20',     emoji:'🏹', name:'Mission Impossible',  desc:'Complete 20 missions',          plan:'starter',condition:u=>((u._missionsCompleted||0)>=20) },
  { id:'streak3',       emoji:'🔑', name:'Regular',         desc:'Login 3 days in a row',     plan:null,    condition:u=>((u._loginStreak||0)>=3) },
  { id:'streak7',       emoji:'🔑', name:'Discipline',       desc:'Login 7 days in a row',     plan:'starter',condition:u=>((u._loginStreak||0)>=7) },
  { id:'streak30',      emoji:'🏋️', name:'Content Athlete',desc:'30 consecutive login days',plan:'pro',  condition:u=>((u._loginStreak||0)>=30), special:true },
  // ── PLANS ──
  { id:'starter_badge', emoji:'🟢', name:'Starter',          desc:'Starter plan activated',             plan:'starter',condition:u=>['starter','pro','elite'].includes(u.plan) },
  { id:'pro_badge',     emoji:'✅', name:'PRO Verified',      desc:'Pro plan activated',                  plan:'pro',   condition:u=>['pro','elite'].includes(u.plan) },
  { id:'affiliate',     emoji:'💰', name:'Affiliate',          desc:'Pro + affiliate program',      plan:'pro',   condition:u=>(['pro','elite'].includes(u.plan)) },
  { id:'elite_badge',   emoji:'🏆', name:'ELITE',            desc:'Elite plan activated',                plan:'elite', condition:u=>(u.plan==='elite') },
  { id:'group_founder', emoji:'🏛️', name:'Founder',        desc:'Create a group (Elite)',           plan:'elite', condition:u=>(u.plan==='elite'&&(u._groupCount||0)>=1) },
  { id:'legend',        emoji:'👑', name:'LEGEND',          desc:'Elite + 100 votes + 20 posts',      plan:'elite', condition:u=>(u.plan==='elite'&&(u.totalVotes||0)>=100&&(u._postCount||0)>=20), special:true },
  { id:'king',          emoji:'💎', name:'DIAMOND KING',     desc:'Elite + 200 top votes',         plan:'elite', condition:u=>(u.plan==='elite'&&(u.totalVotes||0)>=200), special:true },
  { id:'god',           emoji:'🌌', name:'VIRAL GOD',        desc:'Elite + 1000 votes + 500 posts',    plan:'elite', condition:u=>(u.plan==='elite'&&(u.totalVotes||0)>=1000&&(u._postCount||0)>=500), special:true },
  // ── CREDITS USED FOR PLANS ──
  { id:'plan_credits',  emoji:'🪙', name:'Smart Buyer',   desc:'Buy a plan with credits',  plan:null,    condition:u=>((u._planBoughtWithCredits||0)>=1), special:false },
];

function getUserBadges(u){
  return BADGES.map(b=>({...b, unlocked: b.condition(u)}));
}

function renderBadges(u){
  const badges = getUserBadges(u);
  const unlocked = badges.filter(b=>b.unlocked).length;
  return `
  <div class="badges-section">
    <h3>🏅 MY BADGES <span style="font-size:10px;color:var(--muted);font-weight:400">${unlocked}/${badges.length} unlocked</span></h3>
    <div class="badges-grid">
      ${badges.map(b=>{
        const bonus = BADGE_CREDITS[b.id]||5;
        return `<div class="badge-item ${b.unlocked?'unlocked':'locked'} ${b.special?'special':''}">
          ${!b.unlocked?'<span class="badge-lock-icon">🔒</span>':''}
          <div class="badge-emoji">${b.emoji}</div>
          <div class="badge-name">${b.name}</div>
          ${b.plan?`<div class="badge-plan-tag badge-plan-${b.plan}">${b.plan.toUpperCase()}</div>`:''}
          <div class="badge-reward">+${bonus}⚡</div>
          <div class="badge-tooltip">${b.desc} · +${bonus} credits</div>
        </div>`;
      }).join('')}
    </div>
  </div>`;
}


let worldChatMsgs=[],dmTarget=null,dmThreads={},ws=null,wsRetries=0;
let myVotes=new Set(JSON.parse(localStorage.getItem('vb_votes')||'[]'));
let posts=[],selectedSignupPlan='free';
let groupsData=[];
let currentGroupId=null;
let pendingMediaUrl=null, pendingLandingMediaUrl=null, pendingPubMediaUrl=null;
let reportTarget=null;
let currentGroupSettingsId=null;
let groupBgUrl=null, groupSettingsBgUrl=null;

// Credits awarded per badge
const BADGE_CREDITS = {
  first_post:5, post5:10, post20:20, post50:35, post100:60, post500:150,
  first_vote:5, votes10:15, votes50:30, votes100:50, votes500:100, votes1000:200,
  bio:10, profile_links:12, profile_full:25,
  follow1:5, follow10:15, follow50:30, follow100:50,
  followers10:15, followers50:35, followers100:60,
  dm_king:15, dm_master:40,
  chat_pioneer:10, chat_legend:30,
  group_member:10, group_chatter:25,
  ia_first:10, ia_master:30, ia_addict:75, ab_test:20,
  first_showcase:12, showcase5:25, showcase10:50,
  credits50:15, credits200:30, credits1000:100,
  shop_first:10, shop_power:30,
  first_collab:15, collab5:35, collab_master:80,
  first_react:5, react50:20, react200:50,
  like10:8, like100:25, like500:60,
  comment5:10, comment20:30,
  share5:10, share20:30,
  early:20, week1:10, month1:25, month6:60, year1:150,
  mission5:20, mission20:60,
  streak3:15, streak7:35, streak30:100,
  starter_badge:20, pro_badge:50, affiliate:25,
  elite_badge:100, group_founder:40, legend:150, king:200, god:500,
  plan_credits:30,
};

function checkNewBadges(){
  if(!currentUser) return;
  const saved = JSON.parse(localStorage.getItem('vb_earned_badges')||'[]');
  const savedSet = new Set(saved);
  const nowUnlocked = BADGES.filter(b => b.condition(currentUser)).map(b=>b.id);
  const newOnes = nowUnlocked.filter(id => !savedSet.has(id));
  if(newOnes.length){
    newOnes.forEach(id=>{
      const b = BADGES.find(x=>x.id===id);
      const bonus = BADGE_CREDITS[id]||5;
      if(b){
        setTimeout(()=>{
          addCredits(bonus);
          toast(`${b.emoji} Badge unlocked: ${b.name}! +${bonus}⚡`);
        }, 300);
        savedSet.add(id);
      }
    });
    localStorage.setItem('vb_earned_badges', JSON.stringify([...savedSet]));
  }
}

// ── TOAST ──
function toast(msg,type='success'){
  const c=document.getElementById('toast-container');
  const t=document.createElement('div');
  t.className='toast-g'+(type==='success'?' success':'');
  t.textContent=msg;
  c.appendChild(t);
  setTimeout(()=>{t.style.opacity='0';t.style.transform='translateX(50px)';t.style.transition='all 0.3s';setTimeout(()=>t.remove(),300);},3000);
}

// ── PLANS RENDER ──
const PLAN_ORDER = {free:0,starter:1,pro:2,elite:3,legend:4,vip:5};
const PLAN_COLORS = {
  free:   {bg:'rgba(107,114,128,0.15)', border:'rgba(107,114,128,0.3)', text:'#9ca3af', glow:''},
  starter:{bg:'rgba(34,197,94,0.12)',   border:'rgba(34,197,94,0.4)',   text:'#4ade80', glow:''},
  pro:    {bg:'rgba(59,130,246,0.12)',  border:'rgba(59,130,246,0.45)', text:'#60a5fa', glow:'0 0 14px rgba(59,130,246,0.2)'},
  elite:  {bg:'rgba(168,85,247,0.12)', border:'rgba(168,85,247,0.45)', text:'#c084fc', glow:'0 0 16px rgba(168,85,247,0.2)'},
  legend: {bg:'rgba(249,115,22,0.12)', border:'rgba(249,115,22,0.5)',  text:'#fb923c', glow:'0 0 18px rgba(249,115,22,0.25)'},
  vip:    {bg:'rgba(255,215,0,0.12)',   border:'rgba(255,215,0,0.55)',  text:'#ffd700', glow:'0 0 24px rgba(255,215,0,0.3)'}
};
const PLAN_ICONS = {free:'🌱',starter:'🚀',pro:'⚡',elite:'👑',legend:'🔥',vip:'💎'};

function _planOnclick(id, price){
  if(price===0){ openModal('signup-modal'); }
  else{ startPayment(id); }
}
function renderPlans(){
  var PLAN_BTN_STYLES = {
    free:   'background:transparent;border:1.5px solid rgba(107,114,128,0.5);color:#9ca3af;',
    starter:'background:transparent;border:1.5px solid rgba(34,197,94,0.5);color:#4ade80;',
    pro:    'background:linear-gradient(135deg,#1d4ed8,#3b82f6);border:none;color:#fff;box-shadow:0 0 20px rgba(59,130,246,0.35);',
    elite:  'background:linear-gradient(135deg,#7c3aed,#a855f7);border:none;color:#fff;box-shadow:0 0 20px rgba(168,85,247,0.35);',
    legend: 'background:linear-gradient(135deg,#c2410c,#f97316);border:none;color:#fff;box-shadow:0 0 20px rgba(249,115,22,0.35);',
    vip:    'background:linear-gradient(135deg,#b45309,#ffd700);border:none;color:#000;box-shadow:0 0 28px rgba(255,215,0,0.45);'
  };
  var g=document.getElementById('landing-plans');
  if(g) g.innerHTML=PLANS.map(function(p){
    var pc = PLAN_COLORS[p.id]||PLAN_COLORS.free;
    var planIcon = PLAN_ICONS[p.id]||'?';
    var cardStyle = p.id==='vip'
      ? 'background:linear-gradient(160deg,rgba(255,215,0,0.06),rgba(255,140,0,0.03));border:1.5px solid rgba(255,215,0,0.4);box-shadow:0 0 24px rgba(255,215,0,0.12);'
      : p.id==='legend'
      ? 'border:1.5px solid rgba(249,115,22,0.4);box-shadow:0 0 18px rgba(249,115,22,0.1);'
      : p.id==='elite'
      ? 'border:1.5px solid rgba(168,85,247,0.4);box-shadow:0 0 14px rgba(168,85,247,0.1);'
      : p.id==='pro'
      ? 'border:1.5px solid rgba(59,130,246,0.4);box-shadow:0 0 14px rgba(59,130,246,0.1);'
      : '';
    var btnLabel = p.price===0 ? 'Get started free' : 'Choose '+p.name+' &rarr;';
    var popularBadge = p.recommended ? '<div class="plan-badge" style="background:linear-gradient(135deg,#1d4ed8,#3b82f6);color:#fff">&#11088; POPULAR</div>' : '';
    var vipBadge = p.id==='vip' ? '<div class="plan-badge" style="background:linear-gradient(135deg,#b45309,#ffd700);color:#000">&#128142; ULTIMATE</div>' : '';
    var legendBadge = p.id==='legend' ? '<div class="plan-badge" style="background:linear-gradient(135deg,#c2410c,#f97316);color:#fff">&#128293; TOP SELLER</div>' : '';
    var btnStyle = (PLAN_BTN_STYLES[p.id]||PLAN_BTN_STYLES.free)+'width:100%;padding:11px;border-radius:6px;font-family:inherit;font-size:13px;font-weight:700;cursor:pointer;transition:all 0.2s;';
    return '<div class="plan-card" style="'+cardStyle+'">'
      +popularBadge+vipBadge+legendBadge
      +'<div style="font-size:28px;margin-bottom:8px;line-height:1;">'+planIcon+'</div>'
      +'<div class="plan-name" style="color:'+pc.text+'">'+p.name+'</div>'
      +'<div class="plan-price" style="color:'+pc.text+';">'+(p.price===0?'Free':'$'+p.price)+'<span style="font-size:20px;font-family:inherit;opacity:0.7">'+(p.price===0?'':' ')+'</span></div>'
      +'<div class="plan-period">'+(p.price===0?'Free forever':p.period)+'</div>'
      +'<div class="plan-desc">'+p.desc+'</div>'
      +'<ul class="plan-features">'+p.features.map(function(f){return '<li>'+f+'</li>';}).join('')+'</ul>'
      +'<button class="btn-plan-g" style="'+btnStyle+'" onclick="_planOnclick(this.dataset.pid,'+p.price+')" data-pid="'+p.id+'">'+btnLabel+'</button>'
      +'</div>';
  }).join('');

  var sg=document.getElementById('signup-plans-grid');
  if(sg) sg.innerHTML=PLANS.map(function(p){
    return '<div class="sp-card '+(p.id==='free'?'selected':'')+'" onclick="selectSignupPlan(this,\''+p.id+'\')">'+
    '<div class="sp-plan">'+(PLAN_ICONS[p.id]||'')+' '+p.name+'</div>'+
    '<div class="sp-price">'+(p.price===0?'$0':'$'+p.price)+'</div>'+
    '<div class="sp-per">'+(p.price===0?'Free':p.period)+'</div>'+
    '<div class="sp-feat">'+p.features.slice(0,2).join('<br>')+'</div>'+
    '</div>';
  }).join('');
}


function selectSignupPlan(el,planId){
  document.querySelectorAll('#signup-plans-grid .sp-card').forEach(c=>c.classList.remove('selected'));
  el.classList.add('selected');
  selectedSignupPlan=planId;
}

// ── SHOWCASE DATA & RENDER ──
let showcaseData=[];

function openProjectModal(id){
  const p=showcaseData.find(p=>p.id===id);
  if(!p)return;
  const overlay=document.getElementById('project-modal-overlay');
  const box=document.getElementById('project-modal-content');
  if(!overlay||!box)return;
  const avatarColor=getAvatarColor(p.authorId||p.author);
  box.innerHTML=`
    <div class="pmo-banner" style="background:${p.color||'var(--s2)'}">
      ${p.mediaUrl?`<img src="${p.mediaUrl}"/>`:''}
      <span style="position:relative;z-index:1">${p.emoji||'🚀'}</span>
      <button class="pmo-close" onclick="closeProjectModal()">✕</button>
    </div>
    <div class="pmo-body">
      <div class="pmo-cat">${p.type||p.cat||''}</div>
      <div class="pmo-name">${p.name}</div>
      ${p.hook?`<div class="pmo-hook">${p.hook}</div>`:''}
      <div class="pmo-desc">${p.desc||''}</div>
      ${p.tags&&p.tags.length?`<div class="pmo-tags">${p.tags.map(t=>`<span class="pmo-tag">#${t}</span>`).join('')}</div>`:''}
      ${p.url?`<a class="pmo-url" href="${p.url}" target="_blank" rel="noopener noreferrer">
        <span>🔗</span><span>${p.url.replace(/^https?:\/\//,'').replace(/\/$/,'')}</span><span style="color:var(--g3)">↗</span>
      </a>`:''}
      <div class="pmo-footer">
        <div class="pmo-author">
          <div class="pmo-ava" style="background:${avatarColor}">${(p.author||'?')[0]}</div>
          <span>${p.author||'Anonymous'}</span>
          <span class="chat-msg-plan-badge plan-${p.plan||'free'}">${(p.plan||'FREE').toUpperCase()}</span>
        </div>
        <div class="pmo-actions">
          <button class="pmo-btn ${myVotes.has(p.id)?'voted':''}" onclick="voteProject(event,'${p.id}',this);this.querySelector('span').textContent=document.querySelector('[data-pid=\'${p.id}\'] .vote-count')?.textContent||'0'">
            ▲ <span>${p.votes||0}</span>
          </button>
          <button class="pmo-btn pmo-btn-dm" onclick="closeProjectModal();openDMToUser('${p.authorId}','${p.author}')">💬 DM</button>
        </div>
      </div>
    </div>`;
  overlay.classList.remove('hidden');
  document.body.style.overflow='hidden';
}
function closeProjectModal(){
  document.getElementById('project-modal-overlay')?.classList.add('hidden');
  document.body.style.overflow='';
}


// ── FAKE BIG CAMPAIGNS (mega ads injected into showcase) ──
var FAKE_BIG_CAMPAIGNS = [
  {
    id:'fbc_001', _isBigCampaign:true,
    title:'NOVA AI — The Content Tool That Writes Itself',
    headline:'Stop creating. Start dominating.',
    desc:'Nova AI generates viral captions, scripts and ad copy in seconds. Used by 50,000+ creators worldwide. 10x your output, 0x the stress. Try it free for 7 days — no card required.',
    cta:'Try Nova AI Free →', url:'https://novaai.app',
    author:'Ryan Nova', username:'@ryan_nova',
    avatarBg:'linear-gradient(135deg,#7c3aed,#a855f7)',
    photos:[
      'data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI3MDAiIGhlaWdodD0iMzk0IiB2aWV3Qm94PSIwIDAgNzAwIDM5NCI+CiAgPHJlY3Qgd2lkdGg9IjcwMCIgaGVpZ2h0PSIzOTQiIGZpbGw9IiMwZDExMTciLz4KICA8cmVjdCB4PSIwIiB5PSIwIiB3aWR0aD0iNzAwIiBoZWlnaHQ9IjMyIiBmaWxsPSIjMTYxYjIyIi8+CiAgPGNpcmNsZSBjeD0iMjAiIGN5PSIxNiIgcj0iNiIgZmlsbD0iI2ZmNWY1NyIvPgogIDxjaXJjbGUgY3g9IjQwIiBjeT0iMTYiIHI9IjYiIGZpbGw9IiNmZWJjMmUiLz4KICA8Y2lyY2xlIGN4PSI2MCIgY3k9IjE2IiByPSI2IiBmaWxsPSIjMjhjODQwIi8+CiAgPHRleHQgeD0iMzAiIHk9IjcwIiBmb250LXNpemU9IjE0IiBmaWxsPSIjNThhNmZmIiBmb250LWZhbWlseT0ibW9ub3NwYWNlIj5jb25zdCBub3ZhQUkgPSBuZXcgQUkoezwvdGV4dD4KICA8dGV4dCB4PSIzMCIgeT0iOTUiIGZvbnQtc2l6ZT0iMTQiIGZpbGw9IiNlNmVkZjMiIGZvbnQtZmFtaWx5PSJtb25vc3BhY2UiPiAgbW9kZWw6IDx0c3BhbiBmaWxsPSIjYTVkNmZmIj4ibm92YS11bHRyYS12MiI8L3RzcGFuPiw8L3RleHQ+CiAgPHRleHQgeD0iMzAiIHk9IjEyMCIgZm9udC1zaXplPSIxNCIgZmlsbD0iI2U2ZWRmMyIgZm9udC1mYW1pbHk9Im1vbm9zcGFjZSI+ICBzcGVlZDogPHRzcGFuIGZpbGw9IiM3OWMwZmYiPjMwMDA8L3RzcGFuPiwgPHRzcGFuIGZpbGw9IiM4Yjk0OWUiPi8vIG1zPC90c3Bhbj48L3RleHQ+CiAgPHRleHQgeD0iMzAiIHk9IjE0NSIgZm9udC1zaXplPSIxNCIgZmlsbD0iI2U2ZWRmMyIgZm9udC1mYW1pbHk9Im1vbm9zcGFjZSI+ICBsYW5ndWFnZXM6IDx0c3BhbiBmaWxsPSIjYTVkNmZmIj5bIkVOIiwiRlIiLCJFUyJdPC90c3Bhbj48L3RleHQ+CiAgPHRleHQgeD0iMzAiIHk9IjE3MCIgZm9udC1zaXplPSIxNCIgZmlsbD0iI2U2ZWRmMyIgZm9udC1mYW1pbHk9Im1vbm9zcGFjZSI+fSk7PC90ZXh0PgogIDx0ZXh0IHg9IjMwIiB5PSIyMTAiIGZvbnQtc2l6ZT0iMTQiIGZpbGw9IiM1OGE2ZmYiIGZvbnQtZmFtaWx5PSJtb25vc3BhY2UiPm5vdmFBSS48dHNwYW4gZmlsbD0iI2QyYThmZiI+Z2VuZXJhdGU8L3RzcGFuPig8dHNwYW4gZmlsbD0iI2E1ZDZmZiI+InZpcmFsIGNhcHRpb24iPC90c3Bhbj4pPC90ZXh0PgogIDx0ZXh0IHg9IjMwIiB5PSIyMzUiIGZvbnQtc2l6ZT0iMTQiIGZpbGw9IiNlNmVkZjMiIGZvbnQtZmFtaWx5PSJtb25vc3BhY2UiPiAgLnRoZW4ocmVzdWx0ID0mZ3Q7IHs8L3RleHQ+CiAgPHRleHQgeD0iMzAiIHk9IjI2MCIgZm9udC1zaXplPSIxNCIgZmlsbD0iI2U2ZWRmMyIgZm9udC1mYW1pbHk9Im1vbm9zcGFjZSI+ICAgIGNvbnNvbGUuPHRzcGFuIGZpbGw9IiNkMmE4ZmYiPmxvZzwvdHNwYW4+KHJlc3VsdC50ZXh0KTs8L3RleHQ+CiAgPHRleHQgeD0iMzAiIHk9IjI4NSIgZm9udC1zaXplPSIxNCIgZmlsbD0iI2U2ZWRmMyIgZm9udC1mYW1pbHk9Im1vbm9zcGFjZSI+ICB9KTs8L3RleHQ+CiAgPHJlY3QgeD0iMCIgeT0iMzMwIiB3aWR0aD0iNzAwIiBoZWlnaHQ9IjIiIGZpbGw9IiMyMTI2MmQiLz4KICA8cmVjdCB4PSIzMCIgeT0iMzUwIiB3aWR0aD0iMTgwIiBoZWlnaHQ9IjI0IiByeD0iNCIgZmlsbD0iIzIzODYzNiIvPgogIDx0ZXh0IHg9IjEyMCIgeT0iMzY3IiBmb250LXNpemU9IjEyIiB0ZXh0LWFuY2hvcj0ibWlkZGxlIiBmaWxsPSIjZmZmIiBmb250LWZhbWlseT0ibW9ub3NwYWNlIj7ilrYgUnVuIOKAlCAwLjNzPC90ZXh0PgogIDx0ZXh0IHg9IjMwIiB5PSIzOTAiIGZvbnQtc2l6ZT0iMTEiIGZpbGw9IiMzZmI5NTAiIGZvbnQtZmFtaWx5PSJtb25vc3BhY2UiPuKckyBHZW5lcmF0ZWQgODQ3IGNoYXJhY3RlcnMgaW4gMzEybXM8L3RleHQ+Cjwvc3ZnPg==',
      'data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI3MDAiIGhlaWdodD0iMzk0IiB2aWV3Qm94PSIwIDAgNzAwIDM5NCI+CiAgPHJlY3Qgd2lkdGg9IjcwMCIgaGVpZ2h0PSIzOTQiIGZpbGw9IiMwZjA1MjAiLz4KICA8dGV4dCB4PSIzMCIgeT0iNDAiIGZvbnQtc2l6ZT0iMTYiIGZpbGw9IiNjMDg0ZmMiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXdlaWdodD0iYm9sZCI+8J+TiiBOb3ZhIEFJIEFuYWx5dGljczwvdGV4dD4KICA8IS0tIEJhciBjaGFydCAtLT4KICA8cmVjdCB4PSI2MCIgeT0iMjgwIiB3aWR0aD0iNDAiIGhlaWdodD0iNjAiIHJ4PSI0IiBmaWxsPSIjN2MzYWVkIiBvcGFjaXR5PSIwLjgiLz4KICA8cmVjdCB4PSIxMjAiIHk9IjIyMCIgd2lkdGg9IjQwIiBoZWlnaHQ9IjEyMCIgcng9IjQiIGZpbGw9IiM5MzMzZWEiIG9wYWNpdHk9IjAuOCIvPgogIDxyZWN0IHg9IjE4MCIgeT0iMTgwIiB3aWR0aD0iNDAiIGhlaWdodD0iMTYwIiByeD0iNCIgZmlsbD0iI2E4NTVmNyIgb3BhY2l0eT0iMC44Ii8+CiAgPHJlY3QgeD0iMjQwIiB5PSIxNDAiIHdpZHRoPSI0MCIgaGVpZ2h0PSIyMDAiIHJ4PSI0IiBmaWxsPSIjYzA4NGZjIiBvcGFjaXR5PSIwLjgiLz4KICA8cmVjdCB4PSIzMDAiIHk9IjEwMCIgd2lkdGg9IjQwIiBoZWlnaHQ9IjI0MCIgcng9IjQiIGZpbGw9IiNkOGI0ZmUiIG9wYWNpdHk9IjAuOCIvPgogIDxyZWN0IHg9IjM2MCIgeT0iODAiIHdpZHRoPSI0MCIgaGVpZ2h0PSIyNjAiIHJ4PSI0IiBmaWxsPSIjZTlkNWZmIiBvcGFjaXR5PSIwLjgiLz4KICA8cmVjdCB4PSI0MjAiIHk9IjYwIiB3aWR0aD0iNDAiIGhlaWdodD0iMjgwIiByeD0iNCIgZmlsbD0iI2YzZThmZiIgb3BhY2l0eT0iMC45Ii8+CiAgPCEtLSBMYWJlbHMgLS0+CiAgPHRleHQgeD0iNjIiIHk9IjM1NSIgZm9udC1zaXplPSIxMCIgZmlsbD0iIzhiOTQ5ZSIgZm9udC1mYW1pbHk9Im1vbm9zcGFjZSI+TU9OPC90ZXh0PgogIDx0ZXh0IHg9IjEyMiIgeT0iMzU1IiBmb250LXNpemU9IjEwIiBmaWxsPSIjOGI5NDllIiBmb250LWZhbWlseT0ibW9ub3NwYWNlIj5UVUU8L3RleHQ+CiAgPHRleHQgeD0iMTgyIiB5PSIzNTUiIGZvbnQtc2l6ZT0iMTAiIGZpbGw9IiM4Yjk0OWUiIGZvbnQtZmFtaWx5PSJtb25vc3BhY2UiPldFRDwvdGV4dD4KICA8dGV4dCB4PSIyNDIiIHk9IjM1NSIgZm9udC1zaXplPSIxMCIgZmlsbD0iIzhiOTQ5ZSIgZm9udC1mYW1pbHk9Im1vbm9zcGFjZSI+VEhVPC90ZXh0PgogIDx0ZXh0IHg9IjMwMiIgeT0iMzU1IiBmb250LXNpemU9IjEwIiBmaWxsPSIjOGI5NDllIiBmb250LWZhbWlseT0ibW9ub3NwYWNlIj5GUkk8L3RleHQ+CiAgPHRleHQgeD0iMzYyIiB5PSIzNTUiIGZvbnQtc2l6ZT0iMTAiIGZpbGw9IiM4Yjk0OWUiIGZvbnQtZmFtaWx5PSJtb25vc3BhY2UiPlNBVDwvdGV4dD4KICA8dGV4dCB4PSI0MjIiIHk9IjM1NSIgZm9udC1zaXplPSIxMCIgZmlsbD0iIzhiOTQ5ZSIgZm9udC1mYW1pbHk9Im1vbm9zcGFjZSI+U1VOPC90ZXh0PgogIDwhLS0gU3RhdHMgYm94ZXMgLS0+CiAgPHJlY3QgeD0iNTEwIiB5PSI2MCIgd2lkdGg9IjE2MCIgaGVpZ2h0PSI3MCIgcng9IjgiIGZpbGw9IiMxYTA4NDAiIHN0cm9rZT0iIzdjM2FlZCIgc3Ryb2tlLXdpZHRoPSIxIi8+CiAgPHRleHQgeD0iNTkwIiB5PSI4OCIgZm9udC1zaXplPSIxMSIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZmlsbD0iI2MwODRmYyIgZm9udC1mYW1pbHk9Im1vbm9zcGFjZSI+Q0FQVElPTlM8L3RleHQ+CiAgPHRleHQgeD0iNTkwIiB5PSIxMTUiIGZvbnQtc2l6ZT0iMjYiIHRleHQtYW5jaG9yPSJtaWRkbGUiIGZpbGw9IiNlOWQ1ZmYiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXdlaWdodD0iYm9sZCI+NTBLKzwvdGV4dD4KICA8cmVjdCB4PSI1MTAiIHk9IjE1MCIgd2lkdGg9IjE2MCIgaGVpZ2h0PSI3MCIgcng9IjgiIGZpbGw9IiMxYTA4NDAiIHN0cm9rZT0iIzdjM2FlZCIgc3Ryb2tlLXdpZHRoPSIxIi8+CiAgPHRleHQgeD0iNTkwIiB5PSIxNzgiIGZvbnQtc2l6ZT0iMTEiIHRleHQtYW5jaG9yPSJtaWRkbGUiIGZpbGw9IiNjMDg0ZmMiIGZvbnQtZmFtaWx5PSJtb25vc3BhY2UiPkFWRyBUSU1FPC90ZXh0PgogIDx0ZXh0IHg9IjU5MCIgeT0iMjA1IiBmb250LXNpemU9IjI2IiB0ZXh0LWFuY2hvcj0ibWlkZGxlIiBmaWxsPSIjZTlkNWZmIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC13ZWlnaHQ9ImJvbGQiPjAuM3M8L3RleHQ+CiAgPHJlY3QgeD0iNTEwIiB5PSIyNDAiIHdpZHRoPSIxNjAiIGhlaWdodD0iNzAiIHJ4PSI4IiBmaWxsPSIjMWEwODQwIiBzdHJva2U9IiNhODU1ZjciIHN0cm9rZS13aWR0aD0iMSIvPgogIDx0ZXh0IHg9IjU5MCIgeT0iMjY4IiBmb250LXNpemU9IjExIiB0ZXh0LWFuY2hvcj0ibWlkZGxlIiBmaWxsPSIjYzA4NGZjIiBmb250LWZhbWlseT0ibW9ub3NwYWNlIj5MQU5HVUFHRVM8L3RleHQ+CiAgPHRleHQgeD0iNTkwIiB5PSIyOTUiIGZvbnQtc2l6ZT0iMjYiIHRleHQtYW5jaG9yPSJtaWRkbGUiIGZpbGw9IiNlOWQ1ZmYiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXdlaWdodD0iYm9sZCI+MTI8L3RleHQ+Cjwvc3ZnPg==',
      'data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI3MDAiIGhlaWdodD0iMzk0IiB2aWV3Qm94PSIwIDAgNzAwIDM5NCI+CiAgPHJlY3Qgd2lkdGg9IjcwMCIgaGVpZ2h0PSIzOTQiIGZpbGw9IiMwZDA1MjAiLz4KICA8dGV4dCB4PSIzNTAiIHk9IjQ1IiBmb250LXNpemU9IjE4IiB0ZXh0LWFuY2hvcj0ibWlkZGxlIiBmaWxsPSIjYzA4NGZjIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC13ZWlnaHQ9ImJvbGQiPvCfjI0gNTAsMDAwKyBDcmVhdG9ycyBXb3JsZHdpZGU8L3RleHQ+CiAgPCEtLSBVc2VyIGNhcmRzIC0tPgogIDxyZWN0IHg9IjMwIiB5PSI3MCIgd2lkdGg9IjE5MCIgaGVpZ2h0PSIxMDAiIHJ4PSIxMCIgZmlsbD0iIzFhMDg0MCIgc3Ryb2tlPSIjN2MzYWVkIiBzdHJva2Utd2lkdGg9IjEiLz4KICA8Y2lyY2xlIGN4PSI3MCIgY3k9IjExMCIgcj0iMjAiIGZpbGw9IiM3YzNhZWQiLz4KICA8dGV4dCB4PSI3MCIgeT0iMTE2IiBmb250LXNpemU9IjE2IiB0ZXh0LWFuY2hvcj0ibWlkZGxlIiBmaWxsPSIjZmZmIj5BPC90ZXh0PgogIDx0ZXh0IHg9IjEwMCIgeT0iMTAzIiBmb250LXNpemU9IjEyIiBmaWxsPSIjZTlkNWZmIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC13ZWlnaHQ9ImJvbGQiPkFsZXggUi48L3RleHQ+CiAgPHRleHQgeD0iMTAwIiB5PSIxMTgiIGZvbnQtc2l6ZT0iMTAiIGZpbGw9IiM4Yjk0OWUiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIj5AYWxleF9jcmVhdG9yPC90ZXh0PgogIDx0ZXh0IHg9IjUwIiB5PSIxNDgiIGZvbnQtc2l6ZT0iMTAiIGZpbGw9IiNjMDg0ZmMiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIj4iMTB4IGZhc3RlciBjb250ZW50IOKaoSI8L3RleHQ+CiAgPHJlY3QgeD0iMjU1IiB5PSI3MCIgd2lkdGg9IjE5MCIgaGVpZ2h0PSIxMDAiIHJ4PSIxMCIgZmlsbD0iIzFhMDg0MCIgc3Ryb2tlPSIjYTg1NWY3IiBzdHJva2Utd2lkdGg9IjEiLz4KICA8Y2lyY2xlIGN4PSIyOTUiIGN5PSIxMTAiIHI9IjIwIiBmaWxsPSIjOTMzM2VhIi8+CiAgPHRleHQgeD0iMjk1IiB5PSIxMTYiIGZvbnQtc2l6ZT0iMTYiIHRleHQtYW5jaG9yPSJtaWRkbGUiIGZpbGw9IiNmZmYiPlM8L3RleHQ+CiAgPHRleHQgeD0iMzI1IiB5PSIxMDMiIGZvbnQtc2l6ZT0iMTIiIGZpbGw9IiNlOWQ1ZmYiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXdlaWdodD0iYm9sZCI+U2FyYSBNLjwvdGV4dD4KICA8dGV4dCB4PSIzMjUiIHk9IjExOCIgZm9udC1zaXplPSIxMCIgZmlsbD0iIzhiOTQ5ZSIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiPkBzYXJhX3NhYXM8L3RleHQ+CiAgPHRleHQgeD0iMjc1IiB5PSIxNDgiIGZvbnQtc2l6ZT0iMTAiIGZpbGw9IiNjMDg0ZmMiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIj4iQmVzdCBBSSB0b29sIEkndmUgdXNlZCDwn5SlIjwvdGV4dD4KICA8cmVjdCB4PSI0ODAiIHk9IjcwIiB3aWR0aD0iMTkwIiBoZWlnaHQ9IjEwMCIgcng9IjEwIiBmaWxsPSIjMWEwODQwIiBzdHJva2U9IiM3YzNhZWQiIHN0cm9rZS13aWR0aD0iMSIvPgogIDxjaXJjbGUgY3g9IjUyMCIgY3k9IjExMCIgcj0iMjAiIGZpbGw9IiM2ZDI4ZDkiLz4KICA8dGV4dCB4PSI1MjAiIHk9IjExNiIgZm9udC1zaXplPSIxNiIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZmlsbD0iI2ZmZiI+SjwvdGV4dD4KICA8dGV4dCB4PSI1NTAiIHk9IjEwMyIgZm9udC1zaXplPSIxMiIgZmlsbD0iI2U5ZDVmZiIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtd2VpZ2h0PSJib2xkIj5KYWtlIFcuPC90ZXh0PgogIDx0ZXh0IHg9IjU1MCIgeT0iMTE4IiBmb250LXNpemU9IjEwIiBmaWxsPSIjOGI5NDllIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiI+QGpha2VidWlsZHM8L3RleHQ+CiAgPHRleHQgeD0iNTAwIiB5PSIxNDgiIGZvbnQtc2l6ZT0iMTAiIGZpbGw9IiNjMDg0ZmMiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIj4iJDNLL21vIGZyb20gY2FwdGlvbnMg8J+SsCI8L3RleHQ+CiAgPCEtLSBTdGFycyByb3cgLS0+CiAgPHRleHQgeD0iMzUwIiB5PSIyMjAiIGZvbnQtc2l6ZT0iMjgiIHRleHQtYW5jaG9yPSJtaWRkbGUiIGZpbGw9IiNmYmJmMjQiPuKYheKYheKYheKYheKYhTwvdGV4dD4KICA8dGV4dCB4PSIzNTAiIHk9IjI1MCIgZm9udC1zaXplPSIxNCIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZmlsbD0iIzhiOTQ5ZSIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiPjQuOS81IOKAlCAxMiw0MDAgcmV2aWV3czwvdGV4dD4KICA8IS0tIEJvdHRvbSBsb2dvcyByb3cgLS0+CiAgPHJlY3QgeD0iODAiIHk9IjI5MCIgd2lkdGg9IjEwMCIgaGVpZ2h0PSI0MCIgcng9IjYiIGZpbGw9IiMxYTA4NDAiIHN0cm9rZT0iIzRjMWQ5NSIgc3Ryb2tlLXdpZHRoPSIxIi8+CiAgPHRleHQgeD0iMTMwIiB5PSIzMTUiIGZvbnQtc2l6ZT0iMTIiIHRleHQtYW5jaG9yPSJtaWRkbGUiIGZpbGw9IiNjMDg0ZmMiIGZvbnQtZmFtaWx5PSJtb25vc3BhY2UiPlRpa1RvazwvdGV4dD4KICA8cmVjdCB4PSIyMTAiIHk9IjI5MCIgd2lkdGg9IjEwMCIgaGVpZ2h0PSI0MCIgcng9IjYiIGZpbGw9IiMxYTA4NDAiIHN0cm9rZT0iIzRjMWQ5NSIgc3Ryb2tlLXdpZHRoPSIxIi8+CiAgPHRleHQgeD0iMjYwIiB5PSIzMTUiIGZvbnQtc2l6ZT0iMTIiIHRleHQtYW5jaG9yPSJtaWRkbGUiIGZpbGw9IiNjMDg0ZmMiIGZvbnQtZmFtaWx5PSJtb25vc3BhY2UiPkluc3RhZ3JhbTwvdGV4dD4KICA8cmVjdCB4PSIzNDAiIHk9IjI5MCIgd2lkdGg9IjEwMCIgaGVpZ2h0PSI0MCIgcng9IjYiIGZpbGw9IiMxYTA4NDAiIHN0cm9rZT0iIzRjMWQ5NSIgc3Ryb2tlLXdpZHRoPSIxIi8+CiAgPHRleHQgeD0iMzkwIiB5PSIzMTUiIGZvbnQtc2l6ZT0iMTIiIHRleHQtYW5jaG9yPSJtaWRkbGUiIGZpbGw9IiNjMDg0ZmMiIGZvbnQtZmFtaWx5PSJtb25vc3BhY2UiPkxpbmtlZEluPC90ZXh0PgogIDxyZWN0IHg9IjQ3MCIgeT0iMjkwIiB3aWR0aD0iMTAwIiBoZWlnaHQ9IjQwIiByeD0iNiIgZmlsbD0iIzFhMDg0MCIgc3Ryb2tlPSIjNGMxZDk1IiBzdHJva2Utd2lkdGg9IjEiLz4KICA8dGV4dCB4PSI1MjAiIHk9IjMxNSIgZm9udC1zaXplPSIxMiIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZmlsbD0iI2MwODRmYyIgZm9udC1mYW1pbHk9Im1vbm9zcGFjZSI+WW91VHViZTwvdGV4dD4KICA8cmVjdCB4PSI2MDAiIHk9IjI5MCIgd2lkdGg9IjgwIiBoZWlnaHQ9IjQwIiByeD0iNiIgZmlsbD0iIzFhMDg0MCIgc3Ryb2tlPSIjNGMxZDk1IiBzdHJva2Utd2lkdGg9IjEiLz4KICA8dGV4dCB4PSI2NDAiIHk9IjMxNSIgZm9udC1zaXplPSIxMiIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZmlsbD0iI2MwODRmYyIgZm9udC1mYW1pbHk9Im1vbm9zcGFjZSI+WDwvdGV4dD4KPC9zdmc+',
    ],
    thumbnail:'data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNDAwIiBoZWlnaHQ9IjQwMCIgdmlld0JveD0iMCAwIDE0MDAgNDAwIj4KICA8ZGVmcz4KICAgIDxsaW5lYXJHcmFkaWVudCBpZD0iYmciIHgxPSIwJSIgeTE9IjAlIiB4Mj0iMTAwJSIgeTI9IjEwMCUiPgogICAgICA8c3RvcCBvZmZzZXQ9IjAlIiBzdHlsZT0ic3RvcC1jb2xvcjojMGQwNTIwIi8+CiAgICAgIDxzdG9wIG9mZnNldD0iNTAlIiBzdHlsZT0ic3RvcC1jb2xvcjojMWEwODQwIi8+CiAgICAgIDxzdG9wIG9mZnNldD0iMTAwJSIgc3R5bGU9InN0b3AtY29sb3I6IzJkMTA2MCIvPgogICAgPC9saW5lYXJHcmFkaWVudD4KICAgIDxsaW5lYXJHcmFkaWVudCBpZD0iZ2xvdzEiIHgxPSIwJSIgeTE9IjAlIiB4Mj0iMTAwJSIgeTI9IjEwMCUiPgogICAgICA8c3RvcCBvZmZzZXQ9IjAlIiBzdHlsZT0ic3RvcC1jb2xvcjojN2MzYWVkO3N0b3Atb3BhY2l0eTowLjQiLz4KICAgICAgPHN0b3Agb2Zmc2V0PSIxMDAlIiBzdHlsZT0ic3RvcC1jb2xvcjojYTg1NWY3O3N0b3Atb3BhY2l0eTowIi8+CiAgICA8L2xpbmVhckdyYWRpZW50PgogIDwvZGVmcz4KICA8cmVjdCB3aWR0aD0iMTQwMCIgaGVpZ2h0PSI0MDAiIGZpbGw9InVybCgjYmcpIi8+CiAgPGNpcmNsZSBjeD0iMjAwIiBjeT0iMjAwIiByPSIzMDAiIGZpbGw9InVybCgjZ2xvdzEpIi8+CiAgPGNpcmNsZSBjeD0iMTIwMCIgY3k9IjEwMCIgcj0iMjAwIiBmaWxsPSIjN2MzYWVkIiBvcGFjaXR5PSIwLjE1Ii8+CiAgPCEtLSBHcmlkIGxpbmVzIC0tPgogIDxsaW5lIHgxPSIwIiB5MT0iODAiIHgyPSIxNDAwIiB5Mj0iODAiIHN0cm9rZT0iIzdjM2FlZCIgc3Ryb2tlLXdpZHRoPSIwLjUiIG9wYWNpdHk9IjAuMyIvPgogIDxsaW5lIHgxPSIwIiB5MT0iMTYwIiB4Mj0iMTQwMCIgeTI9IjE2MCIgc3Ryb2tlPSIjN2MzYWVkIiBzdHJva2Utd2lkdGg9IjAuNSIgb3BhY2l0eT0iMC4zIi8+CiAgPGxpbmUgeDE9IjAiIHkxPSIyNDAiIHgyPSIxNDAwIiB5Mj0iMjQwIiBzdHJva2U9IiM3YzNhZWQiIHN0cm9rZS13aWR0aD0iMC41IiBvcGFjaXR5PSIwLjMiLz4KICA8bGluZSB4MT0iMCIgeTE9IjMyMCIgeDI9IjE0MDAiIHkyPSIzMjAiIHN0cm9rZT0iIzdjM2FlZCIgc3Ryb2tlLXdpZHRoPSIwLjUiIG9wYWNpdHk9IjAuMyIvPgogIDxsaW5lIHgxPSIyMDAiIHkxPSIwIiB4Mj0iMjAwIiB5Mj0iNDAwIiBzdHJva2U9IiM3YzNhZWQiIHN0cm9rZS13aWR0aD0iMC41IiBvcGFjaXR5PSIwLjMiLz4KICA8bGluZSB4MT0iNDAwIiB5MT0iMCIgeDI9IjQwMCIgeTI9IjQwMCIgc3Ryb2tlPSIjN2MzYWVkIiBzdHJva2Utd2lkdGg9IjAuNSIgb3BhY2l0eT0iMC4zIi8+CiAgPGxpbmUgeDE9IjYwMCIgeTE9IjAiIHgyPSI2MDAiIHkyPSI0MDAiIHN0cm9rZT0iIzdjM2FlZCIgc3Ryb2tlLXdpZHRoPSIwLjUiIG9wYWNpdHk9IjAuMyIvPgogIDxsaW5lIHgxPSI4MDAiIHkxPSIwIiB4Mj0iODAwIiB5Mj0iNDAwIiBzdHJva2U9IiM3YzNhZWQiIHN0cm9rZS13aWR0aD0iMC41IiBvcGFjaXR5PSIwLjMiLz4KICA8bGluZSB4MT0iMTAwMCIgeTE9IjAiIHgyPSIxMDAwIiB5Mj0iNDAwIiBzdHJva2U9IiM3YzNhZWQiIHN0cm9rZS13aWR0aD0iMC41IiBvcGFjaXR5PSIwLjMiLz4KICA8bGluZSB4MT0iMTIwMCIgeTE9IjAiIHgyPSIxMjAwIiB5Mj0iNDAwIiBzdHJva2U9IiM3YzNhZWQiIHN0cm9rZS13aWR0aD0iMC41IiBvcGFjaXR5PSIwLjMiLz4KICA8IS0tIENlbnRyYWwgYnJhaW4vQUkgaWNvbiAtLT4KICA8Y2lyY2xlIGN4PSI3MDAiIGN5PSIyMDAiIHI9IjgwIiBmaWxsPSIjN2MzYWVkIiBvcGFjaXR5PSIwLjIiIHN0cm9rZT0iI2E4NTVmNyIgc3Ryb2tlLXdpZHRoPSIyIi8+CiAgPGNpcmNsZSBjeD0iNzAwIiBjeT0iMjAwIiByPSI1MCIgZmlsbD0iIzdjM2FlZCIgb3BhY2l0eT0iMC4zIi8+CiAgPCEtLSBGbG9hdGluZyBub2RlcyAtLT4KICA8Y2lyY2xlIGN4PSI0MDAiIGN5PSIxNTAiIHI9IjgiIGZpbGw9IiNhODU1ZjciIG9wYWNpdHk9IjAuOCIvPgogIDxjaXJjbGUgY3g9IjU1MCIgY3k9IjI4MCIgcj0iNSIgZmlsbD0iI2MwODRmYyIgb3BhY2l0eT0iMC42Ii8+CiAgPGNpcmNsZSBjeD0iODUwIiBjeT0iMTMwIiByPSI3IiBmaWxsPSIjYTg1NWY3IiBvcGFjaXR5PSIwLjciLz4KICA8Y2lyY2xlIGN4PSIxMDAwIiBjeT0iMjcwIiByPSI2IiBmaWxsPSIjYzA4NGZjIiBvcGFjaXR5PSIwLjUiLz4KICA8Y2lyY2xlIGN4PSIzMDAiIGN5PSIzMDAiIHI9IjQiIGZpbGw9IiNhODU1ZjciIG9wYWNpdHk9IjAuNSIvPgogIDwhLS0gQ29ubmVjdGlvbiBsaW5lcyAtLT4KICA8bGluZSB4MT0iNDAwIiB5MT0iMTUwIiB4Mj0iNjUwIiB5Mj0iMjAwIiBzdHJva2U9IiNhODU1ZjciIHN0cm9rZS13aWR0aD0iMSIgb3BhY2l0eT0iMC40Ii8+CiAgPGxpbmUgeDE9Ijg1MCIgeTE9IjEzMCIgeDI9Ijc1MCIgeTI9IjE4MCIgc3Ryb2tlPSIjYTg1NWY3IiBzdHJva2Utd2lkdGg9IjEiIG9wYWNpdHk9IjAuNCIvPgogIDxsaW5lIHgxPSI1NTAiIHkxPSIyODAiIHgyPSI2NTAiIHkyPSIyMzAiIHN0cm9rZT0iI2MwODRmYyIgc3Ryb2tlLXdpZHRoPSIxIiBvcGFjaXR5PSIwLjMiLz4KICA8bGluZSB4MT0iMTAwMCIgeTE9IjI3MCIgeDI9Ijc4MCIgeTI9IjIyMCIgc3Ryb2tlPSIjYzA4NGZjIiBzdHJva2Utd2lkdGg9IjEiIG9wYWNpdHk9IjAuMyIvPgogIDwhLS0gVGV4dCBvdmVybGF5IC0tPgogIDx0ZXh0IHg9IjcwMCIgeT0iMzUwIiBmb250LXNpemU9IjIyIiB0ZXh0LWFuY2hvcj0ibWlkZGxlIiBmaWxsPSIjYzA4NGZjIiBmb250LWZhbWlseT0ibW9ub3NwYWNlIiBvcGFjaXR5PSIwLjYiPlBPV0VSRUQgQlkgQVJUSUZJQ0lBTCBJTlRFTExJR0VOQ0U8L3RleHQ+Cjwvc3ZnPg==',
    impressions:'100,000+', duration:'30 days', audience:'All Users',
    likes:1847, votes:632, clicks:'24K', followers:'18.4K', plan:'elite',
  },
  {
    id:'fbc_002', _isBigCampaign:true,
    title:'DROPSHIP KINGS — Build a $10K/month Store in 30 Days',
    headline:'Your financial freedom starts HERE.',
    desc:'The most complete dropshipping masterclass of 2025. 42 modules, live mentoring every week, private community of 8,000 students. Students average $4,200/month after 60 days.',
    cta:'Join the Program →', url:'https://dropshipkings.com',
    author:'Sofia Merchant', username:'@sofia_dsk',
    avatarBg:'linear-gradient(135deg,#b45309,#fbbf24)',
    photos:[
      'data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI3MDAiIGhlaWdodD0iMzk0IiB2aWV3Qm94PSIwIDAgNzAwIDM5NCI+CiAgPHJlY3Qgd2lkdGg9IjcwMCIgaGVpZ2h0PSIzOTQiIGZpbGw9IiMwYTA4MDAiLz4KICA8dGV4dCB4PSIzMCIgeT0iNDAiIGZvbnQtc2l6ZT0iMTYiIGZpbGw9IiNmYmJmMjQiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXdlaWdodD0iYm9sZCI+8J+SsCBTdHVkZW50IFJldmVudWUgR3Jvd3RoPC90ZXh0PgogIDwhLS0gTGluZSBjaGFydCBhcmVhIC0tPgogIDxwb2x5bGluZSBwb2ludHM9IjYwLDMwMCAxNTAsMjcwIDI0MCwyNDAgMzMwLDIwMCA0MjAsMTYwIDUxMCwxMTAgNjAwLDYwIiBmaWxsPSJub25lIiBzdHJva2U9IiNmNTllMGIiIHN0cm9rZS13aWR0aD0iMyIvPgogIDxwb2x5Z29uIHBvaW50cz0iNjAsMzAwIDE1MCwyNzAgMjQwLDI0MCAzMzAsMjAwIDQyMCwxNjAgNTEwLDExMCA2MDAsNjAgNjAwLDMzMCA2MCwzMzAiIGZpbGw9IiNmNTllMGIiIG9wYWNpdHk9IjAuMSIvPgogIDwhLS0gRG90cyAtLT4KICA8Y2lyY2xlIGN4PSI2MCIgY3k9IjMwMCIgcj0iNSIgZmlsbD0iI2ZiYmYyNCIvPgogIDxjaXJjbGUgY3g9IjE1MCIgY3k9IjI3MCIgcj0iNSIgZmlsbD0iI2ZiYmYyNCIvPgogIDxjaXJjbGUgY3g9IjI0MCIgY3k9IjI0MCIgcj0iNSIgZmlsbD0iI2ZiYmYyNCIvPgogIDxjaXJjbGUgY3g9IjMzMCIgY3k9IjIwMCIgcj0iNSIgZmlsbD0iI2ZiYmYyNCIvPgogIDxjaXJjbGUgY3g9IjQyMCIgY3k9IjE2MCIgcj0iNSIgZmlsbD0iI2ZiYmYyNCIvPgogIDxjaXJjbGUgY3g9IjUxMCIgY3k9IjExMCIgcj0iNSIgZmlsbD0iI2ZiYmYyNCIvPgogIDxjaXJjbGUgY3g9IjYwMCIgY3k9IjYwIiByPSI3IiBmaWxsPSIjZmZmIiBzdHJva2U9IiNmYmJmMjQiIHN0cm9rZS13aWR0aD0iMiIvPgogIDwhLS0gTGFiZWxzIC0tPgogIDx0ZXh0IHg9IjYwIiB5PSIzNTAiIGZvbnQtc2l6ZT0iMTAiIGZpbGw9IiM2YjUwMjAiIGZvbnQtZmFtaWx5PSJtb25vc3BhY2UiPkRheSAxPC90ZXh0PgogIDx0ZXh0IHg9IjIzMCIgeT0iMzUwIiBmb250LXNpemU9IjEwIiBmaWxsPSIjNmI1MDIwIiBmb250LWZhbWlseT0ibW9ub3NwYWNlIj5EYXkgMTA8L3RleHQ+CiAgPHRleHQgeD0iNDEwIiB5PSIzNTAiIGZvbnQtc2l6ZT0iMTAiIGZpbGw9IiM2YjUwMjAiIGZvbnQtZmFtaWx5PSJtb25vc3BhY2UiPkRheSAyMDwvdGV4dD4KICA8dGV4dCB4PSI1ODAiIHk9IjM1MCIgZm9udC1zaXplPSIxMCIgZmlsbD0iIzZiNTAyMCIgZm9udC1mYW1pbHk9Im1vbm9zcGFjZSI+RGF5IDMwPC90ZXh0PgogIDwhLS0gQW1vdW50IGxhYmVscyAtLT4KICA8dGV4dCB4PSI2MDUiIHk9IjU1IiBmb250LXNpemU9IjEzIiBmaWxsPSIjZmJiZjI0IiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC13ZWlnaHQ9ImJvbGQiPiQxMCwyNDA8L3RleHQ+CiAgPHRleHQgeD0iMzAiIHk9IjMwNSIgZm9udC1zaXplPSIxMSIgZmlsbD0iIzZiNTAyMCIgZm9udC1mYW1pbHk9Im1vbm9zcGFjZSI+JDA8L3RleHQ+CiAgPCEtLSBTaWRlIHN0YXRzIC0tPgogIDxyZWN0IHg9IjMwIiB5PSIzNzAiIHdpZHRoPSIxMzAiIGhlaWdodD0iMSIgZmlsbD0iIzNkMjIwMCIvPgogIDx0ZXh0IHg9Ijk1IiB5PSIzOTAiIGZvbnQtc2l6ZT0iMTIiIHRleHQtYW5jaG9yPSJtaWRkbGUiIGZpbGw9IiNmNTllMGIiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIj5Bdmc6ICQ0LDIwMC9tb250aDwvdGV4dD4KPC9zdmc+',
      'data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI3MDAiIGhlaWdodD0iMzk0IiB2aWV3Qm94PSIwIDAgNzAwIDM5NCI+CiAgPHJlY3Qgd2lkdGg9IjcwMCIgaGVpZ2h0PSIzOTQiIGZpbGw9IiMwYTA4MDAiLz4KICA8dGV4dCB4PSIzMCIgeT0iMzUiIGZvbnQtc2l6ZT0iMTYiIGZpbGw9IiNmYmJmMjQiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXdlaWdodD0iYm9sZCI+8J+TmiBDb3Vyc2UgQ29udGVudCDigJQgNDIgTW9kdWxlczwvdGV4dD4KICA8IS0tIE1vZHVsZSBsaXN0IC0tPgogIDxyZWN0IHg9IjMwIiB5PSI1NSIgd2lkdGg9IjMwMCIgaGVpZ2h0PSIzNSIgcng9IjYiIGZpbGw9IiMxYzBlMDAiIHN0cm9rZT0iI2Y1OWUwYiIgc3Ryb2tlLXdpZHRoPSIxIi8+CiAgPHRleHQgeD0iNTUiIHk9Ijc3IiBmb250LXNpemU9IjEzIiBmaWxsPSIjZmJiZjI0IiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiI+4pyFIE1vZHVsZSAxOiBOaWNoZSBTZWxlY3Rpb248L3RleHQ+CiAgPHJlY3QgeD0iMzAiIHk9IjEwMCIgd2lkdGg9IjMwMCIgaGVpZ2h0PSIzNSIgcng9IjYiIGZpbGw9IiMxYzBlMDAiIHN0cm9rZT0iI2Y1OWUwYiIgc3Ryb2tlLXdpZHRoPSIxIi8+CiAgPHRleHQgeD0iNTUiIHk9IjEyMiIgZm9udC1zaXplPSIxMyIgZmlsbD0iI2ZiYmYyNCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiPuKchSBNb2R1bGUgMjogU3VwcGxpZXIgTWFzdGVyeTwvdGV4dD4KICA8cmVjdCB4PSIzMCIgeT0iMTQ1IiB3aWR0aD0iMzAwIiBoZWlnaHQ9IjM1IiByeD0iNiIgZmlsbD0iIzFjMGUwMCIgc3Ryb2tlPSIjZjU5ZTBiIiBzdHJva2Utd2lkdGg9IjEiLz4KICA8dGV4dCB4PSI1NSIgeT0iMTY3IiBmb250LXNpemU9IjEzIiBmaWxsPSIjZmJiZjI0IiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiI+4pyFIE1vZHVsZSAzOiBTdG9yZSBEZXNpZ248L3RleHQ+CiAgPHJlY3QgeD0iMzAiIHk9IjE5MCIgd2lkdGg9IjMwMCIgaGVpZ2h0PSIzNSIgcng9IjYiIGZpbGw9IiMxYzBlMDAiIHN0cm9rZT0iI2Y1OWUwYiIgc3Ryb2tlLXdpZHRoPSIxIi8+CiAgPHRleHQgeD0iNTUiIHk9IjIxMiIgZm9udC1zaXplPSIxMyIgZmlsbD0iI2ZiYmYyNCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiPuKchSBNb2R1bGUgNDogRmFjZWJvb2sgQWRzPC90ZXh0PgogIDxyZWN0IHg9IjMwIiB5PSIyMzUiIHdpZHRoPSIzMDAiIGhlaWdodD0iMzUiIHJ4PSI2IiBmaWxsPSIjMWMwZTAwIiBzdHJva2U9IiNmNTllMGIiIHN0cm9rZS13aWR0aD0iMSIvPgogIDx0ZXh0IHg9IjU1IiB5PSIyNTciIGZvbnQtc2l6ZT0iMTMiIGZpbGw9IiNmYmJmMjQiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIj7inIUgTW9kdWxlIDU6IFRpa1RvayBTdHJhdGVneTwvdGV4dD4KICA8cmVjdCB4PSIzMCIgeT0iMjgwIiB3aWR0aD0iMzAwIiBoZWlnaHQ9IjM1IiByeD0iNiIgZmlsbD0iIzFjMGUwMCIgc3Ryb2tlPSIjZjU5ZTBiIiBzdHJva2Utd2lkdGg9IjEiLz4KICA8dGV4dCB4PSI1NSIgeT0iMzAyIiBmb250LXNpemU9IjEzIiBmaWxsPSIjZmJiZjI0IiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiI+4pyFIE1vZHVsZSA2OiBFbWFpbCBGbG93czwvdGV4dD4KICA8dGV4dCB4PSIxODAiIHk9IjM1NSIgZm9udC1zaXplPSIxMiIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZmlsbD0iIzZiNTAyMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiPisgMzYgbW9yZSBtb2R1bGVzLi4uPC90ZXh0PgogIDwhLS0gUmlnaHQgc2lkZSBjb3VudGVyIC0tPgogIDxjaXJjbGUgY3g9IjU2MCIgY3k9IjE4MCIgcj0iOTAiIGZpbGw9IiMxYzBlMDAiIHN0cm9rZT0iI2Y1OWUwYiIgc3Ryb2tlLXdpZHRoPSIyIi8+CiAgPHRleHQgeD0iNTYwIiB5PSIxNjUiIGZvbnQtc2l6ZT0iNTIiIHRleHQtYW5jaG9yPSJtaWRkbGUiIGZpbGw9IiNmYmJmMjQiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXdlaWdodD0iYm9sZCI+NDI8L3RleHQ+CiAgPHRleHQgeD0iNTYwIiB5PSIyMDAiIGZvbnQtc2l6ZT0iMTQiIHRleHQtYW5jaG9yPSJtaWRkbGUiIGZpbGw9IiNiNDUzMDkiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIj5NT0RVTEVTPC90ZXh0PgogIDx0ZXh0IHg9IjU2MCIgeT0iMjIwIiBmb250LXNpemU9IjExIiB0ZXh0LWFuY2hvcj0ibWlkZGxlIiBmaWxsPSIjNmI1MDIwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiI+NDArIGhvdXJzIG9mIGNvbnRlbnQ8L3RleHQ+Cjwvc3ZnPg==',
      'data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI3MDAiIGhlaWdodD0iMzk0IiB2aWV3Qm94PSIwIDAgNzAwIDM5NCI+CiAgPHJlY3Qgd2lkdGg9IjcwMCIgaGVpZ2h0PSIzOTQiIGZpbGw9IiMwYTA4MDAiLz4KICA8dGV4dCB4PSIzNTAiIHk9IjQwIiBmb250LXNpemU9IjE2IiB0ZXh0LWFuY2hvcj0ibWlkZGxlIiBmaWxsPSIjZmJiZjI0IiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC13ZWlnaHQ9ImJvbGQiPvCfkaUgUHJpdmF0ZSBDb21tdW5pdHkg4oCUIDgsMDAwIFN0dWRlbnRzPC90ZXh0PgogIDwhLS0gQ2hhdCBidWJibGVzIC0tPgogIDxyZWN0IHg9IjMwIiB5PSI2NSIgd2lkdGg9IjMyMCIgaGVpZ2h0PSI2MCIgcng9IjEyIiBmaWxsPSIjMWMwZTAwIiBzdHJva2U9IiNmNTllMGIiIHN0cm9rZS13aWR0aD0iMSIvPgogIDxjaXJjbGUgY3g9IjU1IiBjeT0iOTUiIHI9IjE1IiBmaWxsPSIjYjQ1MzA5Ii8+CiAgPHRleHQgeD0iNTUiIHk9IjEwMSIgZm9udC1zaXplPSIxMiIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZmlsbD0iI2ZmZiI+TTwvdGV4dD4KICA8dGV4dCB4PSI4MCIgeT0iODUiIGZvbnQtc2l6ZT0iMTIiIGZpbGw9IiNmYmJmMjQiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXdlaWdodD0iYm9sZCI+TWFyY3VzIEsuPC90ZXh0PgogIDx0ZXh0IHg9IjgwIiB5PSIxMDQiIGZvbnQtc2l6ZT0iMTEiIGZpbGw9IiM5MjQwMGUiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIj4iSGl0ICQ4LDQwMCB0aGlzIG1vbnRoISDwn5Sl8J+UpSI8L3RleHQ+CiAgPHJlY3QgeD0iMzUwIiB5PSI2NSIgd2lkdGg9IjMyMCIgaGVpZ2h0PSI2MCIgcng9IjEyIiBmaWxsPSIjMWMwZTAwIiBzdHJva2U9IiNmYmJmMjQiIHN0cm9rZS13aWR0aD0iMSIvPgogIDxjaXJjbGUgY3g9IjM3NSIgY3k9Ijk1IiByPSIxNSIgZmlsbD0iI2Q5NzcwNiIvPgogIDx0ZXh0IHg9IjM3NSIgeT0iMTAxIiBmb250LXNpemU9IjEyIiB0ZXh0LWFuY2hvcj0ibWlkZGxlIiBmaWxsPSIjZmZmIj5MPC90ZXh0PgogIDx0ZXh0IHg9IjQwMCIgeT0iODUiIGZvbnQtc2l6ZT0iMTIiIGZpbGw9IiNmYmJmMjQiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXdlaWdodD0iYm9sZCI+TGF5bGEgUy48L3RleHQ+CiAgPHRleHQgeD0iNDAwIiB5PSIxMDQiIGZvbnQtc2l6ZT0iMTEiIGZpbGw9IiM5MjQwMGUiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIj4iRmlyc3QgJDFLIHdlZWshIFRoYW5rIHlvdSDwn5mPIjwvdGV4dD4KICA8cmVjdCB4PSIzMCIgeT0iMTQ1IiB3aWR0aD0iMzIwIiBoZWlnaHQ9IjYwIiByeD0iMTIiIGZpbGw9IiMxYzBlMDAiIHN0cm9rZT0iI2Y1OWUwYiIgc3Ryb2tlLXdpZHRoPSIxIi8+CiAgPGNpcmNsZSBjeD0iNTUiIGN5PSIxNzUiIHI9IjE1IiBmaWxsPSIjOTI0MDBlIi8+CiAgPHRleHQgeD0iNTUiIHk9IjE4MSIgZm9udC1zaXplPSIxMiIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZmlsbD0iI2ZmZiI+VDwvdGV4dD4KICA8dGV4dCB4PSI4MCIgeT0iMTY1IiBmb250LXNpemU9IjEyIiBmaWxsPSIjZmJiZjI0IiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC13ZWlnaHQ9ImJvbGQiPlRvbSBWLjwvdGV4dD4KICA8dGV4dCB4PSI4MCIgeT0iMTg0IiBmb250LXNpemU9IjExIiBmaWxsPSIjOTI0MDBlIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiI+IlF1aXQgbXkgOS01IGxhc3Qgd2VlayDwn46JIjwvdGV4dD4KICA8cmVjdCB4PSIzNTAiIHk9IjE0NSIgd2lkdGg9IjMyMCIgaGVpZ2h0PSI2MCIgcng9IjEyIiBmaWxsPSIjMWMwZTAwIiBzdHJva2U9IiNmYmJmMjQiIHN0cm9rZS13aWR0aD0iMSIvPgogIDxjaXJjbGUgY3g9IjM3NSIgY3k9IjE3NSIgcj0iMTUiIGZpbGw9IiNiNDUzMDkiLz4KICA8dGV4dCB4PSIzNzUiIHk9IjE4MSIgZm9udC1zaXplPSIxMiIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZmlsbD0iI2ZmZiI+QTwvdGV4dD4KICA8dGV4dCB4PSI0MDAiIHk9IjE2NSIgZm9udC1zaXplPSIxMiIgZmlsbD0iI2ZiYmYyNCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtd2VpZ2h0PSJib2xkIj5BbmEgUi48L3RleHQ+CiAgPHRleHQgeD0iNDAwIiB5PSIxODQiIGZvbnQtc2l6ZT0iMTEiIGZpbGw9IiM5MjQwMGUiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIj4iJDNLIGluIG15IGZpcnN0IDMwIGRheXMg8J+SsCI8L3RleHQ+CiAgPCEtLSBCb3R0b20gc3RhdHMgYmFyIC0tPgogIDxyZWN0IHg9IjMwIiB5PSIyNDAiIHdpZHRoPSI2NDAiIGhlaWdodD0iNzAiIHJ4PSIxMiIgZmlsbD0iIzFjMGUwMCIgc3Ryb2tlPSIjZjU5ZTBiIiBzdHJva2Utd2lkdGg9IjEiLz4KICA8dGV4dCB4PSIxNzUiIHk9IjI2OCIgZm9udC1zaXplPSIxMyIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZmlsbD0iI2I0NTMwOSIgZm9udC1mYW1pbHk9Im1vbm9zcGFjZSI+QUNUSVZFIE1FTUJFUlM8L3RleHQ+CiAgPHRleHQgeD0iMTc1IiB5PSIyOTgiIGZvbnQtc2l6ZT0iMjgiIHRleHQtYW5jaG9yPSJtaWRkbGUiIGZpbGw9IiNmYmJmMjQiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXdlaWdodD0iYm9sZCI+OCwwMDArPC90ZXh0PgogIDxsaW5lIHgxPSIzNTAiIHkxPSIyNTAiIHgyPSIzNTAiIHkyPSIzMDAiIHN0cm9rZT0iIzNkMjIwMCIgc3Ryb2tlLXdpZHRoPSIxIi8+CiAgPHRleHQgeD0iNTI1IiB5PSIyNjgiIGZvbnQtc2l6ZT0iMTMiIHRleHQtYW5jaG9yPSJtaWRkbGUiIGZpbGw9IiNiNDUzMDkiIGZvbnQtZmFtaWx5PSJtb25vc3BhY2UiPldFRUtMWSBMSVZFIENBTExTPC90ZXh0PgogIDx0ZXh0IHg9IjUyNSIgeT0iMjk4IiBmb250LXNpemU9IjI4IiB0ZXh0LWFuY2hvcj0ibWlkZGxlIiBmaWxsPSIjZmJiZjI0IiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC13ZWlnaHQ9ImJvbGQiPkV2ZXJ5IFdlZDwvdGV4dD4KICA8IS0tIFN0YXJzIC0tPgogIDx0ZXh0IHg9IjM1MCIgeT0iMzYwIiBmb250LXNpemU9IjIwIiB0ZXh0LWFuY2hvcj0ibWlkZGxlIiBmaWxsPSIjZmJiZjI0Ij7imIXimIXimIXimIXimIU8L3RleHQ+CiAgPHRleHQgeD0iMzUwIiB5PSIzODUiIGZvbnQtc2l6ZT0iMTIiIHRleHQtYW5jaG9yPSJtaWRkbGUiIGZpbGw9IiM2YjUwMjAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIj5SYXRlZCAjMSBkcm9wc2hpcHBpbmcgY29tbXVuaXR5IDIwMjU8L3RleHQ+Cjwvc3ZnPg==',
    ],
    thumbnail:'data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNDAwIiBoZWlnaHQ9IjQwMCIgdmlld0JveD0iMCAwIDE0MDAgNDAwIj4KICA8ZGVmcz4KICAgIDxsaW5lYXJHcmFkaWVudCBpZD0iYmcyIiB4MT0iMCUiIHkxPSIwJSIgeDI9IjEwMCUiIHkyPSIxMDAlIj4KICAgICAgPHN0b3Agb2Zmc2V0PSIwJSIgc3R5bGU9InN0b3AtY29sb3I6IzBhMDUwMCIvPgogICAgICA8c3RvcCBvZmZzZXQ9IjUwJSIgc3R5bGU9InN0b3AtY29sb3I6IzFjMGUwMCIvPgogICAgICA8c3RvcCBvZmZzZXQ9IjEwMCUiIHN0eWxlPSJzdG9wLWNvbG9yOiMzZDIyMDAiLz4KICAgIDwvbGluZWFyR3JhZGllbnQ+CiAgPC9kZWZzPgogIDxyZWN0IHdpZHRoPSIxNDAwIiBoZWlnaHQ9IjQwMCIgZmlsbD0idXJsKCNiZzIpIi8+CiAgPGNpcmNsZSBjeD0iMzAwIiBjeT0iMjAwIiByPSIzNTAiIGZpbGw9IiNiNDUzMDkiIG9wYWNpdHk9IjAuMDgiLz4KICA8Y2lyY2xlIGN4PSIxMTAwIiBjeT0iMTAwIiByPSIyNTAiIGZpbGw9IiNmYmJmMjQiIG9wYWNpdHk9IjAuMDYiLz4KICA8IS0tIE1vbmV5IHJhaW4gZWZmZWN0IC0tPgogIDx0ZXh0IHg9IjEwMCIgeT0iODAiIGZvbnQtc2l6ZT0iMjQiIGZpbGw9IiNmYmJmMjQiIG9wYWNpdHk9IjAuMTUiPvCfkrA8L3RleHQ+CiAgPHRleHQgeD0iMzAwIiB5PSI1MCIgZm9udC1zaXplPSIxOCIgZmlsbD0iI2ZiYmYyNCIgb3BhY2l0eT0iMC4xMiI+8J+SsDwvdGV4dD4KICA8dGV4dCB4PSI3MDAiIHk9IjkwIiBmb250LXNpemU9IjIyIiBmaWxsPSIjZmJiZjI0IiBvcGFjaXR5PSIwLjEiPvCfkrA8L3RleHQ+CiAgPHRleHQgeD0iMTAwMCIgeT0iNjAiIGZvbnQtc2l6ZT0iMjAiIGZpbGw9IiNmYmJmMjQiIG9wYWNpdHk9IjAuMTMiPvCfkrA8L3RleHQ+CiAgPHRleHQgeD0iMTIwMCIgeT0iMTAwIiBmb250LXNpemU9IjE2IiBmaWxsPSIjZmJiZjI0IiBvcGFjaXR5PSIwLjEiPvCfkrA8L3RleHQ+CiAgPHRleHQgeD0iMTUwIiB5PSIzNTAiIGZvbnQtc2l6ZT0iMTgiIGZpbGw9IiNmYmJmMjQiIG9wYWNpdHk9IjAuMSI+8J+SsDwvdGV4dD4KICA8dGV4dCB4PSI1MDAiIHk9IjM3MCIgZm9udC1zaXplPSIyMCIgZmlsbD0iI2ZiYmYyNCIgb3BhY2l0eT0iMC4xMiI+8J+SsDwvdGV4dD4KICA8dGV4dCB4PSI5MDAiIHk9IjM0MCIgZm9udC1zaXplPSIxNiIgZmlsbD0iI2ZiYmYyNCIgb3BhY2l0eT0iMC4xIj7wn5KwPC90ZXh0PgogIDwhLS0gQ2VudGVyIC0tPgogIDxjaXJjbGUgY3g9IjcwMCIgY3k9IjE5NSIgcj0iODUiIGZpbGw9IiNiNDUzMDkiIG9wYWNpdHk9IjAuMjUiIHN0cm9rZT0iI2ZiYmYyNCIgc3Ryb2tlLXdpZHRoPSIyIi8+CiAgPCEtLSBTdGF0cyBwaWxscyAtLT4KICA8cmVjdCB4PSIyMDAiIHk9IjI4MCIgd2lkdGg9IjE4MCIgaGVpZ2h0PSI0MCIgcng9IjIwIiBmaWxsPSIjMWMwZTAwIiBzdHJva2U9IiNmNTllMGIiIHN0cm9rZS13aWR0aD0iMS41Ii8+CiAgPHRleHQgeD0iMjkwIiB5PSIzMDUiIGZvbnQtc2l6ZT0iMTQiIHRleHQtYW5jaG9yPSJtaWRkbGUiIGZpbGw9IiNmYmJmMjQiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXdlaWdodD0iYm9sZCI+JDEwSy9tb250aDwvdGV4dD4KICA8cmVjdCB4PSI2MTAiIHk9IjI4MCIgd2lkdGg9IjE4MCIgaGVpZ2h0PSI0MCIgcng9IjIwIiBmaWxsPSIjMWMwZTAwIiBzdHJva2U9IiNmNTllMGIiIHN0cm9rZS13aWR0aD0iMS41Ii8+CiAgPHRleHQgeD0iNzAwIiB5PSIzMDUiIGZvbnQtc2l6ZT0iMTQiIHRleHQtYW5jaG9yPSJtaWRkbGUiIGZpbGw9IiNmYmJmMjQiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXdlaWdodD0iYm9sZCI+OCwwMDAgU3R1ZGVudHM8L3RleHQ+CiAgPHJlY3QgeD0iMTAyMCIgeT0iMjgwIiB3aWR0aD0iMTgwIiBoZWlnaHQ9IjQwIiByeD0iMjAiIGZpbGw9IiMxYzBlMDAiIHN0cm9rZT0iI2Y1OWUwYiIgc3Ryb2tlLXdpZHRoPSIxLjUiLz4KICA8dGV4dCB4PSIxMTEwIiB5PSIzMDUiIGZvbnQtc2l6ZT0iMTQiIHRleHQtYW5jaG9yPSJtaWRkbGUiIGZpbGw9IiNmYmJmMjQiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXdlaWdodD0iYm9sZCI+NDIgTW9kdWxlczwvdGV4dD4KPC9zdmc+',
    impressions:'100,000+', duration:'30 days', audience:'Entrepreneurs',
    likes:3210, votes:1140, clicks:'41K', followers:'31.2K', plan:'elite',
  }
];

function renderBigCampaignCard(c){
  return '<div style="grid-column:1/-1;background:linear-gradient(160deg,#0e0005,#1a0010);border:2px solid rgba(255,60,110,0.4);border-radius:18px;overflow:hidden;box-shadow:0 0 40px rgba(255,60,110,0.12);margin-bottom:4px;">'
    // TOP BANNER — real thumbnail photo
    +'<div style="position:relative;height:220px;overflow:hidden;background:#0e0005;">'
    +'<img src="'+c.thumbnail+'" alt="'+((c.title||c.name||'Project thumbnail').replace(/"/g,''))+'" style="width:100%;height:100%;object-fit:cover;display:block;" crossorigin="anonymous"/>'
    +'<div style="position:absolute;inset:0;background:linear-gradient(to bottom,rgba(0,0,0,0.05),rgba(14,0,5,0.80));"></div>'
    +'<div style="position:absolute;top:14px;left:14px;display:flex;gap:8px;align-items:center;">'
    +'<span style="background:linear-gradient(135deg,#ff3c6e,#ff8c00);color:#fff;font-family:\'DM Mono\',monospace;font-size:9px;font-weight:900;padding:4px 12px;border-radius:4px;letter-spacing:2px;">🔥 BIG CAMPAIGN</span>'
    +'<span style="background:rgba(0,0,0,0.55);border:1px solid rgba(255,215,0,0.5);color:#ffd700;font-family:\'DM Mono\',monospace;font-size:9px;padding:3px 10px;border-radius:4px;letter-spacing:1px;">👑 ELITE</span>'
    +'</div>'
    +'<div style="position:absolute;top:14px;right:14px;background:rgba(0,0,0,0.55);border:1px solid rgba(255,60,110,0.3);border-radius:20px;padding:4px 12px;font-family:\'DM Mono\',monospace;font-size:9px;color:rgba(255,255,255,0.8);">👁 '+c.impressions+'</div>'
    +'<div style="position:absolute;bottom:14px;left:16px;right:16px;">'
    +'<div style="font-family:\'Bebas Neue\',sans-serif;font-size:26px;letter-spacing:2px;color:#fff;line-height:1;text-shadow:0 2px 16px rgba(0,0,0,0.95);">'+c.title+'</div>'
    +'<div style="font-size:13px;color:#ff3c6e;font-weight:700;margin-top:4px;text-shadow:0 1px 8px rgba(0,0,0,0.95);">'+c.headline+'</div>'
    +'</div></div>'
    // BODY
    +'<div style="padding:18px 20px;">'
    // Author row
    +'<div style="display:flex;align-items:center;gap:10px;margin-bottom:14px;">'
    +'<div style="width:40px;height:40px;border-radius:50%;background:'+c.avatarBg+';display:flex;align-items:center;justify-content:center;font-size:17px;font-weight:900;color:#fff;font-family:\'Bebas Neue\',sans-serif;letter-spacing:1px;border:2px solid rgba(255,60,110,0.4);flex-shrink:0;">'+(c.author||'?')[0].toUpperCase()+'</div>'
    +'<div><div style="font-size:14px;font-weight:800;color:#fff;">'+c.author+'</div>'
    +'<div style="font-size:11px;color:rgba(255,60,110,0.7);">'+c.username+' · '+c.followers+' followers</div></div>'
    +'<div style="margin-left:auto;font-size:11px;color:var(--muted);">⏱ '+c.duration+'</div>'
    +'</div>'
    // Description
    +'<div style="font-size:13px;color:var(--muted);line-height:1.65;margin-bottom:16px;">'+c.desc+'</div>'
    // 3 real photos
    +'<div style="display:grid;grid-template-columns:repeat(3,1fr);gap:10px;margin-bottom:16px;">'
    +c.photos.map(function(ph){
      return '<div style="border-radius:12px;overflow:hidden;aspect-ratio:16/9;background:#0e0005;">'
        +'<img src="'+ph+'" alt="Project photo" style="width:100%;height:100%;object-fit:cover;display:block;" crossorigin="anonymous"/>'
        +'</div>';
    }).join('')
    +'</div>'
    // Stats + CTA
    +'<div style="display:flex;align-items:center;justify-content:space-between;flex-wrap:wrap;gap:10px;">'
    +'<div style="display:flex;gap:14px;align-items:center;">'
    +'<span style="font-size:12px;color:var(--muted);">▲ '+fmtNum(c.votes)+' votes</span>'
    +'<span style="font-size:12px;color:var(--muted);">❤️ '+fmtNum(c.likes)+'</span>'
    +'<span style="font-size:12px;color:var(--muted);">🔗 '+c.clicks+' clicks</span>'
    +'</div>'
    +'<a href="'+c.url+'" target="_blank" style="padding:10px 22px;background:linear-gradient(135deg,#be123c,#ff3c6e);border:none;border-radius:8px;font-family:\'Plus Jakarta Sans\',sans-serif;font-size:13px;font-weight:800;color:#fff;text-decoration:none;box-shadow:0 0 18px rgba(255,60,110,0.3);">'+c.cta+'</a>'
    +'</div>'
    +'</div></div>';
}

function buildShowcaseGrid(containerId,filter='all'){
  var el=document.getElementById(containerId);
  if(!el)return;
  var data=filter==='all'?showcaseData.slice():showcaseData.filter(function(p){return p.cat===filter;});
  data.sort(function(a,b){
    var boost_a=a._boosted?1:0,boost_b=b._boosted?1:0;
    if(boost_b!==boost_a)return boost_b-boost_a;
    return (PLAN_ORDER[b.plan||'free']||0)-(PLAN_ORDER[a.plan||'free']||0);
  });
  // Inject fake Big Campaigns at top (only on 'all' filter)
  var bigCampHtml='';
  if(filter==='all'){
    bigCampHtml=FAKE_BIG_CAMPAIGNS.map(renderBigCampaignCard).join('');
  }
  if(!data.length && !bigCampHtml){el.innerHTML='<div style="grid-column:1/-1;text-align:center;padding:48px;color:var(--muted)">No posts yet</div>';return;}
  var html=bigCampHtml;
  data.forEach(function(p){
    var isFollowing=(window._followedProjects||new Set()).has(p.id);
    var isLiked=(window._likedProjects||new Set()).has(p.id);
    var isSaved=(window._savedProjects||new Set()).has(p.id);
    var planKey=p.plan||'free';
    var pc=PLAN_COLORS[planKey]||PLAN_COLORS.free;
    var planIcon=PLAN_ICONS[planKey]||'?';
    var cardBorder='border-color:'+pc.border+(pc.glow?';box-shadow:'+pc.glow:'')+';';
    var fu=FAKE_USERS.find(function(u){return u.id===p.authorId;})||{};
    var avaColor=fu.avatar||'#22c55e';
    var avaShow=(p.author||'?')[0].toUpperCase();
    var planBadge='<span style="display:inline-flex;align-items:center;gap:3px;background:'+pc.bg+';border:1px solid '+pc.border+';border-radius:4px;padding:1px 7px;font-family:DM Mono,monospace;font-size:9px;font-weight:700;letter-spacing:1px;color:'+pc.text+';">'+planIcon+' '+planKey.toUpperCase()+'</span>';
    var boostBadge=p._boosted?'<span style="display:inline-flex;align-items:center;gap:3px;background:rgba(255,215,0,0.15);border:1px solid rgba(255,215,0,0.4);border-radius:4px;padding:1px 7px;font-family:DM Mono,monospace;font-size:9px;font-weight:700;color:#ffd700;margin-left:4px;">&#9889; BOOST</span>':'';
    var cardBg=planKey==='vip'?';background:linear-gradient(160deg,rgba(255,215,0,0.04),rgba(255,140,0,0.02))':'';
    html+='<div class="v-card" data-pid="'+p.id+'" style="'+cardBorder+cardBg+'cursor:pointer;" onclick="openProjectModal(this.dataset.pid)">'
      +'<div class="v-body" style="padding:14px 16px;">'
        +'<div style="display:flex;align-items:center;gap:10px;margin-bottom:10px;">'
          +'<div style="width:42px;height:42px;border-radius:50%;background:'+avaColor+';display:flex;align-items:center;justify-content:center;font-size:18px;font-weight:700;color:#fff;flex-shrink:0;border:2px solid '+pc.border+';">'+avaShow+'</div>'
          +'<div style="flex:1;min-width:0;">'
            +'<div style="display:flex;align-items:center;gap:6px;flex-wrap:wrap;">'
              +'<span style="font-size:14px;font-weight:800;color:var(--white);">'+p.author+'</span>'
              +planBadge+boostBadge
            +'</div>'
            +'<div style="font-size:10px;color:var(--muted);margin-top:1px;">'+p.type+' &middot; '+fmtNum(p.followers||0)+' followers</div>'
          +'</div>'
          +'<button class="v-follow-btn'+(isFollowing?' following':'')+'" data-fid="'+p.id+'" onclick="event.stopPropagation();toggleFollowProject(event,this.dataset.fid,this)" style="flex-shrink:0;">'+(isFollowing?'&#10003; Following':'+ Follow')+'</button>'
        +'</div>'
        +'<div style="font-size:13px;font-weight:800;color:var(--white);margin-bottom:4px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;">'+p.name+'</div>'
        +'<div style="font-size:11px;color:var(--muted);line-height:1.5;margin-bottom:10px;display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden;">'+p.desc+'</div>'
        +'<div style="display:flex;align-items:center;justify-content:space-between;flex-wrap:wrap;gap:6px;">'
          +'<div style="display:flex;align-items:center;gap:10px;">'
            +'<span style="font-family:DM Mono,monospace;font-size:9px;color:var(--muted);">&#9650; '+p.votes+' votes</span>'
            +'<span style="font-family:DM Mono,monospace;font-size:9px;color:var(--muted);">'+fmtNum(p.clicks||0)+' clicks</span>'
          +'</div>'
          +'<div style="display:flex;gap:5px;">'
            +'<button class="v-like-btn'+(isLiked?' liked':'')+'" data-lid="'+p.id+'" onclick="event.stopPropagation();toggleLikeProject(event,this.dataset.lid,this)" style="padding:3px 8px;">'
              +'<span class="v-heart">'+(isLiked?'&#10084;&#65039;':'&#129293;')+'</span> <span class="v-like-num">'+fmtNum(p.likes||0)+'</span>'
            +'</button>'
            +'<button class="v-save-btn'+(isSaved?' saved':'')+'" data-sid="'+p.id+'" onclick="event.stopPropagation();toggleSaveProject(event,this.dataset.sid,this)" style="padding:3px 8px;">'
              +(isSaved?'&#128278; Saved':'&#128278; Save')
            +'</button>'
          +'</div>'
        +'</div>'
      +'</div>'
    +'</div>';
  });
  el.innerHTML=html;
}


function filterLandingShowcase(el,filter){
  document.querySelectorAll('#showcase .filters-row .f-btn').forEach(b=>b.classList.remove('active'));
  el.classList.add('active');
  buildShowcaseGrid('landing-showcase-grid',filter);
}
function filterAppShowcase(el,filter){
  document.querySelectorAll('#tab-showcase .f-btn').forEach(b=>b.classList.remove('active'));
  el.classList.add('active');
  buildShowcaseGrid('app-showcase-grid',filter);
}

function fmtNum(n){ return n>=1000 ? (n/1000).toFixed(1).replace('.0','')+'K' : String(n); }

function toggleFollowProject(e, id, btn){
  e.stopPropagation();
  if(!currentUser||currentUser.isDemo){openDemoSignupModal();return;}
  if(!window._followedProjects) window._followedProjects = new Set();
  const p = showcaseData.find(x=>x.id===id);
  if(!p) return;
  if(window._followedProjects.has(id)){
    window._followedProjects.delete(id);
    p.followers = Math.max(0,(p.followers||1)-1);
    btn.textContent = '+ Follow';
    btn.classList.remove('following');
    toast('Unfollowed');
  } else {
    window._followedProjects.add(id);
    p.followers = (p.followers||0)+1;
    btn.textContent = '✓ Following';
    btn.classList.add('following');
    toast('✅ Following '+p.name+'!');
  }
  // Update counter in card
  const card = btn.closest('.v-card');
  if(card){
    const statFollowers = card.querySelector('.v-stat-followers');
    if(statFollowers) statFollowers.textContent = fmtNum(p.followers);
  }
}

async function voteProject(e,id,btn){
  e.stopPropagation();
  if(!currentUser||currentUser.isDemo){openDemoSignupModal();return;}
  if(myVotes.has(id)){toast('You already voted!');return;}
  btn.classList.add('voted');
  const cnt=btn.querySelector('.vote-count');
  const proj=showcaseData.find(p=>p.id===id);
  if(proj)proj.votes++;
  if(cnt)cnt.textContent=(parseInt(cnt.textContent)||0)+1;
  myVotes.add(id);
  localStorage.setItem('vb_votes',JSON.stringify([...myVotes]));
  toast('👍 Vote counted!');
  // sync API
  try{await fetch('/api/projects/'+id+'/vote',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({userId:currentUser.email})});}catch(e){}
}

// ── FAKE USERS POOL ──
const FAKE_USERS = [
  {id:'u_alex',    name:'Alex Turner',    username:'alexbuilds',   emoji:'👨‍💻', plan:'pro',     avatar:'#6366f1', niche:'SaaS'},
  {id:'u_sara',    name:'Sarah K.',       username:'sarahcreates', emoji:'✨',   plan:'starter', avatar:'#ec4899', niche:'TikTok'},
  {id:'u_marc',    name:'Marc Dubois',    username:'marcdubois',   emoji:'🚀',   plan:'elite',   avatar:'#f59e0b', niche:'E-commerce'},
  {id:'u_lena',    name:'Lena Müller',    username:'lenadesigns',  emoji:'🎨',   plan:'starter', avatar:'#10b981', niche:'Design'},
  {id:'u_james',   name:'James W.',       username:'jamesfounder', emoji:'💼',   plan:'starter', avatar:'#3b82f6', niche:'Startup'},
  {id:'u_nina',    name:'Nina Lopez',     username:'ninalopez',    emoji:'📸',   plan:'starter', avatar:'#a855f7', niche:'Instagram'},
  {id:'u_tom',     name:'Tom Chen',       username:'tomchendev',   emoji:'⚡',   plan:'pro',     avatar:'#ef4444', niche:'Dev'},
  {id:'u_clara',   name:'Clara Smith',    username:'clarasmith',   emoji:'🌟',   plan:'starter', avatar:'#14b8a6', niche:'Marketing'},
  {id:'u_ryan',    name:'Ryan Patel',     username:'ryanpatel',    emoji:'🎯',   plan:'starter', avatar:'#f97316', niche:'Freelance'},
  {id:'u_emma',    name:'Emma Johnson',   username:'emmajohnson',  emoji:'💡',   plan:'free',    avatar:'#8b5cf6', niche:'Content'},
  {id:'u_lucas',   name:'Lucas Martin',  username:'lucasbuilds',  emoji:'🛠️',  plan:'pro',     avatar:'#06b6d4', niche:'Dev'},
  {id:'u_sofia',   name:'Sofia Rossi',   username:'sofiarossi',   emoji:'🌺',   plan:'starter', avatar:'#f43f5e', niche:'E-commerce'},
  {id:'u_ben',     name:'Ben Carter',    username:'bencarter',    emoji:'🔥',   plan:'legend',  avatar:'#84cc16', niche:'Growth'},
  {id:'u_jade',    name:'Jade Williams', username:'jadewilliams', emoji:'🎵',   plan:'free',    avatar:'#d946ef', niche:'TikTok'},
  {id:'u_noah',    name:'Noah Fischer',  username:'noahfischer',  emoji:'📊',   plan:'vip',     avatar:'#0ea5e9', niche:'Analytics'},
];

// ── REAL ADS POOL ──
const FAKE_POSTS_POOL = [

  // ─── FREELANCE SERVICES ───
  {type:'pub', text:`🎨 FREELANCE — Logo + full brand identity\n\n✅ Vector logo (3 proposals)\n✅ Color palette + typography\n✅ Social media kit (banners, profile pics)\n✅ Delivered in 5 business days\n\n💶 From $280 — DM for a custom quote`, user:'u_lena', plan:'pro', likes:47, comments:14, shares:9, postUrl:'https://lena-design.fr'},

  {type:'pub', text:`💻 REACT / NODE.JS DEVELOPER AVAILABLE\n\nTaking on 2 new projects this month.\n\n→ Landing pages & web apps\n→ Dashboards & SaaS products\n→ API integrations & webhooks\n\n🕐 Timeline: 2–4 weeks depending on scope\n💶 Day rate: $450/day\n\nPortfolio on request. Reply within 24h ⚡`, user:'u_tom', plan:'elite', likes:83, comments:27, shares:18, postUrl:'https://tomchen.dev'},

  {type:'pub', text:`📱 COMMUNITY MANAGER — Monthly package\n\nI handle your social media end to end:\n📆 Monthly editorial calendar\n✍️ 20 posts written + scheduled\n📊 Monthly performance report\n💬 Comment moderation included\n\n💶 $299/month — Max 3 clients (limited spots)\nDM for a free audit of your accounts 👇`, user:'u_nina', plan:'starter', likes:61, comments:22, shares:11},

  {type:'pub', text:`🎬 PROFESSIONAL VIDEO EDITING\n\n• Viral Reels & TikToks (trending formats)\n• YouTube videos: intro, transitions, SFX\n• Meta Ads & YouTube Ads\n\n⏱️ Delivery guaranteed in 48h\n📁 MP4 + source files included\n💶 From $89/video\n\n🎯 200+ videos delivered. DM with your brief 👇`, user:'u_jade', plan:'free', likes:134, comments:38, shares:29},

  {type:'pub', text:`✍️ COPYWRITING & SALES FUNNELS\n\nGreat product but your copy isn't converting?\n\nI write:\n📄 Full landing page\n📧 Email sequence (7 emails)\n🎯 VSL script & sales video\n\n💶 Full package: $890\n📈 +30% conversion guaranteed or full refund\n\nDM \"COPY\" to discuss 📩`, user:'u_clara', plan:'pro', likes:98, comments:41, shares:33, postUrl:'https://claracopy.com'},

  // ─── COURSES & DIGITAL PRODUCTS ───
  {type:'pub', text:`🚀 DROPSHIPPING COURSE — REAL RESULTS\n\nWhat you'll learn:\n→ Find winning products in 30 min/day\n→ Launch your Shopify store in 1 weekend\n→ Run your first Meta Ads from $5/day\n→ Scale to $5K/month in 90 days\n\n📦 120 videos · Lifetime access · Updates included\n💶 $197 (was $497 — launch price)\n\n🔗 Link in bio`, projName:'DropSchool', projEmoji:'📦', projType:'Course', user:'u_marc', plan:'elite', likes:211, comments:87, shares:94, postUrl:'https://dropschool.fr'},

  {type:'pub', text:`📊 NOTION PACK — COMPLETE PRODUCTIVITY SYSTEM\n\n✅ Pro & personal life dashboard\n✅ Quarterly OKR tracker\n✅ Simplified client CRM\n✅ Freelance revenue tracker\n✅ Resource library\n\n8 interconnected, ready-to-use templates\n💶 $47 — Instant download\n\n1,200+ entrepreneurs already use it daily ⚡`, projName:'ProNotion Pack', projEmoji:'📊', projType:'Template', user:'u_lucas', plan:'pro', likes:176, comments:53, shares:67, postUrl:'https://pronotion.gumroad.com'},

  {type:'pub', text:`💡 PACK OF 50 CANVA TEMPLATES — SOCIAL MEDIA\n\nReady to go. Customize in 5 minutes.\n\n📦 Includes:\n• 15 Instagram Post templates\n• 10 Stories templates\n• 10 LinkedIn templates\n• 10 TikTok thumbnails\n• 5 YouTube templates\n\nShared Canva folder · Edit endlessly\n💶 $19 — Delivered instantly\n\nDM \"CANVA\" to order 📩`, user:'u_emma', plan:'free', likes:203, comments:76, shares:112, postUrl:'https://emma-templates.gumroad.com'},

  {type:'pub', text:`🎯 FREE MASTERCLASS — Hit $3K/month as a freelancer\n\nWednesday 8PM — Live on Zoom\n\nOn the agenda:\n→ The 3 niches that pay best in 2024\n→ How to structure a premium offer\n→ Exact script to close on the phone\n→ Live Q&A\n\n🎁 Bonus: free proposal template for attendees\n📩 Comment \"LIVE\" to register 👇`, user:'u_ryan', plan:'starter', likes:89, comments:143, shares:57},

  // ─── PRODUCTS / SAAS / APPS ───
  {type:'pub', text:`🤖 FREE BETA — Our AI app is live!\n\nFaceWrite generates your Instagram, TikTok and LinkedIn captions from a single photo.\n\n⚡ Generated in 3 seconds · 100% adapted to your tone\n🌍 English, French, Spanish\n📱 iOS & Android\n\n🎁 First 100 signups = 3 months PRO free\n\nDownload link 👇`, projName:'FaceWrite AI', projEmoji:'🤖', projType:'AI App', user:'u_alex', plan:'pro', likes:319, comments:128, shares:204, postUrl:'https://facewrite.app'},

  {type:'pub', text:`🔧 SAAS LAUNCH — LeadTrack Pro is live!\n\nThe CRM built for freelancers and solopreneurs:\n\n→ Visual drag & drop pipeline\n→ Quote & contract tracking\n→ Automatic client reminders\n→ Real-time revenue dashboard\n\n💶 Free up to 10 clients · Pro at $19/month\n🎯 7-day trial — No credit card required\n\nFeedback very welcome 🙏`, projName:'LeadTrack Pro', projEmoji:'📋', projType:'SaaS', user:'u_noah', plan:'pro', likes:156, comments:44, shares:38, postUrl:'https://leadtrack.pro'},

  {type:'pub', text:`📧 EMAIL MARKETING MADE SIMPLE 🇪🇺\n\nMailZen — The clean alternative to Mailchimp\n\n✅ Drag & drop visual editor\n✅ Visual automations\n✅ Native GDPR compliance\n✅ Support 7 days a week\n\n💶 Free up to 500 contacts\n→ Pro plan: $29/month\n\n14-day free trial 🎁 Link in bio`, projName:'MailZen', projEmoji:'📧', projType:'SaaS', user:'u_sofia', plan:'elite', likes:94, comments:31, shares:26, postUrl:'https://mailzen.fr'},

  // ─── COLLAB / HIRING ───
  {type:'pub', text:`🤝 LOOKING FOR A CO-FOUNDER — Active e-commerce project\n\nWe already have:\n✅ Live Shopify store (3 months, $28K revenue)\n✅ Validated and tested suppliers\n✅ 12K TikTok followers\n\nWe need:\n→ Experienced marketing / Ads profile\n→ Available min. 15h/week\n→ Buy-in: $2,000 (repaid by month 3)\n\nDM with your background. Serious inquiries only 🙏`, user:'u_marc', plan:'elite', likes:67, comments:89, shares:23},

  {type:'pub', text:`📣 WE'RE HIRING — Senior Community Manager\n\n🏢 B2B SaaS startup · 15 people · Paris / Remote\n\n📌 Responsibilities:\n→ Manage our LinkedIn & Twitter/X communities\n→ Create educational content (posts, threads, videos)\n→ Handle creator partnerships\n\n💶 $38–45K · Full remote · Health insurance + equity\n\n📩 Send your portfolio + 3 posts you're proud of in DM 👇`, user:'u_james', plan:'pro', likes:44, comments:58, shares:31},

  {type:'pub', text:`🎙️ PODCAST COLLAB — Looking for creator guests\n\nI host "Build & Grow" — a podcast on digital entrepreneurship\n\n👥 12,000 listens/month · Spotify + Apple Podcasts\n\nLooking for founders who can share:\n• A concrete growth strategy\n• A failure and what they learned\n• Behind-the-scenes of their business\n\nRecorded on video call · 45 min\n📩 DM \"PODCAST\" if interested 🎧`, user:'u_ben', plan:'starter', likes:78, comments:52, shares:44},

  // ─── FLASH OFFERS / OPPORTUNITIES ───
  {type:'pub', text:`⚡ FREE LANDING PAGE AUDIT (48h turnaround)\n\n10 spots this month.\n\nYou get:\n→ The 5 things driving visitors away\n→ Concrete copywriting recommendations\n→ Benchmark of 3 competitors in your niche\n\n$0 · No commitment\n\nWhy free? To show you the value before proposing anything.\n\n📩 Comment \"AUDIT\" and I'll reach out today 👇`, user:'u_clara', plan:'pro', likes:187, comments:214, shares:88},

  {type:'pub', text:`🔖 FOR SALE — Turnkey e-commerce store\n\nNiche: SPORTS ACCESSORIES\n\n📊 Numbers:\n• 8 months active\n• Total revenue: $31,000\n• Net margin: ~38%\n• Traffic: 4,200 visits/month (70% organic SEO)\n\n📦 Includes: domain + stock + suppliers + email list (1,400 contacts) + ad templates\n\n💶 Asking price: $12,000 negotiable\n\nFull file available under NDA. Serious inquiries only 🤝`, user:'u_sara', plan:'starter', likes:143, comments:67, shares:52},

]

// ── SHOWCASE POOL ──
const FAKE_SHOWCASE_POOL = [
  {
    name:'ContentPro', hook:`Create once. Post everywhere.`,
    desc:`ContentPro analyzes your source content (article, voice note, raw video) and automatically generates optimized posts for TikTok, Instagram Reels, LinkedIn, Twitter/X and YouTube Shorts — with the right hashtags, formats and lengths for each platform. No more hours of manual reformatting. Our users save an average of 8h/week and multiply their reach by 5x from the first month.`,
    cat:'saas', type:'SAAS', emoji:'📝', color:'linear-gradient(135deg,#6366f1,#8b5cf6)',
    url:'https://contentpro.app', votes:127, followers:2840, likes:341, clicks:5200,
    user:'u_alex', plan:'pro', tags:['AI','Content','SaaS','Automation'], badge:'🏆 TRENDING'
  },
  {
    name:'UIKit Pro', hook:`Design faster. Ship sooner.`,
    desc:`400+ Figma components ready to use: buttons, forms, modals, tables, cards, navigation, full dashboards. Everything is built dark mode native, responsive mobile-first and pixel-perfect. Used by 2,000+ designers and developers in 40 countries. Every component is documented, properly named and organized in auto-layout to drop into any project in 2 clicks.`,
    cat:'site', type:'SITE', emoji:'🎨', color:'linear-gradient(135deg,#10b981,#06b6d4)',
    url:'https://uikitpro.design', votes:94, followers:1920, likes:278, clicks:3800,
    user:'u_lena', plan:'starter', tags:['Design','Figma','UI','Components']
  },
  {
    name:'DropMaster', hook:`Your first $5K month starts here.`,
    desc:`The most complete dropshipping system on the market: 200+ validated suppliers with under 7-day delivery, 50 high-converting Meta Ads templates, ready-to-copy post-purchase email sequences, and the exact method to identify a winning product in under 30 minutes. Includes lifetime access to the private community (3,100 active members) and monthly product trend updates.`,
    cat:'ecommerce', type:'ECOMMERCE', emoji:'🛍️', color:'linear-gradient(135deg,#f59e0b,#ef4444)',
    url:'https://dropmaster.io', votes:83, followers:3100, likes:512, clicks:7400,
    user:'u_marc', plan:'elite', tags:['Ecommerce','Dropshipping','Meta Ads','Shopify'], badge:'🔥 HOT'
  },
  {
    name:'TaskFlow', hook:`Build more. Think less.`,
    desc:`TaskFlow is the task manager built specifically for solopreneurs and solo founders: zero bloat, zero meetings, zero unnecessary complexity. Drop in your tasks, set your deadlines, ship. Clean interface available on iOS, Android and desktop. Instant cross-device sync, full offline mode, and smart reminders that learn your work habits over time.`,
    cat:'app', type:'APP', emoji:'✅', color:'linear-gradient(135deg,#3b82f6,#6366f1)',
    url:'https://taskflow.app', votes:71, followers:980, likes:189, clicks:2100,
    user:'u_alex', plan:'pro', tags:['Productivity','App','Solopreneur','Focus']
  },
  {
    name:'LeadPulse', hook:`Close more deals in less time.`,
    desc:`The CRM built for freelancers who want to sell more without spending their day on admin. Create a visual drag & drop pipeline in 5 minutes, send proposals directly from the interface, track follow-ups automatically and get alerts when a client hasn't responded in 3 days. Real-time revenue dashboard with MRR, active pipeline and conversion rate. No onboarding needed — up and running in 15 minutes.`,
    cat:'saas', type:'SAAS', emoji:'📊', color:'linear-gradient(135deg,#0ea5e9,#10b981)',
    url:'https://leadpulse.co', votes:65, followers:740, likes:143, clicks:1900,
    user:'u_lucas', plan:'pro', tags:['CRM','Sales','Freelance','Pipeline']
  },
  {
    name:'ViralHooks', hook:`Stop the scroll. Every time.`,
    desc:`A library of 500+ proven TikTok hooks, sorted by niche (business, lifestyle, fitness, finance, tech) and by goal (sell, inform, entertain, engage). Each hook comes with a real example video that hit 500K+ views, an analysis of why it worked, and an adaptable variant for your content. Updated weekly with the latest viral formats. Average result: +340% views in the first 30 days.`,
    cat:'tiktok', type:'TIKTOK', emoji:'🎵', color:'linear-gradient(135deg,#d946ef,#a855f7)',
    url:'https://viralhooks.co', votes:159, followers:8200, likes:1240, clicks:14500,
    user:'u_sara', plan:'starter', tags:['TikTok','Hooks','Viral','Content'], badge:'⚡ VIRAL'
  },
  {
    name:'RemoteJobs.fyi', hook:`Work from anywhere.`,
    desc:`The most active remote job board for creatives and tech workers: 200+ new listings every week, hand-filtered to remove scams and fake remote positions. Roles in design, dev, marketing, copywriting and support. Personalized email alerts by skill and salary range. 100% free for candidates. Hirers post from 45 different countries — 40% offer salaries in hard currencies (USD, GBP, CHF).`,
    cat:'site', type:'SITE', emoji:'🌍', color:'linear-gradient(135deg,#14b8a6,#0ea5e9)',
    url:'https://remotejobs.fyi', votes:48, followers:560, likes:98, clicks:1200,
    user:'u_tom', plan:'elite', tags:['Jobs','Remote','Career','Design']
  },
  {
    name:'GrowthOS', hook:`Systematize your growth.`,
    desc:`GrowthOS is a full marketing OS on Notion: 12 operational growth frameworks (AARRR, ICE scoring, content pillar, newsletter flywheel), 30+ campaign templates, a weekly metrics review ritual, and a growth idea prioritization system. Built for founders and marketers who want to stop improvising and build a repeatable growth machine — even with just 5 hours a week available.`,
    cat:'saas', type:'SAAS', emoji:'📈', color:'linear-gradient(135deg,#84cc16,#10b981)',
    url:'https://growthos.co', votes:37, followers:430, likes:76, clicks:880,
    user:'u_clara', plan:'pro', tags:['Marketing','Notion','Growth','Frameworks']
  },
  {
    name:'PixelPerfect', hook:`Inspect any design in 1 click.`,
    desc:`The Chrome extension every designer and developer needs: hover over any element on any website and instantly get its margins, paddings, exact colors (HEX, RGB, HSL), fonts, border-radius and box-shadows. Export values as CSS or design tokens in one click. Works on all sites including complex CSS frameworks. Perfect for inspiration, competitive audits, or rebuilding a component you spotted in the wild.`,
    cat:'app', type:'APP', emoji:'🔍', color:'linear-gradient(135deg,#f97316,#ef4444)',
    url:'https://pixelperfect.app', votes:29, followers:310, likes:54, clicks:620,
    user:'u_lena', plan:'free', tags:['Design','Chrome','Dev','CSS']
  },
  {
    name:'SocialProof.io', hook:`Turn visitors into buyers.`,
    desc:`Display real-time social proof notifications on your website: recent purchases, signups, customer reviews, live visitor counters. Every notification is fully customizable (color, position, duration, message) and can be targeted by page or segment. Integrates in 1 line of code on Shopify, WordPress or Webflow. Our customers see an average of +23% conversion rate and -18% cart abandonment within the first two weeks.`,
    cat:'saas', type:'SAAS', emoji:'⭐', color:'linear-gradient(135deg,#fbbf24,#f59e0b)',
    url:'https://socialproof.io', votes:52, followers:890, likes:167, clicks:2300,
    user:'u_sofia', plan:'elite', tags:['Conversion','Social Proof','SaaS','E-commerce']
  },
  {
    name:'MailZen', hook:`Email marketing made simple.`,
    desc:`MailZen is the email tool built for creators, freelancers and small shops who want to send professional campaigns without drowning in Mailchimp complexity. Visual drag & drop editor, 3-click automations (welcome, cart abandon, re-engagement), behavioral segmentation, and native GDPR compliance. Support 7 days a week. Hosted 100% in Europe. Free up to 500 contacts.`,
    cat:'saas', type:'SAAS', emoji:'📧', color:'linear-gradient(135deg,#22c55e,#0ea5e9)',
    url:'https://mailzen.fr', votes:61, followers:1100, likes:198, clicks:2800,
    user:'u_sofia', plan:'elite', tags:['Email','Marketing','GDPR','Automation']
  },
  {
    name:'FaceWrite AI', hook:`One photo. Perfect caption.`,
    desc:`Take a photo, FaceWrite generates in 3 seconds an Instagram caption, a TikTok hook and a LinkedIn post perfectly adapted to your tone and niche. The AI analyzes the image, detects the context, and produces 3 variants per platform — from casual to professional. Works in English, French and Spanish. Used by 4,000+ content creators who save an average of 45 minutes per post.`,
    cat:'app', type:'APP IA', emoji:'🤖', color:'linear-gradient(135deg,#a855f7,#3b82f6)',
    url:'https://facewrite.app', votes:184, followers:5200, likes:876, clicks:11200,
    user:'u_alex', plan:'pro', tags:['AI','Captions','Creators','Social Media'], badge:'🚀 NEW'
  },
  {
    name:'DropSchool', hook:`From $0 to $5K/month in 90 days.`,
    desc:`The most complete dropshipping course on the market: 120 HD videos across 8 progressive modules, from building your Shopify store to scaling with Meta Ads. Included: list of 80 verified suppliers, pack of 40 high-converting video ads, lifetime access to the private Discord community (3,800 members), and 4 live coaching sessions per month. 73% of active students surpass $2K/month before completing the course.`,
    cat:'ecommerce', type:'COURSE', emoji:'📦', color:'linear-gradient(135deg,#f59e0b,#ef4444)',
    url:'https://dropschool.fr', votes:112, followers:3800, likes:634, clicks:9100,
    user:'u_marc', plan:'elite', tags:['Dropshipping','Course','Shopify','Meta Ads'], badge:'🔥 TOP'
  },
  {
    name:'ProNotion Pack', hook:`Your life system in one click.`,
    desc:`8 carefully crafted and interconnected Notion templates: pro & personal life dashboard, quarterly OKR system, client CRM with pipeline, freelance revenue tracker with auto charts, resource library, structured daily journal, content planner, and a market intelligence workspace. Everything is documented with setup videos. Compatible with free Notion. 1,200+ entrepreneurs use it daily. Updated every quarter.`,
    cat:'saas', type:'TEMPLATE', emoji:'📊', color:'linear-gradient(135deg,#6366f1,#a855f7)',
    url:'https://pronotion.gumroad.com', votes:78, followers:2100, likes:412, clicks:5600,
    user:'u_lucas', plan:'pro', tags:['Notion','Template','Productivity','System']
  },
  {
    name:'LeadTrack Pro', hook:`Close more. Admin less.`,
    desc:`LeadTrack Pro is the minimal CRM for freelancers who spend too much time chasing follow-ups manually. Visual drag & drop pipeline, quotes created in 2 minutes directly in the interface, automatic reminders if a prospect goes cold, and integrated e-signature. Real-time revenue dashboard with MRR, closing rate and average deal value. Native integrations with Stripe, Calendly and Gmail. Free up to 10 active clients.`,
    cat:'saas', type:'SAAS', emoji:'📋', color:'linear-gradient(135deg,#0ea5e9,#6366f1)',
    url:'https://leadtrack.pro', votes:55, followers:680, likes:124, clicks:1700,
    user:'u_noah', plan:'pro', tags:['CRM','Freelance','SaaS','Quotes']
  },
]
// ── AUTO-INJECTED ADS ──
const HOURLY_POSTS = [
  u => ({text:`🎯 SERVICE — Full SEO audit\n\n→ Technical analysis of your site\n→ Priority keyword research\n→ Detailed action report\n\n💶 $149 · Delivered in 72h\n📩 DM to book your slot`, user:u.id, likes:Math.floor(Math.random()*40+15), comments:Math.floor(Math.random()*12+3), shares:Math.floor(Math.random()*8+1)}),
  u => ({text:`📦 FOR SALE — Growth Hacking Course 2024\n\n50 tested techniques to grow your audience with zero ad budget.\n\n📌 Format: PDF + 4h of video\n💶 $67 — Instant access\n\n🔗 Link in bio`, user:u.id, likes:Math.floor(Math.random()*60+20), comments:Math.floor(Math.random()*18+4), shares:Math.floor(Math.random()*14+2)}),
  u => ({text:`🤝 LOOKING FOR A VISIBILITY PARTNERSHIP\n\nI run a newsletter with 6,500 subscribers (entrepreneurship niche).\nLooking for partners with a similar audience for cross-promotion.\n\nFormat: shoutout in my next edition (Thursday)\n📩 DM with your stats`, user:u.id, likes:Math.floor(Math.random()*35+10), comments:Math.floor(Math.random()*20+5), shares:Math.floor(Math.random()*6+1)}),
  u => ({text:`⚡ 48H FLASH OFFER — Full visual identity\n\n• Logo + variations\n• Brand guidelines\n• Social media templates (10 formats)\n\n💶 $350 instead of $650\nOnly 2 spots available\n\n📩 DM \"FLASH\" before midnight tonight`, user:u.id, likes:Math.floor(Math.random()*80+30), comments:Math.floor(Math.random()*25+8), shares:Math.floor(Math.random()*20+5)}),
  u => ({text:`🚀 OPEN BETA — AI competitive intelligence tool\n\nTrack your competitors automatically:\n→ Their new offers\n→ Their pricing changes\n→ Their viral content\n\n🎁 3 months free for the first 50 signups\n🔗 Link in bio`, user:u.id, likes:Math.floor(Math.random()*90+25), comments:Math.floor(Math.random()*30+10), shares:Math.floor(Math.random()*25+8)}),
  u => ({text:`💼 AVAILABLE FREELANCE — iOS/Android Developer\n\nSpecialty: cross-platform React Native apps\n\n🛠️ Stack: React Native · Firebase · Stripe · Push notifications\n⏱️ Average timeline: 6–10 weeks\n💶 Day rate: $500/day\n\n📌 Portfolio on request. DM to discuss your project 👋`, user:u.id, likes:Math.floor(Math.random()*45+10), comments:Math.floor(Math.random()*15+3), shares:Math.floor(Math.random()*8+1)}),
  u => ({text:`📣 HIRING — Paid Acquisition Manager (full-time)\n\n→ Budget managed: $50K/month (Meta + Google)\n→ Remote-first · Team of 8\n→ $35–42K · Revenue share\n\nProfile: 2+ years paid media experience, analytical mindset, self-starter.\n📩 CV + past results in DM`, user:u.id, likes:Math.floor(Math.random()*50+15), comments:Math.floor(Math.random()*40+10), shares:Math.floor(Math.random()*20+5)}),
  u => ({text:`🌟 ACQUISITION — Content site (personal finance niche)\n\nMetrics:\n📈 18,000 visits/month (SEO)\n💶 Revenue: $720/month (display + affiliate)\n📅 Site active for 2 years\n\nAsking price: $15,000 (20x MRR multiple)\n\nFull file available. Serious buyers only 🤝`, user:u.id, likes:Math.floor(Math.random()*55+20), comments:Math.floor(Math.random()*30+8), shares:Math.floor(Math.random()*12+3)}),
]
function _timeAgo(mins) {
  if(mins < 1) return 'just now';
  if(mins < 60) return `${mins}m ago`;
  if(mins < 1440) return `${Math.floor(mins/60)}h ago`;
  return `${Math.floor(mins/1440)}d ago`;
}

function _fakeUser(uid) {
  return FAKE_USERS.find(u=>u.id===uid)||FAKE_USERS[0];
}

// ── PHOTOS LOCALES PAR CATÉGORIE (dégradés CSS) ──
// ── REAL PHOTOS PER SHOWCASE PROJECT ──
// Using Unsplash (free, open license) - specific image per project
const SHOWCASE_PHOTOS = {
  'fsc_contentpro':    'https://images.unsplash.com/photo-1611162617213-7d7a39e9b1d7?w=500&h=220&fit=crop&auto=format', // social media / content creation
  'fsc_uikitpro':      'https://images.unsplash.com/photo-1558655146-d09347e92766?w=500&h=220&fit=crop&auto=format', // UI/design components
  'fsc_dropmaster':    'https://images.unsplash.com/photo-1556742049-0cfed4f6a45d?w=500&h=220&fit=crop&auto=format', // ecommerce / packages
  'fsc_taskflow':      'https://images.unsplash.com/photo-1484480974693-6ca0a78fb36b?w=500&h=220&fit=crop&auto=format', // productivity / tasks
  'fsc_leadpulse':     'https://images.unsplash.com/photo-1460925895917-afdab827c52f?w=500&h=220&fit=crop&auto=format', // CRM / sales dashboard
  'fsc_viralhooks':    'https://images.unsplash.com/photo-1611605698335-8b1569810432?w=500&h=220&fit=crop&auto=format', // TikTok / phone / social
  'fsc_remotejobs.fyi':'https://images.unsplash.com/photo-1521737852567-6949f3f9f2b5?w=500&h=220&fit=crop&auto=format', // remote work / laptop
  'fsc_growthos':      'https://images.unsplash.com/photo-1533750349088-cd871a92f312?w=500&h=220&fit=crop&auto=format', // growth / analytics chart
  'fsc_pixelperfect':  'https://images.unsplash.com/photo-1587440871875-191322ee64b0?w=500&h=220&fit=crop&auto=format', // design / chrome / screen
  'fsc_socialproof.io':'https://images.unsplash.com/photo-1551288049-bebda4e38f71?w=500&h=220&fit=crop&auto=format', // conversion / reviews / stats
  'fsc_mailzen':       'https://images.unsplash.com/photo-1596526131083-e8c633c948d2?w=500&h=220&fit=crop&auto=format', // email marketing
  'fsc_facewriteai':   'https://images.unsplash.com/photo-1677442135703-1787eea5ce01?w=500&h=220&fit=crop&auto=format', // AI / futuristic
  'fsc_dropschool':    'https://images.unsplash.com/photo-1607082348824-0a96f2a4b9da?w=500&h=220&fit=crop&auto=format', // ecommerce / shopping
  'fsc_pronotionpack': 'https://images.unsplash.com/photo-1611532736597-de2d4265fba3?w=500&h=220&fit=crop&auto=format', // notion / productivity system
  'fsc_leadtrackpro':  'https://images.unsplash.com/photo-1551434678-e076c223a692?w=500&h=220&fit=crop&auto=format', // startup / team / CRM
};

// Fallback photos by category
const UNSPLASH_BY_TYPE = {
  saas:      ['https://images.unsplash.com/photo-1551434678-e076c223a692?w=500&h=220&fit=crop&auto=format',
              'https://images.unsplash.com/photo-1460925895917-afdab827c52f?w=500&h=220&fit=crop&auto=format',
              'https://images.unsplash.com/photo-1504868584819-f8e8b4b6d7e3?w=500&h=220&fit=crop&auto=format'],
  app:       ['https://images.unsplash.com/photo-1512941937669-90a1b58e7e9c?w=500&h=220&fit=crop&auto=format',
              'https://images.unsplash.com/photo-1526406915894-7bcd65f60845?w=500&h=220&fit=crop&auto=format',
              'https://images.unsplash.com/photo-1565106430482-8f6e74349ca1?w=500&h=220&fit=crop&auto=format'],
  tiktok:    ['https://images.unsplash.com/photo-1611605698335-8b1569810432?w=500&h=220&fit=crop&auto=format',
              'https://images.unsplash.com/photo-1598550476439-6847785fcea6?w=500&h=220&fit=crop&auto=format',
              'https://images.unsplash.com/photo-1614680376573-df3480f0c6ff?w=500&h=220&fit=crop&auto=format'],
  ecommerce: ['https://images.unsplash.com/photo-1556742049-0cfed4f6a45d?w=500&h=220&fit=crop&auto=format',
              'https://images.unsplash.com/photo-1607082348824-0a96f2a4b9da?w=500&h=220&fit=crop&auto=format',
              'https://images.unsplash.com/photo-1472851294608-062f824d29cc?w=500&h=220&fit=crop&auto=format'],
  site:      ['https://images.unsplash.com/photo-1547658719-da2b51169166?w=500&h=220&fit=crop&auto=format',
              'https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?w=500&h=220&fit=crop&auto=format',
              'https://images.unsplash.com/photo-1499951360447-b19be8fe80f5?w=500&h=220&fit=crop&auto=format'],
  design:    ['https://images.unsplash.com/photo-1558655146-d09347e92766?w=500&h=220&fit=crop&auto=format',
              'https://images.unsplash.com/photo-1561070791-2526d30994b5?w=500&h=220&fit=crop&auto=format',
              'https://images.unsplash.com/photo-1541462608143-67571c6738dd?w=500&h=220&fit=crop&auto=format'],
  default:   ['https://images.unsplash.com/photo-1517245386807-bb43f82c33c4?w=500&h=220&fit=crop&auto=format',
              'https://images.unsplash.com/photo-1522071820081-009f0129c71c?w=500&h=220&fit=crop&auto=format',
              'https://images.unsplash.com/photo-1497366216548-37526070297c?w=500&h=220&fit=crop&auto=format'],
};

const COVER_GRADIENTS = {}; // Not used anymore - real photos now

function getUnsplashPhoto(type, seed){
  const arr = UNSPLASH_BY_TYPE[(type||'').toLowerCase()] || UNSPLASH_BY_TYPE.default;
  return arr[Math.abs(seed||0) % arr.length];
}

function _buildFakePost(raw, minsAgo) {
  const u = _fakeUser(raw.user);
  // Photo Unsplash si le post a un projet avec type
  const photoSeed = minsAgo + (raw.projName||'').length;
  const mediaUrl = raw.projType ? getUnsplashPhoto(raw.projType, photoSeed) : null;
  return {
    id: 'fake_'+raw.user+'_'+Math.random().toString(36).slice(2),
    userId: raw.user,
    author: u.name,
    emoji: u.emoji,
    plan: raw.plan||u.plan,
    time: _timeAgo(minsAgo),
    text: raw.text,
    likes: raw.likes||0,
    comments: raw.comments||0,
    shares: raw.shares||0,
    postUrl: raw.url||null,
    projName: raw.projName||null,
    projEmoji: raw.projEmoji||null,
    projType: raw.projType||null,
    projDesc: raw.projDesc||null,
    mediaUrl: mediaUrl,
    mediaType: mediaUrl ? 'image/jpeg' : null,
    _fake: true,
    _minsAgo: minsAgo,
  };
}


function _buildFakeShowcase(raw) {
  const u = _fakeUser(raw.user);
  const seed = raw.name.length + raw.votes;
  return {
    id: 'fsc_'+raw.name.replace(/\s/g,'').toLowerCase(),
    name: raw.name,
    desc: raw.desc,
    cat: raw.cat,
    type: raw.cat.toUpperCase(),
    emoji: raw.emoji,
    color: raw.color,
    url: raw.url,
    votes: raw.votes,
    author: u.name,
    authorId: raw.user,
    plan: raw.plan||u.plan,
    tags: raw.tags||[],
    hook: raw.hook||'',
    badge: raw.badge||null,
    followers: raw.followers || Math.floor(Math.random()*500+50),
    likes: raw.likes || Math.floor(Math.random()*100+10),
    clicks: raw.clicks || Math.floor(Math.random()*1000+100),
    mediaUrl: SHOWCASE_PHOTOS['fsc_'+raw.name.replace(/\s/g,'').toLowerCase()] || getUnsplashPhoto(raw.cat, seed),
    _fake: true,
  };
}

function initFakeData() {
  // Build showcase
  showcaseData = FAKE_SHOWCASE_POOL.map(p => _buildFakeShowcase(p));

  // Build feed posts with realistic time offsets
  const now = Date.now();
  const timeSlots = [2,5,11,18,27,40,55,70,90,115,140,170,210,260,320,390,460,540,640,760,900,1080,1300,1560];
  feedPosts = FAKE_POSTS_POOL.map((raw, i) => _buildFakePost(raw, timeSlots[i]||i*45+2));
  feedPosts.sort((a,b) => a._minsAgo - b._minsAgo);
}

// Inject a new fake post every hour (simulates live activity)
function startHourlyFakeInjection() {
  function injectOne() {
    const u = FAKE_USERS[Math.floor(Math.random()*FAKE_USERS.length)];
    const tpl = HOURLY_POSTS[Math.floor(Math.random()*HOURLY_POSTS.length)];
    const raw = tpl(u);
    raw.plan = u.plan;
    const post = _buildFakePost(raw, 0);
    feedPosts.unshift(post);
    // Refresh feed if currently visible
    const feedPanel = document.getElementById('tab-feed');
    if(feedPanel && feedPanel.classList.contains('active')) {
      buildFeed();
      // Flash new post
      const card = document.getElementById('post-'+post.id);
      if(card){ card.style.animation='fadeUp 0.4s ease both'; }
    }
    // Show toast if app is visible
    if(currentUser) toast(`🔔 ${u.name} just posted something new!`);
  }
  // First injection after 3 min (feels natural), then every 60 min
  setTimeout(injectOne, 3*60*1000);
  setInterval(injectOne, 60*60*1000);
}

// No fake posts — only real publications (replaced by initFakeData above)
let feedPosts=[];

// Load feed from API at startup
// Fetch with timeout to avoid blocking if server doesn't respond
function fetchWithTimeout(url,opts={},ms=4000){
  const ctrl=new AbortController();
  const tid=setTimeout(()=>ctrl.abort(),ms);
  return fetch(url,{...opts,signal:ctrl.signal}).finally(()=>clearTimeout(tid));
}

async function loadPostsFromAPI(){
  // Always start with fake data so feed is never empty
  initFakeData();
  try{
    const r=await fetchWithTimeout('/api/posts');
    const apiPosts=await r.json();
    if(Array.isArray(apiPosts)&&apiPosts.length){
      feedPosts=[...apiPosts,...feedPosts];
    }
    try{
      const rs=await fetchWithTimeout('/api/projects');
      const apiProjects=await rs.json();
      if(Array.isArray(apiProjects)&&apiProjects.length){
        showcaseData=[...apiProjects,...showcaseData];
      }
    }catch(e2){}
  }catch(e){}
  buildFeed();
  buildShowcaseGrid('landing-showcase-grid');
  startHourlyFakeInjection();
}

function buildFeed(filter='all'){
  const el=document.getElementById('feed-list');
  if(!el)return;
  // Update trending
  const tw = document.getElementById('trending-widget-container');
  if(tw) tw.innerHTML = renderTrendingWidget();
  let data=[...feedPosts];
  if(filter==='following')data=data.filter(p=>currentUser?.following?.includes(p.userId)||p.userId===currentUser?.id);
  if(filter==='top')data=data.sort((a,b)=>b.likes-a.likes);
  else data.sort((a,b)=>(b._boosted?1:0)-(a._boosted?1:0));
  if(!data.length){el.innerHTML='<div style="text-align:center;padding:48px;color:var(--muted)">'+'No posts yet'+'</div>';return;}
  el.innerHTML=data.map(p=>{
    const plan=PLANS.find(pl=>pl.id===p.plan)||PLANS[0];
    const isMe=p.userId===currentUser?.email;
    const isElite=(p.plan||'free')==='elite';
    const timerHtml=p.timerEnd?`<span class="post-timer">⏱ <span class="post-timer-val" data-end="${p.timerEnd}">--:--</span></span>`:'';
    const actionClass=isElite?'btn-action elite-action':'btn-action';
    const likedByMe=p.myLike;
    const mediaHtml=p.mediaUrl?`${p.mediaType&&p.mediaType.startsWith('video')?`<video class="post-media-video" controls src="${p.mediaUrl}"></video>`:`<img class="post-media" src="${p.mediaUrl}" alt="media" onclick="window.open('${p.mediaUrl}','_blank')" style="cursor:zoom-in"/>`}`:'';
    return `
    <div class="post-card" id="post-${p.id}" data-pid="${p.id}">
      <div class="post-header">
        <div class="post-ava" style="background:${getAvatarColor(p.userId)}" onclick="viewUserProfile('${p.userId}')">${(p.author||'?')[0].toUpperCase()}</div>
        <div class="post-meta">
          <div class="post-author" onclick="viewUserProfile('${p.userId}')">${isElite?'<span class="badge-elite-gold">🏆</span> ':''} ${p.author}</div>
          <div class="post-info"><span class="chat-msg-plan-badge plan-${p.plan||'free'}">${(p.plan||'FREE').toUpperCase()}</span> · ${p.time} ${timerHtml}</div>
        </div>
        ${!isMe?`<button class="btn-dm-small" onclick="openDMToUser('${p.userId}','${p.author}')" title="DM">💬</button>`:''}
        <button class="btn-report" onclick="openReport('${p.userId}','${p.author}')" title="Report">⚑</button>
      </div>
      <div class="post-content">${escHtml(p.text)}</div>
      ${mediaHtml}
      ${p.postUrl?`<a class="post-url-card" href="${p.postUrl}" target="_blank" rel="noopener noreferrer">
        <span class="post-url-icon">🔗</span>
        <span class="post-url-text">${p.postUrl.replace(/^https?:\/\//,'').replace(/\/$/,'')}</span>
        <span class="post-url-arrow">↗</span>
      </a>`:''}
      ${p.projName?`<div class="post-project" onclick="void(0)">
        <div class="post-proj-icon">${getTypeIcon(p.projType?.toLowerCase()||'default')}</div>
        <div><div class="post-proj-name">${p.projName}</div><div class="post-proj-cat">${p.projType||'pub'}</div>${p.projDesc?`<div class="post-proj-desc">${p.projDesc}</div>`:''}</div>
      </div>`:''}
      <div class="post-actions">
        <button class="${actionClass} ${likedByMe?'like-active':''}" onclick="likePost('${p.id}',this)"><svg width="13" height="13" viewBox="0 0 24 24" fill="${likedByMe?'currentColor':'none'}" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"/></svg> <span class="like-count">${p.likes||0}</span></button>
        <button class="${actionClass}" onclick="openComments('${p.id}')"><svg width="13" height="13" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"/></svg> <span class="comment-count">${p.comments||0}</span></button>
        <button class="${actionClass}" onclick="sharePost('${p.id}',this)"><svg width="13" height="13" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="18" cy="5" r="3"/><circle cx="6" cy="12" r="3"/><circle cx="18" cy="19" r="3"/><line x1="8.59" y1="13.51" x2="15.42" y2="17.49"/><line x1="15.41" y1="6.51" x2="8.59" y2="10.49"/></svg> <span class="share-count">${p.shares||0}</span></button>
        <button class="${actionClass} ${p.mySave?'save-active':''}" onclick="savePost('${p.id}',this)"><svg width="13" height="13" viewBox="0 0 24 24" fill="${p.mySave?'currentColor':'none'}" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M19 21l-7-5-7 5V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2z"/></svg></button>
        ${isMe?`<button class="${actionClass}" onclick="deletePost('${p.id}')" style="margin-left:auto;color:#f87171"><svg width="13" height="13" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="3 6 5 6 21 6"/><path d="M19 6l-1 14a2 2 0 0 1-2 2H8a2 2 0 0 1-2-2L5 6"/><path d="M10 11v6"/><path d="M14 11v6"/><path d="M9 6V4h6v2"/></svg></button><button class="${actionClass}" onclick="openBoostMyPost('${p.id}')" style="color:var(--gold)" title="Boost"><svg width="13" height="13" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M13 2L3 14h9l-1 8 10-12h-9l1-8z"/></svg> Boost</button>`:''}
      </div>
      <div class="reactions-row">
        ${buildReactionsHTML(p)}
      </div>
    </div>`;
  }).join('');
  updateTimers();
}

function switchFeed(filter,el){
  document.querySelectorAll('.feed-tab').forEach(b=>b.classList.remove('active'));
  el.classList.add('active');
  buildFeed(filter);
}

async function likePost(id,btn){
  const p=feedPosts.find(p=>p.id===id);
  if(!p)return;
  p.myLike=!p.myLike;
  p.likes+=p.myLike?1:-1;
  btn.classList.toggle('like-active',p.myLike);
  btn.classList.remove('active');
  // Burst animation
  btn.classList.add('like-burst');
  setTimeout(()=>btn.classList.remove('like-burst'),400);
  const svg=btn.querySelector('svg');
  if(svg)svg.setAttribute('fill',p.myLike?'currentColor':'none');
  const cnt=btn.querySelector('.like-count');
  if(cnt)cnt.textContent=p.likes;
  if(p.myLike && currentUser){
    currentUser._todayLikes=(currentUser._todayLikes||0)+1;
    localStorage.setItem('viralboost_user',JSON.stringify(currentUser));
  }
  try{fetch('/api/posts/'+id+'/like',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({userId:currentUser?.email||'anon'})});}catch(e){}
}

async function sharePost(id,btn){
  navigator.clipboard.writeText(window.location.origin+'#post-'+id).then(()=>toast('🔗 Link copied!'));
  const p=feedPosts.find(p=>p.id===id);
  if(p){p.shares=(p.shares||0)+1;const cnt=btn?.querySelector('.share-count');if(cnt)cnt.textContent=p.shares;}
  try{fetch('/api/posts/'+id+'/share',{method:'POST'});}catch(e){}
}

function openComments(id){
  toast('💬 Comments — coming soon!');
}

function deletePost(id){
  feedPosts=feedPosts.filter(p=>p.id!==id);
  document.getElementById('post-'+id)?.remove();
}

// ── REACTION SYSTEM ──
const REACTIONS_FREE = [
  {type:'fire',   emoji:'🔥', label:'Feu',     color:'#f97316'},
  {type:'bulb',   emoji:'💡', label:'Idea',    color:'#facc15'},
  {type:'money',  emoji:'💸', label:'Cash',    color:'#4ade80'},
  {type:'clap',   emoji:'👏', label:'Bravo',   color:'#fb923c'},
];
const REACTIONS_PREMIUM = [
  {type:'rocket', emoji:'🚀', label:'Takeoff', color:'#818cf8', plan:'starter'},
  {type:'crown',  emoji:'👑', label:'Roi',      color:'#ffd700', plan:'pro'},
  {type:'gem',    emoji:'💎', label:'Gem',      color:'#22d3ee', plan:'pro'},
  {type:'eyes',   emoji:'👀', label:'Watching', color:'#a78bfa', plan:'elite'},
  {type:'zap',    emoji:'⚡', label:'Boost',   color:'#86efac', plan:'starter'},
  {type:'star',   emoji:'🌟', label:'Star',    color:'#ffd700', plan:'elite'},
];
const ALL_REACTIONS = [...REACTIONS_FREE, ...REACTIONS_PREMIUM];

function buildReactionsHTML(p){
  if(!p.reactions) p.reactions = {};
  const plan = currentUser?.plan||'free';
  const planOrder = {free:0, starter:1, pro:2, elite:3, legend:4, vip:5};
  const userLevel = planOrder[plan]||0;

  return ALL_REACTIONS.map(r => {
    const count = p.reactions[r.type]||0;
    const active = p['myReact_'+r.type] ? 'active-'+r.type : '';
    const isPremium = REACTIONS_PREMIUM.find(x=>x.type===r.type);
    const reqLevel = isPremium ? planOrder[isPremium.plan]||0 : 0;
    const locked = isPremium && userLevel < reqLevel;
    if(locked){
      return `<button class="react-btn premium-lock" onclick="reactLocked('${isPremium.plan}')">
        ${r.emoji} ${count>0?`<span class="react-count" style="color:var(--muted)">${count}</span>`:''}
        <span class="react-premium-tip">${r.label} · ${isPremium.plan.toUpperCase()} required</span>
      </button>`;
    }
    return `<button class="react-btn ${active}" onclick="toggleReaction('${p.id}','${r.type}',this)" style="${active?'border-color:'+r.color+';color:'+r.color:''}">
      ${r.emoji} <span class="react-count">${count||0}</span>
    </button>`;
  }).join('');
}

function toggleReaction(postId, type, btn){
  const p = feedPosts.find(x=>x.id===postId);
  if(!p) return;
  if(!p.reactions) p.reactions = {};
  const key = 'myReact_'+type;
  const was = p[key];
  p[key] = !was;
  p.reactions[type] = Math.max(0,(p.reactions[type]||0)+(was?-1:1));
  const r = ALL_REACTIONS.find(x=>x.type===type);
  const activeClass = 'active-'+type;
  btn.classList.toggle(activeClass, !was);
  if(!was){ btn.style.borderColor=r?.color||''; btn.style.color=r?.color||''; }
  else { btn.style.borderColor=''; btn.style.color=''; }
  btn.querySelector('.react-count').textContent = p.reactions[type]||0;
  if(!was && currentUser){
    currentUser._todayReacts = (currentUser._todayReacts||0)+1;
    localStorage.setItem('viralboost_user',JSON.stringify(currentUser));
  }
}

function reactLocked(plan){
  toast(`🔒 Reaction ${plan.toUpperCase()} — Upgrade to unlock!`, 'error');
  setTimeout(()=>openModal('pricing-modal'),800);
}

// ── MEDIA UPLOAD ──
async function handleMediaUpload(input){
  const file=input.files[0];
  if(!file)return;
  const preview=document.getElementById('feed-media-preview');
  preview.style.display='block';
  preview.innerHTML='<div class="media-preview-item">⏳ Upload in progress...</div>';
  const fd=new FormData();
  fd.append('file',file);
  try{
    const r=await fetch('/api/upload',{method:'POST',body:fd});
    const d=await r.json();
    pendingMediaUrl=d.url;
    const isVideo=file.type.startsWith('video');
    preview.innerHTML=`<div class="media-preview-item">${isVideo?`<video src="${d.url}" style="max-width:100px;max-height:70px;border-radius:4px"></video>`:`<img src="${d.url}" style="max-width:100px;max-height:70px;border-radius:4px;object-fit:cover"/>`} <span style="flex:1">${file.name}</span> <span class="remove-media" onclick="pendingMediaUrl=null;document.getElementById('feed-media-preview').innerHTML='';document.getElementById('feed-media-preview').style.display='none'">✕</span></div>`;
  }catch(e){preview.innerHTML='<div class="media-preview-item" style="color:#f87171">Error upload</div>';pendingMediaUrl=null;}
}

async function handleLandingMediaUpload(input){
  const file=input.files[0];
  if(!file)return;
  const preview=document.getElementById('pl-media-preview');
  preview.innerHTML='<div class="media-preview-item">⏳ Upload in progress...</div>';
  const fd=new FormData();fd.append('file',file);
  try{
    const r=await fetch('/api/upload',{method:'POST',body:fd});
    const d=await r.json();
    pendingLandingMediaUrl=d.url;
    preview.innerHTML=`<div class="media-preview-item"><img src="${d.url}" style="max-width:100px;max-height:60px;border-radius:4px;object-fit:cover"/> <span style="flex:1">${file.name}</span></div>`;
  }catch(e){preview.innerHTML='<div class="media-preview-item" style="color:#f87171">Error upload</div>';}
}

async function handleGroupBgUpload(input){
  const file=input.files[0];if(!file)return;
  const fd=new FormData();fd.append('file',file);
  try{const r=await fetch('/api/upload',{method:'POST',body:fd});const d=await r.json();groupBgUrl=d.url;document.getElementById('grp-bg-preview').innerHTML=`<img src="${d.url}" style="width:100%;height:80px;object-fit:cover;border-radius:6px;margin-top:6px"/>`;}catch(e){}
}

async function handleGroupSettingsBg(input){
  const file=input.files[0];if(!file)return;
  const fd=new FormData();fd.append('file',file);
  try{const r=await fetch('/api/upload',{method:'POST',body:fd});const d=await r.json();groupSettingsBgUrl=d.url;}catch(e){}
}

async function handleGroupChatFeede(input){
  const file=input.files[0];if(!file)return;
  const fd=new FormData();fd.append('file',file);
  try{
    const r=await fetch('/api/upload',{method:'POST',body:fd});
    const d=await r.json();
    // Send as message with media
    const msg={text:'',mediaUrl:d.url,mediaType:file.type,userId:currentUser.email,author:currentUser.name,plan:currentUser.plan||'free',timestamp:new Date().toISOString()};
    await fetch('/api/groups/'+currentGroupId+'/messages',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(msg)});
    loadGroupMessages(currentGroupId);
  }catch(e){}
}

// ── PUBLISH LANDING AD (before account) ──
async function publishLandingAd(){
  const title=document.getElementById('pl-title').value.trim();
  const text=document.getElementById('pl-text').value.trim();
  if(!title||!text){toast('Please fill in the title and message.');return;}
  const type=document.getElementById('pl-type').value;
  const url=document.getElementById('pl-url').value.trim();
  const post={
    id:'p'+Date.now(),userId:'landing_'+Date.now(),author:'Visitur',
    emoji:'📢',plan:'free',text:title+'\n\n'+text,projName:title,projType:type,
    projEmoji:getTypeEmoji(type),projDesc:text.slice(0,80),projUrl:url,
    mediaUrl:pendingLandingMediaUrl,mediaType:pendingLandingMediaUrl?.match(/\.(mp4|webm|mov)/i)?'video/mp4':'image/jpeg',
    time:'Just now',likes:0,comments:0,shares:0,timerEnd:Date.now()+3600000
  };
  feedPosts.unshift(post);
  pendingLandingMediaUrl=null;
  closeModal('publish-landing-modal');
  try{await fetch('/api/posts',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(post)});}catch(e){}
  toast('📢 Ad published! Create an account to manage your ads.');
  setTimeout(()=>openModal('signup-modal'),2000);
}

function openPublishLanding(){
  document.getElementById('pl-title').value='';
  document.getElementById('pl-text').value='';
  document.getElementById('pl-media-preview').innerHTML='';
  pendingLandingMediaUrl=null;
  openModal('publish-landing-modal');
}

// ── PUBLISH POST ──
let pubHourCount=0, pubHourReset=0;
function toggleUrlField(){
  const wrap=document.getElementById('pub-url-wrap');
  const trigger=document.getElementById('pub-url-trigger');
  if(wrap){wrap.style.display='block';if(trigger)trigger.style.display='none';document.getElementById('feed-url')?.focus();}
}
function closeUrlField(){
  const wrap=document.getElementById('pub-url-wrap');
  const trigger=document.getElementById('pub-url-trigger');
  if(wrap){wrap.style.display='none';const inp=document.getElementById('feed-url');if(inp)inp.value='';}
  if(trigger)trigger.style.display='inline-flex';
}

function selectPubType(el, type){
  document.querySelectorAll('.pub-type-pill').forEach(p=>p.classList.remove('active'));
  el.classList.add('active');
  const sel=document.getElementById('feed-proj-type');
  if(sel) sel.value=type;
  const projWrap=document.getElementById('pub-proj-wrap');
  if(projWrap) projWrap.style.display=(type&&type!=='')?'block':'none';
}
function updateCharCount(el){
  const count=el.value.length;
  const display=document.getElementById('pub-char-count');
  if(display){
    display.style.opacity=count>0?'1':'0';
    display.textContent=count+'/500';
    display.style.color=count>450?'#f87171':count>350?'var(--gold)':'var(--muted2)';
  }
}
function autoGrowTA(el){
  el.style.height='auto';
  el.style.height=el.scrollHeight+'px';
}
// Show pills on textarea focus
document.addEventListener('DOMContentLoaded',function(){
  const ta=document.getElementById('feed-text');
  const row=document.getElementById('pub-type-row');
  if(ta&&row){
    ta.addEventListener('focus',function(){row.classList.add('visible');});
  }
});

function publishPost(){
  if(currentUser&&currentUser.isDemo){openDemoSignupModal();return;}
  if(!currentUser||currentUser.isDemo){openDemoSignupModal();return;}
  const text=document.getElementById('feed-text')?.value.trim()||'';
  if(!text){toast(t('toast_write'));return;}

  // Check limits
  const plan=PLANS.find(p=>p.id===currentUser.plan)||PLANS[0];
  const now=Date.now();
  if(currentUser.plan==='free'){
    if(now-pubHourReset>3600000){pubHourCount=0;pubHourReset=now;}
    if(pubHourCount>=1){toast(t('toast_limit_free'));return;}
  } else if(plan.limits.pubsPerDay){
    const today=new Date().toDateString();
    const key='vb_pubs_'+today;
    const count=parseInt(localStorage.getItem(key)||'0');
    if(count>=plan.limits.pubsPerDay){toast(t('toast_limit_day'));return;}
    localStorage.setItem(key,count+1);
  }

  const projName=document.getElementById('feed-proj-name')?.value.trim()||'';
  const projType=document.getElementById('feed-proj-type')?.value||'';
  let postUrl=document.getElementById('feed-url')?.value.trim()||'';
  // Add https:// if missing
  if(postUrl && !postUrl.startsWith('http')) postUrl='https://'+postUrl;
  const timerEnd=currentUser.plan==='free'?Date.now()+3600000:null;

  const post={
    id:'p'+Date.now(),userId:currentUser.email,author:currentUser.name,
    emoji:currentUser.avatar||'🙂',plan:currentUser.plan||'free',
    text,projName,projType,projEmoji:getTypeEmoji(projType),projDesc:'',
    postUrl,
    mediaUrl:pendingMediaUrl,mediaType:pendingMediaUrl?'image':'',
    time:'Just now',likes:0,comments:0,shares:0,myLike:false,timerEnd
  };
  feedPosts.unshift(post);
  pubHourCount++;
  // Tracker for badges
  currentUser._postCount = (currentUser._postCount||0) + 1;
  currentUser._todayPosts = (currentUser._todayPosts||0) + 1;
  // Tracker médias for missions
  if(pendingMediaUrl){
    const isVideo = post.mediaType && post.mediaType.startsWith('video');
    const isFeed = pendingMediaUrl && /\.(pdf|doc|docx|zip|txt|ppt|xls)/i.test(pendingMediaUrl);
    if(isVideo) currentUser._todayVideoPosts = (currentUser._todayVideoPosts||0)+1;
    else if(isFeed) currentUser._todayFeedePosts = (currentUser._todayFeedePosts||0)+1;
    else currentUser._todayMediaPosts = (currentUser._todayMediaPosts||0)+1;
  }
  localStorage.setItem('viralboost_user', JSON.stringify(currentUser));
  checkNewBadges();
  pendingMediaUrl=null;
  if(document.getElementById('feed-text')) document.getElementById('feed-text').value='';
  if(document.getElementById('feed-proj-name')) document.getElementById('feed-proj-name').value='';
  closeUrlField();
  document.getElementById('feed-media-preview').innerHTML='';
  document.getElementById('feed-media-preview').style.display='none';
  buildFeed();
  toast(t('toast_published'));
  // Sync API
  try{fetch('/api/posts',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(post)});}catch(e){}
  if(timerEnd)setTimeout(()=>{feedPosts=feedPosts.filter(p=>p.id!==post.id);buildFeed();},3600000);
}

async function handlePubMediaUpload(input){
  const file = input.files[0]; if(!file) return;
  const preview = document.getElementById('pub-media-preview');
  preview.innerHTML = '<div class="media-preview-item">⏳ Upload in progress...</div>';
  const fd = new FormData(); fd.append('file', file);
  try{
    const r = await fetch('/api/upload',{method:'POST',body:fd});
    const d = await r.json(); pendingPubMediaUrl = d.url;
    // Update showcase preview with image
    const imgWrap = document.getElementById('pub-preview-img-wrap');
    const imgEl = document.getElementById('pub-preview-img');
    if(imgWrap && imgEl){ imgEl.src = d.url; imgWrap.style.display = 'block'; }
    preview.innerHTML = `<div class="media-preview-item" style="display:flex;align-items:center;gap:8px;background:var(--s2);border:1px solid var(--border2);border-radius:8px;padding:8px 12px">
      <img src="${d.url}" style="width:48px;height:36px;border-radius:4px;object-fit:cover"/>
      <span style="font-size:12px;color:var(--g4)">✅ ${file.name.slice(0,30)}</span>
      <button onclick="removePubMedia()" style="margin-left:auto;background:none;border:none;color:var(--muted);cursor:pointer;font-size:14px">✕</button>
    </div>`;
    updatePubCompletion();
  }catch(e){
    // Local preview fallback if no backend
    const url = URL.createObjectURL(file); pendingPubMediaUrl = url;
    const imgWrap = document.getElementById('pub-preview-img-wrap');
    const imgEl = document.getElementById('pub-preview-img');
    if(imgWrap && imgEl){ imgEl.src = url; imgWrap.style.display = 'block'; }
    preview.innerHTML = `<div class="media-preview-item" style="display:flex;align-items:center;gap:8px;background:var(--s2);border:1px solid var(--border2);border-radius:8px;padding:8px 12px">
      <img src="${url}" style="width:48px;height:36px;border-radius:4px;object-fit:cover"/>
      <span style="font-size:12px;color:var(--g4)">📎 ${file.name.slice(0,30)}</span>
      <button onclick="removePubMedia()" style="margin-left:auto;background:none;border:none;color:var(--muted);cursor:pointer;font-size:14px">✕</button>
    </div>`;
    updatePubCompletion();
  }
  // Make the drop zone clickable
  document.getElementById('pub-media-drop')?.addEventListener('click', ()=>document.getElementById('pub-media-input')?.click());
}
function removePubMedia(){
  pendingPubMediaUrl = null;
  document.getElementById('pub-media-preview').innerHTML = '';
  const imgWrap = document.getElementById('pub-preview-img-wrap');
  if(imgWrap) imgWrap.style.display = 'none';
  updatePubCompletion();
}

// ── PUBLISH PROJECT ──
function publishProject(){
  if(!currentUser||currentUser.isDemo){openDemoSignupModal();return;}
  const name = document.getElementById('pub-name')?.value.trim()||'';
  const desc = document.getElementById('pub-desc')?.value.trim()||'';
  if(!name || !desc){ toast('Fill in at least the name and description.', 'error'); return; }
  if(name.length < 4){ toast('The name is too short (4 characters min).', 'error'); return; }
  if(desc.length < 20){ toast('The description is too short (20 characters min).', 'error'); return; }

  const type = document.getElementById('pub-type')?.value||'';
  const emoji = document.getElementById('pub-emoji')?.value || getTypeEmoji(type);
  const url = document.getElementById('pub-url')?.value.trim() || '';
  const target = document.getElementById('pub-target')?.value.trim() || '';
  const hook = document.getElementById('pub-hook')?.value.trim() || '';
  const tags = (document.getElementById('pub-tags')?.value || '').split(',').map(t=>t.trim()).filter(Boolean).slice(0,5);
  const stage = document.getElementById('pub-stage')?.value || '';
  const collabNeed = document.getElementById('pub-collab-need')?.value || '';
  const plan = PLANS.find(p=>p.id===currentUser.plan)||PLANS[0];
  const colors = ['linear-gradient(135deg,#15803d,#22c55e)','linear-gradient(135deg,#166534,#4ade80)','linear-gradient(135deg,#14532d,#86efac)'];

  const proj = {
    id:'pub'+Date.now(), name, cat:type, type:typeName(type),
    desc: desc.slice(0,300), hook, emoji, url, target, tags, stage, collabNeed,
    color: colors[Math.floor(Math.random()*colors.length)],
    author: currentUser.name, authorId: currentUser.email,
    plan: currentUser.plan || 'free',
    votes: 0, mediaUrl: wizPhotoDataUrl || pendingPubMediaUrl,
    timerEnd: plan.limits.showcaseHours < 999999 ? Date.now() + plan.limits.showcaseHours*3600000 : null,
    createdAt: Date.now()
  };

  pendingPubMediaUrl = null;
  wizPhotoDataUrl = null;
  removeWizPhoto();
  document.getElementById('pub-media-preview').innerHTML = '';
  const imgWrap = document.getElementById('pub-preview-img-wrap');
  if(imgWrap) imgWrap.style.display = 'none';
  showcaseData.unshift(proj);
  buildShowcaseGrid('app-showcase-grid');
  buildShowcaseGrid('landing-showcase-grid');

  // Reset form
  ['pub-name','pub-desc','pub-hook','pub-url','pub-target','pub-tags'].forEach(id => { const el=document.getElementById(id); if(el) el.value=''; });
  updatePubCompletion(); updateDescCount(); renderTagsPreview(); updateMobilePreview();
  // Reset wizard to step 1
  wizGoTo(1);

  // Badges & missions
  currentUser._postCount = (currentUser._postCount||0) + 1;
  currentUser._todayPosts = (currentUser._todayPosts||0) + 1;
  localStorage.setItem('viralboost_user', JSON.stringify(currentUser));
  checkNewBadges();

  // Save & sync
  const saved = JSON.parse(localStorage.getItem('vb_my_projects')||'[]');
  saved.unshift(proj); localStorage.setItem('vb_my_projects', JSON.stringify(saved));
  try{ fetch('/api/projects',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(proj)}); }catch(e){}

  // Confirmation with tip
  toast('🌐 Project published on Showcase! Share the link in chat to get your first votes 🚀');
}

async function generateBoostForProject(){
  const name=document.getElementById('pub-name')?.value.trim()||'My project';
  const desc=document.getElementById('pub-desc')?.value.trim()||'Project digital';
  const type=document.getElementById('pub-type')?.value||'';
  const target=document.getElementById('pub-target')?.value.trim()||'Grand public';
  const btn=document.getElementById('btn-pub-project');
  btn.disabled=true;
  const outBox=document.getElementById('pub-strategy');
  outBox.style.display='block';
  outBox.innerHTML='<div class="dots"><span></span><span></span><span></span></div>';
  try{
    const res=await fetch('/api/generate-boost',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({prompt:`You are a digital marketing expert. Generate a promotion strategy for:\n- Project: ${name} (${type})\n- Target: ${target}\n- Description: ${desc}\n\nProvide: TikTok hashtags, 2-week content calendar, 3 viral post ideas, 5 SEO keywords.`})});
    const data=await res.json();
    outBox.textContent=data.content;
  }catch(e){outBox.textContent='Connect the Render backend to generate AI strategies.';}
  btn.disabled=false;
}

// ── WORLD CHAT ──
let chatMsgsToday=parseInt(localStorage.getItem('vb_chat_today_'+new Date().toDateString())||'0');

function buildWorldChat(){
  const el=document.getElementById('world-chat-msgs');
  if(!el)return;
  const msgs=[...worldChatMsgs];
  if(!msgs.length){
    el.innerHTML='<div style="text-align:center;padding:32px;color:var(--muted);font-size:13px">Be the first to write in the chat! 👋</div>';
    return;
  }
  el.innerHTML=msgs.map(m=>`
    <div class="chat-msg-item">
      <div class="chat-msg-name">${m.name} <span class="chat-msg-plan-badge plan-${m.plan}">${m.plan.toUpperCase()}</span> <span style="font-family:'DM Mono',monospace;font-size:9px;color:var(--muted2);margin-left:auto">${m.time||''}</span></div>
      <div class="chat-msg-text">${escHtml(m.text)}</div>
    </div>`).join('');
  el.scrollTop=el.scrollHeight;
  // Update online count
  const onlineEl=document.getElementById('world-online-count');
  if(onlineEl)onlineEl.textContent=(12+Math.floor(Math.random()*8))+' online';
}

function sendWorldChat(){
  if(!currentUser||currentUser.isDemo){openDemoSignupModal();return;}
  const inp=document.getElementById('world-chat-in');
  const text=inp.value.trim();
  if(!text)return;
  const plan=PLANS.find(p=>p.id===currentUser.plan)||PLANS[0];
  const today=new Date().toDateString();
  if(chatMsgsToday>=plan.limits.chatMsgs){
    document.getElementById('world-chat-upgrade').style.display='flex';
    toast('Message limit reached! Upgrade your plan.');
    return;
  }
  chatMsgsToday++;
  localStorage.setItem('vb_chat_today_'+today,chatMsgsToday);
  document.getElementById('chat-msgs-left').textContent=Math.max(0,plan.limits.chatMsgs-chatMsgsToday);
  const now=new Date();
  const time=now.getHours()+':'+String(now.getMinutes()).padStart(2,'0');
  worldChatMsgs.push({name:currentUser.name,plan:currentUser.plan||'free',text,time});
  inp.value='';
  buildWorldChat();
  // WS send
  if(ws&&ws.readyState===WebSocket.OPEN){
    ws.send(JSON.stringify({type:'message',name:currentUser.name,plan:currentUser.plan||'free',text}));
  }
}

// ── PROFILE ──
function renderMyProfile(){
  const el=document.getElementById('my-profile-view');
  if(!el||!currentUser)return;
  const u=currentUser;
  const followers=(u.followers||[]).length;
  const following=(u.following||[]).length;
  // Compute creator card stats
  const myPosts2=feedPosts.filter(p=>p.userId===u.email);
  const myVotes2=myPosts2.reduce((a,p)=>a+(p.votes||0),0);
  let serial2=0; const em2=u.email||''; for(let i=0;i<em2.length;i++) serial2=((serial2*31)+em2.charCodeAt(i))&0xffff;
  const styleMap2={default:'color:var(--g3)',neon:'color:#22c55e;text-shadow:0 0 12px rgba(34,197,94,0.8)',gold:'color:#ffd700;text-shadow:0 0 10px rgba(255,215,0,0.6)',fire:'background:linear-gradient(135deg,#f97316,#ef4444);-webkit-background-clip:text;-webkit-text-fill-color:transparent',ice:'color:#38bdf8;text-shadow:0 0 10px rgba(56,189,248,0.6)',purple:'color:#c084fc;text-shadow:0 0 10px rgba(192,132,252,0.5)',italic:'color:var(--g3);font-style:italic',mono:'color:var(--g4);font-family:DM Mono,monospace;font-size:14px;letter-spacing:3px'};
  const ns=styleMap2[u.nameStyle||'default']||styleMap2.default;
  const planColors2={free:'var(--g3)',pro:'#60a5fa',elite:'#ffd700',vip:'#ffd700',legend:'#f97316'};
  const planC2=planColors2[u.plan||'free']||'var(--g3)';
  const rankVal2=myVotes2>500?'🥇':myVotes2>100?'🥈':myVotes2>20?'🥉':'—';

  // Plan accent colors for card
  const cardPlanAccents = {free:'#22c55e',starter:'#60a5fa',pro:'#60a5fa',elite:'#ffd700',vip:'#c084fc',legend:'#f97316'};
  const cardAccent = cardPlanAccents[u.plan||'free'] || '#22c55e';
  const isGold = (u.plan==='elite'||u.plan==='vip');
  const xpPct = Math.min(100, Math.round(((myVotes2||0) / 300) * 100));
  const lvl = myVotes2>500?'LVL 5':myVotes2>200?'LVL 4':myVotes2>100?'LVL 3':myVotes2>20?'LVL 2':'LVL 1';
  const planIcon2 = isGold ? (u.plan==='elite'?'👑':'💎') : '';
  const niche2 = u.niche||u.title||'Creator';
  const bio2 = (u.bio||'').slice(0,90);

  const creatorCardHtml = ''
    +'<div style="position:relative;background:linear-gradient(145deg,#030e05 0%,#06140a 50%,#091c0d 100%);border-radius:22px;overflow:hidden;box-shadow:0 24px 60px rgba(0,0,0,0.75),0 0 0 1.5px '+cardAccent+'55;">'
    // animated top glow
    +'<div style="position:absolute;top:-50px;left:50%;transform:translateX(-50%);width:220px;height:110px;background:radial-gradient(ellipse,'+cardAccent+'28 0%,transparent 70%);pointer-events:none;"></div>'
    // scan lines
    +'<div style="position:absolute;inset:0;background:repeating-linear-gradient(0deg,transparent,transparent 2px,rgba(0,0,0,0.07) 2px,rgba(0,0,0,0.07) 3px);pointer-events:none;opacity:0.6;"></div>'
    // TOP STRIP
    +'<div style="background:linear-gradient(90deg,'+cardAccent+'20,transparent);border-bottom:1px solid '+cardAccent+'22;padding:9px 18px;display:flex;align-items:center;justify-content:space-between;">'
      +'<div style="display:flex;align-items:center;gap:7px;">'
        +'<div style="width:6px;height:6px;border-radius:50%;background:'+cardAccent+';box-shadow:0 0 7px '+cardAccent+';"></div>'
        +'<span style="font-family:DM Mono,monospace;font-size:7px;letter-spacing:3px;color:'+cardAccent+'99;text-transform:uppercase;">VB CREATOR</span>'
      +'</div>'
      +'<div style="display:flex;align-items:center;gap:7px;">'
        +(isGold?'<span style="font-size:13px;">'+planIcon2+'</span>':'')
        +'<span style="font-family:DM Mono,monospace;font-size:9px;font-weight:700;color:'+cardAccent+';background:'+cardAccent+'18;border:1px solid '+cardAccent+'44;border-radius:5px;padding:2px 9px;letter-spacing:2px;">'+(u.plan||'FREE').toUpperCase()+'</span>'
      +'</div>'
    +'</div>'
    // MAIN CONTENT
    +'<div style="padding:18px 20px 16px;">'
      // AVATAR + NAME
      +'<div style="display:flex;align-items:center;gap:14px;margin-bottom:16px;">'
        +'<div style="position:relative;flex-shrink:0;">'
          +'<div style="width:60px;height:60px;border-radius:16px;background:linear-gradient(135deg,'+cardAccent+'66,'+cardAccent+'33);display:flex;align-items:center;justify-content:center;font-family:Bebas Neue,sans-serif;font-size:28px;color:#fff;font-weight:900;box-shadow:0 0 24px '+cardAccent+'44;">'+(u.avatarUrl?'<img src="'+u.avatarUrl+'" alt="User avatar" style="width:100%;height:100%;object-fit:cover;border-radius:14px;"/>':(u.name||'C')[0].toUpperCase())+'</div>'
          +'<div style="position:absolute;inset:-3px;border-radius:19px;border:2px solid '+cardAccent+'44;pointer-events:none;"></div>'
        +'</div>'
        +'<div style="flex:1;min-width:0;">'
          +'<div style="font-family:Bebas Neue,sans-serif;font-size:22px;letter-spacing:2px;color:#f4fdf6;line-height:1;margin-bottom:4px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;">'+(u.name||'CREATOR').toUpperCase()+'</div>'
          +'<div style="font-family:DM Mono,monospace;font-size:10px;color:'+cardAccent+'cc;margin-bottom:4px;">@'+(u.username||u.email.split('@')[0])+'</div>'
          +'<div style="font-size:10px;color:#3a6a4a;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;">'+niche2+'</div>'
        +'</div>'
        +'<div style="font-family:DM Mono,monospace;font-size:7px;color:'+cardAccent+'44;text-align:right;flex-shrink:0;">#VB-'+String(serial2).padStart(5,'0')+'</div>'
      +'</div>'
      // BIO
      +(bio2?'<div style="font-size:11px;color:#4a7a5a;line-height:1.65;margin-bottom:14px;padding:10px 13px;background:rgba(0,0,0,0.3);border-radius:10px;border:1px solid rgba(255,255,255,0.04);font-style:italic;">'+bio2+(bio2.length>=90?'…':'')+'</div>':'')
      // STATS
      +'<div style="display:grid;grid-template-columns:repeat(4,1fr);gap:6px;margin-bottom:14px;">'
        +[{v:myPosts2.length,l:'POSTS',icon:'📢'},{v:myVotes2,l:'VOTES',icon:'▲'},{v:followers,l:'FOLLOW',icon:'👥'},{v:rankVal2,l:'RANK',icon:'🏆'}].map(function(s){
          return '<div style="background:rgba(255,255,255,0.018);border:1px solid '+cardAccent+'1e;border-radius:11px;padding:9px 4px;text-align:center;">'
            +'<div style="font-size:10px;margin-bottom:3px;opacity:0.45;">'+s.icon+'</div>'
            +'<div style="font-family:Bebas Neue,sans-serif;font-size:21px;color:'+cardAccent+';line-height:1;">'+s.v+'</div>'
            +'<div style="font-family:DM Mono,monospace;font-size:7px;color:#2a4a34;letter-spacing:1px;margin-top:2px;">'+s.l+'</div>'
          +'</div>';
        }).join('')
      +'</div>'
      // XP BAR
      +'<div style="margin-bottom:16px;">'
        +'<div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:5px;">'
          +'<span style="font-family:DM Mono,monospace;font-size:8px;color:'+cardAccent+'77;letter-spacing:1px;">XP PROGRESS</span>'
          +'<span style="font-family:DM Mono,monospace;font-size:9px;color:'+cardAccent+';font-weight:700;">'+lvl+'</span>'
        +'</div>'
        +'<div style="height:5px;background:rgba(255,255,255,0.04);border-radius:3px;overflow:hidden;">'
          +'<div style="height:100%;width:'+xpPct+'%;background:linear-gradient(90deg,'+cardAccent+'66,'+cardAccent+');border-radius:3px;"></div>'
        +'</div>'
      +'</div>'
      // FOOTER
      +'<div style="display:flex;align-items:center;justify-content:space-between;padding-top:12px;border-top:1px solid '+cardAccent+'12;">'
        +'<div style="display:flex;align-items:center;gap:5px;">'
          +'<div style="width:30px;height:3px;border-radius:2px;background:'+cardAccent+';"></div>'
          +'<div style="width:18px;height:3px;border-radius:2px;background:'+cardAccent+'44;"></div>'
          +'<div style="width:9px;height:3px;border-radius:2px;background:'+cardAccent+'22;"></div>'
        +'</div>'
        +'<button onclick="shareCreatorCard()" style="display:flex;align-items:center;gap:6px;background:'+cardAccent+'1a;border:1.5px solid '+cardAccent+'44;border-radius:9px;padding:7px 16px;font-family:DM Mono,monospace;font-size:9px;color:'+cardAccent+';cursor:pointer;letter-spacing:1px;font-weight:700;transition:all 0.2s;">↗ SHARE CARD</button>'
      +'</div>'
    +'</div>'
  +'</div>';

  el.innerHTML=`
    <div style="display:grid;grid-template-columns:1fr 220px;gap:18px;align-items:start">
      <div>
        <div class="profile-banner" style="background:linear-gradient(135deg,${getAvatarColor(u.email)},var(--s3))">
          <div class="profile-avatar" style="background:${getAvatarColor(u.email)};font-family:'Bebas Neue',sans-serif;font-size:32px;letter-spacing:2px;"><span style="line-height:1">${(u.name||'C')[0].toUpperCase()}</span></div>
          <button class="profile-edit-btn" onclick="openEditProfile()">✏️ Edit</button>
          ${u.plan==='elite'?`<button class="btn-contact-admin" style="position:absolute;bottom:14px;right:14px" onclick="openContactAdmin()">📩 Admin</button>`:''}
        </div>
        <div class="profile-info">
          <div style="font-family:'DM Mono',monospace;font-size:8px;letter-spacing:3px;color:var(--g3);text-transform:uppercase;margin-bottom:4px;opacity:0.6;">✦ CREATOR</div>
          <div class="profile-name" style="${ns};cursor:pointer;" onclick="openNameStylePicker()">${u.name||'Utilisateur'}${getVerifiedBadge(u)} <span style="font-size:11px;color:var(--muted);font-family:'DM Mono',monospace;letter-spacing:0;font-style:normal;">🎨</span></div>
          <div class="profile-handle">@${u.username||u.email.split('@')[0]} · <span class="chat-msg-plan-badge plan-${u.plan||'free'}">${(u.plan||'FREE').toUpperCase()}</span></div>
          <div class="profile-bio">${u.bio||'<span style="color:var(--muted2)">Add a bio in "Edit my profile"</span>'}</div>
          ${u.tags&&u.tags.length?`<div class="profile-tags">${u.tags.map(t=>`<span class="profile-tag">${t}</span>`).join('')}</div>`:''}
          <div class="profile-stats">
            <div class="pstat"><div class="pstat-num">${followers}</div><div class="pstat-label">Followers</div></div>
            <div class="pstat"><div class="pstat-num">${following}</div><div class="pstat-label">Plans</div></div>
            <div class="pstat"><div class="pstat-num">${(u.projects||[]).length}</div><div class="pstat-label">Projects</div></div>
            <div class="pstat"><div class="pstat-num">${u.totalVotes||0}</div><div class="pstat-label">Votes received</div></div>
          </div>
          ${renderProfileLinks(u)}
          ${renderProfileFields(u)}
        </div>
      </div>
      <div style="position:sticky;top:80px;">${creatorCardHtml}</div>
    </div>
    ${renderProfileCompletion(u)}
    ${renderProfileActivityGrid(u.email)}
    ${renderSocialBtns(u)}
    <div style="margin-top:16px;background:var(--s1);border:1.5px solid var(--border2);border-radius:12px;padding:16px 20px;display:flex;align-items:center;justify-content:space-between;flex-wrap:wrap;gap:10px">
      <div>
        <div style="font-size:10px;color:var(--muted);font-family:'DM Mono',monospace;letter-spacing:1px;margin-bottom:4px">ABONNEMENT ACTUEL</div>
        <div style="font-size:18px;font-weight:800;color:var(--g3)">${(u.plan||'free').toUpperCase()}</div>
        ${u.plan==='free'?'<div style="font-size:11px;color:var(--muted);margin-top:2px">Free forever</div>':'<div style="font-size:11px;color:var(--g4);margin-top:2px">Plan active</div>'}
      </div>
      ${u.plan==='free'?'<button onclick="showAppTab(\'boost-credits\',null);switchCreditsTab(\'shop\',document.getElementById(\'ctab-shop\'))" style="padding:9px 18px;background:var(--g2);border:none;border-radius:8px;font-family:Plus Jakarta Sans,sans-serif;font-size:12px;font-weight:700;color:var(--bg);cursor:pointer">Upgrade my plan →</button>':'<span style="font-size:11px;color:var(--muted2)">Thank you for your trust 🙏</span>'}
    </div>
    ${renderSoldes(u)}
    <div style="margin-top:24px">
      <h3 style="font-family:'DM Mono',monospace;font-size:11px;color:var(--g3);letter-spacing:2px;margin-bottom:12px">MY POSTS</h3>
      <div id="my-posts-feed">${feedPosts.filter(p=>p.userId===u.email).length===0?'<div style="color:var(--muted);font-size:13px">No posts yet.</div>':''}</div>
    </div>
    ${renderBadges(u)}
    ${renderSuggestedProfiles()}`;
  // Render my posts
  const myPosts=feedPosts.filter(p=>p.userId===u.email);
  const mpEl=document.getElementById('my-posts-feed');
  if(mpEl&&myPosts.length){
    mpEl.innerHTML=myPosts.map(p=>`<div class="post-card" style="margin-bottom:10px"><div class="post-content">${escHtml(p.text)}</div><div style="font-family:'DM Mono',monospace;font-size:10px;color:var(--muted);margin-top:8px">${p.time} · ❤️ ${p.likes}</div></div>`).join('');
  }
}



// ══════════════════════════════════════════════════════
//  REVENUE DASHBOARD — renderRevenueDashboard()
// ══════════════════════════════════════════════════════
function renderRevenueDashboard() {
  const root = document.getElementById('revenue-dashboard-root');
  if (!root) return;
  const u = currentUser;
  if (!u) { root.innerHTML = '<p style="color:var(--muted);padding:40px;text-align:center">Please log in.</p>'; return; }

  // Générer des données simulées cohérentes basées sur l'email
  let seed = 0; for (let c of (u.email||'')) seed = (seed * 31 + c.charCodeAt(0)) & 0xffff;
  const rng = (min, max, s) => min + ((seed * s * 1664525 + 1013904223) & 0xffff) % (max - min);

  const planMulti = {free:1, starter:2.5, pro:5, elite:12, vip:20, legend:35}[u.plan||'free'] || 1;
  const base = 80 + rng(20, 200, 3);
  const mrr  = Math.round(base * planMulti);
  const totalRev = Math.round(mrr * (3 + rng(1,8,7)));
  const totalViews = 1200 + rng(500, 8000, 5);
  const convRate = (1.2 + rng(0, 30, 11) / 10).toFixed(1);
  const avgOrder = Math.round(14 + rng(5, 80, 13));

  // Données 12 mois
  const months = ['Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec'];
  const now = new Date();
  const currentMonth = now.getMonth();
  const monthData = months.map((m, i) => {
    const dist = (currentMonth - i + 12) % 12;
    const growth = 1 + dist * 0.08;
    const val = Math.round((mrr / growth) * (0.7 + rng(0, 60, i*7) / 100));
    return { label: m, val };
  });
  // Réordonner pour afficher les 12 derniers mois dans l'ordre
  const ordered = [...monthData.slice(currentMonth+1), ...monthData.slice(0, currentMonth+1)];
  const maxVal = Math.max(...ordered.map(d => d.val)) || 1;

  // Sources de revenus
  const sources = [
    { name:'Sponsorships', color:'#22c55e', pct: 35 + rng(0,20,3) },
    { name:'Affiliates',   color:'#c084fc', pct: 20 + rng(0,15,5) },
    { name:'Credits sold', color:'#ffd700', pct: 15 + rng(0,12,7) },
    { name:'Plans',        color:'#38bdf8', pct: 10 + rng(0,10,9) },
    { name:'Direct sales', color:'#fb923c', pct:  8 + rng(0,8,11) },
  ];
  // Normaliser à 100%
  const total = sources.reduce((s,x)=>s+x.pct, 0);
  sources.forEach(s => s.pct = Math.round(s.pct/total*100));

  // Top performing posts
  const myPosts = feedPosts.filter(p => p.userId === u.email).slice(0,4);

  root.innerHTML = `
  <div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:24px;flex-wrap:wrap;gap:10px;">
    <div>
      <div style="font-family:'DM Mono',monospace;font-size:10px;letter-spacing:3px;color:var(--g3);opacity:0.7;margin-bottom:4px;">💰 REVENUE CENTER</div>
      <h2 style="font-family:'Bebas Neue',sans-serif;font-size:34px;letter-spacing:2px;color:var(--white);line-height:1;">TABLEAU DE BORD</h2>
    </div>
    <div style="display:flex;align-items:center;gap:8px;">
      <div style="background:rgba(34,197,94,0.08);border:1px solid rgba(34,197,94,0.2);border-radius:8px;padding:6px 14px;font-family:'DM Mono',monospace;font-size:10px;color:var(--g4);">Last 12 months</div>
      <button onclick="toast('📊 Export CSV — coming soon!')" style="background:var(--s1);border:1.5px solid var(--border2);border-radius:8px;padding:7px 14px;font-family:'DM Mono',monospace;font-size:10px;color:var(--muted);cursor:pointer;transition:all 0.2s;" onmouseover="this.style.borderColor='var(--g3)';this.style.color='var(--g3)'" onmouseout="this.style.borderColor='var(--border2)';this.style.color='var(--muted)'">↓ EXPORT</button>
    </div>
  </div>

  <!-- KPI GRID -->
  <div class="rev-kpi-grid">
    <div class="rev-kpi">
      <div class="rev-kpi-icon">💵</div>
      <div class="rev-kpi-val" style="color:#4ade80;">$${mrr.toLocaleString()}</div>
      <div class="rev-kpi-lbl">MRR</div>
      <div class="rev-kpi-trend up">↑ +${rng(5,28,3)}% vs last month</div>
    </div>
    <div class="rev-kpi">
      <div class="rev-kpi-icon">🏦</div>
      <div class="rev-kpi-val" style="color:#ffd700;">$${totalRev.toLocaleString()}</div>
      <div class="rev-kpi-lbl">Total revenue</div>
      <div class="rev-kpi-trend up">↑ +${rng(10,42,5)}% this year</div>
    </div>
    <div class="rev-kpi">
      <div class="rev-kpi-icon">👁️</div>
      <div class="rev-kpi-val" style="color:#38bdf8;">${totalViews.toLocaleString()}</div>
      <div class="rev-kpi-lbl">Total views</div>
      <div class="rev-kpi-trend up">↑ +${rng(3,18,9)}%</div>
    </div>
    <div class="rev-kpi">
      <div class="rev-kpi-icon">🎯</div>
      <div class="rev-kpi-val" style="color:#c084fc;">${convRate}%</div>
      <div class="rev-kpi-lbl">Conv. rate</div>
      <div class="rev-kpi-trend ${convRate > 2.5 ? 'up' : 'flat'}">${convRate > 2.5 ? '↑' : '→'} avg $${avgOrder}/order</div>
    </div>
  </div>

  <!-- GRAPHE REVENUS MENSUELS -->
  <div class="rev-chart-wrap">
    <div class="rev-chart-head">
      <div class="rev-chart-title">MONTHLY REVENUE</div>
      <div class="rev-chart-tabs">
        <button class="rev-chart-tab active">Revenue</button>
        <button class="rev-chart-tab" onclick="toast('Views chart — coming soon!')">Views</button>
        <button class="rev-chart-tab" onclick="toast('Clicks chart — coming soon!')">Clicks</button>
      </div>
    </div>
    <div class="rev-bar-chart">
      ${ordered.map((d,i) => {
        const h = Math.round((d.val / maxVal) * 90);
        const isCurrentMonth = i === 11;
        return `<div class="rev-bar-col">
          <div class="rev-bar" data-val="$${d.val}"
            style="height:${h}px;background:${isCurrentMonth
              ? 'linear-gradient(180deg,#4ade80,#16a34a)'
              : 'linear-gradient(180deg,rgba(34,197,94,0.5),rgba(22,163,74,0.25))'};
              ${isCurrentMonth ? 'box-shadow:0 0 12px rgba(74,222,128,0.4);' : ''}"></div>
          <span class="rev-bar-lbl">${d.label.slice(0,3)}</span>
        </div>`;
      }).join('')}
    </div>
    <div style="display:flex;justify-content:space-between;align-items:center;margin-top:14px;padding-top:12px;border-top:1px solid var(--border2);">
      <span style="font-family:'DM Mono',monospace;font-size:9px;color:var(--muted2);">■ Current month highlighted</span>
      <span style="font-family:'DM Mono',monospace;font-size:10px;color:var(--g3);font-weight:700;">Peak: $${Math.max(...ordered.map(d=>d.val)).toLocaleString()}</span>
    </div>
  </div>

  <!-- SOURCES + TOP POSTS -->
  <div class="rev-sources-grid">
    <!-- Sources de revenus -->
    <div class="rev-source-card">
      <div style="font-family:'DM Mono',monospace;font-size:10px;letter-spacing:2px;color:var(--g4);margin-bottom:16px;">REVENUE SOURCES</div>
      ${sources.map(s => `
        <div class="rev-source-row">
          <div class="rev-source-name">
            <div class="rev-source-dot" style="background:${s.color};box-shadow:0 0 6px ${s.color}88;"></div>
            ${s.name}
          </div>
          <div class="rev-source-bar-wrap">
            <div class="rev-source-bar-fill" style="width:${s.pct}%;background:${s.color};"></div>
          </div>
          <span class="rev-source-val">${s.pct}%</span>
        </div>`).join('')}
    </div>
    <!-- Top posts -->
    <div class="rev-source-card">
      <div style="font-family:'DM Mono',monospace;font-size:10px;letter-spacing:2px;color:var(--g4);margin-bottom:16px;">TOP PERFORMING POSTS</div>
      ${myPosts.length === 0
        ? `<div style="color:var(--muted);font-size:12px;text-align:center;padding:20px 0;">Publish posts to see stats here</div>`
        : `<table class="rev-top-table">
          <thead><tr><th>Post</th><th>Views</th><th>Revenue</th></tr></thead>
          <tbody>${myPosts.map((p,i) => {
            const v = 200 + rng(50,1200, i*13);
            const r = (v * parseFloat(convRate) / 100 * avgOrder).toFixed(0);
            return `<tr>
              <td style="max-width:140px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;color:var(--g5);">${(p.text||'Post').slice(0,35)}…</td>
              <td style="font-family:'DM Mono',monospace;color:var(--muted);">${v.toLocaleString()}</td>
              <td style="font-family:'DM Mono',monospace;color:#4ade80;font-weight:700;">$${r}</td>
            </tr>`;
          }).join('')}</tbody>
        </table>`}
    </div>
  </div>

  <!-- PAYOUT SECTION -->
  <div style="background:linear-gradient(135deg,rgba(22,163,74,0.08),rgba(74,222,128,0.04));border:1.5px solid rgba(34,197,94,0.25);border-radius:14px;padding:20px 24px;display:flex;align-items:center;justify-content:space-between;flex-wrap:wrap;gap:14px;">
    <div>
      <div style="font-family:'DM Mono',monospace;font-size:9px;letter-spacing:2px;color:var(--g4);margin-bottom:6px;">💳 NEXT PAYOUT</div>
      <div style="font-family:'Bebas Neue',sans-serif;font-size:28px;color:#4ade80;letter-spacing:1px;">$${Math.round(mrr * 0.82).toLocaleString()}</div>
      <div style="font-size:11px;color:var(--muted);margin-top:3px;">Expected on the 1st of next month</div>
    </div>
    <div style="display:flex;gap:10px;flex-wrap:wrap;">
      <button onclick="toast('💳 Payout settings — Stripe integration coming soon!')" style="padding:10px 20px;background:linear-gradient(135deg,var(--g1),var(--g2));border:none;border-radius:9px;font-family:'DM Mono',monospace;font-size:11px;font-weight:700;color:var(--bg);cursor:pointer;letter-spacing:1px;">REQUEST PAYOUT →</button>
      <button onclick="toast('🏦 Bank details — coming soon!')" style="padding:10px 18px;background:transparent;border:1.5px solid var(--border);border-radius:9px;font-family:'DM Mono',monospace;font-size:11px;color:var(--muted);cursor:pointer;letter-spacing:1px;">BANK DETAILS</button>
    </div>
  </div>`;
}

// ══════════════════════════════════════════════════════
//  PROFIL AMÉLIORÉ — injecté dans renderMyProfile
// ══════════════════════════════════════════════════════
function renderProfileActivityGrid(email) {
  // 30 jours d'activité simulée
  let seed = 0; for (let c of (email||'x')) seed = (seed * 31 + c.charCodeAt(0)) & 0xffff;
  const days = Array.from({length:30}, (_,i) => {
    const v = ((seed * (i+1) * 1664525 + 1013904223) & 0xffff) % 5;
    const colors = ['var(--s2)','rgba(34,197,94,0.15)','rgba(34,197,94,0.3)','rgba(34,197,94,0.55)','rgba(34,197,94,0.85)'];
    return `<div class="prof-activity-cell" style="background:${colors[v]};" title="Day ${30-i}"></div>`;
  });
  return `<div style="margin-bottom:16px;">
    <div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:8px;">
      <span style="font-family:'DM Mono',monospace;font-size:9px;letter-spacing:1.5px;color:var(--muted2);">ACTIVITY — LAST 30 DAYS</span>
      <span style="font-family:'DM Mono',monospace;font-size:9px;color:var(--g4);">Less ▪▪▪▪▪ More</span>
    </div>
    <div class="prof-activity-grid">${days.join('')}</div>
  </div>`;
}

function renderProfileCompletion(u) {
  const fields = [
    {label:'Name',    done:!!(u.name)},
    {label:'Bio',     done:!!(u.bio)},
    {label:'Photo',   done:!!(u.avatarUrl)},
    {label:'Niche',   done:!!(u.niche||u.title)},
    {label:'Socials', done:!!(u.tiktok||u.instagram||u.twitter||u.youtube)},
    {label:'Tags',    done:!!(u.tags&&u.tags.length)},
  ];
  const done = fields.filter(f=>f.done).length;
  const pct  = Math.round(done/fields.length*100);
  const color = pct===100?'#4ade80':pct>=60?'#ffd700':'#f87171';
  return `<div class="prof-completion">
    <div style="flex-shrink:0;width:48px;height:48px;border-radius:50%;background:conic-gradient(${color} ${pct*3.6}deg, var(--s3) 0deg);display:flex;align-items:center;justify-content:center;">
      <div style="width:36px;height:36px;border-radius:50%;background:var(--bg);display:flex;align-items:center;justify-content:center;font-family:'Bebas Neue',sans-serif;font-size:14px;color:${color};">${pct}%</div>
    </div>
    <div style="flex:1;">
      <div style="font-size:12px;font-weight:700;color:var(--white);margin-bottom:4px;">Profile ${pct===100?'Complete ✅':'Completion'}</div>
      <div style="display:flex;gap:6px;flex-wrap:wrap;">
        ${fields.map(f=>`<span style="font-family:'DM Mono',monospace;font-size:8px;padding:2px 7px;border-radius:3px;${f.done?'background:rgba(34,197,94,0.12);color:var(--g4);':'background:rgba(248,113,113,0.1);color:rgba(248,113,113,0.7);'}">${f.done?'✓':'○'} ${f.label}</span>`).join('')}
      </div>
    </div>
    ${pct<100?`<button onclick="openEditProfile()" style="flex-shrink:0;padding:7px 14px;background:var(--g2);border:none;border-radius:8px;font-family:'DM Mono',monospace;font-size:10px;font-weight:700;color:var(--bg);cursor:pointer;letter-spacing:1px;">COMPLETE →</button>`:''}
  </div>`;
}

function renderSocialBtns(u) {
  const socials = [
    {key:'tiktok',    label:'TikTok',    icon:'🎵', color:'#f0f0f0', border:'rgba(255,255,255,0.2)'},
    {key:'instagram', label:'Instagram', icon:'📸', color:'#e1306c', border:'rgba(225,48,108,0.4)'},
    {key:'twitter',   label:'Twitter',   icon:'𝕏',  color:'#1d9bf0', border:'rgba(29,155,240,0.4)'},
    {key:'youtube',   label:'YouTube',   icon:'▶',  color:'#ff0000', border:'rgba(255,0,0,0.3)'},
  ].filter(s => u[s.key]);

  if (!socials.length) return `<div style="font-size:12px;color:var(--muted);margin-bottom:16px;">
    <button onclick="openEditProfile()" style="background:none;border:1.5px dashed var(--border2);border-radius:8px;padding:7px 14px;font-size:11px;color:var(--muted);cursor:pointer;">+ Add social links</button>
  </div>`;

  return `<div class="prof-social-row">${socials.map(s =>
    `<a href="${u[s.key]}" target="_blank" class="prof-social-btn" style="color:${s.color};border-color:${s.border};background:${s.border.replace('0.4','0.07')};">
      <span>${s.icon}</span>${s.label}
    </a>`).join('')}</div>`;
}

function renderSuggestedProfiles() {
  const accounts = typeof _getAccounts === 'function' ? Object.values(_getAccounts()) : [];
  const others = accounts.filter(a => a.email !== (currentUser||{}).email).slice(0,3);
  if (!others.length) return '';
  const planColors = {free:'var(--g3)',starter:'#60a5fa',pro:'#60a5fa',elite:'#ffd700',vip:'#c084fc',legend:'#f97316'};
  return `<div style="margin-top:24px;">
    <div style="font-family:'DM Mono',monospace;font-size:10px;letter-spacing:2px;color:var(--muted2);margin-bottom:12px;">SUGGESTED CREATORS</div>
    <div class="prof-suggested">
      ${others.map(u => {
        const col = planColors[u.plan||'free']||'var(--g3)';
        return `<div class="prof-sug-card" onclick="viewUserProfile('${u.email}')">
          <div style="width:44px;height:44px;border-radius:50%;background:linear-gradient(135deg,${col}44,${col}22);border:2px solid ${col}66;display:flex;align-items:center;justify-content:center;font-family:'Bebas Neue',sans-serif;font-size:20px;color:${col};margin:0 auto 8px;">${(u.name||'?')[0].toUpperCase()}</div>
          <div style="font-size:12px;font-weight:700;color:var(--white);overflow:hidden;text-overflow:ellipsis;white-space:nowrap;">${u.name||'Creator'}</div>
          <div style="font-family:'DM Mono',monospace;font-size:8px;color:${col};margin-top:3px;letter-spacing:1px;">${(u.plan||'FREE').toUpperCase()}</div>
          <button onclick="event.stopPropagation();openDMToUser('${u.email}','${u.name||'Creator'}')" style="margin-top:8px;width:100%;padding:5px;background:rgba(34,197,94,0.08);border:1px solid rgba(34,197,94,0.2);border-radius:6px;font-family:'DM Mono',monospace;font-size:9px;color:var(--g4);cursor:pointer;">💬 Message</button>
        </div>`;
      }).join('')}
    </div>
  </div>`;
}

function getFollowerNameStyle(followers){
  if(followers>=100000) return 'color:#ffd700;text-shadow:0 0 20px rgba(255,215,0,0.6);';
  if(followers>=10000)  return 'color:#c0a060;';
  if(followers>=1000)   return 'color:#22c55e;';
  if(followers>=100)    return 'color:#86efac;';
  return '';
}

function renderSoldes(u){
  const followers = (u.followers||[]).length;
  const pct = Math.min(100, Math.round(followers/10));
  const salesEnabled = u.salesEnabled || false;
  const inp = "width:100%;padding:9px 12px;background:var(--s1);border:1.5px solid var(--border2);border-radius:8px;font-family:Plus Jakarta Sans,sans-serif;font-size:13px;color:var(--white);outline:none";

  if(followers < 1000){
    return '<div style="margin-top:24px;background:linear-gradient(135deg,rgba(255,215,0,0.06),rgba(255,140,0,0.03));border:1.5px solid rgba(255,215,0,0.2);border-radius:14px;padding:20px 22px;display:flex;align-items:center;gap:14px">'
      +'<span style="font-size:28px">💰</span>'
      +'<div style="flex:1">'
      +'<div style="font-size:13px;font-weight:800;color:#ffd700;margin-bottom:4px">Sales — Monetize your community</div>'
      +'<div style="font-size:11px;color:var(--muted);line-height:1.6">Available from <strong style="color:var(--white)">1,000 followers</strong>. You have <strong style="color:var(--g3)">'+followers+'</strong>.</div>'
      +'<div style="margin-top:10px;background:var(--s2);border-radius:6px;height:6px;overflow:hidden">'
      +'<div style="height:100%;width:'+pct+'%;background:linear-gradient(90deg,var(--g2),var(--g4))"></div></div>'
      +'<div style="font-size:10px;color:var(--muted2);margin-top:4px">'+followers+'/1000 followers</div>'
      +'</div></div>';
  }

  const toggleBg = salesEnabled ? 'var(--g2)' : 'var(--s3)';
  const toggleBorder = salesEnabled ? 'var(--g3)' : 'var(--border)';
  const toggleLeft = salesEnabled ? '20px' : '2px';

  let html = '<div style="margin-top:24px;background:linear-gradient(135deg,rgba(255,215,0,0.08),rgba(255,140,0,0.04));border:1.5px solid rgba(255,215,0,0.35);border-radius:14px;padding:20px 22px">'
    +'<div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:16px;flex-wrap:wrap;gap:10px">'
    +'<div style="display:flex;align-items:center;gap:10px"><span style="font-size:28px">💰</span>'
    +'<div><div style="font-size:14px;font-weight:800;color:#ffd700">Sales unlocked!</div>'
    +'<div style="font-size:11px;color:var(--muted)">Monetize your community of '+followers+' followers</div></div></div>'
    +'<label style="display:flex;align-items:center;gap:8px;cursor:pointer">'
    +'<span style="font-size:11px;color:var(--muted)">Enable sales</span>'
    +'<div onclick="toggleSales()" style="width:44px;height:24px;border-radius:12px;background:'+toggleBg+';position:relative;flex-shrink:0;border:1.5px solid '+toggleBorder+'">'
    +'<div style="position:absolute;top:2px;left:'+toggleLeft+';width:18px;height:18px;border-radius:50%;background:white"></div>'
    +'</div></label></div>';

  if(salesEnabled){
    html += '<div style="display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-bottom:14px">'
      +'<div class="fg"><label style="font-size:11px;color:var(--muted);display:block;margin-bottom:4px">Offer name</label>'
      +'<input id="sale-title" type="text" placeholder="ex: TikTok Audit 30 min" value="'+(u.saleTitle||'')+'" style="'+inp+'" oninput="saveSaleField(&apos;saleTitle&apos;,this.value)"/></div>'
      +'<div class="fg"><label style="font-size:11px;color:var(--muted);display:block;margin-bottom:4px">Price ($)</label>'
      +'<input id="sale-price" type="number" min="1" placeholder="29" value="'+(u.salePrice||'')+'" style="'+inp+'" oninput="saveSaleField(&apos;salePrice&apos;,this.value)"/></div>'
      +'<div style="grid-column:1/-1"><label style="font-size:11px;color:var(--muted);display:block;margin-bottom:4px">Description</label>'
      +'<textarea id="sale-desc" placeholder="Describe your offer..." style="'+inp+';resize:none;min-height:56px" oninput="saveSaleField(&apos;saleDesc&apos;,this.value)">'+(u.saleDesc||'')+'</textarea></div>'
      +'<div style="grid-column:1/-1"><label style="font-size:11px;color:var(--muted);display:block;margin-bottom:4px">Payment link (Stripe, PayPal...)</label>'
      +'<input id="sale-link" type="url" placeholder="https://buy.stripe.com/..." value="'+(u.saleLink||'')+'" style="'+inp+'" oninput="saveSaleField(&apos;saleLink&apos;,this.value)"/></div>'
      +'</div>'
      +'<div style="background:var(--s1);border:1px solid var(--border2);border-radius:10px;padding:14px;font-size:12px;color:var(--muted)">🎯 Your offer will be visible on your public profile.</div>';
  } else {
    html += '<div style="font-size:12px;color:var(--muted);text-align:center;padding:10px 0">Enable sales to configure your offer.</div>';
  }

  html += '</div>';
  return html;
}

function toggleSales(){
  if(!currentUser)return;
  currentUser.salesEnabled = !currentUser.salesEnabled;
  localStorage.setItem('viralboost_user', JSON.stringify(currentUser));
  renderMyProfile();
}

function saveSaleField(key, val){
  if(!currentUser)return;
  currentUser[key] = val;
  localStorage.setItem('viralboost_user', JSON.stringify(currentUser));
}

function renderProfileLinks(u){
  const links=[];
  if(u.website)links.push(`<a class="profile-link" href="${u.website}" target="_blank">🌐 Website</a>`);
  if(u.tiktok)links.push(`<a class="profile-link" href="https://tiktok.com/@${u.tiktok.replace('@','')}" target="_blank">🎵 ${u.tiktok}</a>`);
  if(u.instagram)links.push(`<a class="profile-link" href="https://instagram.com/${u.instagram.replace('@','')}" target="_blank">📸 ${u.instagram}</a>`);
  if(u.twitter)links.push(`<a class="profile-link" href="https://twitter.com/${u.twitter.replace('@','')}" target="_blank">🐦 ${u.twitter}</a>`);
  if(u.linkedin)links.push(`<a class="profile-link" href="${u.linkedin}" target="_blank">💼 LinkedIn</a>`);
  if(u.youtube)links.push(`<a class="profile-link" href="https://youtube.com/@${u.youtube.replace('@','')}" target="_blank">▶️ ${u.youtube}</a>`);
  if(!links.length)return '';
  return `<div class="profile-links" style="margin-bottom:16px">${links.join('')}</div>`;
}

function renderProfileFields(u){
  const fields=[];
  if(u.title)fields.push({l:'Title',v:u.title});
  if(u.location)fields.push({l:'Location',v:u.location});
  if(u.niche)fields.push({l:'Niche',v:u.niche});
  if(u.exp)fields.push({l:'Experience',v:u.exp});
  if(u.dispo)fields.push({l:'Availability',v:u.dispo});
  if(u.goal)fields.push({l:'Goal',v:u.goal});
  if(u.skills)fields.push({l:'Skills',v:u.skills});
  if(u.tools)fields.push({l:'Tools',v:u.tools});
  if(u.langs)fields.push({l:'Languages',v:u.langs});
  if(u.tiktokCount)fields.push({l:'TikTok followers',v:u.tiktokCount});
  if(u.igCount)fields.push({l:'Instagram followers',v:u.igCount});
  if(u.revenue)fields.push({l:'Monthly revenue',v:u.revenue});
  if(!fields.length)return '';
  return `<div class="profile-fields">${fields.map(f=>`<div class="pfield"><div class="pfield-label">${f.l}</div><div class="pfield-value">${f.v}</div></div>`).join('')}</div>`;
}

function openEditProfile(){
  if(!currentUser)return;
  if(currentUser.isDemo){openDemoSignupModal();return;}
  const u=currentUser;
  const fields={name:'ep-name',username:'ep-username',title:'ep-title',location:'ep-location',bio:'ep-bio',niche:'ep-niche',goal:'ep-goal',skills:'ep-skills',tools:'ep-tools',langs:'ep-langs',website:'ep-website',tiktok:'ep-tiktok',instagram:'ep-instagram',twitter:'ep-twitter',linkedin:'ep-linkedin',youtube:'ep-youtube',tiktokCount:'ep-tiktok-count',igCount:'ep-ig-count',projectsCount:'ep-projects-count',sales:'ep-sales',looking:'ep-looking'};
  Object.entries(fields).forEach(([key,id])=>{const el=document.getElementById(id);if(el&&u[key])el.value=u[key];});
  if(u.exp){const sel=document.getElementById('ep-exp');if(sel)for(let o of sel.options)if(o.value===u.exp||o.text===u.exp)sel.value=o.value;}
  if(u.dispo){const sel=document.getElementById('ep-dispo');if(sel)for(let o of sel.options)if(o.text===u.dispo)sel.value=o.value;}
  if(u.revenue){const sel=document.getElementById('ep-revenue');if(sel)for(let o of sel.options)if(o.text===u.revenue)sel.value=o.value;}
  // Restore avatar in form
  const avaEl = document.getElementById('edit-ava-emoji');
  const avaImg = document.getElementById('edit-ava-img');
  if(u.avatarUrl && avaImg){ avaImg.src=u.avatarUrl; avaImg.style.display='block'; if(avaEl) avaEl.style.display='none'; }
  else if(avaEl){ avaEl.textContent=u.avatar||'🙂'; if(avaImg) avaImg.style.display='none'; }
  openModal('edit-profile-modal');
}

function selectEmoji(el,emoji){
  document.querySelectorAll('.emoji-opt').forEach(e=>e.classList.remove('selected'));
  el.classList.add('selected');
  const prev = document.getElementById('edit-ava-preview');
  const emojiSpan = document.getElementById('edit-ava-emoji');
  const imgEl = document.getElementById('edit-ava-img');
  if(emojiSpan) emojiSpan.textContent = emoji;
  if(imgEl){ imgEl.style.display='none'; if(emojiSpan) emojiSpan.style.display=''; }
  if(currentUser) currentUser._pendingEmoji = emoji;
}

function selectEmojiPremium(el, emoji, requiredPlan){
  const planOrder = {free:0, starter:1, pro:2, elite:3, legend:4, vip:5};
  const userLevel = planOrder[currentUser?.plan||'free']||0;
  const reqLevel = planOrder[requiredPlan]||0;
  if(userLevel < reqLevel){
    toast(`🔒 Avatar ${requiredPlan.toUpperCase()} — Upgrade required!`, 'error');
    setTimeout(()=>openModal('pricing-modal'), 800);
    return;
  }
  selectEmoji(el, emoji);
}

async function handleAvatarUpload(input){
  const file = input.files[0];
  if(!file) return;
  const imgEl = document.getElementById('edit-ava-img');
  const emojiSpan = document.getElementById('edit-ava-emoji');
  // Preview local immédiat
  const url = URL.createObjectURL(file);
  if(imgEl){ imgEl.src=url; imgEl.style.display='block'; }
  if(emojiSpan) emojiSpan.style.display='none';
  const overlay=document.querySelector('.ava-upload-overlay'); if(overlay) overlay.style.display='none';
  document.getElementById('edit-ava-preview')?.classList.add('has-photo');
  // Tenter upload serveur
  try{
    const fd = new FormData(); fd.append('file', file);
    const r = await fetch('/api/upload', {method:'POST', body:fd});
    const d = await r.json();
    if(d.url && currentUser){ currentUser.avatarUrl = d.url; localStorage.setItem('viralboost_user', JSON.stringify(currentUser)); }
  }catch(e){ /* keep local preview */ }
  if(currentUser){ currentUser._pendingAvatarUrl = url; }
  toast('📷 Profile photo updated!');
}

function saveProfile(){
  if(!currentUser)return;
  const sel=document.getElementById('ep-exp');
  const selD=document.getElementById('ep-dispo');
  const selR=document.getElementById('ep-revenue');
  Object.assign(currentUser,{
    name:document.getElementById('ep-name').value.trim()||currentUser.name,
    username:document.getElementById('ep-username').value.trim().replace('@',''),
    title:document.getElementById('ep-title').value.trim(),
    location:document.getElementById('ep-location').value.trim(),
    bio:document.getElementById('ep-bio').value.trim(),
    niche:document.getElementById('ep-niche').value.trim(),
    exp:sel?sel.options[sel.selectedIndex].text:'',
    dispo:selD?selD.options[selD.selectedIndex].text:'',
    revenue:selR?selR.options[selR.selectedIndex].text:'',
    goal:document.getElementById('ep-goal').value.trim(),
    skills:document.getElementById('ep-skills').value.trim(),
    tools:document.getElementById('ep-tools').value.trim(),
    langs:document.getElementById('ep-langs').value.trim(),
    website:document.getElementById('ep-website').value.trim(),
    tiktok:document.getElementById('ep-tiktok').value.trim(),
    instagram:document.getElementById('ep-instagram').value.trim(),
    twitter:document.getElementById('ep-twitter').value.trim(),
    linkedin:document.getElementById('ep-linkedin').value.trim(),
    youtube:document.getElementById('ep-youtube').value.trim(),
    tiktokCount:document.getElementById('ep-tiktok-count').value.trim(),
    igCount:document.getElementById('ep-ig-count').value.trim(),
    looking:document.getElementById('ep-looking').value.trim(),
    avatar:document.getElementById('edit-ava-preview').textContent||'🙂',
    tags:[currentUser.niche,currentUser.dispo].filter(Boolean)
  });
  localStorage.setItem('viralboost_user',JSON.stringify(currentUser));
  _saveAccount(currentUser);
  closeModal('edit-profile-modal');
  updateAppBar();
  renderMyProfile();
  toast('✅ Profile updated!');
}

// ── FOLLOWERS ──
// No fake users — only real members
const sampleUsers=[];

async function buildFollowList(type='followers'){
  const el=document.getElementById('follow-list-container');
  if(!el)return;
  const myFollowers=currentUser?.followers||[];
  const myFollowing=currentUser?.following||[];
  let users=[];
  try{
    const r=await fetchWithTimeout('/api/admin/all-users');
    const allUsers=await r.json();
    if(type==='followers') users=(allUsers||[]).filter(u=>myFollowers.includes(u.email||u.id));
    if(type==='following') users=(allUsers||[]).filter(u=>myFollowing.includes(u.email||u.id));
    if(type==='discover') users=(allUsers||[]).filter(u=>(u.email||u.id)!==currentUser?.email).slice(0,20);
  }catch(e){}
  if(!users.length){
    const msgs={followers:'You have no followers yet.',following:'You are not following anyone yet.',discover:'No other creators registered yet.'};
    el.innerHTML=`<div style="text-align:center;padding:40px;color:var(--muted)">${msgs[type]||''}</div>`;
    document.getElementById('followers-count').textContent=myFollowers.length;
    document.getElementById('following-count').textContent=myFollowing.length;
    return;
  }
  el.innerHTML=users.map(u=>`
    <div class="follow-item">
      <div class="follow-item-ava" style="background:${getAvatarColor(u.email||u.id)}">${u.avatar||u.name?.[0]||'🙂'}</div>
      <div style="flex:1">
        <div class="follow-item-name">${escHtml(u.name||'Creator')}</div>
        <div class="follow-item-sub">${escHtml(u.bio||'')}</div>
        <div style="font-size:11px;color:var(--muted);margin-top:2px"><span class="chat-msg-plan-badge plan-${u.plan||'free'}">${(u.plan||'free').toUpperCase()}</span></div>
      </div>
      <button class="btn-dm-list" onclick="openDMToUser('${u.email||u.id}','${escHtml(u.name||'?')}')" title="DM">💬</button>
      <button class="btn-follow-list ${myFollowing.includes(u.email||u.id)?'following':''}" onclick="toggleFollow(this,'${u.email||u.id}')">${myFollowing.includes(u.email||u.id)?'Following ✓':'Follow'}</button>
    </div>`).join('');
  document.getElementById('followers-count').textContent=myFollowers.length;
  document.getElementById('following-count').textContent=myFollowing.length;
}

function switchFollowTab(type,el){
  document.querySelectorAll('#tab-abonnes .feed-tab').forEach(b=>b.classList.remove('active'));
  el.classList.add('active');
  buildFollowList(type);
}

function toggleFollow(btn,userId){
  if(!currentUser)return;
  currentUser.following=currentUser.following||[];
  if(currentUser.following.includes(userId)){
    currentUser.following=currentUser.following.filter(id=>id!==userId);
    btn.textContent='Follow';btn.classList.remove('following');
    toast('Unfollowed');
  } else {
    currentUser.following.push(userId);
    btn.textContent='Suivi ✓';btn.classList.add('following');
    toast('✅ Followed!');
  }
  localStorage.setItem('viralboost_user',JSON.stringify(currentUser));
  document.getElementById('following-count').textContent=currentUser.following.length;
}

// ── DM ──
function openDMToUser(userId,name){
  if(!currentUser||currentUser.isDemo){openDemoSignupModal();return;}
  if(userId===currentUser.email){toast('You can\'t DM yourself 😄');return;}
  dmTarget={id:userId,name};
  const nameEl = document.getElementById('dm-modal-name');
  const avaEl = document.getElementById('dm-modal-avatar');
  if(nameEl) nameEl.textContent = name || 'Creator';
  if(avaEl) avaEl.textContent = (name||'?')[0].toUpperCase();
  renderDMThread(userId);
  openModal('dm-modal');
}

function renderDMThread(userId){
  const el=document.getElementById('dm-msgs-list');
  const thread=dmThreads[userId]||[];
  if(!thread.length){
    el.innerHTML=`<div style="text-align:center;padding:40px 20px;">
      <div style="width:56px;height:56px;border-radius:50%;background:linear-gradient(135deg,#0b1a0d,#142e17);border:2px solid rgba(34,197,94,0.2);display:flex;align-items:center;justify-content:center;font-size:24px;margin:0 auto 14px;">👋</div>
      <div style="font-family:'Plus Jakarta Sans',sans-serif;font-size:14px;font-weight:700;color:#f0fdf4;margin-bottom:6px;">Start a conversation</div>
      <div style="font-family:'DM Mono',monospace;font-size:10px;color:var(--muted);letter-spacing:0.5px;">Your messages are private and secure</div>
    </div>`;
    return;
  }
  el.innerHTML=thread.map(m=>`
    <div style="display:flex;flex-direction:column;align-items:${m.fromMe?'flex-end':'flex-start'};gap:3px;">
      <div style="max-width:72%;padding:10px 14px;border-radius:${m.fromMe?'18px 18px 4px 18px':'18px 18px 18px 4px'};background:${m.fromMe?'linear-gradient(135deg,#15803d,#22c55e)':'rgba(11,26,13,0.9)'};border:${m.fromMe?'none':'1px solid rgba(34,197,94,0.15)'};font-family:'Plus Jakarta Sans',sans-serif;font-size:13px;color:${m.fromMe?'#040a05':'#f0fdf4'};line-height:1.5;word-break:break-word;">${escHtml(m.text)}</div>
      <div style="font-family:'DM Mono',monospace;font-size:9px;color:var(--muted);padding:0 4px;">${m.time}</div>
    </div>`).join('');
  el.scrollTop=el.scrollHeight;
}

function openMessagesPanel() {
  if(!currentUser||currentUser.isDemo){openDemoSignupModal();return;}
  renderMessageThreadList();
  openModal('messages-panel-modal');
}

function renderMessageThreadList(filter) {
  const el = document.getElementById('messages-thread-list');
  if(!el) return;
  const threads = Object.entries(dmThreads||{});
  if(!threads.length) {
    el.innerHTML = `<div style="text-align:center;padding:48px 20px;">
      <div style="width:56px;height:56px;border-radius:50%;background:linear-gradient(135deg,#0b1a0d,#142e17);border:2px solid rgba(34,197,94,0.15);display:flex;align-items:center;justify-content:center;font-size:26px;margin:0 auto 14px;">💬</div>
      <div style="font-family:'Plus Jakarta Sans',sans-serif;font-size:14px;font-weight:700;color:#f0fdf4;margin-bottom:6px;">No conversations yet</div>
      <div style="font-family:'DM Mono',monospace;font-size:10px;color:var(--muted);letter-spacing:0.5px;">Tap a DM button on any profile to start chatting</div>
    </div>`;
    return;
  }
  const q = (filter||'').toLowerCase();
  const items = threads.filter(([id,msgs]) => {
    if(!q) return true;
    return id.toLowerCase().includes(q) || msgs.some(m=>m.text.toLowerCase().includes(q));
  }).map(([userId, msgs]) => {
    const last = msgs[msgs.length-1];
    const rawName = userId.includes('@') ? userId.split('@')[0] : userId.replace(/^u_/,'').replace(/_/g,' ');
    const displayName = rawName.charAt(0).toUpperCase() + rawName.slice(1);
    const preview = last ? ((last.fromMe ? 'You: ' : '') + last.text.slice(0,48) + (last.text.length>48?'…':'')) : '';
    const initial = displayName[0].toUpperCase();
    const colors = ['#22c55e','#3b82f6','#a855f7','#f59e0b','#ec4899','#fb923c'];
    const col = colors[userId.length % colors.length];
    return `<div onclick="closeModal('messages-panel-modal');openDMToUser('${userId}','${displayName}')" style="display:flex;align-items:center;gap:12px;padding:13px 18px;cursor:pointer;transition:background 0.15s;border-bottom:1px solid rgba(34,197,94,0.05);" onmouseover="this.style.background='rgba(34,197,94,0.05)'" onmouseout="this.style.background=''">
      <div style="width:46px;height:46px;border-radius:50%;background:linear-gradient(135deg,${col}22,${col}0d);border:2px solid ${col}55;display:flex;align-items:center;justify-content:center;font-size:20px;font-weight:900;color:${col};font-family:'Bebas Neue',sans-serif;flex-shrink:0;">${initial}</div>
      <div style="flex:1;min-width:0;">
        <div style="font-family:'Plus Jakarta Sans',sans-serif;font-size:13px;font-weight:700;color:#f0fdf4;margin-bottom:2px;">${displayName}</div>
        <div style="font-family:'DM Mono',monospace;font-size:10px;color:var(--muted);white-space:nowrap;overflow:hidden;text-overflow:ellipsis;">${preview||'Tap to open conversation'}</div>
      </div>
      ${last?`<div style="font-family:'DM Mono',monospace;font-size:9px;color:var(--muted);flex-shrink:0;">${last.time}</div>`:''}
    </div>`;
  });
  el.innerHTML = items.length ? items.join('') : `<div style="text-align:center;padding:32px;color:var(--muted);font-family:'DM Mono',monospace;font-size:11px;">No results</div>`;
}

function filterMessageThreads(val) { renderMessageThreadList(val); }

function promptNewMessage() {
  const name = prompt('Enter username or name to message:');
  if(name && name.trim()) openDMToUser(name.trim().toLowerCase().replace(/\s+/g,'_'), name.trim());
}

function sendDM(){
  const inp=document.getElementById('dm-input');
  const text=inp.value.trim();
  if(!text)return;
  const now=new Date();
  const time=now.getHours()+':'+String(now.getMinutes()).padStart(2,'0');
  if(!dmThreads[dmTarget.id])dmThreads[dmTarget.id]=[];
  dmThreads[dmTarget.id].push({fromMe:true,text,time});
  inp.value='';
  // Tracker for badges
  currentUser._dmCount = (currentUser._dmCount||0) + 1;
  currentUser._todayDMs = (currentUser._todayDMs||0) + 1;
  localStorage.setItem('viralboost_user', JSON.stringify(currentUser));
  checkNewBadges();
  renderDMThread(dmTarget.id);
  // WS
  if(ws&&ws.readyState===WebSocket.OPEN){
    ws.send(JSON.stringify({type:'dm',toId:dmTarget.id,fromName:currentUser.name,fromPlan:currentUser.plan||'free',text}));
  }
}

// ── IA BOOST ──
function selectBoostType(el,type){
  document.querySelectorAll('#tab-ia-boost .sp-card').forEach(c=>c.classList.remove('selected'));
  el.classList.add('selected');
  selectedBoostType=type;
}

const boostPrompts={
  social:(n,t,d,g)=>`TikTok/Instagram growth hacking expert. Strategy for:\n- Project: ${n}\n- Target: ${t}\n- Description: ${d}\n- Goal: ${g}\n\nProvide: 5 viral video scripts, 20 hashtags, 30-day calendar, best posting times.`,
  seo:(n,t,d,g)=>`SEO expert. Plan for:\n- Project: ${n}\n- Target: ${t}\n- Description: ${d}\n\nProvide: 20 keywords, 5 article topics, backlink strategy, on-page checklist.`,
  ads:(n,t,d,g)=>`Ad copywriting expert. Create for:\n- Project: ${n}\n- Target: ${t}\n\nProvide: 3 Facebook Ads, 3 TikTok Ads scripts (30s), 3 Google ads, 5 Instagram hooks.`,
  email:(n,t,d,g)=>`Email marketing expert. Sequence for:\n- Project: ${n}\n- Target: ${t}\n\nProvide: 5 complete emails (welcome D0, value D3, proof D7, promo D14, follow-up D30).`,
  strategy:(n,t,d,g)=>`Digital strategy consultant. 90-day plan for:\n- Project: ${n}\n- Target: ${t}\n- Goal: ${g}\n\nProvide: SWOT analysis, SMART goals, month 1/2/3 actions, estimated budget.`,
  coach:(n,t,d,g)=>`You are an expert marketing coach. Give personalized advice for:\n- Project: ${n}\n- Description: ${d}\n- Goal: ${g}\n\nConcrete, actionable, prioritized advice.`
};

async function runIABoost(){
  if(!currentUser||currentUser.isDemo){openDemoSignupModal();return;}
  const name=document.getElementById('boost-name').value.trim()||'My project';
  const target=document.getElementById('boost-target').value.trim()||'Grand public';
  const desc=document.getElementById('boost-desc').value.trim()||'Project digital';
  const goal=document.getElementById('boost-goal').value.trim()||'Grow';
  const btn=document.getElementById('btn-ia-boost');
  btn.disabled=true;btn.textContent='⚡ Generating...';
  const out=document.getElementById('boost-output-box');
  const txt=document.getElementById('boost-output-text');
  out.style.display='block';
  txt.innerHTML='<div class="dots"><span></span><span></span><span></span></div>';
  try{
    const res=await fetch('/api/generate-boost',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({prompt:boostPrompts[selectedBoostType](name,target,desc,goal)})});
    const data=await res.json();
    txt.textContent=data.content;
    toast('✅ Strategy generated!');
  }catch(e){txt.textContent='Connect the Render backend to generate complete AI strategies.';}
  btn.disabled=false;btn.textContent='⚡ Generate my strategy';
}

// ── AUTH ──
function signup(){
  const email=document.getElementById('s-email').value.trim();
  const pass=document.getElementById('s-pass').value;
  if(!email||!pass){toast('Please fill in your email and password.');return;}
  if(!email.includes('@')){toast('Email invalide.');return;}
  if(pass.length<8){toast('Password too short (8 chars min).');return;}
  const name = email.split('@')[0];
  const username = name;
  if(selectedSignupPlan!=='free'){
    closeModal('signup-modal');
    pendingSignup={name,username,email,pass};
    startPayment(selectedSignupPlan);
    return;
  }
  createUser({name,username,email,plan:'free',pass});
  closeModal('signup-modal');
  showApp();
  showAppTab('home', document.querySelector('.app-tab[data-tab="home"]'));
  setTimeout(renderHomeTab, 200);
  setTimeout(() => openOnboarding(), 1000);
}

let pendingSignup=null;

function createUser({name,username,email,plan,pass}){
  const offeredPlan=localStorage.getItem('vb_offer_pending')?'pro':(plan||'free');
  currentUser={id:email,name,username:username||email.split('@')[0],email,plan:offeredPlan,avatar:'🙂',bio:'',followers:[],following:[],projects:[],totalVotes:0,createdAt:new Date().toISOString()};
  if(offeredPlan==='pro'&&localStorage.getItem('vb_offer_pending')){
    currentUser.offerClaimed=true;
    currentUser.offerExpiry=new Date(Date.now()+365*24*60*60*1000).toISOString();
    localStorage.removeItem('vb_offer_pending');
    setTimeout(()=>toast('🎉 PRO plan activated for free for 1 year!'),800);
  }
  if(pass) currentUser._pass = pass;
  localStorage.setItem('viralboost_user',JSON.stringify(currentUser));
  _saveAccount(currentUser);
  // Welcome credits
  const welcomeCredits = 50;
  addCredits(welcomeCredits);
  setTimeout(()=>toast(`🎁 Welcome! +${welcomeCredits}⚡ ViralCredits awarded!`), 1200);
  try{fetch('/api/register-user',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(currentUser)});}catch(e){}
}

// ── SUPER ADMIN ──
const SUPER_ADMIN_EMAIL='soug759@gmail.com';
const SUPER_ADMIN_PASS='Carla123';

function isSuperAdmin(email,pass){
  return email===SUPER_ADMIN_EMAIL&&pass===SUPER_ADMIN_PASS;
}

function loginAsSuperAdmin(){
  currentUser={
    id:SUPER_ADMIN_EMAIL,
    name:'Admin',
    username:'admin_viralboost',
    email:SUPER_ADMIN_EMAIL,
    plan:'elite',
    avatar:'👑',
    bio:'Super Administrator of ViralBoost',
    isSuperAdmin:true,
    followers:[],following:[],projects:[],totalVotes:0,
    createdAt:new Date().toISOString()
  };
  localStorage.setItem('viralboost_user',JSON.stringify(currentUser));
  closeModal('login-modal');
  showApp();
  showAppTab('home', document.querySelector('.app-tab[data-tab="home"]'));
  setTimeout(renderHomeTab, 200);
  // Load all admin data
  loadAdminData();
}

async function loadAdminData(){
  // Load all users, reports, DMs, projects
  try{
    const [usersRes,reportsRes,dmsRes,projectsRes]=await Promise.all([
      fetch('/api/admin/all-users?key=viralboost-admin').catch(()=>({ok:false})),
      fetch('/api/admin/reports?key=viralboost-admin').catch(()=>({ok:false})),
      fetch('/api/admin/dms?key=viralboost-admin').catch(()=>({ok:false})),
      fetch('/api/projects').catch(()=>({ok:false}))
    ]);
    window._adminData={
      users: usersRes.ok ? await usersRes.json() : [],
      reports: reportsRes.ok ? await reportsRes.json() : [],
      dms: dmsRes.ok ? await dmsRes.json() : [],
      projects: projectsRes.ok ? await projectsRes.json() : []
    };
    toast('👑 Full Admin access activated!');
    showAdminPanel();
  }catch(e){
    toast('👑 Admin mode activated (local data)');
    window._adminData={users:[],reports:[],dms:[],projects:[]};
    showAdminPanel();
  }
}

function showAdminPanel(){
  // Add Admin tab in bar if not already there
  const tabs=document.querySelector('.app-tabs');
  if(tabs&&!document.getElementById('tab-btn-admin')){
    const btn=document.createElement('button');
    btn.className='app-tab';
    btn.id='tab-btn-admin';
    btn.dataset.color='#ffd700';
    btn.innerHTML='👑 Admin';
    btn.onclick=()=>showAppTab('admin',btn);
    tabs.appendChild(btn);
    // Create the admin panel
    const panel=document.createElement('div');
    panel.className='tpanel';
    panel.id='tab-admin';
    panel.innerHTML=buildAdminPanelHTML();
    document.querySelector('#app > div[style]').appendChild(panel);
  }
}

function buildAdminPanelHTML(){
  const d=window._adminData||{};
  const users=d.users||[];
  const reports=d.reports||[];
  const dms=d.dms||[];
  const projects=d.projects||[];

  return `
  <div style="max-width:1100px;margin:0 auto;padding:22px 0">
    <h2 style="font-family:'Bebas Neue',sans-serif;font-size:36px;letter-spacing:3px;color:#ffd700;margin-bottom:6px">👑 PANNEAU SUPER ADMIN</h2>
    <p style="font-size:12px;color:var(--muted);margin-bottom:24px;font-family:'DM Mono',monospace">Access exclusif · soug759@gmail.com</p>

    <!-- STATS -->
    <div style="display:grid;grid-template-columns:repeat(5,1fr);gap:12px;margin-bottom:28px">
      <div style="background:rgba(255,215,0,0.06);border:1.5px solid rgba(255,215,0,0.2);border-radius:10px;padding:16px;text-align:center">
        <div style="font-family:'Bebas Neue',sans-serif;font-size:36px;color:#ffd700" id="admin-stat-users">${users.length||'?'}</div>
        <div style="font-size:10px;color:var(--muted);font-family:'DM Mono',monospace">UTILISATEURS</div>
      </div>
      <div style="background:rgba(255,215,0,0.06);border:1.5px solid rgba(255,215,0,0.2);border-radius:10px;padding:16px;text-align:center">
        <div style="font-family:'Bebas Neue',sans-serif;font-size:36px;color:#ffd700" id="admin-stat-projects">${projects.length||'?'}</div>
        <div style="font-size:10px;color:var(--muted);font-family:'DM Mono',monospace">PROJECTS/ADS</div>
      </div>
      <div style="background:rgba(255,75,75,0.08);border:1.5px solid rgba(255,75,75,0.2);border-radius:10px;padding:16px;text-align:center">
        <div style="font-family:'Bebas Neue',sans-serif;font-size:36px;color:#f87171" id="admin-stat-reports">${reports.length||'0'}</div>
        <div style="font-size:10px;color:var(--muted);font-family:'DM Mono',monospace">SIGNALEMENTS</div>
      </div>
      <div style="background:rgba(255,215,0,0.06);border:1.5px solid rgba(255,215,0,0.2);border-radius:10px;padding:16px;text-align:center">
        <div style="font-family:'Bebas Neue',sans-serif;font-size:36px;color:#ffd700" id="admin-stat-dms">${dms.length||'0'}</div>
        <div style="font-size:10px;color:var(--muted);font-family:'DM Mono',monospace">DMS ADMIN</div>
      </div>
      <div style="background:rgba(34,197,94,0.06);border:1.5px solid rgba(34,197,94,0.2);border-radius:10px;padding:16px;text-align:center">
        <div style="font-family:'Bebas Neue',sans-serif;font-size:36px;color:var(--g3)" id="admin-stat-online">—</div>
        <div style="font-size:10px;color:var(--muted);font-family:'DM Mono',monospace">EN LIGNE</div>
      </div>
    </div>

    <!-- TABS -->
    <div class="feed-tabs" style="margin-bottom:18px">
      <button class="feed-tab active" onclick="switchAdminTab('users',this)">👥 Users</button>
      <button class="feed-tab" onclick="switchAdminTab('reports',this)">🚨 Reports</button>
      <button class="feed-tab" onclick="switchAdminTab('dms',this)">📩 DMs</button>
      <button class="feed-tab" onclick="switchAdminTab('projects',this)">📢 Posts</button>
      <button class="feed-tab" onclick="switchAdminTab('chat',this)">💬 Global chat</button>
    </div>

    <!-- USERS -->
    <div id="admin-tab-users">
      <div style="background:var(--s1);border:1.5px solid var(--border2);border-radius:10px;overflow:hidden">
        <table style="width:100%;border-collapse:collapse">
          <thead><tr style="background:var(--s2)">
            <th style="padding:10px 14px;text-align:left;font-size:10px;color:var(--g3);font-family:'DM Mono',monospace;letter-spacing:1px">NOM</th>
            <th style="padding:10px 14px;text-align:left;font-size:10px;color:var(--g3);font-family:'DM Mono',monospace;letter-spacing:1px">EMAIL</th>
            <th style="padding:10px 14px;text-align:left;font-size:10px;color:var(--g3);font-family:'DM Mono',monospace;letter-spacing:1px">PLAN</th>
            <th style="padding:10px 14px;text-align:left;font-size:10px;color:var(--g3);font-family:'DM Mono',monospace;letter-spacing:1px">INSCRIT</th>
            <th style="padding:10px 14px;text-align:left;font-size:10px;color:var(--g3);font-family:'DM Mono',monospace;letter-spacing:1px">ACTIONS</th>
          </tr></thead>
          <tbody id="admin-users-tbody">
            ${users.length?users.map(u=>`<tr style="border-top:1px solid var(--border2)">
              <td style="padding:10px 14px;font-size:13px">${u.name||'—'}</td>
              <td style="padding:10px 14px;font-size:12px;color:var(--muted);font-family:'DM Mono',monospace">${u.email||'—'}</td>
              <td style="padding:10px 14px"><span class="chat-msg-plan-badge plan-${u.plan||'free'}">${(u.plan||'FREE').toUpperCase()}</span></td>
              <td style="padding:10px 14px;font-size:11px;color:var(--muted)">${u.createdAt?new Date(u.createdAt).toLocaleDateString('en-US'):'—'}</td>
              <td style="padding:10px 14px"><button onclick="adminBanUser('${u.email}')" style="background:transparent;border:1px solid rgba(248,113,113,0.3);border-radius:4px;padding:3px 8px;font-size:10px;color:#f87171;cursor:pointer;font-family:'Plus Jakarta Sans',sans-serif">Bannedr</button></td>
            </tr>`).join(''):'<tr><td colspan="5" style="padding:24px;text-align:center;color:var(--muted)">Connect MongoDB to see users</td></tr>'}
          </tbody>
        </table>
      </div>
    </div>

    <!-- REPORTS (hidden by default) -->
    <div id="admin-tab-reports" style="display:none">
      ${reports.length?`<div style="display:flex;flex-direction:column;gap:8px">
        ${reports.map(r=>`<div style="background:rgba(248,113,113,0.06);border:1.5px solid rgba(248,113,113,0.2);border-radius:10px;padding:14px 18px">
          <div style="display:flex;align-items:center;gap:10px;margin-bottom:6px">
            <span style="font-size:12px;font-weight:700;color:#f87171">🚨 ${r.reportedName||r.reportedId||'?'}</span>
            <span style="font-size:10px;color:var(--muted);font-family:'DM Mono',monospace">reported by ${r.reporterName||r.reporterEmail||'?'}</span>
            <span style="background:rgba(248,113,113,0.15);color:#f87171;font-size:9px;padding:2px 7px;border-radius:3px;font-family:'DM Mono',monospace;margin-left:auto">${r.reason||'?'}</span>
          </div>
          ${r.details?`<div style="font-size:12px;color:var(--muted)">${r.details}</div>`:''}
          <div style="font-size:10px;color:var(--muted2);margin-top:6px;font-family:'DM Mono',monospace">${r.createdAt?new Date(r.createdAt).toLocaleString('en-US'):''}</div>
        </div>`).join('')}
      </div>`:'<div style="text-align:center;padding:40px;color:var(--muted)">No reports at the moment 🎉</div>'}
    </div>

    <!-- DMs (hidden) -->
    <div id="admin-tab-dms" style="display:none">
      ${dms.length?`<div style="display:flex;flex-direction:column;gap:8px">
        ${dms.map(d=>`<div style="background:rgba(255,215,0,0.04);border:1.5px solid rgba(255,215,0,0.15);border-radius:10px;padding:14px 18px">
          <div style="display:flex;align-items:center;gap:8px;margin-bottom:6px">
            <span style="font-size:20px">👑</span>
            <span style="font-size:12px;font-weight:700;color:#ffd700">${d.fromName||d.fromEmail||'?'}</span>
            <span class="chat-msg-plan-badge plan-${d.fromPlan||'elite'}" style="font-size:9px">${(d.fromPlan||'ELITE').toUpperCase()}</span>
            <span style="font-size:10px;color:var(--muted);margin-left:auto;font-family:'DM Mono',monospace">${d.createdAt?new Date(d.createdAt).toLocaleString('en-US'):''}</span>
          </div>
          <div style="font-size:13px;color:var(--g5)">${d.text||'—'}</div>
          <button onclick="replyToAdminDM('${d.fromEmail}')" style="margin-top:8px;background:transparent;border:1px solid rgba(255,215,0,0.2);border-radius:4px;padding:4px 10px;font-size:10px;color:#ffd700;cursor:pointer;font-family:'Plus Jakarta Sans',sans-serif">Reply</button>
        </div>`).join('')}
      </div>`:'<div style="text-align:center;padding:40px;color:var(--muted)">No admin DMs yet</div>'}
    </div>

    <!-- PROJECTS (hidden) -->
    <div id="admin-tab-projects" style="display:none">
      ${projects.length?`<div class="showcase-grid">${projects.slice(0,12).map(p=>`
        <div class="v-card">
          <div class="v-banner" style="background:${p.color||'var(--s2)'};">${p.emoji||'🚀'}
            <div class="v-badge" style="background:#ffd700;color:#1a0a00">${p.cat||p.type||'pub'}</div>
          </div>
          <div class="v-body">
            <div class="v-name">${p.name}</div>
            <div class="v-desc">${(p.desc||'').slice(0,80)}</div>
            <div class="v-footer">
              <div class="v-author" style="font-size:11px">${p.author||'?'}</div>
              <button onclick="adminDeleteProject('${p.id}')" style="background:transparent;border:1px solid rgba(248,113,113,0.3);border-radius:4px;padding:2px 7px;font-size:10px;color:#f87171;cursor:pointer">🗑</button>
            </div>
          </div>
        </div>`).join('')}</div>`:'<div style="text-align:center;padding:40px;color:var(--muted)">No projects posted</div>'}
    </div>

    <!-- CHAT (hidden) -->
    <div id="admin-tab-chat" style="display:none">
      <div class="chat-box" style="height:500px">
        <div class="chat-msgs-area" id="admin-chat-msgs">
          ${[...publicMessages].reverse().slice(0,50).map(m=>`<div class="chat-msg-item"><div class="chat-msg-name">${m.name||'?'} <span class="chat-msg-plan-badge plan-${m.plan||'free'}">${(m.plan||'FREE').toUpperCase()}</span><span style="font-family:'DM Mono',monospace;font-size:9px;color:var(--muted2);margin-left:auto">${m.timestamp?new Date(m.timestamp).toLocaleTimeString('en',{hour:'2-digit',minute:'2-digit'}):''}</span></div><div class="chat-msg-text">${m.text||''}</div></div>`).join('')||'<div style="text-align:center;padding:32px;color:var(--muted)">Real-time chat visible here</div>'}
        </div>
        <div class="chat-input-row">
          <input type="text" id="admin-chat-in" class="chat-input-field" placeholder="Send un message en tant qu\'Admin 👑..." onkeydown="if(event.key===\\'Enter\\')sendAdminChatMsg()"/>
          <button class="btn-send" onclick="sendAdminChatMsg()" style="background:linear-gradient(135deg,#ffd700,#ff8c00);color:#1a0a00">→</button>
        </div>
      </div>
    </div>

    <div style="margin-top:24px;padding:14px;background:rgba(255,215,0,0.04);border:1px solid rgba(255,215,0,0.1);border-radius:8px;font-size:11px;color:var(--muted);font-family:'DM Mono',monospace;text-align:center">
      👑 Super Admin Panel · soug759@gmail.com · <a href="/admin?key=viralboost-admin" target="_blank" style="color:#ffd700;text-decoration:none">Dashboard serveur complet →</a>
    </div>
  </div>`;
}

function switchAdminTab(tab,el){
  document.querySelectorAll('#tab-admin .feed-tab').forEach(b=>b.classList.remove('active'));
  el.classList.add('active');
  ['users','reports','dms','projects','chat'].forEach(t=>{
    const el2=document.getElementById('admin-tab-'+t);
    if(el2)el2.style.display=t===tab?'block':'none';
  });
}

function adminBanUser(email){
  if(confirm('Bannedr '+email+' ?')){
    fetch('/api/admin/ban',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({email,key:'viralboost-admin'})}).catch(()=>{});
    toast('🚫 Utilisateur banned : '+email);
  }
}

function adminDeleteProject(id){
  if(confirm('Delete this project?')){
    showcaseData=showcaseData.filter(p=>p.id!==id);
    fetch('/api/projects/'+id,{method:'DELETE',headers:{'Content-Type':'application/json'},body:JSON.stringify({key:'viralboost-admin'})}).catch(()=>{});
    toast('🗑 Project deleted');
    document.getElementById('tab-admin').innerHTML=buildAdminPanelHTML();
  }
}

function replyToAdminDM(email){
  openDMToUser(email, email.split('@')[0]);
}

function sendAdminChatMsg(){
  const inp=document.getElementById('admin-chat-in');
  const text=inp.value.trim();
  if(!text)return;
  inp.value='';
  const el=document.getElementById('admin-chat-msgs');
  const div=document.createElement('div');
  div.className='chat-msg-item';
  div.style.background='rgba(255,215,0,0.06)';
  div.style.border='1px solid rgba(255,215,0,0.15)';
  div.innerHTML=`<div class="chat-msg-name"><span style="color:#ffd700">👑 Admin</span> <span class="admin-msg-badge">ADMIN</span></div><div class="chat-msg-text">${escHtml(text)}</div>`;
  el.appendChild(div);el.scrollTop=el.scrollHeight;
  if(ws&&ws.readyState===1){
    ws.send(JSON.stringify({type:'message',name:'👑 Admin',plan:'elite',text,isAdmin:true}));
  }
}

function login(){
  const email=document.getElementById('l-email').value.trim().toLowerCase();
  const pass=document.getElementById('l-pass').value;
  if(!email||!pass){toast('Please fill in all fields.');return;}

  // ── SUPER ADMIN ──
  if(isSuperAdmin(email,pass)){loginAsSuperAdmin();return;}

  // Search in multi-accounts store
  const accounts = _getAccounts();
  const account = accounts[email];
  if(account){
    if(account._pass && account._pass !== pass){
      toast('❌ Password incorrect.');return;
    }
    currentUser = account;
    localStorage.setItem('viralboost_user', JSON.stringify(currentUser));
    closeModal('login-modal');
    showApp();
    showAppTab('home', document.querySelector('.app-tab[data-tab="home"]'));
    setTimeout(renderHomeTab, 200);
    return;
  }
  toast('❌ No account found. Sign up!');
}

// ── MULTI-ACCOUNT STORE ──
function _getAccounts(){
  try{ return JSON.parse(localStorage.getItem('vb_accounts')||'{}'); }catch(e){ return {}; }
}
function _saveAccount(user){
  const accounts = _getAccounts();
  accounts[user.email.toLowerCase()] = user;
  localStorage.setItem('vb_accounts', JSON.stringify(accounts));
}

function logout(){
  currentUser=null;
  localStorage.removeItem('viralboost_user'); // clears active session, not accounts
  document.body.classList.remove('app-active');
  document.getElementById('app').style.display='none';
  document.getElementById('landing').style.display='block';
  const guestBtns=document.getElementById('mob-btns-guest');
  const userBtns=document.getElementById('mob-btns-user');
  if(guestBtns)guestBtns.style.display='flex';
  if(userBtns)userBtns.style.display='none';
  window.scrollTo(0,0);
}

async function loadShowcaseFromAPI(){
  try{
    const r=await fetchWithTimeout('/api/projects');
    const apiProjects=await r.json();
    if(Array.isArray(apiProjects)&&apiProjects.length>0){
      const apiIds=new Set(apiProjects.map(p=>p.id));
      showcaseData=[...apiProjects,...(showcaseData||[]).filter(p=>!apiIds.has(p.id))];
    }
  }catch(e){}
  buildShowcaseGrid('app-showcase-grid');
}


function startDemoPublish(){
  // If already connected, go directly to Home
  const saved = localStorage.getItem('viralboost_user');
  if(saved){ try{ currentUser = JSON.parse(saved); showApp(); return; }catch(e){} }
  // Not connected → launch demo and go to Home
  startDemo();
}

function openDemoSignupModal(){
  // Remove demo banner temporarily and show a powerful signup modal
  const modal = document.createElement('div');
  modal.id = 'demo-signup-modal';
  modal.style.cssText = 'position:fixed;inset:0;background:rgba(4,10,5,0.94);backdrop-filter:blur(16px);z-index:9999;display:flex;align-items:center;justify-content:center;padding:20px;animation:fadeIn 0.25s ease;';
  modal.innerHTML = `
    <div style="background:var(--s1);border:2px solid rgba(34,197,94,0.5);border-radius:20px;padding:32px 28px;max-width:400px;width:100%;position:relative;animation:popIn 0.35s cubic-bezier(0.34,1.56,0.64,1);">
      <div style="position:absolute;top:0;left:50%;transform:translateX(-50%);width:60%;height:2px;background:linear-gradient(90deg,transparent,var(--g3),transparent);border-radius:100px;"></div>
      
      <div style="text-align:center;margin-bottom:22px;">
        <div style="font-size:40px;margin-bottom:10px;">🚀</div>
        <div style="font-family:'Bebas Neue',sans-serif;font-size:30px;letter-spacing:2px;color:var(--white);margin-bottom:6px;">You're 1 step away from publishing!</div>
        <div style="font-size:13px;color:var(--muted);line-height:1.6;">Your ad is ready. Create your free account in 30 seconds to publish it now.</div>
      </div>

      <div style="display:flex;flex-direction:column;gap:9px;margin-bottom:20px;background:rgba(22,163,74,0.05);border:1px solid rgba(34,197,94,0.12);border-radius:12px;padding:14px 16px;">
        <div style="font-size:12px;color:var(--g5);">✅ &nbsp;Publication <strong style="color:var(--g3)">immediate</strong> — visible to the entire community</div>
        <div style="font-size:12px;color:var(--g5);">✅ &nbsp;Access au feed, collabs & groups</div>
        <div style="font-size:12px;color:var(--g5);">✅ &nbsp;<strong style="color:var(--g3)">100% free</strong> — no credit card</div>
      </div>

      <div style="display:flex;flex-direction:column;gap:9px;margin-bottom:14px;">
        <input id="dsm-email" class="signup-input" placeholder="📧 Your email" type="email" style="width:100%;padding:12px 14px;background:rgba(4,10,5,0.9);border:1.5px solid rgba(34,197,94,0.2);border-radius:10px;font-family:'Plus Jakarta Sans',sans-serif;font-size:14px;color:var(--white);outline:none;" />
        <input id="dsm-pass" class="signup-input" placeholder="🔒 Password (8 chars min.)" type="password" style="width:100%;padding:12px 14px;background:rgba(4,10,5,0.9);border:1.5px solid rgba(34,197,94,0.2);border-radius:10px;font-family:'Plus Jakarta Sans',sans-serif;font-size:14px;color:var(--white);outline:none;" />
      </div>

      <button onclick="demoSignupSubmit()" style="width:100%;padding:15px;background:linear-gradient(135deg,var(--g1),var(--g3));border:none;border-radius:12px;font-family:'Plus Jakarta Sans',sans-serif;font-size:16px;font-weight:800;cursor:pointer;color:var(--bg);box-shadow:0 0 36px rgba(34,197,94,0.45);transition:all 0.2s;margin-bottom:10px;" onmouseover="this.style.transform=\'translateY(-2px)\'" onmouseout="this.style.transform=''">
        ⚡ Create my account & Publish →
      </button>
      
      <div style="text-align:center;font-size:11px;color:var(--muted2);margin-bottom:10px;">By creating an account you accept our T&Cs</div>
      
      <button onclick="closeDemoSignupModal()" style="display:block;width:100%;text-align:center;background:none;border:none;font-size:12px;color:var(--muted2);cursor:pointer;padding:6px;font-family:'Plus Jakarta Sans',sans-serif;">
        Continue in demo mode →
      </button>
    </div>
  `;
  document.body.appendChild(modal);
  // Focus first input
  setTimeout(() => { const inp = document.getElementById('dsm-email'); if(inp) inp.focus(); }, 300);
}

function closeDemoSignupModal(){
  const m = document.getElementById('demo-signup-modal');
  if(m) m.remove();
}

function demoSignupSubmit(){
  const email = (document.getElementById('dsm-email')?.value||'').trim();
  const pass = (document.getElementById('dsm-pass')?.value||'').trim();
  if(!email||!email.includes('@')){toast('⚠️ Email invalide !');return;}
  if(pass.length < 8){toast('⚠️ Password too short (8 chars min)!');return;}
  
  // Create the account directly
  closeDemoSignupModal();
  const name = email.split('@')[0];
  createUser({name, username: name, email, plan:'free', pass});
  showApp();
  setTimeout(() => openOnboarding(), 1000);
}

function startDemo(){
  // Create a read-only demo user
  currentUser = {
    name: 'Visitur Demo',
    username: 'demo_visitor',
    email: 'demo@viralboost.app',
    plan: 'free',
    avatar: '👀',
    followers: [],
    following: [],
    projects: [],
    totalVotes: 0,
    isDemo: true
  };
  showApp();
}

function exitDemo(){
  currentUser = null;
  const banner = document.getElementById('demo-banner');
  if(banner) banner.remove();
  const app = document.getElementById('app');
  if(app) app.style.paddingTop = '';
  document.getElementById('landing').style.display='block';
  document.getElementById('app').style.display='none';
  document.body.classList.remove('app-active');
  openModal('signup-modal');
}

function showApp(){
  document.getElementById('landing').style.display='none';
  document.getElementById('app').style.display='block';
  document.body.classList.add('app-active');
  // Mobile menu: show Log out, hide Log in/Join
  const guestBtns = document.getElementById('mob-btns-guest');
  const userBtns = document.getElementById('mob-btns-user');
  if(guestBtns) guestBtns.style.display='none';
  if(userBtns) userBtns.style.display='flex';
  updateAppBar();
  window.scrollTo(0,0);
  // Init new features — API calls différés pour ne pas bloquer le rendu
  setTimeout(()=>{
    loadPostsFromAPI();
    loadMemberCount();
    loadShowcaseFromAPI();
  }, 500);
  setTimeout(()=>{
    injectSearchBtn();
    applyTheme();
    checkReferral();
    const sb = document.getElementById('stories-bar-container');
    if(sb) sb.innerHTML = renderStoriesBar();
  }, 300);
  connectWS();
  const plan=PLANS.find(p=>p.id===currentUser.plan)||PLANS[0];
  document.getElementById('feed-limit-info').innerHTML=`Plan ${(currentUser.plan||'FREE').toUpperCase()} · <span id="pubs-left">${plan.limits.pubsPerHour||plan.limits.pubsPerDay||'∞'}</span> pub${currentUser.plan==='free'?'/h':'/jour'}`;
  const chatLeft=Math.max(0,(PLANS.find(p=>p.id===currentUser.plan)||PLANS[0]).limits.chatMsgs-chatMsgsToday);
  const chatEl=document.getElementById('chat-msgs-left');
  if(chatEl)chatEl.textContent=chatLeft;
  // Restore wallpaper
  if(currentUser.wallpaper&&currentUser.wallpaper!=='none'){
    const app=document.getElementById('app');
    app.style.background=currentUser.wallpaper;
    app.classList.add('has-wallpaper');
  }
  // Hero ad after sign up
  if(window._pendingHeroAd&&currentUser){
    const ad=window._pendingHeroAd;
    document.getElementById('feed-text').value=ad.desc;
    document.getElementById('feed-proj-name').value=ad.name;
    const sel=document.getElementById('feed-proj-type');
    if(sel&&ad.type)sel.value=ad.type;
    showAppTab('feed',document.querySelector('.app-tab'));
    toast('📢 Your ad is ready! Click Publish.');
    window._pendingHeroAd=null;
  }
  // News features
  updateCreditsDisplay();
  // Go directly to Home by default
  if(!window._pendingHeroAd){
    showAppTab('home', document.querySelector('.app-tab[data-tab="home"]'));
    setTimeout(renderHomeTab, 200);
  }
  setTimeout(checkOnboarding,800);
  setTimeout(checkNewBadges, 500);
}

function updateAppBar(){
  if(!currentUser)return;
  const nameEl=document.getElementById('app-user-name');
  if(nameEl){
    nameEl.textContent=(currentUser.name||'ME').toUpperCase();
    // Apply the users custom name style
    const style=currentUser.nameStyle||'default';
    const styleMap={
      default:'color:var(--g3);text-shadow:none;font-style:normal;',
      neon:'color:#22c55e;text-shadow:0 0 12px rgba(34,197,94,0.8),0 0 24px rgba(34,197,94,0.4);font-style:normal;',
      gold:'color:#ffd700;text-shadow:0 0 10px rgba(255,215,0,0.6);font-style:normal;',
      fire:'background:linear-gradient(135deg,#f97316,#ef4444);-webkit-background-clip:text;-webkit-text-fill-color:transparent;text-shadow:none;font-style:normal;',
      ice:'color:#38bdf8;text-shadow:0 0 10px rgba(56,189,248,0.6);font-style:normal;',
      purple:'color:#c084fc;text-shadow:0 0 10px rgba(192,132,252,0.5);font-style:normal;',
      italic:'color:var(--g3);font-style:italic;text-shadow:none;',
      mono:'color:var(--g4);font-family:DM Mono,monospace;font-size:12px;letter-spacing:3px;font-style:normal;',
    };
    nameEl.style.fontFamily = "'Bebas Neue',sans-serif";
    nameEl.style.fontSize = '16px';
    nameEl.style.letterSpacing = '2px';
    nameEl.style.lineHeight = '1';
    nameEl.style.transition = 'all 0.2s';
    // Apply color/effect from style map
    var styleStr = styleMap[style]||styleMap.default;
    var tempEl = document.createElement('div');
    tempEl.setAttribute('style', styleStr);
    nameEl.style.color = tempEl.style.color||'';
    nameEl.style.textShadow = tempEl.style.textShadow||'none';
    nameEl.style.fontStyle = tempEl.style.fontStyle||'normal';
    nameEl.style.background = tempEl.style.background||'';
    nameEl.style.webkitBackgroundClip = tempEl.style.webkitBackgroundClip||'';
    nameEl.style.webkitTextFillColor = tempEl.style.webkitTextFillColor||'';
  }
  const chip=document.getElementById('app-plan-chip');
  chip.textContent=(currentUser.plan||'FREE').toUpperCase();
  const isElite=currentUser.plan==='elite';
  if(isElite){chip.style.background='linear-gradient(135deg,#ffd700,#ff8c00)';chip.style.color='#1a0a00';}
  else{chip.style.background='';chip.style.color='';}
  const btnWp=document.getElementById('btn-wallpaper');
  const btnAdm=document.getElementById('btn-admin-dm');
  if(btnWp)btnWp.style.display=isElite?'flex':'none';
  if(btnAdm)btnAdm.style.display=isElite?'flex':'none';
}

// ── PAYMENT ──
function startPayment(planId){
  const plan=PLANS.find(p=>p.id===planId);
  if(!plan||plan.price===0)return;
  pendingPlan=planId;
  document.getElementById('pay-plan-name').textContent=plan.name;
  document.getElementById('pay-plan-price').textContent='$'+plan.price;
  openModal('payment-modal');
  if(stripe){
    const el=stripe.elements({appearance:{theme:'night',variables:{colorPrimary:'#22c55e',colorBackground:'#0b1a0d',colorText:'#f0fdf4',borderRadius:'8px'}}});
    cardElement=el.create('card');
    setTimeout(()=>cardElement.mount('#card-element'),100);
  }
}

async function processPayment(){
  const btn=document.getElementById('btn-pay');
  btn.disabled=true;btn.innerHTML='<div class="dots"><span></span><span></span><span></span></div>';
  const amounts={starter:300,pro:1499,elite:3999};
  try{
    const r=await fetch('/api/create-payment-intent',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({plan:pendingPlan,amount:amounts[pendingPlan]||300})});
    const{clientSecret,error:ie}=await r.json();
    if(ie)throw new Error(ie);
    const{error,paymentIntent}=await stripe.confirmCardPayment(clientSecret,{payment_method:{card:cardElement}});
    if(error)throw new Error(error.message);
    if(paymentIntent.status==='succeeded'){
      if(pendingPlan==='boost_pub'){
        closeModal('payment-modal');
        applyBoostPub(null);
      } else if(pendingSignup){createUser({...pendingSignup,plan:pendingPlan});pendingSignup=null;}
      else if(currentUser){currentUser.plan=pendingPlan;localStorage.setItem('viralboost_user',JSON.stringify(currentUser));}
      if(pendingPlan!=='boost_pub'){
        closeModal('payment-modal');
        updateAppBar();
        showApp();
        toast('&#127881; Plan '+pendingPlan.toUpperCase()+' activated!');
      }
    }
  }catch(err){
    document.getElementById('card-errors').textContent=err.message;
    btn.disabled=false;btn.textContent='🔒 S\'abonner';
  }
}

// ── WEBSOCKET ──
function connectWS(){
  if(!currentUser)return;
  try{
    const proto=location.protocol==='https:'?'wss':'ws';
    ws=new WebSocket(`${proto}://${location.host}`);
    ws.onopen=()=>{
      wsRetries=0;
      ws.send(JSON.stringify({type:'join',userId:currentUser.email,name:currentUser.name,plan:currentUser.plan||'free'}));
    };
    ws.onmessage=(e)=>{
      try{
        const data=JSON.parse(e.data);
        // Chat history on load (previous messages)
        if(data.type==='history'&&Array.isArray(data.messages)){
          worldChatMsgs=data.messages.map(m=>({name:m.name,plan:m.plan||'free',text:m.text,time:new Date(m.timestamp).toLocaleTimeString('en',{hour:'2-digit',minute:'2-digit'})}));
          if(document.getElementById('tab-chat-global')?.classList.contains('active'))buildWorldChat();
        }
        // Previous showcase publications sent on login
        if(data.type==='projects_history'&&Array.isArray(data.projects)){
          const apiIds=new Set(data.projects.map(p=>p.id));
          showcaseData=[...data.projects,...(showcaseData||[]).filter(p=>!apiIds.has(p.id))];
          if(document.getElementById('tab-showcase')?.classList.contains('active'))buildShowcaseGrid('app-showcase-grid');
        }
        if(data.type==='message'&&data.message){
          worldChatMsgs.push({name:data.message.name,plan:data.message.plan||'free',text:data.message.text,time:new Date(data.message.timestamp).toLocaleTimeString('en',{hour:'2-digit',minute:'2-digit'})});
          if(document.getElementById('tab-chat-global')?.classList.contains('active'))buildWorldChat();
          else{const nd=document.getElementById('chat-notif');if(nd)nd.style.display='inline-block';}
        }
        if(data.type==='online_users'){
          const cnt=document.getElementById('world-online-count');
          if(cnt)cnt.textContent=data.users.length+' online';
        }
        if(data.type==='dm'&&data.message?.fromId){
          const fromId=data.message.fromId;
          if(!dmThreads[fromId])dmThreads[fromId]=[];
          dmThreads[fromId].push({fromMe:false,text:data.message.text,time:new Date().toLocaleTimeString('en',{hour:'2-digit',minute:'2-digit'})});
          if(dmTarget&&dmTarget.id===fromId)renderDMThread(fromId);
          toast('💬 New DM from '+data.message.fromName);
        }
        if(data.type==='vote_update'){
          document.querySelectorAll('[data-pid="'+data.projectId+'"] .vote-count').forEach(el=>el.textContent=data.votes);
        }
        if(data.type==='new_project'&&data.project?.authorId!==currentUser?.email){
          showcaseData.unshift(data.project);
          toast('🚀 New project : '+data.project.name);
        }
        if(data.type==='new_post'&&data.post?.userId!==currentUser?.email){
          // Add the post in real time
          if(!feedPosts.find(p=>p.id===data.post.id)){
            const p=data.post;
            p.time='Just now';
            feedPosts.unshift(p);
            if(document.getElementById('tab-feed')?.classList.contains('active'))buildFeed();
          }
        }
        if(data.type==='like_update'){
          const p=feedPosts.find(p=>p.id===data.postId);
          if(p){p.likes=data.likes;}
          const cnt=document.querySelector(`#post-${data.postId} .like-count`);
          if(cnt)cnt.textContent=data.likes;
        }
        if(data.type==='comment_update'){
          const p=feedPosts.find(p=>p.id===data.postId);
          if(p)p.comments=data.comments;
          const cnt=document.querySelector(`#post-${data.postId} .comment-count`);
          if(cnt)cnt.textContent=data.comments;
        }
        if(data.type==='share_update'){
          const cnt=document.querySelector(`#post-${data.postId} .share-count`);
          if(cnt)cnt.textContent=data.shares;
        }
        if(data.type==='group_message'&&data.groupId===currentGroupId){
          if(document.getElementById('group-chat-modal')?.classList.contains('open')){
            loadGroupMessages(currentGroupId);
          }
        }
      }catch(e){}
    };
    ws.onclose=()=>{
      wsRetries=(wsRetries||0)+1;
      if(wsRetries<10)setTimeout(connectWS,Math.min(5000*wsRetries,30000));
    };
  }catch(e){}
}

// ── TIMERS (posts) ──
function updateTimers(){
  document.querySelectorAll('.post-timer-val').forEach(el=>{
    const end=parseInt(el.dataset.end);
    if(!end)return;
    const left=end-Date.now();
    if(left<=0){el.closest('.post-card')?.remove();return;}
    const m=Math.floor(left/60000),s=Math.floor((left%60000)/1000);
    el.textContent=m+'m'+String(s).padStart(2,'0')+'s';
  });
}
setInterval(updateTimers,1000);

// ── TABS update to include groups ──
function showAppTab(tab,el){
  syncBottomNav(tab);
  // Reset toutes les couleurs custom
  document.querySelectorAll('.app-tab').forEach(t=>{
    t.classList.remove('active');
    t.style.color='';
    t.style.borderBottomColor='';
  });
  document.querySelectorAll('.tpanel').forEach(p=>p.classList.remove('active'));
  // Trouver le bon bouton tab
  const targetBtn = el || document.querySelector('[data-tab="'+tab+'"]') || document.querySelector('.app-tab[onclick*=\"'+tab+'\"]');
  if(targetBtn){
    targetBtn.classList.add('active');
    const color = targetBtn.dataset.color;
    if(color){ 
      targetBtn.style.color=color; 
      targetBtn.style.borderBottomColor=color;
      targetBtn.style.setProperty('--tab-active-color', color);
    } else {
      targetBtn.style.color='var(--white)';
    }
  }
  const panel=document.getElementById('tab-'+tab);
  if(panel)panel.classList.add('active');
  // Onglets originaux
  if(tab==='showcase')buildShowcaseGrid('app-showcase-grid');
  if(tab==='profile')renderMyProfile();
  if(tab==='abonnes')buildFollowList('discover');
  if(tab==='chat-global'){buildWorldChat();const nd=document.getElementById('chat-notif');if(nd)nd.style.display='none';}
  if(tab==='feed')buildFeed();
  if(tab==='groups')loadGroups();
  // Newx onglets
  if(tab==='stats'){ loadStats(); renderRevenueDashboard(); }
  if(tab==='leaderboard')loadLeaderboard('pubs');
  if(tab==='collab')loadCollabs();
  if(tab==='calendrier')buildCalendar();
  if(tab==='publish'){
    updatePubCompletion(); updateDescCount();
    setTimeout(()=>{ const drop=document.getElementById('pub-media-drop'); if(drop) drop.onclick=()=>document.getElementById('pub-media-input')?.click(); },100);
    // First-open guide
    if(!localStorage.getItem('vb_pub_guide_seen')){
      setTimeout(()=>{ document.getElementById('pub-guide-overlay')?.classList.remove('hidden'); }, 500);
    }
  }
  if(tab==='boost-credits'){updateCreditsDisplay();loadBoostPostOptions();renderMissions();updateMissionsCountdown();}
  if(tab==='home'){if(typeof renderHomeTab==='function')renderHomeTab();}
}

// ── GROUPES ──
async function loadGroups(){
  try{
    const r=await fetch('/api/groups');
    groupsData=await r.json();
  }catch(e){groupsData=[];}
  buildGroupsList();
  const btn=document.getElementById('btn-create-group');
  if(btn)btn.style.display=(currentUser?.plan==='elite')?'block':'none';
}

// No fake groups — only real groups created by members
const sampleGroups=[];

function buildGroupsList(){
  const el=document.getElementById('groups-list');
  if(!el)return;
  const data=groupsData;
  if(!data.length){
    el.innerHTML='<div style="text-align:center;padding:48px;color:var(--muted);grid-column:1/-1"><div style="font-size:40px;margin-bottom:12px">🏛️</div><div style="font-size:14px;font-weight:700;color:var(--g5);margin-bottom:8px">No groups yet</div><div style="font-size:12px">Elite members can create themed groups.</div></div>';
    return;
  }
  el.innerHTML=data.map(g=>`
    <div class="group-card" onclick="openGroupChat('${g.id}','${escHtml(g.name)}','${g.creatorId}','${g.access}','${g.allowPhotos||1}')">
      <div class="group-banner" style="${g.bgUrl?`background:url('${g.bgUrl}') center/cover`:'background:linear-gradient(135deg,var(--s2),var(--s3))'}">
        <span style="font-size:36px">${g.emoji||'💬'}</span>
        ${g.access==='private'?'<span style="position:absolute;top:8px;right:8px;font-size:10px;background:rgba(0,0,0,0.6);padding:2px 7px;border-radius:4px;color:#fff">🔒 Private</span>':''}
      </div>
      <div class="group-body">
        <div class="group-name">${g.name}</div>
        <div class="group-desc">${g.desc||''}</div>
        <div class="group-footer">
          <div class="group-meta">👥 ${g.membersCount||0} members · ${g.cat||''}</div>
          ${currentUser?.plan==='elite'&&currentUser?.email===g.creatorId?`<button class="btn-report" onclick="event.stopPropagation();openGroupSettings('${g.id}')" style="border-color:rgba(212,175,55,0.4);color:#f5c842">⚙️ Admin</button>`:''}
        </div>
      </div>
    </div>`).join('');
}

async function openGroupChat(groupId,groupName,creatorId,access,allowPhotos){
  if(!currentUser||currentUser.isDemo){openDemoSignupModal();return;}
  currentGroupId=groupId;
  document.getElementById('group-chat-title').textContent=groupName;
  // Show admin btn if elite creator
  const acts=document.getElementById('group-chat-actions');
  acts.innerHTML='';
  if(currentUser.plan==='elite'&&currentUser.email===creatorId){
    acts.innerHTML=`<button class="btn-report" onclick="openGroupSettings('${groupId}')" style="border-color:rgba(212,175,55,0.4);color:#f5c842">⚙️ Settings group</button>`;
  }
  // Show media upload if allowed
  const mediaBtnLabel=document.getElementById('group-media-btn');
  if(mediaBtnLabel)mediaBtnLabel.style.display=(allowPhotos==='1'||allowPhotos===1)?'flex':'none';
  await loadGroupMessages(groupId);
  openModal('group-chat-modal');
}

async function loadGroupMessages(groupId){
  const el=document.getElementById('group-chat-msgs');
  try{
    const r=await fetch('/api/groups/'+groupId+'/messages');
    const msgs=await r.json();
    if(!msgs.length){el.innerHTML='<div style="text-align:center;padding:32px;color:var(--muted);font-size:13px">Be the first to write in this group 👋</div>';return;}
    el.innerHTML=msgs.map(m=>`
      <div class="chat-msg-item">
        <div class="chat-msg-name">${escHtml(m.author||'Anonymous')} <span class="chat-msg-plan-badge plan-${m.plan||'free'}">${(m.plan||'FREE').toUpperCase()}</span><span style="font-family:'DM Mono',monospace;font-size:9px;color:var(--muted2);margin-left:auto">${m.timestamp?new Date(m.timestamp).toLocaleTimeString('en',{hour:'2-digit',minute:'2-digit'}):''}</span></div>
        ${m.text?`<div class="chat-msg-text">${escHtml(m.text)}</div>`:''}
        ${m.mediaUrl?`<div style="margin-top:4px">${m.mediaType?.startsWith('video')?`<video src="${m.mediaUrl}" controls style="max-width:200px;border-radius:6px"></video>`:`<img src="${m.mediaUrl}" style="max-width:200px;border-radius:6px;object-fit:cover"/>`}</div>`:''}
      </div>`).join('');
    el.scrollTop=el.scrollHeight;
  }catch(e){el.innerHTML='<div style="color:var(--muted);text-align:center;padding:20px">Unable to load messages</div>';}
}

async function sendGroupMessage(){
  if(!currentUser||currentUser.isDemo){openDemoSignupModal();return;}
  const inp=document.getElementById('group-chat-input');
  const text=inp.value.trim();
  if(!text||!currentGroupId)return;
  const msg={text,userId:currentUser.email,author:currentUser.name,plan:currentUser.plan||'free',timestamp:new Date().toISOString()};
  inp.value='';
  try{await fetch('/api/groups/'+currentGroupId+'/messages',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(msg)});}catch(e){}
  await loadGroupMessages(currentGroupId);
}

function openCreateGroup(){
  if(currentUser?.plan!=='elite'){toast('⭐ Creating a group is reserved for the ELITE plan.');startPayment('elite');return;}
  openModal('create-group-modal');
}

async function createGroup(){
  if(!currentUser){return;}
  const name=document.getElementById('grp-name').value.trim();
  const desc=document.getElementById('grp-desc').value.trim();
  if(!name||!desc){toast('Please fill in the name and description.');return;}
  const group={
    name,desc,emoji:document.getElementById('grp-emoji').value||'💬',
    cat:document.getElementById('grp-cat').value,
    access:document.getElementById('grp-access').value,
    rules:document.getElementById('grp-rules').value.trim(),
    bgUrl:groupBgUrl||'',allowPhotos:1,
    creatorId:currentUser.email,membersCount:1
  };
  try{
    const r=await fetch('/api/groups',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(group)});
    const d=await r.json();
    toast('🏛️ Group created!');
    closeModal('create-group-modal');
    groupBgUrl=null;
    await loadGroups();
  }catch(e){
    // Local fallback if no backend
    group.id='grp'+Date.now();
    groupsData.unshift(group);
    toast('🏛️ Group created!');
    closeModal('create-group-modal');
    buildGroupsList();
  }
}

function openGroupSettings(groupId){
  currentGroupSettingsId=groupId;
  const grp=groupsData.find(g=>g.id===groupId);
  if(grp){
    document.getElementById('gs-rules').value=grp.rules||'';
    document.getElementById('gs-allow-photos').value=grp.allowPhotos||1;
    document.getElementById('gs-access').value=grp.access||'public';
  }
  openModal('group-settings-modal');
}

async function saveGroupSettings(){
  if(!currentGroupSettingsId)return;
  const settings={
    allowPhotos:parseInt(document.getElementById('gs-allow-photos').value),
    rules:document.getElementById('gs-rules').value.trim(),
    access:document.getElementById('gs-access').value
  };
  if(groupSettingsBgUrl)settings.bgUrl=groupSettingsBgUrl;
  try{
    await fetch('/api/groups/'+currentGroupSettingsId+'/settings',{method:'PUT',headers:{'Content-Type':'application/json'},body:JSON.stringify({settings,requesterId:currentUser.email})});
    toast('✅ Group settings updated!');
    closeModal('group-settings-modal');
    groupSettingsBgUrl=null;
    await loadGroups();
  }catch(e){toast('Settings error.');}
}

// ── SIGNALEMENT ──
function openReport(userId,userName){
  if(!currentUser||currentUser.isDemo){openDemoSignupModal();return;}
  reportTarget={id:userId,name:userName};
  document.getElementById('report-modal-sub').textContent='Report: '+userName+' → sent to admin';
  openModal('report-modal');
}

async function submitReport(){
  if(!reportTarget||!currentUser)return;
  const reason=document.getElementById('report-reason').value;
  const details=document.getElementById('report-details').value.trim();
  try{
    await fetch('/api/report',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({
      reporterId:currentUser.email,reporterEmail:currentUser.email,reporterName:currentUser.name,
      reportedId:reportTarget.id,reportedName:reportTarget.name,reason,details
    })});
    toast('🚨 Report sent to admin!');
    closeModal('report-modal');
  }catch(e){toast('Error sending report.');}
}

// ── CONTACT ADMIN (ELITE) ──
function openContactAdmin(){
  if(currentUser?.plan!=='elite'){toast('⭐ Contacting admin is reserved for the ELITE plan.');return;}
  openModal('contact-admin-modal');
}

async function sendAdminMessage(){
  if(!currentUser)return;
  const subject=document.getElementById('ca-subject').value.trim();
  const message=document.getElementById('ca-message').value.trim();
  if(!message){toast('Write your message.');return;}
  try{
    await fetch('/api/contact-admin',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({
      fromName:currentUser.name,fromEmail:currentUser.email,fromPlan:currentUser.plan,
      subject,message
    })});
    toast('📩 Message sent to admin!');
    closeModal('contact-admin-modal');
  }catch(e){toast('Error sending.');}
}

// ── HERO PUBLISH AD ──
function heroPublishAd(){
  const name=document.getElementById('hero-ad-name').value.trim();
  const type=document.getElementById('hero-ad-type').value;
  const desc=document.getElementById('hero-ad-desc').value.trim();
  if(!name){document.getElementById('hero-ad-name').focus();toast('Enter your product name!','error');return;}
  if(!desc){document.getElementById('hero-ad-desc').focus();toast('Briefly describe your ad!','error');return;}
  // Pre-fill signup modal and publish the ad after sign up
  window._pendingHeroAd={name,type,desc};
  openModal('signup-modal');
  toast('✅ Create your account to publish your ad!');
}

// ── PUBLIC FEED ──
function buildPublicFeed(){
  const el=document.getElementById('public-feed-list');
  if(!el)return;
  const publicPosts=[...feedPosts].slice(0,3);
  if(!publicPosts.length){
    el.innerHTML=`<div style="text-align:center;padding:48px 24px;color:var(--muted)">
      <div style="font-size:40px;margin-bottom:12px">📢</div>
      <div style="font-size:14px;color:var(--g5);font-weight:700;margin-bottom:8px">Be the first to publish!</div>
      <div style="font-size:12px;line-height:1.8">The feed fills up with real community posts.</div>
      <button class="btn-unlock-feed" onclick="openModal('signup-modal')" style="margin-top:20px">Create an account & publish →</button>
    </div>`;
    return;
  }
  el.innerHTML=`<div>${publicPosts.slice(0,3).map(p=>{
    const isElite=p.plan==='elite';
    return `<div class="public-post-card ${isElite?'elite-pub':''}">
      <div style="display:flex;align-items:center;gap:8px;margin-bottom:8px">
        <div style="width:32px;height:32px;border-radius:50%;background:${getAvatarColor(p.userId)};display:flex;align-items:center;justify-content:center;font-size:13px;font-weight:700;color:var(--bg)">${p.emoji||p.author?.[0]||'?'}</div>
        <div>
          <div style="font-size:13px;font-weight:700;${isElite?'color:var(--gold)':''}">${p.author||'Anonymous'}</div>
          <div style="font-size:10px;color:var(--muted);font-family:'DM Mono',monospace">${p.time||''}</div>
        </div>
        <span class="chat-msg-plan-badge plan-${p.plan||'free'}" style="margin-left:auto">${(p.plan||'FREE').toUpperCase()}</span>
      </div>
      <div style="font-size:13px;line-height:1.7;color:#c4d9cb">${p.text?p.text.slice(0,160)+(p.text.length>160?'...':''):''}</div>
      <div style="display:flex;gap:8px;margin-top:10px">
        <span style="font-size:11px;color:${isElite?'var(--gold)':'var(--muted)'};display:flex;align-items:center;gap:4px"><svg width="12" height="12" viewBox="0 0 24 24" fill="${isElite?'var(--gold)':'var(--muted)'}" stroke="none"><path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"/></svg> ${p.likes||0}</span>
        <span style="font-size:11px;color:${isElite?'var(--gold)':'var(--muted)'};display:flex;align-items:center;gap:4px"><svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="${isElite?'var(--gold)':'var(--muted)'}" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"/></svg> ${p.comments||0}</span>
        <span style="font-size:11px;color:${isElite?'var(--gold)':'var(--muted)'};display:flex;align-items:center;gap:4px"><svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="${isElite?'var(--gold)':'var(--muted)'}" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"/><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"/></svg> Share</span>
      </div>
    </div>`;
  }).join('')}</div><div class="feed-lock"><button class="btn-unlock-feed" onclick="openModal('signup-modal')">📢 See full feed & publish your ad →</button></div>`;
}

// ── MEDIA PREVIEW ──
function previewFeedMedia(input){
  const preview=document.getElementById('feed-media-preview');
  if(!preview)return;
  preview.innerHTML='';
  const files=Array.from(input.files).slice(0,4);
  files.forEach(f=>{
    const div=document.createElement('div');
    div.className='media-preview-item';
    if(f.type.startsWith('image/')){
      const img=document.createElement('img');
      img.src=URL.createObjectURL(f);
      div.appendChild(img);
    } else if(f.type.startsWith('video/')){
      const vid=document.createElement('video');
      vid.src=URL.createObjectURL(f);
      vid.muted=true;
      div.appendChild(vid);
    } else {
      div.innerHTML=`<div style="padding:8px;font-size:11px;color:var(--g4);text-align:center">📄<br>${f.name.slice(0,12)}</div>`;
    }
    const rm=document.createElement('button');
    rm.className='rm-media';rm.textContent='✕';
    rm.onclick=()=>{div.remove();};
    div.appendChild(rm);
    preview.appendChild(div);
  });
}

// ── REPORT (with radio) ──
function submitReport(){
  if(!currentUser)return;
  const radios=document.querySelectorAll('input[name="report-reason"]');
  let reason='';
  radios.forEach(r=>{if(r.checked)reason=r.value;});
  if(!reason){toast('Please choose a report reason.');return;}
  const details=document.getElementById('report-details').value.trim();
  fetch('/api/report',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({
    reporterId:currentUser?.email||'anonymous',reporterName:currentUser?.name||'?',
    reportedId:reportTarget?.id||'?',reportedName:reportTarget?.name||'?',reason,details,timestamp:new Date().toISOString()
  })}).catch(()=>{});
  toast('🚨 Report sent to admin!');
  closeModal('report-modal');
  reportTarget=null;
}

// ── SEND GROUP MSG ──
function sendGroupMsg(){
  if(!currentUser||currentUser.isDemo){openDemoSignupModal();return;}
  const inp=document.getElementById('group-chat-in');
  const text=inp.value.trim();
  if(!text||!currentGroupId)return;
  const now=new Date();
  const time=now.getHours()+':'+String(now.getMinutes()).padStart(2,'0');
  const el=document.getElementById('group-chat-msgs');
  const div=document.createElement('div');
  div.className='chat-msg-item';
  div.innerHTML=`<div class="chat-msg-name">${escHtml(currentUser.name)} <span class="chat-msg-plan-badge plan-${currentUser.plan||'free'}">${(currentUser.plan||'FREE').toUpperCase()}</span><span style="font-family:'DM Mono',monospace;font-size:9px;color:var(--muted2);margin-left:auto">${time}</span></div><div class="chat-msg-text">${escHtml(text)}</div>`;
  el.appendChild(div);el.scrollTop=el.scrollHeight;
  inp.value='';
  fetch('/api/groups/'+currentGroupId+'/messages',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({text,userId:currentUser.email,author:currentUser.name,plan:currentUser.plan||'free'})}).catch(()=>{});
}

function sendGroupMedia(input){
  const f=input.files[0];
  if(!f||!currentGroupId)return;
  const el=document.getElementById('group-chat-msgs');
  const div=document.createElement('div');
  div.className='chat-msg-item';
  const url=URL.createObjectURL(f);
  div.innerHTML=`<div class="chat-msg-name">${escHtml(currentUser.name)} <span class="chat-msg-plan-badge plan-${currentUser.plan||'free'}">${(currentUser.plan||'FREE').toUpperCase()}</span></div><div style="margin-top:4px">${f.type.startsWith('video')?`<video src="${url}" controls style="max-width:200px;border-radius:6px"></video>`:`<img src="${url}" style="max-width:200px;border-radius:6px"/>`}</div>`;
  el.appendChild(div);el.scrollTop=el.scrollHeight;
  input.value='';
}

// ── CREATE GROUP (new modal IDs) ──
function createGroup(){
  if(!currentUser){return;}
  if(currentUser.plan!=='elite'){toast('⭐ Creating a group is reserved for the ELITE plan.');return;}
  const name=document.getElementById('cg-name')?.value.trim();
  if(!name){toast('Please name your group.');return;}
  const group={
    id:'grp'+Date.now(),name,emoji:document.getElementById('cg-emoji')?.value||'💬',
    desc:document.getElementById('cg-desc')?.value.trim()||'',
    cat:document.getElementById('cg-cat')?.value||'other',
    access:document.getElementById('cg-private')?.checked?'private':'public',
    allowPhotos:document.getElementById('cg-allow-photos')?.checked?1:0,
    allowVideos:document.getElementById('cg-allow-videos')?.checked?1:0,
    premod:document.getElementById('cg-premod')?.checked?1:0,
    creatorId:currentUser.email,membersCount:1
  };
  groupsData.unshift(group);
  toast('🏆 Group created!');
  closeModal('create-group-modal');
  if(document.getElementById('tab-groups')?.classList.contains('active'))buildGroupsList();
  fetch('/api/groups',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(group)}).catch(()=>{});
}

// ── WALLPAPER (ELITE) ──
function setWallpaper(bg){
  if(currentUser?.plan!=='elite'){toast('⭐ The background is reserved for the ELITE plan.');return;}
  const app=document.getElementById('app');
  if(bg==='none'){app.style.background='';app.classList.remove('has-wallpaper');}
  else{app.style.background=bg;app.classList.add('has-wallpaper');}
  currentUser.wallpaper=bg;
  localStorage.setItem('viralboost_user',JSON.stringify(currentUser));
  closeModal('wallpaper-modal');
  toast('🖼️ Background applied!');
}

function setWallpaperFromFeede(input){
  if(!input.files[0])return;
  if(currentUser?.plan!=='elite'){toast('⭐ The background is reserved for the ELITE plan.');return;}
  const url=URL.createObjectURL(input.files[0]);
  const app=document.getElementById('app');
  app.style.background=`url('${url}') center/cover fixed`;
  app.classList.add('has-wallpaper');
  toast('🖼️ Background applied!');
  closeModal('wallpaper-modal');
}

// ── DM ADMIN (ELITE) ──
let adminDMMessages=[];
function openAdminDM(){
  if(currentUser?.plan!=='elite'){toast('⭐ Contacting admin directly is reserved for the ELITE plan.');return;}
  renderAdminDMThread();
  openModal('dm-admin-modal');
}
function renderAdminDMThread(){
  const el=document.getElementById('dm-admin-msgs');
  if(!el)return;
  if(!adminDMMessages.length){el.innerHTML='<div style="text-align:center;padding:24px;color:var(--muted);font-size:12px">📩 First message to admin — reply within 24h</div>';return;}
  el.innerHTML=adminDMMessages.map(m=>`<div class="dm-msg ${m.fromMe?'mine':'theirs'}"><div class="dm-bubble-g">${escHtml(m.text)}</div><div class="dm-time">${m.time}</div></div>`).join('');
  el.scrollTop=el.scrollHeight;
}
function sendAdminDM(){
  const inp=document.getElementById('dm-admin-input');
  const text=inp.value.trim();
  if(!text||!currentUser)return;
  const now=new Date();
  const time=now.getHours()+':'+String(now.getMinutes()).padStart(2,'0');
  adminDMMessages.push({fromMe:true,text,time});
  inp.value='';
  renderAdminDMThread();
  fetch('/api/admin-dm',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({fromEmail:currentUser.email,fromName:currentUser.name,fromPlan:currentUser.plan,text,timestamp:new Date().toISOString()})}).catch(()=>{});
  toast('📩 Message sent to admin!');
}

// ── OPEN REPORT ──
function openReport(userId,userName){
  if(!currentUser||currentUser.isDemo){openDemoSignupModal();return;}
  reportTarget={id:userId,name:userName};
  document.getElementById('report-modal-sub').textContent='Report: '+userName+' → sent to admin';
  document.querySelectorAll('input[name="report-reason"]').forEach(r=>r.checked=false);
  document.getElementById('report-details').value='';
  openModal('report-modal');
}

// ── OPEN GROUP CHAT ──
function openGroupChat(groupId,groupName,creatorId,access,allowPhotos){
  if(!currentUser||currentUser.isDemo){openDemoSignupModal();return;}
  currentGroupId=groupId;
  document.getElementById('group-chat-title').textContent=groupName;
  document.getElementById('group-chat-sub').textContent='Discussion group · '+(access==='private'?'🔒 Private':'🌍 Public');
  // Admin controls
  const adminCtrl=document.getElementById('group-admin-controls');
  if(adminCtrl)adminCtrl.style.display=(currentUser.plan==='elite'&&currentUser.email===creatorId)?'block':'none';
  // Media upload
  const mediLabel=document.getElementById('group-media-upload-label');
  if(mediLabel)mediLabel.style.display=(allowPhotos==='1'||allowPhotos===1||allowPhotos===true)?'inline-flex':'none';
  // Load members
  const ml=document.getElementById('group-members-list');
  if(ml)ml.innerHTML='<div style="color:var(--muted2);font-size:11px">👥 Online...</div>';
  // Load messages
  const msgEl=document.getElementById('group-chat-msgs');
  msgEl.innerHTML='<div style="text-align:center;padding:24px;color:var(--muted)">Be the first to write in this group 👋</div>';
  fetch('/api/groups/'+groupId+'/messages').then(r=>r.json()).then(msgs=>{
    if(!msgs.length)return;
    msgEl.innerHTML=msgs.map(m=>`<div class="chat-msg-item"><div class="chat-msg-name">${escHtml(m.author||'?')} <span class="chat-msg-plan-badge plan-${m.plan||'free'}">${(m.plan||'FREE').toUpperCase()}</span><span style="font-family:'DM Mono',monospace;font-size:9px;color:var(--muted2);margin-left:auto">${m.timestamp?new Date(m.timestamp).toLocaleTimeString('en',{hour:'2-digit',minute:'2-digit'}):''}</span></div>${m.text?`<div class="chat-msg-text">${escHtml(m.text)}</div>`:''}${m.mediaUrl?`<div style="margin-top:4px">${m.mediaType?.startsWith('video')?`<video src="${m.mediaUrl}" controls style="max-width:200px;border-radius:6px"></video>`:`<img src="${m.mediaUrl}" style="max-width:200px;border-radius:6px"/>`}</div>`:''}</div>`).join('');
    msgEl.scrollTop=msgEl.scrollHeight;
  }).catch(()=>{});
  openModal('group-chat-modal');
}

function openGroupSettings(groupId){
  if(currentUser?.plan!=='elite'){toast('⭐ Reserved for the ELITE plan.');return;}
  openModal('create-group-modal');
}

// ── GOLD LIKE/SHARE/COMMENT ELITE ──
function likePost(id,btn){
  const p=feedPosts.find(p=>p.id===id);
  if(!p)return;
  p.myLike=!p.myLike;
  p.likes+=p.myLike?1:-1;
  // Toggle like-active class (rouge)
  btn.classList.toggle('like-active',p.myLike);
  // Animation burst
  btn.classList.add('like-burst');
  setTimeout(()=>btn.classList.remove('like-burst'),400);
  // Update SVG fill
  const svg=btn.querySelector('svg');
  if(svg)svg.setAttribute('fill',p.myLike?'currentColor':'none');
  const cnt=btn.querySelector('.like-count');
  if(cnt)cnt.textContent=p.likes;
  // WS broadcast
  if(ws&&ws.readyState===1){ws.send(JSON.stringify({type:'like',postId:id,likes:p.likes,userId:currentUser?.email,userPlan:currentUser?.plan}));}
}

function savePost(id,btn){
  const p=feedPosts.find(p=>p.id===id);
  if(!p)return;
  if(!currentUser||currentUser.isDemo){openDemoSignupModal();return;}
  p.mySave=!p.mySave;
  btn.classList.toggle('save-active',p.mySave);
  const svg=btn.querySelector('svg');
  if(svg)svg.setAttribute('fill',p.mySave?'currentColor':'none');
  toast(p.mySave?'🔖 Post saved!':'🔖 Removed from saved');
}

function toggleLikeProject(e,id,btn){
  e.stopPropagation();
  if(!currentUser||currentUser.isDemo){openDemoSignupModal();return;}
  if(!window._likedProjects)window._likedProjects=new Set();
  const p=showcaseData.find(x=>x.id===id);
  if(!p)return;
  if(window._likedProjects.has(id)){
    window._likedProjects.delete(id);
    p.likes=Math.max(0,(p.likes||1)-1);
    btn.classList.remove('liked');
    btn.querySelector('.v-heart').textContent='🤍';
  }else{
    window._likedProjects.add(id);
    p.likes=(p.likes||0)+1;
    btn.classList.add('liked');
    const heart=btn.querySelector('.v-heart');
    heart.textContent='❤️';
    heart.style.animation='none';void heart.offsetWidth;heart.style.animation='';
  }
  const num=btn.querySelector('.v-like-num');
  if(num)num.textContent=fmtNum(p.likes||0);
}

function toggleSaveProject(e,id,btn){
  e.stopPropagation();
  if(!currentUser||currentUser.isDemo){openDemoSignupModal();return;}
  if(!window._savedProjects)window._savedProjects=new Set();
  if(window._savedProjects.has(id)){
    window._savedProjects.delete(id);
    btn.classList.remove('saved');
    btn.textContent='🔖 Save';
    toast('🔖 Removed from saved');
  }else{
    window._savedProjects.add(id);
    btn.classList.add('saved');
    btn.textContent='🔖 Saved';
    toast('🔖 Project saved!');
  }
}

function openWallpaperModal(){
  if(currentUser?.plan!=='elite'){toast('⭐ Reserved for the ELITE plan.');return;}
  openModal('wallpaper-modal');
}
function _patchWS(){
  if(ws){
    const origOnMessage=ws.onmessage;
    ws.onmessage=(e)=>{
      if(origOnMessage)origOnMessage(e);
      try{
        const data=JSON.parse(e.data);
        if(data.type==='like'){
          const btn=document.querySelector(`[data-post-id="${data.postId}"] .btn-like`);
          if(btn)btn.textContent='❤️ '+data.likes;
        }
      }catch(err){}
    };
  }
}

function openWallpaperModal(){
  if(currentUser?.plan!=='elite'){toast('⭐ Reserved for the ELITE plan.');return;}
  openModal('wallpaper-modal');
}

// ── WEBSOCKET — update for group messages ──

function escHtml(s){return String(s).replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;');}
function getAvatarColor(id){const colors=['linear-gradient(135deg,#15803d,#4ade80)','linear-gradient(135deg,#166534,#22c55e)','linear-gradient(135deg,#14532d,#86efac)','linear-gradient(135deg,#065f46,#34d399)'];return colors[(id||'').split('').reduce((a,c)=>a+c.charCodeAt(0),0)%colors.length];}
function getTypeEmoji(t){return{site:'🌐',app:'📱',saas:'🚀',tiktok:'🎵',instagram:'📸',ecommerce:'🛍️'}[t]||'🚀';}

/* SVG icons par catégorie */
function getTypeSVG(t){
  const icons={
    site:`<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="9"/><path d="M2 12h20M12 2a15 15 0 0 1 0 20M12 2a15 15 0 0 0 0 20"/></svg>`,
    app:`<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"><rect x="5" y="2" width="14" height="20" rx="3"/><circle cx="12" cy="17" r="1" fill="currentColor" stroke="none"/></svg>`,
    saas:`<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"><path d="M12 2L2 7l10 5 10-5-10-5z"/><path d="M2 17l10 5 10-5"/><path d="M2 12l10 5 10-5"/></svg>`,
    tiktok:`<svg viewBox="0 0 24 24" fill="currentColor"><path d="M19.59 6.69a4.83 4.83 0 0 1-3.77-4.25V2h-3.45v13.67a2.89 2.89 0 0 1-2.88 2.5 2.89 2.89 0 0 1-2.89-2.89 2.89 2.89 0 0 1 2.89-2.89c.28 0 .54.04.79.1V9.01a6.32 6.32 0 0 0-.79-.05 6.34 6.34 0 0 0-6.34 6.34 6.34 6.34 0 0 0 6.34 6.34 6.34 6.34 0 0 0 6.33-6.34V8.69a8.17 8.17 0 0 0 4.78 1.52V6.77a4.85 4.85 0 0 1-1.01-.08z"/></svg>`,
    instagram:`<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"><rect x="2" y="2" width="20" height="20" rx="5"/><circle cx="12" cy="12" r="4"/><circle cx="17.5" cy="6.5" r="0.5" fill="currentColor" stroke="none"/></svg>`,
    ecommerce:`<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"><path d="M6 2L3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4z"/><line x1="3" y1="6" x2="21" y2="6"/><path d="M16 10a4 4 0 0 1-8 0"/></svg>`,
    service:`<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"><rect x="2" y="7" width="20" height="14" rx="2"/><path d="M16 7V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v2"/><line x1="12" y1="12" x2="12" y2="16"/><line x1="10" y1="14" x2="14" y2="14"/></svg>`,
    default:`<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></svg>`
  };
  return icons[t]||icons.default;
}

const TYPE_COLORS={site:'#60a5fa',app:'#a78bfa',saas:'#4ade80',tiktok:'#f472b6',instagram:'#fb923c',ecommerce:'#fbbf24',service:'#22d3ee',default:'#4ade80'};

function getTypeIcon(t){
  const color=TYPE_COLORS[t]||TYPE_COLORS.default;
  return `<span class="post-proj-svg" style="color:${color}">${getTypeSVG(t)}</span>`;
}
function typeName(t){return{site:'Website',app:'Application',saas:'SaaS',tiktok:'TikTok',instagram:'Instagram',ecommerce:'E-commerce'}[t]||t;}

// ── MODALS ──
function openModal(id){document.getElementById(id).classList.add('open');}
function closeModal(id){document.getElementById(id).classList.remove('open');}
function switchModal(a,b){closeModal(a);setTimeout(()=>openModal(b),200);}
document.querySelectorAll('.modal-bg').forEach(m=>m.addEventListener('click',e=>{if(e.target===m)m.classList.remove('open');}));

// ── STRIPE ──
try{stripe=Stripe('pk_test_YOUR_STRIPE_KEY_HERE');}catch(e){}

// ── INIT ──
window.addEventListener('load', function(){
  // Init fake data immediately so feed & showcase are never empty
  initFakeData();
  renderPlans();
  buildShowcaseGrid('landing-showcase-grid');
  buildPublicFeed();
  // Then try to load real data from API in background
  loadPostsFromAPI();
});

// ── SMART AUTO-LOGIN ──
function _tryAutoLogin(){
  const saved = localStorage.getItem('viralboost_user');
  if(!saved) return false;
  try{
    const u = JSON.parse(saved);
    if(u && u.email){
      // Reload freshest version from accounts store
      const accounts = _getAccounts();
      currentUser = accounts[u.email.toLowerCase()] || u;
      localStorage.setItem('viralboost_user', JSON.stringify(currentUser));
      showApp();
      return true;
    }
  }catch(e){}
  return false;
}


</script>
<!-- ── FIRST 100 OFFER POPUP — shown after 10 seconds ── -->
<div id="offer-popup" class="hidden">
  <div id="offer-box-wrap">
    <!-- Default content visible instantly -->
    <div class="offer-box">
      <button class="offer-close-btn" onclick="closeOffer()">✕</button>
      <div class="offer-crown">🎁</div>
      <div class="offer-title">LAUNCH OFFER</div>
      <div class="offer-sub">Limitd to the first 100 signups only</div>
      <div class="offer-badge">💎 PRO PLAN — 1 YEAR 100% FREE</div>
      <div class="offer-desc">
        Real value: <strong>179,88$</strong><br>
        ✅ 999 posts/day<br>
        ✅ Unlimitd AI Coach<br>
        ✅ Showcase 30 days<br>
        ✅ ✅ Unlimitd chat
      </div>
      <div class="offer-timer">⏰ Offer expires in: <span id="offer-countdown">--:--:--</span></div>
      <div class="offer-counter">
        <div class="offer-counter-num" id="offer-remaining">—</div>
        <div class="offer-counter-lbl">spots remaining out of 100</div>
      </div>
      <button class="offer-cta" onclick="claimOffer()">🚀 CREATE MY FREE ACCOUNT</button>
      <div class="offer-skip" onclick="closeOffer()">No thanks, I'll pay</div>
    </div>
  </div>
</div>

<script>

// ══════════════════════════════════════════════
// ── NEW FEATURES ViralBoost v2 ──
// ══════════════════════════════════════════════

// ── ONBOARDING TOOLTIP (mini help on arrival) ──
const OB_STEPS = [
  {icon:'&#128226;', label:'PUBLISH YOUR PROJECT', desc:"Click Publish and fill in your profile in 2 min."},
  {icon:'&#128479;', label:'VOTE & EXPLORE', desc:"Vote for projects you like. You earn credits."},
  {icon:'&#129302;', label:'AI BOOST', desc:'Generate a TikTok, SEO or Email strategy in 10 seconds.'},
  {icon:'&#129309;', label:'FIND COLLABS', desc:"AI matching connects creators by niche and goals."},
  {icon:'&#9889;', label:'EARN CREDITS', desc:"Post, vote, complete missions. Your credits unlock boosts."},
];
let _obStep = 0;
let _obTooltip = null;

function checkOnboarding(){
  if(!currentUser) return;
  // If profile onboarding not done yet, wait for it to finish first
  if(!currentUser.onboarded){
    // Will be triggered by finishOnboarding() or skipOnboarding()
    return;
  }
  if(localStorage.getItem('vb_onboarded_'+currentUser.email)) return;
  setTimeout(showOnboardingTooltip, 800);
}

function showOnboardingTooltip(){
  if(document.getElementById('ob-tooltip')) return;
  _obStep = 0;
  const el = document.createElement('div');
  el.id = 'ob-tooltip';
  el.className = 'ob-tooltip';
  el.innerHTML = buildTooltipHTML();
  document.body.appendChild(el);
  _obTooltip = el;
}

function buildTooltipHTML(){
  const s = OB_STEPS[_obStep];
  const isLast = _obStep === OB_STEPS.length - 1;
  return `<div class="ob-tooltip-inner">
    <div class="ob-tooltip-header">
      <div style="font-family:'Bebas Neue',sans-serif;font-size:14px;letter-spacing:2px;color:var(--g3)">✦ HOW DOES IT WORK?</div>
      <button class="ob-tooltip-close" onclick="closeOnboardingTooltip()">✕</button>
    </div>
    <div class="ob-steps-row" id="ob-steps-row">
      ${OB_STEPS.map((step, i) => `
        <div class="ob-step-card ${i === _obStep ? 'active' : ''}" onclick="goObStep(${i})">
          <div class="ob-step-icon">${step.icon}</div>
          <div class="ob-step-label">${step.label}</div>
          <div class="ob-step-desc">${i === _obStep ? step.desc : ''}</div>
        </div>`).join('')}
    </div>
    <div class="ob-tooltip-footer">
      <div class="ob-progress">
        ${OB_STEPS.map((_, i) => `<div class="ob-dot ${i === _obStep ? 'active' : ''}"></div>`).join('')}
      </div>
      <div style="display:flex;gap:8px;align-items:center">
        <span onclick="closeOnboardingTooltip()" style="font-size:11px;color:var(--muted2);cursor:pointer;text-decoration:underline">Passer</span>
        <button class="ob-btn-next" onclick="${isLast ? 'closeOnboardingTooltip()' : 'obNext()'}">${isLast ? 'Let\'s go 🚀' : 'Next →'}</button>
      </div>
    </div>
  </div>`;
}

function goObStep(i){
  _obStep = i;
  if(_obTooltip) _obTooltip.innerHTML = buildTooltipHTML();
}
function obNext(){
  if(_obStep < OB_STEPS.length - 1){ _obStep++; if(_obTooltip) _obTooltip.innerHTML = buildTooltipHTML(); }
  else closeOnboardingTooltip();
}
function closeOnboardingTooltip(){
  const el = document.getElementById('ob-tooltip');
  if(!el) return;
  el.classList.add('hiding');
  setTimeout(() => el.remove(), 350);
  if(currentUser) localStorage.setItem('vb_onboarded_'+currentUser.email, '1');
}

// Keep showOnboarding as alias
function showOnboarding(){ showOnboardingTooltip(); }

// openOnboarding = opens the profile modal for new users to complete
function openOnboarding(){
  if(!currentUser) return;
  openEditProfile();
  // Add a welcome message at the top of the modal
  setTimeout(() => {
    const modal = document.querySelector('#edit-profile-modal .modal');
    if(!modal || modal.querySelector('#ob-welcome-msg')) return;
    const msg = document.createElement('div');
    msg.id = 'ob-welcome-msg';
    msg.style.cssText = 'background:linear-gradient(135deg,rgba(34,197,94,0.1),rgba(74,222,128,0.05));border:1.5px solid rgba(34,197,94,0.3);border-radius:12px;padding:14px 18px;margin-bottom:20px;display:flex;align-items:center;gap:12px;';
    msg.innerHTML = '<span style="font-size:28px">🎉</span><div><div style="font-family:\'Bebas Neue\',sans-serif;font-size:18px;letter-spacing:1.5px;color:var(--g3)">WELCOME TO VIRALBOOST!</div><div style="font-size:12px;color:var(--muted);margin-top:2px;">Complete your profile to maximize your visibility with the community.</div></div>';
    const h2 = modal.querySelector('h2');
    if(h2) h2.parentNode.insertBefore(msg, h2);
  }, 200);
}

// ══════════════════════════════════════════════
// ── PROFILE CREATION WIZARD — 5 STEPS ──
// ══════════════════════════════════════════════

let _wizStep = 1;
const _WIZ_TOTAL = 5;

function openOnboarding(){
  if(!currentUser) return;
  _wizStep = 1;
  // Inject wizard HTML if not present
  if(!document.getElementById('profile-wizard-overlay')){
    document.body.insertAdjacentHTML('beforeend', buildProfileWizardHTML());
  }
  document.getElementById('profile-wizard-overlay').style.display = 'flex';
  renderWizStep(1);
}

function buildProfileWizardHTML(){
  return `
  <div id="profile-wizard-overlay" style="display:none;position:fixed;inset:0;background:rgba(4,10,5,0.97);backdrop-filter:blur(20px);z-index:10000;align-items:center;justify-content:center;padding:16px;overflow-y:auto;">
    <div id="profile-wizard-box" style="background:var(--s1);border:2px solid rgba(34,197,94,0.4);border-radius:20px;max-width:560px;width:100%;position:relative;animation:popIn 0.4s cubic-bezier(0.34,1.56,0.64,1);max-height:92vh;overflow-y:auto;">
      
      <!-- Top bar verte -->
      <div style="position:sticky;top:0;z-index:10;background:var(--s1);border-bottom:1px solid var(--border2);padding:18px 24px 14px;border-radius:20px 20px 0 0;">
        <!-- Logo + step -->
        <div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:14px;">
          <div style="font-family:'Bebas Neue',sans-serif;font-size:18px;letter-spacing:3px;color:var(--g3)">⚡ VIRALBOOST</div>
          <div id="wiz-step-counter" style="font-family:'DM Mono',monospace;font-size:11px;color:var(--muted);letter-spacing:1px;"></div>
        </div>
        <!-- Stepper visuel -->
        <div style="display:flex;align-items:center;gap:0;">
          ${[1,2,3,4,5].map(i => `
            <div style="flex:1;display:flex;flex-direction:column;align-items:center;gap:4px;">
              <div id="wiz-dot-${i}" style="width:30px;height:30px;border-radius:50%;border:2px solid var(--border2);background:var(--s2);display:flex;align-items:center;justify-content:center;font-size:11px;font-weight:800;font-family:'DM Mono',monospace;color:var(--muted);transition:all 0.3s;">${i}</div>
              <div id="wiz-dot-lbl-${i}" style="font-size:8px;font-family:'DM Mono',monospace;color:var(--muted);letter-spacing:0.5px;text-align:center;text-transform:uppercase;">${['IDENTITY','ACTIVITY','NETWORKS','NUMBERS','AVATAR'][i-1]}</div>
            </div>
            ${i < 5 ? `<div id="wiz-conn-${i}" style="flex:1;height:2px;background:var(--border2);margin-bottom:14px;transition:background 0.4s;"></div>` : ''}
          `).join('')}
        </div>
        <!-- Progress bar -->
        <div style="height:3px;background:var(--s3);border-radius:2px;margin-top:12px;overflow:hidden;">
          <div id="wiz-prog-bar" style="height:100%;background:linear-gradient(90deg,var(--g2),var(--g3));border-radius:2px;transition:width 0.5s cubic-bezier(0.4,0,0.2,1);width:20%;"></div>
        </div>
      </div>

      <!-- Dynamic content -->
      <div id="profile-wizard-content" style="padding:24px 28px 28px;"></div>
    </div>
  </div>`;
}

function renderWizStep(step){
  _wizStep = step;
  // Update stepper dots
  [1,2,3,4,5].forEach(i => {
    const dot = document.getElementById('wiz-dot-'+i);
    const lbl = document.getElementById('wiz-dot-lbl-'+i);
    const conn = document.getElementById('wiz-conn-'+i);
    if(!dot) return;
    if(i < step){ dot.style.cssText = 'width:30px;height:30px;border-radius:50%;border:2px solid var(--g2);background:rgba(22,163,74,0.15);display:flex;align-items:center;justify-content:center;font-size:13px;font-family:DM Mono,monospace;color:var(--g3);transition:all 0.3s;'; dot.textContent = '✓'; }
    else if(i === step){ dot.style.cssText = 'width:30px;height:30px;border-radius:50%;border:2px solid var(--g3);background:linear-gradient(135deg,var(--g1),var(--g2));display:flex;align-items:center;justify-content:center;font-size:11px;font-weight:800;font-family:DM Mono,monospace;color:var(--bg);box-shadow:0 0 16px rgba(34,197,94,0.4);transition:all 0.3s;'; dot.textContent = i; }
    else { dot.style.cssText = 'width:30px;height:30px;border-radius:50%;border:2px solid var(--border2);background:var(--s2);display:flex;align-items:center;justify-content:center;font-size:11px;font-weight:800;font-family:DM Mono,monospace;color:var(--muted);transition:all 0.3s;'; dot.textContent = i; }
    if(conn) conn.style.background = i < step ? 'linear-gradient(90deg,var(--g2),var(--g3))' : 'var(--border2)';
    if(lbl) lbl.style.color = i <= step ? 'var(--g4)' : 'var(--muted)';
  });
  const counter = document.getElementById('wiz-step-counter');
  if(counter) counter.textContent = 'STEP ' + step + ' / ' + _WIZ_TOTAL;
  const bar = document.getElementById('wiz-prog-bar');
  if(bar) bar.style.width = (step / _WIZ_TOTAL * 100) + '%';

  const content = document.getElementById('profile-wizard-content');
  if(!content) return;
  content.style.opacity = '0';
  content.style.transform = 'translateY(12px)';
  setTimeout(() => {
    content.innerHTML = getWizStepHTML(step);
    content.style.transition = 'opacity 0.3s ease, transform 0.3s ease';
    content.style.opacity = '1';
    content.style.transform = 'translateY(0)';
    // Pre-fill saved values
    prefillWizStep(step);
  }, 120);
  // Scroll top
  const box = document.getElementById('profile-wizard-box');
  if(box) box.scrollTop = 0;
}

function getWizStepHTML(step){
  const inp = (id, placeholder, type='text', extra='') => `
    <input type="${type}" id="${id}" placeholder="${placeholder}" ${extra}
      style="width:100%;padding:12px 15px;background:rgba(4,10,5,0.85);border:1.5px solid var(--border2);border-radius:10px;font-family:'Plus Jakarta Sans',sans-serif;font-size:14px;color:var(--white);outline:none;transition:border-color 0.2s;"
      onfocus="this.style.borderColor=\'rgba(34,197,94,0.5)\'" onblur="this.style.borderColor=\'var(--border2)\'"/>`;

  const sel = (id, options) => `
    <select id="${id}" style="width:100%;padding:12px 15px;background:rgba(4,10,5,0.85);border:1.5px solid var(--border2);border-radius:10px;font-family:'Plus Jakarta Sans',sans-serif;font-size:14px;color:var(--white);outline:none;"
      onfocus="this.style.borderColor=\'rgba(34,197,94,0.5)\'" onblur="this.style.borderColor=\'var(--border2)\'">
      ${options.map(o => typeof o === 'string' ? `<option style="background:var(--s1)">${o}</option>` : `<option value="${o.v}" style="background:var(--s1)">${o.l}</option>`).join('')}
    </select>`;

  const field = (label, content, hint='') => `
    <div style="margin-bottom:16px;">
      <label style="display:block;font-family:'DM Mono',monospace;font-size:10px;color:var(--g4);margin-bottom:6px;letter-spacing:1.5px;text-transform:uppercase;">${label}</label>
      ${content}
      ${hint ? `<div style="font-size:11px;color:var(--muted);margin-top:5px;line-height:1.5;">${hint}</div>` : ''}
    </div>`;

  const navBtns = (step) => `
    <div style="display:flex;gap:12px;margin-top:28px;">
      ${step > 1 ? `<button onclick="wizBack()" style="flex:1;padding:13px;background:transparent;border:1.5px solid var(--border);border-radius:10px;font-family:'Plus Jakarta Sans',sans-serif;font-size:13px;font-weight:700;color:var(--muted);cursor:pointer;" onmouseover="this.style.borderColor='var(--g3)';this.style.color='var(--g3)'" onmouseout="this.style.borderColor='var(--border)';this.style.color='var(--muted)'">← Back</button>` : ''}
      <button onclick="wizNext()" style="flex:3;padding:14px;background:linear-gradient(135deg,var(--g1),var(--g2));border:none;border-radius:10px;font-family:'Plus Jakarta Sans',sans-serif;font-size:14px;font-weight:800;color:var(--bg);cursor:pointer;box-shadow:0 0 20px rgba(34,197,94,0.3);transition:all 0.2s;" onmouseover="this.style.boxShadow='0 0 36px rgba(34,197,94,0.5)';this.style.transform='translateY(-1px)'" onmouseout="this.style.boxShadow='0 0 20px rgba(34,197,94,0.3)';this.style.transform=''">
        ${step < 5 ? 'Continue →' : '✅ Done →'}
      </button>
    </div>
    <button onclick="skipWizard()" style="display:block;width:100%;text-align:center;background:none;border:none;font-size:11px;color:var(--muted2);cursor:pointer;margin-top:10px;padding:6px;font-family:'Plus Jakarta Sans',sans-serif;">Skip this step</button>`;

  if(step === 1) return `
    <div style="margin-bottom:24px;">
      <div style="font-family:'DM Mono',monospace;font-size:10px;color:var(--g3);letter-spacing:3px;text-transform:uppercase;margin-bottom:8px;">STEP 1 OF 5</div>
      <div style="font-family:'Bebas Neue',sans-serif;font-size:32px;letter-spacing:2px;color:var(--white);line-height:1.1;margin-bottom:8px;">YOUR PROFILE</div>
      <div style="font-size:13px;color:var(--muted);line-height:1.7;">This information will be visible to all community members.</div>
    </div>
    ${field('Full name or stage name *', inp('wiz-name', 'e.g. Alex Martin, SarahCreates...'), 'Displayed on your posts and profile.')}
    ${field('Username *', inp('wiz-username', '@username'), 'Your unique identifier in the community.')}
    ${field('Title or role', inp('wiz-title', 'e.g. Content Creator · SaaS Founder · Indie Dev'), 'One line describing what you do.')}
    ${field('Location', inp('wiz-location', 'e.g. Paris, France — or Remote'), 'Helps nearby members find you.')}
    ${field('Bio *', `<textarea id="wiz-bio" rows="4" placeholder="Tell us who you are, what you build, and what drives you..." style="width:100%;padding:12px 15px;background:rgba(4,10,5,0.85);border:1.5px solid var(--border2);border-radius:10px;font-family:'Plus Jakarta Sans',sans-serif;font-size:14px;color:var(--white);outline:none;resize:vertical;min-height:90px;" onfocus="this.style.borderColor=\'rgba(34,197,94,0.5)\'" onblur="this.style.borderColor=\'var(--border2)\'"></textarea>`, 'Profiles with a complete bio receive 3× more visits.')}
    ${navBtns(1)}`;

  if(step === 2) return `
    <div style="margin-bottom:24px;">
      <div style="font-family:'DM Mono',monospace;font-size:10px;color:var(--g3);letter-spacing:3px;text-transform:uppercase;margin-bottom:8px;">STEP 2 OF 5</div>
      <div style="font-family:'Bebas Neue',sans-serif;font-size:32px;letter-spacing:2px;color:var(--white);line-height:1.1;margin-bottom:8px;">YOUR ACTIVITY</div>
      <div style="font-size:13px;color:var(--muted);line-height:1.7;">This helps our AI match you with the right creators and opportunities.</div>
    </div>
    ${field('Sector / Main niche *', inp('wiz-niche', 'Ex: Digital marketing, Fitness, Tech, Finance, Art...'), 'Describes your main area of activity.')}
    ${field('Experience level', sel('wiz-exp', ['Beginner (0–1 year)','Intermediate (1–3 years)','Confirmed (3–5 years)','Expert (5+ years)']))}
    ${field('Your main goal *', inp('wiz-goal', 'Ex: Reach 100K followers, launch my SaaS, find clients...'), 'Be precise! This helps AI matching find the right connections for you.')}
    ${field('Key skills', inp('wiz-skills', 'Ex: Video, Copywriting, SEO, Development, Design, Sales...'), 'Separate with commas. These tags appear on your profile.')}
    ${field('Tools & software used', inp('wiz-tools', 'Ex: CapCut, Canva, Notion, Figma, VSCode, Shopify...'), 'Helps members understand your work environment.')}
    ${field('What you\'re looking for on ViralBoost', sel('wiz-dispo', ['Open to collaborations','Available for projects freelance','Looking for investor','Looking for a partner / co-founder','Hiring talent','Just networking / market watch']))}
    ${field('What you expect from the community', `<textarea id="wiz-looking" rows="3" placeholder="Ex: I'm looking for video creators to collab on TikTok, a dev for my SaaS, clients for my coaching service..." style="width:100%;padding:12px 15px;background:rgba(4,10,5,0.85);border:1.5px solid var(--border2);border-radius:10px;font-family:'Plus Jakarta Sans',sans-serif;font-size:14px;color:var(--white);outline:none;resize:vertical;" onfocus="this.style.borderColor=\'rgba(34,197,94,0.5)\'" onblur="this.style.borderColor=\'var(--border2)\'"></textarea>`, 'The more precise you are, the better AI can match you.')}
    ${navBtns(2)}`;

  if(step === 3) return `
    <div style="margin-bottom:24px;">
      <div style="font-family:'DM Mono',monospace;font-size:10px;color:var(--g3);letter-spacing:3px;text-transform:uppercase;margin-bottom:8px;">STEP 3 OF 5</div>
      <div style="font-family:'Bebas Neue',sans-serif;font-size:32px;letter-spacing:2px;color:var(--white);line-height:1.1;margin-bottom:8px;">YOUR NETWORKS</div>
      <div style="font-size:13px;color:var(--muted);line-height:1.7;">Connect your platforms so members can find you everywhere.</div>
    </div>
    <div style="background:rgba(34,197,94,0.05);border:1px solid var(--border2);border-radius:12px;padding:16px 18px;margin-bottom:20px;">
      <div style="font-size:12px;color:var(--g5);line-height:1.8;">💡 <strong style="color:var(--g3)">Tip:</strong> Profiles with at least 2 connected networks receive on average <strong style="color:var(--g3)">4x more collab requests</strong> than empty profiles.</div>
    </div>
    ${field('🌐 Website / Portfolio', inp('wiz-website', 'https://your-site.com', 'url'), 'Your website, portfolio, landing page...')}
    ${field('🎵 TikTok', inp('wiz-tiktok', '@your_tiktok_account'), 'Ex: @marie_creates — without the full URL.')}
    ${field('📸 Instagram', inp('wiz-instagram', '@my_instagram_account'), 'Your creator or business account.')}
    ${field('🐦 Twitter / X', inp('wiz-twitter', '@your_twitter_account'), 'So people can find you on X.')}
    ${field('💼 LinkedIn', inp('wiz-linkedin', 'linkedin.com/in/your-profile', 'url'), 'Complete professional profile.')}
    ${field('▶️ YouTube', inp('wiz-youtube', '@my_youtube_channel'), 'Your YouTube channel or handle.')}
    ${field('Other languages spoken', inp('wiz-langs', 'Ex : French, English, Spanish...'), 'Useful for international collabs.')}
    ${navBtns(3)}`;

  if(step === 4) return `
    <div style="margin-bottom:24px;">
      <div style="font-family:'DM Mono',monospace;font-size:10px;color:var(--g3);letter-spacing:3px;text-transform:uppercase;margin-bottom:8px;">STEP 4 OF 5</div>
      <div style="font-family:'Bebas Neue',sans-serif;font-size:32px;letter-spacing:2px;color:var(--white);line-height:1.1;margin-bottom:8px;">YOUR NUMBERS</div>
      <div style="font-size:13px;color:var(--muted);line-height:1.7;">Optional — but creators who share their metrics attract higher-quality collaborations.</div>
    </div>
    <div style="background:rgba(255,215,0,0.04);border:1px solid rgba(255,215,0,0.2);border-radius:12px;padding:14px 18px;margin-bottom:22px;">
      <div style="font-size:12px;color:var(--g5);line-height:1.8;">🔒 <strong style="color:var(--gold)">Privacy:</strong> You control what you share. These numbers are visible on your public profile only if you fill them in.</div>
    </div>
    ${field('Followers TikTok', inp('wiz-tiktok-count', 'Ex : 45 000'), 'Total number of followers on TikTok.')}
    ${field('Followers Instagram', inp('wiz-ig-count', 'Ex : 12 500'), 'Followers on your Instagram account.')}
    ${field('Projects launched', inp('wiz-projects-count', 'Ex: 3'), 'Number of projects, products or services you\'ve launched.')}
    ${field('Sales / Clients to date', inp('wiz-sales', 'Ex: 150 clients, 50 sales...'), 'Gives an idea of your commercial traction.')}
    ${field('Approximate monthly revenue', sel('wiz-revenue', [{v:'',l:'I prefer not to say'},{v:'0-500',l:'$0 – $500/month'},{v:'500-2000',l:'$500 – $2,000/month'},{v:'2000-5000',l:'$2,000 – $5,000/month'},{v:'5000-10000',l:'$5,000 – $10,000/month'},{v:'10000+',l:'$10,000+/month'}]), 'Helps potential partners calibrate collabs.')}
    ${field('Current availability', sel('wiz-dispo2', ['Very available — actively looking','Partially available','Not very available — selective about projects','Not available right now']))}
    ${navBtns(4)}`;

  if(step === 5) return `
    <div style="margin-bottom:24px;">
      <div style="font-family:'DM Mono',monospace;font-size:10px;color:var(--g3);letter-spacing:3px;text-transform:uppercase;margin-bottom:8px;">STEP 5 OF 5</div>
      <div style="font-family:'Bebas Neue',sans-serif;font-size:32px;letter-spacing:2px;color:var(--white);line-height:1.1;margin-bottom:8px;">YOUR AVATAR</div>
      <div style="font-size:13px;color:var(--muted);line-height:1.7;">Choose how you appear in the community. A clear avatar increases your visibility.</div>
    </div>
    <!-- Profile photo -->
    <div style="margin-bottom:20px;">
      <label style="display:block;font-family:'DM Mono',monospace;font-size:10px;color:var(--g4);margin-bottom:10px;letter-spacing:1.5px;text-transform:uppercase;">PROFILE PHOTO</label>
      <div style="display:flex;align-items:center;gap:16px;">
        <div id="wiz-ava-preview" style="width:72px;height:72px;border-radius:50%;background:linear-gradient(135deg,var(--g1),var(--g2));display:flex;align-items:center;justify-content:center;font-size:32px;flex-shrink:0;border:3px solid rgba(34,197,94,0.4);position:relative;overflow:hidden;cursor:pointer;" onclick="document.getElementById('wiz-ava-file').click()">
          <span id="wiz-ava-emoji-display">🙂</span>
          <img id="wiz-ava-img" alt="Avatar" style="display:none;position:absolute;inset:0;width:100%;height:100%;object-fit:cover;border-radius:50%;" />
        </div>
        <div>
          <label style="display:inline-flex;align-items:center;gap:8px;cursor:pointer;background:var(--s2);border:1.5px solid var(--border);border-radius:8px;padding:9px 16px;font-size:12px;font-weight:600;color:var(--g3);transition:all 0.2s;" onmouseover="this.style.borderColor=\'var(--g3)\'" onmouseout="this.style.borderColor=\'var(--border)\'">
            📁 Upload a photo
            <input type="file" id="wiz-ava-file" accept="image/*" style="display:none" onchange="handleWizAvatarUpload(this)"/>
          </label>
          <div style="font-size:11px;color:var(--muted);margin-top:6px;line-height:1.5;">JPG, PNG, WebP · Max 5 MB<br>Profiles with a photo get 5x more interactions.</div>
        </div>
      </div>
    </div>
    <!-- Emoji avatar -->
    <div style="margin-bottom:20px;">
      <label style="display:block;font-family:'DM Mono',monospace;font-size:10px;color:var(--g4);margin-bottom:10px;letter-spacing:1.5px;text-transform:uppercase;">OR CHOOSE AN EMOJI</label>
      <div style="display:flex;flex-wrap:wrap;gap:8px;">
        ${['🙂','😎','🤩','😏','🧐','🚀','💡','🎯','🔥','⚡','🌍','🧠','💎','👑','🦁','🐉','🌟','🏆','🦊','🤖'].map(e => 
          `<div onclick="selectWizEmoji('${e}')" data-wiz-emoji="${e}" style="width:40px;height:40px;border-radius:10px;border:2px solid var(--border2);cursor:pointer;display:flex;align-items:center;justify-content:center;font-size:20px;transition:all 0.15s;background:var(--s2);" onmouseover="this.style.borderColor='var(--g3)';this.style.background='rgba(34,197,94,0.1)'" onmouseout="if(!this.classList.contains('wiz-emo-sel')){this.style.borderColor='var(--border2)';this.style.background='var(--s2)'}">${e}</div>`
        ).join('')}
      </div>
    </div>
    <!-- Profile color -->
    <div style="margin-bottom:20px;">
      <label style="display:block;font-family:'DM Mono',monospace;font-size:10px;color:var(--g4);margin-bottom:10px;letter-spacing:1.5px;text-transform:uppercase;">ACCENT COLOR</label>
      <div style="display:flex;gap:10px;flex-wrap:wrap;">
        ${[['#22c55e','Green'],['#3b82f6','Blue'],['#a855f7','Purple'],['#f97316','Orange'],['#ef4444','Red'],['#ffd700','Gold'],['#06b6d4','Cyan'],['#ec4899','Pink']].map(([c,n]) =>
          `<div onclick="selectWizColor('${c}')" data-wiz-color="${c}" title="${n}" style="width:36px;height:36px;border-radius:8px;background:${c};cursor:pointer;border:3px solid transparent;transition:all 0.2s;opacity:0.8;" onmouseover="this.style.opacity='1';this.style.transform='scale(1.1)'" onmouseout="if(!this.classList.contains('wiz-col-sel')){this.style.opacity='0.8';this.style.transform=''}"></div>`
        ).join('')}
      </div>
    </div>
    ${navBtns(5)}`;

  return '';
}

function prefillWizStep(step){
  if(!currentUser) return;
  const set = (id, val) => { const el = document.getElementById(id); if(el && val) el.value = val; };
  if(step === 1){
    set('wiz-name', currentUser.name !== currentUser.email?.split('@')[0] ? currentUser.name : '');
    set('wiz-username', currentUser.username);
    set('wiz-title', currentUser.title);
    set('wiz-location', currentUser.location);
    set('wiz-bio', currentUser.bio);
  } else if(step === 2){
    set('wiz-niche', currentUser.niche);
    set('wiz-goal', currentUser.goal);
    set('wiz-skills', currentUser.skills);
    set('wiz-tools', currentUser.tools);
    set('wiz-looking', currentUser.looking);
  } else if(step === 3){
    set('wiz-website', currentUser.website);
    set('wiz-tiktok', currentUser.tiktok);
    set('wiz-instagram', currentUser.instagram);
    set('wiz-twitter', currentUser.twitter);
    set('wiz-linkedin', currentUser.linkedin);
    set('wiz-youtube', currentUser.youtube);
    set('wiz-langs', currentUser.langs);
  } else if(step === 4){
    set('wiz-tiktok-count', currentUser.tiktokCount);
    set('wiz-ig-count', currentUser.igCount);
    set('wiz-projects-count', currentUser.projectsCount);
    set('wiz-sales', currentUser.sales);
  } else if(step === 5){
    if(currentUser.avatar) {
      const disp = document.getElementById('wiz-ava-emoji-display');
      if(disp) disp.textContent = currentUser.avatar;
    }
    if(currentUser.avatarUrl){
      const img = document.getElementById('wiz-ava-img');
      const disp = document.getElementById('wiz-ava-emoji-display');
      if(img){ img.src = currentUser.avatarUrl; img.style.display = 'block'; }
      if(disp) disp.style.display = 'none';
    }
  }
}

function saveWizStep(step){
  if(!currentUser) return;
  if(step === 1){
    const name = document.getElementById('wiz-name')?.value.trim();
    const username = document.getElementById('wiz-username')?.value.trim().replace('@','');
    if(!name){ toast('⚠️ Your name / stage name is required!'); return false; }
    Object.assign(currentUser, {
      name: name || currentUser.name,
      username: username || currentUser.username,
      title: document.getElementById('wiz-title')?.value.trim(),
      location: document.getElementById('wiz-location')?.value.trim(),
      bio: document.getElementById('wiz-bio')?.value.trim(),
    });
  } else if(step === 2){
    const niche = document.getElementById('wiz-niche')?.value.trim();
    const goal = document.getElementById('wiz-goal')?.value.trim();
    if(!niche){ toast('⚠️ Enter your sector / niche!'); return false; }
    const expEl = document.getElementById('wiz-exp');
    const dispoEl = document.getElementById('wiz-dispo');
    Object.assign(currentUser, {
      niche,
      exp: expEl?.options[expEl.selectedIndex]?.text,
      goal,
      skills: document.getElementById('wiz-skills')?.value.trim(),
      tools: document.getElementById('wiz-tools')?.value.trim(),
      dispo: dispoEl?.options[dispoEl.selectedIndex]?.text,
      looking: document.getElementById('wiz-looking')?.value.trim(),
    });
  } else if(step === 3){
    Object.assign(currentUser, {
      website: document.getElementById('wiz-website')?.value.trim(),
      tiktok: document.getElementById('wiz-tiktok')?.value.trim(),
      instagram: document.getElementById('wiz-instagram')?.value.trim(),
      twitter: document.getElementById('wiz-twitter')?.value.trim(),
      linkedin: document.getElementById('wiz-linkedin')?.value.trim(),
      youtube: document.getElementById('wiz-youtube')?.value.trim(),
      langs: document.getElementById('wiz-langs')?.value.trim(),
    });
  } else if(step === 4){
    const revEl = document.getElementById('wiz-revenue');
    const dispo2El = document.getElementById('wiz-dispo2');
    Object.assign(currentUser, {
      tiktokCount: document.getElementById('wiz-tiktok-count')?.value.trim(),
      igCount: document.getElementById('wiz-ig-count')?.value.trim(),
      projectsCount: document.getElementById('wiz-projects-count')?.value.trim(),
      sales: document.getElementById('wiz-sales')?.value.trim(),
      revenue: revEl?.options[revEl.selectedIndex]?.text,
      dispo: dispo2El?.options[dispo2El.selectedIndex]?.text || currentUser.dispo,
    });
  } else if(step === 5){
    // avatar saved via selectWizEmoji/handleWizAvatarUpload
  }
  localStorage.setItem('viralboost_user', JSON.stringify(currentUser));
  return true;
}

function wizNext(){
  if(!saveWizStep(_wizStep)) return;
  if(_wizStep < _WIZ_TOTAL){
    renderWizStep(_wizStep + 1);
  } else {
    finishProfileWizard();
  }
}
function wizBack(){
  if(_wizStep > 1) renderWizStep(_wizStep - 1);
}
function skipWizard(){
  if(_wizStep < _WIZ_TOTAL){
    renderWizStep(_wizStep + 1);
  } else {
    finishProfileWizard();
  }
}

function selectWizEmoji(emoji){
  document.querySelectorAll('[data-wiz-emoji]').forEach(el => {
    el.classList.remove('wiz-emo-sel');
    el.style.borderColor = 'var(--border2)';
    el.style.background = 'var(--s2)';
  });
  const el = document.querySelector('[data-wiz-emoji="'+emoji+'"]');
  if(el){ el.classList.add('wiz-emo-sel'); el.style.borderColor = 'var(--g3)'; el.style.background = 'rgba(34,197,94,0.15)'; }
  const disp = document.getElementById('wiz-ava-emoji-display');
  const img = document.getElementById('wiz-ava-img');
  if(disp){ disp.textContent = emoji; disp.style.display = ''; }
  if(img) img.style.display = 'none';
  if(currentUser) currentUser.avatar = emoji;
  localStorage.setItem('viralboost_user', JSON.stringify(currentUser));
}

function selectWizColor(color){
  document.querySelectorAll('[data-wiz-color]').forEach(el => {
    el.classList.remove('wiz-col-sel');
    el.style.borderColor = 'transparent';
    el.style.opacity = '0.8';
    el.style.transform = '';
  });
  const el = document.querySelector('[data-wiz-color="'+color+'"]');
  if(el){ el.classList.add('wiz-col-sel'); el.style.borderColor = '#fff'; el.style.opacity = '1'; el.style.transform = 'scale(1.15)'; }
  if(currentUser){ currentUser.accentColor = color; localStorage.setItem('viralboost_user', JSON.stringify(currentUser)); }
}

function handleWizAvatarUpload(input){
  const file = input.files[0];
  if(!file) return;
  const reader = new FeedeReader();
  reader.onload = e => {
    const img = document.getElementById('wiz-ava-img');
    const disp = document.getElementById('wiz-ava-emoji-display');
    const preview = document.getElementById('wiz-ava-preview');
    if(img){ img.src = e.target.result; img.style.display = 'block'; }
    if(disp) disp.style.display = 'none';
    if(currentUser){ currentUser.avatarUrl = e.target.result; localStorage.setItem('viralboost_user', JSON.stringify(currentUser)); }
    toast('✅ Photo uploaded!');
  };
  reader.readAsDataURL(file);
}

function finishProfileWizard(){
  // Close wizard
  const overlay = document.getElementById('profile-wizard-overlay');
  if(overlay){ overlay.style.opacity = '0'; overlay.style.transition = 'opacity 0.4s'; setTimeout(() => overlay.style.display = 'none', 400); }
  // Mark as onboarded
  if(currentUser){ currentUser.onboarded = true; localStorage.setItem('viralboost_user', JSON.stringify(currentUser)); }
  updateAppBar();
  renderMyProfile();
  // Show app tour
  setTimeout(() => openAppTour(), 500);
}

// ══════════════════════════════════════════════
// ── APP GUIDED TOUR ──
// ══════════════════════════════════════════════

const APP_TOUR_SLIDES = [
  {
    icon: '📢',
    color: '#22c55e',
    title: 'THE FEED — YOUR AD WALL',
    subtitle: 'Explore community posts',
    desc: 'The Feed is the heart of ViralBoost. Every member can post an ad, announcement, service or launch. You can <strong>like, comment, share</strong> and directly contact any creator.',
    tips: ['🔥 Filter by niche, post type or popularity','⚡ Vote for posts you like — earn credits','💬 Comment and engage to boost your visibility','📌 Save posts that interest you'],
    cta: 'Explore the Feed'
  },
  {
    icon: '📤',
    color: '#4ade80',
    title: 'PUBLISH — BROADCAST YOUR CONTENT',
    subtitle: 'Create your ad in 30 seconds',
    desc: 'The <strong>Publish</strong> tab lets you create a post in various types: announcement, product launch, service offer, collab, promo, poll... Each post is instantly visible to the entire community.',
    tips: ['🎯 Choose the right post type for your need','🖼️ Add an image or video for +70% engagement','🏷️ Use precise tags to reach the right audience','🚀 PRO & ELITE plans get automatic visibility boost'],
    cta: 'Create my first ad'
  },
  {
    icon: '🤝',
    color: '#a78bfa',
    title: 'AI MATCHING — FIND YOUR COLLABS',
    subtitle: 'AI connects the right creators together',
    desc: 'Our matching algorithm analyzes your profile, niche, goals and skills to suggest the most compatible collaborators. The more complete your profile, the more precise the suggestions.',
    tips: ['🧠 AI analyzes 12 compatibility criteria','📊 Match score displayed on each profile','💌 Send a DM directly from matching','🔄 New suggestions every day'],
    cta: 'See my matches'
  },
  {
    icon: '💬',
    color: '#38bdf8',
    title: 'GROUPS & CHAT — THE COMMUNITY',
    subtitle: 'Join groups by niche and interest',
    desc: '<strong>Groups</strong> are themed spaces where creators from the same niche gather to exchange, share resources and build projects together. The <strong>Global Chat</strong> connects the entire community in real time.',
    tips: ['🏛️ Join groups by theme: SaaS, TikTok, E-commerce...','✨ ELITE members can create their own groups','⚡ Global chat available 24/7 in real time','📎 Share images, links and files in groups'],
    cta: 'Join a group'
  },
  {
    icon: '🚀',
    color: '#fbbf24',
    title: 'AI BOOST & CREDITS — ACCELERATE YOUR GROWTH',
    subtitle: 'Powerful AI tools at your disposal',
    desc: 'The <strong>AI Boost</strong> module generates personalized strategies in 10 seconds: viral TikTok plan, SEO strategy, email campaign, investor pitch, launch plan... Use your <strong>ViralCredits</strong> to unlock premium features.',
    tips: ['⚡ 50 ViralCredits gifted at signup','🎯 Generate TikTok, SEO, Email, YouTube strategies...','💰 Earn credits by posting, voting, referring','💎 Paid plans give bonus credits every month'],
    cta: 'Try AI Boost'
  },
];

let _tourSlide = 0;

function openAppTour(){
  _tourSlide = 0;
  if(!document.getElementById('app-tour-overlay')){
    document.body.insertAdjacentHTML('beforeend', `
      <div id="app-tour-overlay" style="position:fixed;inset:0;background:rgba(4,10,5,0.97);backdrop-filter:blur(20px);z-index:10001;display:flex;align-items:center;justify-content:center;padding:16px;">
        <div id="app-tour-box" style="background:var(--s1);border:2px solid rgba(34,197,94,0.35);border-radius:20px;max-width:560px;width:100%;overflow:hidden;"></div>
      </div>`);
  }
  document.getElementById('app-tour-overlay').style.display = 'flex';
  renderTourSlide(0);
}

function renderTourSlide(idx){
  _tourSlide = idx;
  const s = APP_TOUR_SLIDES[idx];
  const box = document.getElementById('app-tour-box');
  if(!box) return;
  box.style.borderColor = s.color + '55';

  const dots = APP_TOUR_SLIDES.map((_,i) => 
    `<div style="width:${i===idx?'22px':'8px'};height:8px;border-radius:4px;background:${i===idx?s.color:'var(--muted2)'};transition:all 0.3s;"></div>`
  ).join('');

  box.innerHTML = `
    <!-- Colored header -->
    <div style="background:linear-gradient(135deg,${s.color}18,${s.color}08);border-bottom:1px solid ${s.color}22;padding:32px 32px 24px;text-align:center;">
      <div style="font-size:56px;margin-bottom:12px;filter:drop-shadow(0 0 16px ${s.color}60);">${s.icon}</div>
      <div style="font-family:'Bebas Neue',sans-serif;font-size:28px;letter-spacing:2px;color:#fff;margin-bottom:6px;">${s.title}</div>
      <div style="font-size:13px;color:${s.color};font-weight:600;">${s.subtitle}</div>
    </div>

    <!-- Content -->
    <div style="padding:24px 28px;">
      <p style="font-size:14px;color:#c4d9cb;line-height:1.8;margin-bottom:20px;">${s.desc}</p>

      <!-- Tips -->
      <div style="background:rgba(255,255,255,0.02);border:1px solid rgba(255,255,255,0.06);border-radius:12px;padding:16px 18px;margin-bottom:24px;">
        <div style="font-family:'DM Mono',monospace;font-size:9px;color:${s.color};letter-spacing:2px;text-transform:uppercase;margin-bottom:12px;">CE QU'IL FAUT SAVOIR</div>
        ${s.tips.map(t => `<div style="font-size:13px;color:var(--g5);padding:6px 0;border-bottom:1px solid rgba(255,255,255,0.04);line-height:1.5;">${t}</div>`).join('')}
      </div>

      <!-- Nav -->
      <div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:16px;">
        <div style="display:flex;gap:6px;align-items:center;">${dots}</div>
        <div style="font-family:'DM Mono',monospace;font-size:10px;color:var(--muted);">${idx+1} / ${APP_TOUR_SLIDES.length}</div>
      </div>
      <div style="display:flex;gap:10px;">
        ${idx > 0 ? `<button onclick="renderTourSlide(${idx-1})" style="flex:1;padding:12px;background:transparent;border:1.5px solid var(--border);border-radius:10px;font-family:'Plus Jakarta Sans',sans-serif;font-size:13px;font-weight:700;color:var(--muted);cursor:pointer;">← Previous</button>` : ''}
        ${idx < APP_TOUR_SLIDES.length - 1 
          ? `<button onclick="renderTourSlide(${idx+1})" style="flex:3;padding:13px;background:linear-gradient(135deg,${s.color}90,${s.color});border:none;border-radius:10px;font-family:'Plus Jakarta Sans',sans-serif;font-size:14px;font-weight:800;color:#fff;cursor:pointer;box-shadow:0 0 24px ${s.color}40;">Next →</button>`
          : `<button onclick="closeAppTour()" style="flex:3;padding:13px;background:linear-gradient(135deg,var(--g1),var(--g3));border:none;border-radius:10px;font-family:'Plus Jakarta Sans',sans-serif;font-size:14px;font-weight:800;color:var(--bg);cursor:pointer;box-shadow:0 0 28px rgba(34,197,94,0.45);">🚀 Launch ViralBoost !</button>`
        }
      </div>
      ${idx === APP_TOUR_SLIDES.length - 1 ? '' : `<button onclick="closeAppTour()" style="display:block;width:100%;text-align:center;background:none;border:none;font-size:11px;color:var(--muted2);cursor:pointer;margin-top:10px;padding:6px;font-family:'Plus Jakarta Sans',sans-serif;">Passer le tutoriel</button>`}
    </div>`;
}

function closeAppTour(){
  const overlay = document.getElementById('app-tour-overlay');
  if(overlay){ overlay.style.opacity = '0'; overlay.style.transition = 'opacity 0.4s'; setTimeout(() => { overlay.style.display = 'none'; }, 400); }
  // Go to feed
  showAppTab('feed', null);
  setTimeout(() => toast('🎉 Welcome to ViralBoost! Explore the feed or publish your first ad.'), 600);
}
function updatePubCompletion(){
  const name = document.getElementById('pub-name')?.value.trim() || '';
  const desc = document.getElementById('pub-desc')?.value.trim() || '';
  const url  = document.getElementById('pub-url')?.value.trim() || '';
  const target = document.getElementById('pub-target')?.value.trim() || '';
  const tags = document.getElementById('pub-tags')?.value.trim() || '';
  const hasMedia = !!document.querySelector('#pub-media-preview img, #pub-media-preview video');

  const checks = {
    name: name.length >= 4,
    desc: desc.length >= 40,
    url: url.length > 5,
    target: target.length >= 3,
    tags: tags.length >= 2,
    media: hasMedia,
  };
  const done = Object.values(checks).filter(Boolean).length;
  const pct = Math.round((done / 6) * 100);

  const bar = document.getElementById('pub-completion-bar');
  const txt = document.getElementById('pub-completion-txt');
  if(bar){ bar.style.width = pct + '%'; bar.style.background = pct >= 80 ? 'linear-gradient(90deg,#16a34a,#4ade80)' : pct >= 50 ? 'linear-gradient(90deg,var(--g2),var(--g3))' : 'linear-gradient(90deg,var(--g1),var(--g2))'; }
  if(txt){ txt.textContent = pct + '%'; txt.style.color = pct >= 80 ? 'var(--g3)' : pct >= 50 ? 'var(--gold)' : 'var(--muted)'; }

  document.querySelectorAll('.pub-hint').forEach(el => {
    const hint = el.dataset.hint;
    el.classList.toggle('done', !!checks[hint]);
    el.classList.toggle('pending', !checks[hint]);
  });

  // Accountur nom
  const nc = document.getElementById('pub-name-count');
  if(nc) nc.textContent = name.length;
  // Label plan
  const pl = document.getElementById('pub-plan-label');
  if(pl && currentUser){ const lbl = {free:'FREE · 24h',starter:'STARTER · 7j',pro:'PRO · 30j',elite:'ELITE · Permanent'}; pl.textContent = '📋 ' + (lbl[currentUser.plan] || ''); }
}

function updateDescCount(){
  const d = document.getElementById('pub-desc')?.value || '';
  const c = document.getElementById('pub-desc-count');
  const q = document.getElementById('pub-desc-quality');
  if(c) c.textContent = d.length;
  if(q){
    if(d.length === 0) q.textContent = '';
    else if(d.length < 40) q.style.color = 'var(--muted)', q.textContent = '⚠️ Trop court';
    else if(d.length < 100) q.style.color = 'var(--gold)', q.textContent = '👍 Correct';
    else if(d.length < 200) q.style.color = 'var(--g3)', q.textContent = '✅ Bon';
    else q.style.color = 'var(--g4)', q.textContent = '🔥 Excellent';
  }
}

function renderTagsPreview(){
  const raw = document.getElementById('pub-tags')?.value || '';
  const container = document.getElementById('pub-tags-preview');
  if(!container) return;
  const tags = raw.split(',').map(t => t.trim()).filter(Boolean).slice(0, 5);
  container.innerHTML = tags.map(t => `<span class="pub-tag-chip">#${t}</span>`).join('');
  updatePubCompletion();
}

function insertDescTip(el){
  const tip = el.dataset.tip;
  const ta = document.getElementById('pub-desc');
  if(!ta) return;
  const cur = ta.value;
  const sep = cur.length > 0 && !cur.endsWith('\n') ? '\n' : '';
  ta.value = cur + sep + tip;
  ta.focus();
  updateDescCount();
  updatePubCompletion();
  updateMobilePreview();
  el.style.borderColor = 'var(--g3)';
  el.style.color = 'var(--g3)';
  setTimeout(() => { el.style.borderColor = ''; el.style.color = ''; }, 1000);
}

function updatePubTypeEmoji(){
  const type = document.getElementById('pub-type')?.value;
  const map = {saas:'🚀',site:'🌐',ecommerce:'🛍️',service:'💼',coaching:'🎓',tiktok:'🎵',instagram:'📸',newsletter:'📧',podcast:'🎙️',communaute:'👥'};
  const emojiInput = document.getElementById('pub-emoji');
  if(emojiInput && !emojiInput.value) emojiInput.value = map[type] || '🚀';
  updateMobilePreview();
}

// ── WIZARD NAVIGATION ──
let currentWizStep = 1;
const WIZ_TOTAL = 5;

function wizGoTo(step){
  // Confirm before advancing
  if(step > currentWizStep){
    for(let s = currentWizStep; s < step; s++){
      if(!wizValidate(s)) return;
    }
  }
  // Cacher panel actuel
  document.getElementById('wpanel-' + currentWizStep)?.classList.remove('active');
  // Update dots
  for(let i=1; i<=WIZ_TOTAL; i++){
    const dot = document.getElementById('wdot-'+i);
    const circ = document.getElementById('wcirc-'+i);
    const conn = document.getElementById('wconn-'+i);
    if(!dot||!circ) continue;
    dot.className = 'wiz-step-dot' + (i===step?' active':i<step?' done':'');
    circ.className = 'wiz-step-circle' + (i===step?' active':i<step?' done':'');
    if(conn) conn.className = 'wiz-connector' + (i<step?' done':'');
  }
  // Afficher new panel
  currentWizStep = step;
  document.getElementById('wpanel-' + step)?.classList.add('active');
  // Progress bar
  const pct = Math.round((step/WIZ_TOTAL)*100);
  const fill = document.getElementById('wiz-prog-fill');
  if(fill) fill.style.width = pct+'%';
  // If step 5: refresh preview
  if(step===5) wizRefreshPreview();
  // Scroll to top of wizard
  document.getElementById('wiz-stepper')?.scrollIntoView({behavior:'smooth',block:'start'});
}

function wizNext(from){ if(wizValidate(from)) wizGoTo(from+1); }
function wizPrev(from){ wizGoTo(from-1); }

// ── WIZARD PHOTO FUNCTIONS ──
let wizPhotoDataUrl = null;

function handleWizPhoto(input){
  const file = input.files[0];
  if(!file) return;
  const reader = new FileReader();
  reader.onload = function(e){
    wizPhotoDataUrl = e.target.result;
    const img = document.getElementById('wiz-photo-preview-img');
    const preview = document.getElementById('wiz-photo-preview');
    const btns = document.getElementById('wiz-photo-btns');
    if(img) img.src = wizPhotoDataUrl;
    if(preview) preview.style.display = 'block';
    if(btns) btns.style.display = 'none';
    // Also sync to step 4 media
    const step4img = document.getElementById('wiz-prev-img');
    if(step4img){ step4img.src = wizPhotoDataUrl; step4img.style.display = 'block'; }
  };
  reader.readAsDataURL(file);
}

function removeWizPhoto(){
  wizPhotoDataUrl = null;
  const preview = document.getElementById('wiz-photo-preview');
  const btns = document.getElementById('wiz-photo-btns');
  if(preview) preview.style.display = 'none';
  if(btns) btns.style.display = 'flex';
}

function skipWizPhoto(){
  wizPhotoDataUrl = null;
  wizNext(1);
}

function wizValidate(step){
  if(step===1){
    const n = document.getElementById('pub-name')?.value.trim()||'';
    if(n.length < 3){ toast('Give your project a name (3 characters min)','error'); document.getElementById('pub-name')?.focus(); return false; }
  }
  if(step===2){
    const d = document.getElementById('pub-desc')?.value.trim()||'';
    if(d.length < 20){ toast('The description is too short (20 characters min)','error'); document.getElementById('pub-desc')?.focus(); return false; }
  }
  return true;
}

function wizRefreshPreview(){
  const name = document.getElementById('pub-name')?.value||'';
  const desc = document.getElementById('pub-desc')?.value||'';
  const hook = document.getElementById('pub-hook')?.value||'';
  const emoji = document.getElementById('pub-emoji')?.value||'🚀';
  const tags = (document.getElementById('pub-tags')?.value||'').split(',').map(t=>t.trim()).filter(Boolean).slice(0,5);
  const collab = document.getElementById('pub-collab-need')?.value||'';

  const pname = document.getElementById('wiz-prev-name');
  const pdesc = document.getElementById('wiz-prev-desc');
  const phook = document.getElementById('wiz-prev-hook');
  const pemoji = document.getElementById('wiz-prev-emoji');
  const ptags = document.getElementById('wiz-prev-tags');
  const pcollab = document.getElementById('wiz-prev-collab');
  const pauthor = document.getElementById('wiz-prev-author');
  const pimg = document.getElementById('wiz-prev-img');

  if(pname) pname.textContent = name||'Project name';
  if(pdesc) pdesc.textContent = desc ? desc.slice(0,200)+(desc.length>200?'...':'') : 'Your description will appear here...';
  if(phook){ phook.textContent=hook; phook.style.display=hook?'block':'none'; }
  if(pemoji) pemoji.textContent=emoji;
  if(ptags) ptags.innerHTML=tags.map(t=>`<span class="pub-tag-chip" style="font-size:10px;padding:2px 8px">#${t}</span>`).join('');
  const collabMap={dev:'🔍 Looking for dev',marketing:'🔍 Looking for marketer',design:'🔍 Looking for designer',video:'🔍 Looking for video creator',investisseur:'🔍 Looking for investor',associe:'🔍 Looking for partner',client:'🔍 First clients'};
  if(pcollab){ pcollab.textContent=collabMap[collab]||''; pcollab.style.display=collab?'block':'none'; }
  if(pauthor&&currentUser) pauthor.textContent=currentUser.name||'';
  // Image if uploaded
  if(pimg && pendingPubMediaUrl){ pimg.src=pendingPubMediaUrl; pimg.style.display='block'; const pe=document.getElementById('wiz-prev-emoji'); if(pe) pe.style.display='none'; }
  else if(pimg){ pimg.style.display='none'; const pe=document.getElementById('wiz-prev-emoji'); if(pe){ pe.style.display='block'; } }

  // Completion checklist
  wizRefreshChecklist();
}

function wizRefreshChecklist(){
  const name = document.getElementById('pub-name')?.value.trim()||'';
  const desc = document.getElementById('pub-desc')?.value.trim()||'';
  const url = document.getElementById('pub-url')?.value.trim()||'';
  const target = document.getElementById('pub-target')?.value.trim()||'';
  const tags = document.getElementById('pub-tags')?.value.trim()||'';
  const hasMedia = !!pendingPubMediaUrl;
  const checks=[
    {key:'name',label:'📝 Nom',ok:name.length>=3},
    {key:'desc',label:'💬 Description',ok:desc.length>=50},
    {key:'hook',label:'✨ Accroche',ok:!!(document.getElementById('pub-hook')?.value.trim())},
    {key:'url',label:'🔗 Link',ok:url.length>5},
    {key:'target',label:'🎯 Audience',ok:target.length>3},
    {key:'tags',label:'🏷️ Tags',ok:tags.length>1},
    {key:'media',label:'🖼️ Visuel',ok:hasMedia},
  ];
  const done=checks.filter(c=>c.ok).length;
  const pct=Math.round((done/checks.length)*100);
  const bar=document.getElementById('wiz-completion-bar');
  const pctEl=document.getElementById('wiz-completion-pct');
  const hints=document.getElementById('wiz-hints');
  if(bar) bar.style.width=pct+'%';
  if(pctEl){ pctEl.textContent=pct+'%'; pctEl.style.color=pct>=80?'var(--g3)':pct>=50?'var(--gold)':'var(--muted)'; }
  if(hints) hints.innerHTML=checks.map(c=>`<span style="font-size:10px;font-family:'DM Mono',monospace;padding:2px 8px;border-radius:3px;background:${c.ok?'rgba(34,197,94,0.12)':'rgba(0,0,0,0.2)'};border:1px solid ${c.ok?'rgba(34,197,94,0.25)':'var(--border2)'};color:${c.ok?'var(--g4)':'var(--muted)'}">${c.ok?'✓':''} ${c.label}</span>`).join('');
}

// ── GUIDE MODAL ──
function showPubGuide(){
  document.getElementById('pub-guide-overlay')?.classList.remove('hidden');
}
function closePubGuide(){
  document.getElementById('pub-guide-overlay')?.classList.add('hidden');
  localStorage.setItem('vb_pub_guide_seen','1');
}

// Override updateMobilePreview to also update showcase preview
const _origUpdateMobilePreview = typeof updateMobilePreview !== 'undefined' ? updateMobilePreview : null;
function updateMobilePreview(){
  const name = document.getElementById('pub-name')?.value || '';
  const desc = document.getElementById('pub-desc')?.value || '';
  const hook = document.getElementById('pub-hook')?.value || '';
  const emoji = document.getElementById('pub-emoji')?.value || '🚀';
  const tags = (document.getElementById('pub-tags')?.value || '').split(',').map(t=>t.trim()).filter(Boolean).slice(0,5);
  const stage = document.getElementById('pub-stage')?.value || '';
  const collab = document.getElementById('pub-collab-need')?.value || '';

  // Mobile preview (olds IDs maintenus for compat)
  const mn = document.getElementById('mob-preview-name') || document.querySelector('#mobile-pub-preview .mob-title');
  const md = document.getElementById('mob-preview-desc') || document.querySelector('#mobile-pub-preview .mob-text');
  if(mn) mn.textContent = name || 'Project name';
  if(md) md.textContent = desc ? desc.slice(0, 100) + (desc.length > 100 ? '...' : '') : 'Your ad description will appear here...';

  // Old preview IDs (compat)
  const pn = document.getElementById('pub-preview-name');
  const pd = document.getElementById('pub-preview-desc');
  const pe = document.getElementById('pub-preview-emoji');
  const ph = document.getElementById('pub-preview-hook');
  const pt = document.getElementById('pub-preview-tags');
  const ps = document.getElementById('pub-preview-stage-badge');
  const pc = document.getElementById('pub-preview-collab-badge');
  const pa = document.getElementById('pub-preview-author');
  if(pn) pn.textContent = name || 'Project name';
  if(pd) pd.textContent = desc ? desc.slice(0, 160) + (desc.length > 160 ? '...' : '') : 'Your description will appear here...';
  if(pe) pe.textContent = emoji;
  if(ph){ ph.textContent = hook; ph.style.display = hook ? 'block' : 'none'; }
  if(pt){ pt.innerHTML = tags.map(t => `<span class="pub-tag-chip" style="font-size:10px;padding:2px 8px">#${t}</span>`).join(''); }
  const stageMap = {idee:'💭 Idea',beta:'🧪 Beta',lance:'🚀 Launched',croissance:'📈 Growing',monetise:'💰 Monetized'};
  if(ps){ ps.textContent = stageMap[stage] || ''; ps.style.display = stage && stage !== 'lance' ? 'block' : 'none'; }
  if(pc){ const collabMap = {dev:'🔍 Looking for dev',marketing:'🔍 Looking for marketer',design:'🔍 Looking for designer',video:'🔍 Looking for video creator',investisseur:'🔍 Looking for investor',associe:'🔍 Looking for partner',client:'🔍 First clients'}; pc.textContent = collabMap[collab]||''; pc.style.display = collab ? 'block' : 'none'; }
  if(pa && currentUser) pa.textContent = currentUser.name || '';

  // Completion
  updatePubCompletion();
}

// ── STATS / ANALYTICS — VRAIES DONNÉES ──
function loadStats(){
  if(!currentUser)return;

  // My real publications
  const myPosts=feedPosts.filter(p=>p.userId===currentUser.email||p.userId===currentUser.id);
  const myProjects=showcaseData.filter(p=>p.authorId===currentUser.email);

  // Real numbers calculated from real data
  const totalLikes=myPosts.reduce((s,p)=>s+(p.likes||0),0);
  const totalComments=myPosts.reduce((s,p)=>s+(p.comments||0),0);
  const totalVotes=myProjects.reduce((s,p)=>s+(p.votes||0),0);
  const totalFollowers=(currentUser.followers||[]).length;
  const totalFollowing=(currentUser.following||[]).length;

  // KPIs
  document.getElementById('stat-views').textContent=(totalLikes*12+totalComments*5+myPosts.length*30).toLocaleString('en');
  document.getElementById('stat-clicks').textContent=(totalLikes*2+totalVotes).toLocaleString('en');
  document.getElementById('stat-posts').textContent=myPosts.length+myProjects.length;
  document.getElementById('stat-followers').textContent=totalFollowers;

  // Trending based on real data
  const hasActivity=myPosts.length>0||myProjects.length>0;
  document.getElementById('stat-views-trend').textContent=hasActivity?'↑ Active':'— Publie for view tes stats';
  document.getElementById('stat-views-trend').className='stat-card-trend '+(hasActivity?'up':'');
  document.getElementById('stat-clicks-trend').textContent=totalLikes>0?'↑ '+totalLikes+' likes':'— 0 like';
  document.getElementById('stat-clicks-trend').className='stat-card-trend '+(totalLikes>0?'up':'');
  document.getElementById('stat-followers-trend').textContent=totalFollowers>0?'↑ '+totalFollowing+' subscriptions':'— Follow creatorsteurs';
  document.getElementById('stat-followers-trend').className='stat-card-trend '+(totalFollowers>0?'up':'');

  // 7-day views chart — based on your real posts
  const chart=document.getElementById('views-chart');
  const labels=document.getElementById('views-chart-labels');
  const days=['L','M','M','J','V','S','D'];
  const today=new Date();
  // Calculate real daily views by looking at post timestamps
  const vals=days.map((_,i)=>{
    const d=new Date(today);d.setDate(today.getDate()-6+i);
    const dayStr=d.toDateString();
    const dayPosts=myPosts.filter(p=>{
      if(!p.createdAt&&!p.time)return false;
      const pd=p.createdAt?new Date(p.createdAt).toDateString():'';
      return pd===dayStr;
    });
    // If no precise timestamps, distribute existing likes
    return dayPosts.length>0?dayPosts.reduce((s,p)=>s+(p.likes||0)*12+15,0):0;
  });
  // If no data with timestamp, still show totals in readable format
  const hasTimestamps=vals.some(v=>v>0);
  const displayVals=hasTimestamps?vals:[0,0,0,0,0,0,totalLikes*12+myPosts.length*30];
  const max=Math.max(...displayVals,1);
  if(chart){
    chart.innerHTML=displayVals.map((v,i)=>`<div class="mini-bar" style="height:${Math.max(4,Math.round(v/max*100))}%;${v===0?'opacity:0.2':''}" title="Day ${days[i]}: ${v} estimated views"></div>`).join('');
    labels.innerHTML=days.map(d=>`<span>${d}</span>`).join('');
  }

  // User's TOP REAL posts
  const tp=document.getElementById('top-posts-list');
  if(tp){
    if(!myPosts.length&&!myProjects.length){
      tp.innerHTML='<div style="color:var(--muted);font-size:11px;padding:8px 0">You haven\'t posted yet. <a href="#plans" onclick="showAppTab(\'publish\',null);return false;" style="color:var(--g3);cursor:pointer">Publish maintenant →</a></div>';
    } else {
      const sorted=[...myPosts].sort((a,b)=>(b.likes||0)-(a.likes||0)).slice(0,3);
      tp.innerHTML=sorted.map((p,i)=>`
        <div style="display:flex;align-items:center;justify-content:space-between;padding:8px 0;border-bottom:1px solid var(--border2)">
          <div style="font-size:11px;color:var(--g5);flex:1;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;max-width:150px">${i+1}. ${escHtml((p.text||'').substring(0,40))}</div>
          <div style="display:flex;gap:8px;font-family:'DM Mono',monospace;font-size:10px;flex-shrink:0">
            <span style="color:var(--g3)">❤️ ${p.likes||0}</span>
            <span style="color:var(--muted)">💬 ${p.comments||0}</span>
          </div>
        </div>`).join('');
    }
  }

  // Distribution by category — MY real projects
  const cc=document.getElementById('cat-chart');
  if(cc){
    const allMine=[...myPosts,...myProjects];
    if(!allMine.length){
      cc.innerHTML='<div style="color:var(--muted);font-size:11px;padding:8px 0">No posts yet</div>';
    } else {
      const catCount={};
      allMine.forEach(p=>{
        const cat=p.projType||p.cat||p.type||'autre';
        catCount[cat]=(catCount[cat]||0)+1;
      });
      const total=allMine.length;
      const catEmojis={site:'🌐',app:'📱',saas:'🚀',tiktok:'🎵',instagram:'📸',ecommerce:'🛍️',service:'💼',coaching:'🎓',autre:'📦'};
      cc.innerHTML=Object.entries(catCount).sort((a,b)=>b[1]-a[1]).map(([cat,count])=>{
        const pct=Math.round(count/total*100);
        return `<div style="display:flex;align-items:center;gap:8px;margin-bottom:8px">
          <span style="font-size:11px;width:80px;flex-shrink:0">${catEmojis[cat]||'📦'} ${cat}</span>
          <div style="flex:1;height:8px;background:var(--s2);border-radius:4px">
            <div style="width:${pct}%;height:100%;background:var(--g2);border-radius:4px;transition:width 0.5s"></div>
          </div>
          <span style="font-family:'DM Mono',monospace;font-size:10px;color:var(--muted);width:28px;text-align:right">${pct}%</span>
        </div>`;
      }).join('');
    }
  }

  // Overall summary at bottom
  const summary=`
    <div style="background:rgba(34,197,94,0.05);border:1.5px solid rgba(34,197,94,0.12);border-radius:10px;padding:14px 18px;margin-top:14px;font-size:12px;color:var(--g5);line-height:1.8">
      📊 <strong style="color:var(--g3)">${myPosts.length}</strong> publication${myPosts.length>1?'s':''} ·
      <strong style="color:var(--g3)">${myProjects.length}</strong> project${myProjects.length>1?'s':''} en showcase ·
      <strong style="color:var(--g3)">${totalLikes}</strong> like${totalLikes>1?'s':''} received ·
      <strong style="color:var(--g3)">${totalVotes}</strong> vote${totalVotes>1?'s':''} ·
      <strong style="color:var(--g3)">${totalFollowers}</strong> follower${totalFollowers>1?'s':''}
    </div>`;
  const statsPanel=document.getElementById('tab-stats');
  if(statsPanel){
    const existing=statsPanel.querySelector('.stats-summary');
    if(existing)existing.remove();
    const wrap=statsPanel.querySelector('[style*="max-width:960px"]');
    if(wrap){const div=document.createElement('div');div.className='stats-summary';div.innerHTML=summary;wrap.appendChild(div);}
  }
}

// ── BOOST CREDITS ──
let userCredits=parseInt(localStorage.getItem('vb_credits')||'0');
let selectedBoostOpt='top-feed';
let pendingShopItem=null, pendingShopCost=0;

// ── MISSIONS QUOTIDIENNES ──
const MISSIONS_DEF = [
  // ── QUOTIDIENNES ──
  { id:'pub1',      icon:'📝', title:'Post today',         desc:'Publish 1 post',              max:1,  reward:8,  counter:u=>Math.min(u._todayPosts||0,1) },
  { id:'pub3',      icon:'🔥', title:'3 posts in one day',   desc:'Post 3 times today',max:3,  reward:20, counter:u=>Math.min(u._todayPosts||0,3) },
  { id:'pub5',      icon:'💥', title:'5 posts in one day',   desc:'Post 5 times today',max:5,  reward:35, counter:u=>Math.min(u._todayPosts||0,5) },
  { id:'like3',     icon:'❤️', title:'Like 3 posts',                desc:'Aime 3 publications',              max:3,  reward:6,  counter:u=>Math.min(u._todayLikes||0,3) },
  { id:'like10',    icon:'💗', title:'Like 10 posts',               desc:'Like 10 posts',             max:10, reward:15, counter:u=>Math.min(u._todayLikes||0,10) },
  { id:'dm1',       icon:'💬', title:'Send a DM',                desc:'Contact a creator',             max:1,  reward:5,  counter:u=>Math.min(u._todayDMs||0,1) },
  { id:'dm3',       icon:'📨', title:'3 DMs sent',               desc:'Contact 3 creators',             max:3,  reward:12, counter:u=>Math.min(u._todayDMs||0,3) },
  { id:'profile',    icon:'✍️', title:'Complete your profile',         desc:'Add bio + link',                max:1,  reward:15, counter:u=>(u.bio&&u.bio.length>10&&(u.website||u.tiktok||u.instagram)?1:0) },
  { id:'showcase1',  icon:'✨', title:'Publish to showcase',           desc:'Add a project to showcase',    max:1,  reward:12, counter:u=>Math.min(u._todayProjects||0,1) },
  { id:'chat5',     icon:'🌐', title:'5 global chat messages',     desc:'Participate in the community chat',  max:5,  reward:10, counter:u=>Math.min(u._todayChat||0,5) },
  { id:'chat10',    icon:'💭', title:'10 global chat messages',    desc:'Actively contribute to chat',     max:10, reward:20, counter:u=>Math.min(u._todayChat||0,10) },
  { id:'login', icon:'🌅', title:'Daily login',       desc:'Log in every day',         max:1,  reward:5,  counter:u=>1 },
  { id:'vote3',     icon:'🗳️', title:'Vote for 3 projects',         desc:'Vote for projects in showcase', max:3,  reward:8,  counter:u=>Math.min(u._todayVotes||0,3) },
  { id:'share1',    icon:'📤', title:'Share a post',     desc:'Share 1 community post',   max:1,  reward:7,  counter:u=>Math.min(u._todayShares||0,1) },
  { id:'react5',    icon:'😍', title:'5 reactions on posts',   desc:'Use 5 reactions (🔥💡💸👏)',   max:5,  reward:10, counter:u=>Math.min(u._todayReacts||0,5) },
  { id:'react_all', icon:'🎭', title:'Use 4 types of reactions',desc:'Try fire, idea, cash and bravo',  max:4,  reward:18, counter:u=>Math.min(u._todayReactTypes||0,4) },
  { id:'follow1',   icon:'👥', title:'Follow a creator',            desc:'Subscribe to 1 creator',          max:1,  reward:5,  counter:u=>Math.min((u._todayFollows||0),1) },
  { id:'follow5',   icon:'🤝', title:'Follow 5 creators',            desc:'Subscribe to 5 creators',         max:5,  reward:15, counter:u=>Math.min((u._todayFollows||0),5) },
  { id:'comment2',  icon:'💡', title:'Commente 2 posts',            desc:'Laisse 2 comments',            max:2,  reward:8,  counter:u=>Math.min(u._todayComments||0,2) },
  { id:'iaboost1',  icon:'🤖', title:'Use AI Boost',            desc:'Generate an AI strategy',          max:1,  reward:18, counter:u=>Math.min(u._todayIA||0,1) },
  { id:'collab1',   icon:'🔗', title:'Propose a collaboration',   desc:'Contacte quelqu\'un via Collabs',  max:1,  reward:20, counter:u=>Math.min(u._todayCollabs||0,1) },
  { id:'group1',    icon:'👾', title:'Join a group',           desc:'Join 1 themed group',  max:1,  reward:10, counter:u=>Math.min(u._todayGroups||0,1) },
  { id:'profile_img',icon:'🖼️', title:'Add your social networks', desc:'Add TikTok or Instagram',    max:1,  reward:12, counter:u=>(u.tiktok||u.instagram?1:0) },
  { id:'streak3',   icon:'🌟', title:'Log in 3 days in a row',  desc:'Come back every day',              max:3,  reward:30, counter:u=>Math.min(u._loginStreak||0,3) },
  { id:'credits50', icon:'⚡', title:'Accumulate 50 credits',         desc:'Reach 50 ViralCredits',          max:50, reward:25, counter:u=>Math.min(userCredits||0,50) },
  { id:'pub_desc',  icon:'📋', title:'Post with long description', desc:'Write a post with 100+ characters', max:1,  reward:10, counter:u=>Math.min(u._todayLongPosts||0,1) },
  // ── NEW — IMAGES & MEDIA ──
  { id:'pub_img',   icon:'📸', title:'Post with an image',       desc:'Add a photo to your post',max:1,  reward:14, counter:u=>Math.min(u._todayMediaPosts||0,1) },
  { id:'pub_img3',  icon:'🖼️', title:'3 posts with image',           desc:'Post 3 times with an image',     max:3,  reward:28, counter:u=>Math.min(u._todayMediaPosts||0,3) },
  { id:'pub_video', icon:'🎬', title:'Post a video',            desc:'Share a video with the community',max:1, reward:20, counter:u=>Math.min(u._todayVideoPosts||0,1) },
  { id:'pub_file',  icon:'📄', title:'Share un fichier',          desc:'Add un fichier PDF ou document', max:1, reward:12, counter:u=>Math.min(u._todayFeedePosts||0,1) },
  { id:'showcase_img',icon:'🌠',title:'Showcase with image',          desc:'Publish a project with a visual',  max:1,  reward:20, counter:u=>Math.min(u._todayVisualProjects||0,1) },
  // ── NEW — AVATAR ICONS ──
  { id:'ava_emoji', icon:'🎭', title:'Change your avatar',            desc:'Update your emoji or photo',   max:1,  reward:8,  counter:u=>(u._changedAvatar?1:0) },
  { id:'ava_photo', icon:'📷', title:'Profile photo',             desc:'Add a real profile photo', max:1,  reward:25, counter:u=>(u.avatarUrl?1:0) },
  // ── NEW — PREMIUM REACTIONS ──
  { id:'react_rocket',icon:'🚀',title:'Reaction Takeoff',        desc:'Use the 🚀 reaction (Starter+)', max:3,  reward:15, counter:u=>Math.min(u._todayRocketReacts||0,3), premium:'starter' },
  { id:'react_crown', icon:'👑',title:'Reaction Royale',           desc:'Use the 👑 reaction (Pro+)',     max:3,  reward:20, counter:u=>Math.min(u._todayCrownReacts||0,3), premium:'pro' },
  { id:'react_gem',   icon:'💎',title:'Reaction Gem',              desc:'Use the 💎 reaction (Pro+)',     max:5,  reward:18, counter:u=>Math.min(u._todayGemReacts||0,5),   premium:'pro' },
  { id:'react_star',  icon:'🌟',title:'Reaction Star',             desc:'Use the 🌟 reaction (Elite)',   max:5,  reward:25, counter:u=>Math.min(u._todayStarReacts||0,5),  premium:'elite' },
];

function getMissionsState(){
  const today = new Date().toDateString();
  const raw = JSON.parse(localStorage.getItem('vb_missions_'+today)||'{}');
  return raw;
}
function saveMissionsState(state){
  const today = new Date().toDateString();
  localStorage.setItem('vb_missions_'+today, JSON.stringify(state));
}

function renderMissions(){
  const list = document.getElementById('missions-list');
  if(!list) return;
  const state = getMissionsState();
  const plan = currentUser?.plan||'free';
  const planOrder = {free:0,starter:1,pro:2,elite:3};
  const userLevel = planOrder[plan]||0;

  // Group by category
  const categories = [
    {label:'📅 Quotidiennes', ids:['pub1','pub3','pub5','like3','like10','login','dm1','dm3','chat5','chat10','vote3','share1','comment2','follow1','follow5','iaboost1','collab1','group1']},
    {label:'🖼️ Images & Media', ids:['pub_img','pub_img3','pub_video','pub_file','showcase_img','pub_desc','showcase1']},
    {label:'😎 Avatar & Profile', ids:['ava_emoji','ava_photo','profile','profile_img']},
    {label:'🎭 Reactions', ids:['react5','react_all','react_rocket','react_crown','react_gem','react_star']},
    {label:'⚡ Progression', ids:['streak3','credits50']},
  ];

  let html = '';
  categories.forEach(cat => {
    const missions = MISSIONS_DEF.filter(m => cat.ids.includes(m.id));
    if(!missions.length) return;
    html += `<div style="font-family:'DM Mono',monospace;font-size:10px;color:var(--g3);letter-spacing:2px;margin:16px 0 8px;text-transform:uppercase">${cat.label}</div>`;
    html += missions.map(m => {
      const prog = m.counter(currentUser||{});
      const done = state[m.id+'_claimed'];
      const canClaim = prog >= m.max && !done;
      const pct = Math.round((prog/m.max)*100);
      const reqLevel = m.premium ? planOrder[m.premium]||0 : 0;
      const locked = reqLevel > 0 && userLevel < reqLevel;
      const premiumBadge = m.premium ? `<span style="font-size:8px;font-family:'DM Mono',monospace;background:linear-gradient(135deg,rgba(255,215,0,0.2),rgba(255,140,0,0.15));border:1px solid rgba(255,215,0,0.4);border-radius:3px;padding:1px 6px;color:var(--gold);margin-left:6px">${m.premium.toUpperCase()}</span>` : '';
      return `<div class="mission-card ${done?'done':''} ${locked?'locked':''}">
        <div class="mission-icon" style="${locked?'filter:grayscale(1);opacity:0.5':''}">${m.icon}</div>
        <div class="mission-info">
          <div class="mission-title">${m.title}${premiumBadge}</div>
          <div class="mission-desc">${locked?`🔒 Requires ${m.premium?.toUpperCase()} — Upgrade to unlock`:m.desc}</div>
          <div class="mission-prog-bar"><div class="mission-prog-fill" style="width:${locked?0:pct}%"></div></div>
          <div class="mission-prog-txt">${locked?'--':prog+'/'+m.max}</div>
        </div>
        <div class="mission-reward">
          <div class="mission-reward-val" style="${locked?'color:var(--muted)':''}">+${m.reward}</div>
          <div class="mission-reward-label">⚡ credits</div>
          ${done
            ? '<div class="mission-done-tag">✅ Claimed</div>'
            : locked
              ? `<button class="btn-claim" style="background:linear-gradient(135deg,rgba(255,215,0,0.1),rgba(255,140,0,0.08));border-color:rgba(255,215,0,0.3);color:var(--gold)" onclick="openModal('pricing-modal')">Upgrade →</button>`
              : `<button class="btn-claim" onclick="claimMission('${m.id}',${m.reward})" ${canClaim?'':'disabled'}>${canClaim?'Claim':'In progress'}</button>`
          }
        </div>
      </div>`;
    }).join('');
  });
  list.innerHTML = html;
}

function claimMission(id, reward){
  const m = MISSIONS_DEF.find(x=>x.id===id);
  if(!m) return;
  const prog = m.counter(currentUser||{});
  if(prog < m.max){ toast('Mission not yet completed!','error'); return; }
  const state = getMissionsState();
  if(state[id+'_claimed']){ toast('Already claimed!','error'); return; }
  state[id+'_claimed'] = true;
  saveMissionsState(state);
  addCredits(reward);
  toast(`⚡ +${reward} credits claimed! Mission accomplished 🎯`);
  renderMissions();
}

function updateMissionsCountdown(){
  const el = document.getElementById('missions-countdown');
  if(!el) return;
  const now = new Date();
  const midnight = new Date(now); midnight.setHours(24,0,0,0);
  const diff = midnight - now;
  const h = Math.floor(diff/3600000);
  const m = Math.floor((diff%3600000)/60000);
  const s = Math.floor((diff%60000)/1000);
  el.textContent = String(h).padStart(2,'0')+':'+String(m).padStart(2,'0')+':'+String(s).padStart(2,'0');
}
setInterval(updateMissionsCountdown, 1000);

// Incrémenter accounturs journaliers
function trackTodayAction(action){
  if(!currentUser) return;
  const key = '_today'+action;
  currentUser[key] = (currentUser[key]||0)+1;
  localStorage.setItem('viralboost_user', JSON.stringify(currentUser));
  renderMissions();
}

// ── SHOP ──
function switchCreditsTab(tab, btn){
  document.querySelectorAll('.credits-tab').forEach(t=>t.classList.remove('active'));
  document.querySelectorAll('.cpanel').forEach(p=>p.classList.remove('active'));
  const tabBtn = typeof btn === 'string' ? document.getElementById('ctab-'+tab) : btn;
  if(tabBtn) tabBtn.classList.add('active');
  const panel = document.getElementById('cpanel-'+tab);
  if(panel) panel.classList.add('active');
  if(tab==='missions') renderMissions();
  if(tab==='boost'||tab==='shop') loadBoostPostOptions();
  if(tab==='plans') updatePlansCreditsPanel();
}

function updatePlansCreditsPanel(){
  const el = document.getElementById('plans-credits-display');
  const planEl = document.getElementById('plans-current-plan');
  if(el) el.textContent = userCredits;
  if(planEl && currentUser) planEl.textContent = (currentUser.plan||'free').toUpperCase();
  // Update progress bars for all 6 plans
  ['starter','pro','elite','legend','vip'].forEach(planId=>{
    const cost = PLAN_CREDIT_COSTS[planId];
    if(!cost) return;
    const pct = Math.min(100, Math.round((userCredits/cost)*100));
    const bar = document.getElementById(planId+'-progress-bar');
    const txt = document.getElementById(planId+'-progress-txt');
    if(bar) bar.style.width = pct+'%';
    if(txt){
      if(userCredits >= cost) txt.textContent = '✅ Tu peux acheter ce plan !';
      else txt.textContent = userCredits+'/'+cost+'⚡ ('+pct+'% — encore '+(cost-userCredits)+'⚡)';
      txt.style.color = userCredits >= cost ? 'var(--g3)' : 'var(--muted)';
    }
  });
}

let _shopBoostType=null, _shopBoostCost=0;
function buyBoostPub(){
  if(!currentUser){ openModal('signup-modal'); return; }
  pendingPlan = 'boost_pub';
  document.getElementById('pay-plan-name').textContent = '⚡ BOOST PUB';
  document.getElementById('pay-plan-price').textContent = '$2.49';
  openModal('payment-modal');
  if(stripe){
    const el=stripe.elements({appearance:{theme:'night',variables:{colorPrimary:'#ffd700',colorBackground:'#0b1a0d',colorText:'#f0fdf4',borderRadius:'8px'}}});
    cardElement=el.create('card');
    setTimeout(()=>cardElement.mount('#card-element'),100);
  } else {
    // No Stripe configured - apply boost directly (demo)
    setTimeout(()=>{
      closeModal('payment-modal');
      applyBoostPub(null);
    }, 800);
  }
}

function applyBoostPub(postId){
  // Boost all posts/projects by current user immediately to top
  const uid = currentUser?.email||currentUser?.id;
  const boostedProjs = showcaseData.filter(p=>p.authorId===uid||p.user===uid);
  const boostedPosts = feedPosts.filter(p=>p.userId===uid);
  // If no match, boost all (demo mode)
  const projTargets = boostedProjs.length ? boostedProjs : showcaseData.slice(0,2);
  const postTargets = boostedPosts.length ? boostedPosts : feedPosts.slice(0,2);
  projTargets.forEach(p=>p._boosted=true);
  postTargets.forEach(p=>p._boosted=true);
  buildShowcaseGrid('app-showcase-grid');
  buildShowcaseGrid('landing-showcase-grid');
  buildFeed();
  toast('⚡ Boost activé ! Tes pubs sont maintenant en tête pendant 48h.');
  setTimeout(()=>{
    projTargets.forEach(p=>p._boosted=false);
    postTargets.forEach(p=>p._boosted=false);
    buildShowcaseGrid('app-showcase-grid');
    buildFeed();
  }, 48*60*60*1000);
}

function shopBuy(item, cost){
  if(!currentUser||currentUser.isDemo){openDemoSignupModal();return;}
  const boostItems = ['top-feed','showcase-24h','notif-push','boost-7j'];
  if(boostItems.includes(item)){
    if(userCredits < cost){ toast(`⚡ Il te faut ${cost} credits. Tu en as ${userCredits}.`,'error'); return; }
    const wrap = document.getElementById('shop-boost-select-wrap');
    wrap.style.display = 'block';
    _shopBoostType = item; _shopBoostCost = cost;
    loadBoostPostOptions();
    wrap.scrollIntoView({behavior:'smooth',block:'nearest'});
    return;
  }
  if(userCredits < cost){ toast(`⚡ Il te faut ${cost} credits. Tu en as ${userCredits}.`,'error'); return; }
  spendCredits(cost);
  const labels={
    'cadre-or':'🖼️ Golden Frame activated on your profile!',
    'badge-feu':'🔥 Fire Badge added to your profile!',
    'emoji-pack':'🎭 Emojis+ Pack unlocked!',
    'title-vip':'💎 VIP title added under your name!',
    'ia-analysis':'🔬 AI Analysis launched — check the AI Boost tab!',
    'ia-hashtags':'📌 30 viral hashtags generated — check AI Boost!',
    'ia-strategie':'🗺️ 30-day strategy generated — check AI Boost!'
  };
  toast(labels[item]||'✅ Purchase made!');
  // Save the purchase
  const bought = JSON.parse(localStorage.getItem('vb_shop_items')||'[]');
  bought.push({item, date:new Date().toISOString()});
  localStorage.setItem('vb_shop_items', JSON.stringify(bought));
}

function confirmShopBoost(){
  const sel = document.getElementById('boost-post-select');
  if(!sel||!sel.value){ toast('Please choose a post!','error'); return; }
  if(userCredits < _shopBoostCost){ toast(`⚡ Insufficient credits.`,'error'); return; }
  spendCredits(_shopBoostCost);
  document.getElementById('shop-boost-select-wrap').style.display='none';
  const labels={'top-feed':'🔝 Post moved to top of feed for 2h!','showcase-24h':'✨ Post pinned in showcase for 24h!','notif-push':'🔔 Notification sent to the community!','boost-7j':'🏆 7-day Boost activated!'};
  toast(labels[_shopBoostType]||'🚀 Boost activated!');
}

function addCredits(n){
  userCredits += n;
  localStorage.setItem('vb_credits', userCredits);
  updateCreditsDisplay();
}
function spendCredits(n){
  userCredits = Math.max(0, userCredits - n);
  localStorage.setItem('vb_credits', userCredits);
  updateCreditsDisplay();
}

// ── BUY A PLAN WITH CREDITS ──
const PLAN_CREDIT_COSTS = { starter: 800, pro: 3500, elite: 9000, legend: 18000, vip: 40000 };
function buyPlanWithCredits(planId){
  if(!currentUser){ openModal('login-modal'); return; }
  const cost = PLAN_CREDIT_COSTS[planId];
  if(!cost){ toast('Plan introuvable.','error'); return; }
  const planName = planId.toUpperCase();
  if(currentUser.plan === planId){ toast(`You already have the ${planName} !`,'error'); return; }
  if(userCredits < cost){
    const missing = cost - userCredits;
    toast(`⚡ You need ${missing} more credits for the ${planName} plan. Keep completing missions!`,'error');
    return;
  }
  if(!confirm(`Buy the ${planName} for ${cost}⚡ ViralCredits (1 month)?`)) return;
  spendCredits(cost);
  const prevPlan = currentUser.plan;
  currentUser.plan = planId;
  currentUser._planBoughtWithCredits = (currentUser._planBoughtWithCredits||0) + 1;
  localStorage.setItem('viralboost_user', JSON.stringify(currentUser));
  updateAppBar();
  checkNewBadges();
  toast(`🎉 Plan ${planName} activated for 1 month! -${cost}⚡`);
  // Sync API
  try{ fetch('/api/register-user',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(currentUser)}).catch(()=>{}); }catch(e){}
  // Refresh credits display
  updateCreditsDisplay();
}

function updateCreditsDisplay(){
  const val = userCredits;
  document.querySelectorAll('#user-credits').forEach(el=>el.textContent=val);
  const hc = document.getElementById('header-credits');
  if(hc) hc.textContent = val;
  const bnc = document.getElementById('bn-credits-val');
  if(bnc) bnc.textContent = val;
}
function bottomNavGoCredits(btn){
  document.querySelectorAll('.bn-item').forEach(b=>b.classList.remove('active'));
  btn.classList.add('active');
  showAppTab('boost-credits', document.querySelector('.app-tab[onclick*="boost-credits"]'));
  switchCreditsTab('shop', document.getElementById('ctab-shop'));
}
function selectBoostOpt(el,type){
  document.querySelectorAll('.boost-opt').forEach(o=>o.classList.remove('selected'));
  el.classList.add('selected');
  selectedBoostOpt=type;
}
function buyCredits(amount,price){
  toast(`💳 Redirection payment ${price}$ for ${amount} credits...`);
  setTimeout(()=>{
    addCredits(amount);
    toast(`⚡ ${amount} ViralCredits added!`);
  },1200);
}
function openBuyCredits(){ switchCreditsTab('packs', document.getElementById('ctab-packs')); }
function applyBoost(){
  const sel=document.getElementById('boost-post-select2');
  const costs={'top-feed':10,'showcase-24h':25,'notif-push':50,'boost-7j':80};
  const cost=costs[selectedBoostOpt]||10;
  if(userCredits<cost){toast('⚡ Insufficient credits. Buy a pack!','error');return;}
  if(!sel||!sel.value){toast('Choose a post to boost!','error');return;}
  spendCredits(cost);
  toast('🚀 Boost activated! Your post is now featured.');
}
function loadBoostPostOptions(){
  ['boost-post-select','boost-post-select2'].forEach(id=>{
    const sel=document.getElementById(id);
    if(!sel||!feedPosts)return;
    const myPosts=feedPosts.filter(p=>p.userId===currentUser?.email||p.author===currentUser?.name);
    sel.innerHTML='<option value="">Choose a post...</option>'+myPosts.map(p=>`<option value="${p.id}">${(p.text||'').substring(0,50)}…</option>`).join('');
  });
}

// ── LEADERBOARD ──
function loadLeaderboard(type='pubs'){
  const list=document.getElementById('leaderboard-list');
  if(!list)return;
  let items=[];
  if(type==='pubs'){
    items=feedPosts.sort((a,b)=>(b.likes||0)-(a.likes||0)).slice(0,10)
      .map((p,i)=>({rank:i+1,name:(p.text||'').substring(0,55),sub:p.author||'?',score:(p.likes||0)+' reactions',plan:p.plan||'free'}));
  }else if(type==='createurs'){
    // Only real users from the API — no fake data
    items=[];
  }else{
    items=showcaseData.sort((a,b)=>b.votes-a.votes).slice(0,8)
      .map((p,i)=>({rank:i+1,name:p.name,sub:p.type,score:p.votes+' votes'}));
  }
  if(!items.length){
    list.innerHTML='<div style="text-align:center;padding:40px;color:var(--muted)">The rankings will fill up with real community posts 🚀</div>';
    return;
  }
  const medals=['🥇','🥈','🥉'];
  list.innerHTML=items.map(item=>`
    <div class="lb-item${item.rank<=3?' top'+item.rank:''}">
      <div class="lb-rank">${item.rank}</div>
      ${item.rank<=3?`<div class="lb-medal">${medals[item.rank-1]}</div>`:''}
      <div class="lb-info"><div class="lb-name">${escHtml(item.name)}</div><div class="lb-sub">${item.sub||''}</div></div>
      <div class="lb-score">${item.score}</div>
    </div>`).join('');
}
function switchLeaderboard(type,btn){
  document.querySelectorAll('#tab-leaderboard .feed-tab').forEach(b=>b.classList.remove('active'));
  btn.classList.add('active');
  loadLeaderboard(type);
}

// ── COLLABS MATCHING IA ──
async function loadCollabs(){
  const list=document.getElementById('collab-list');
  if(!list||!currentUser)return;
  list.innerHTML='<div style="text-align:center;padding:24px;color:var(--muted)"><span class="dots"><span></span><span></span><span></span></span> Analysis in progress...</div>';
  await new Promise(r=>setTimeout(r,900));
  // Find real users from the API
  let candidates=[];
  try{
    const r=await fetchWithTimeout('/api/admin/all-users');
    const users=await r.json();
    candidates=(users||[])
      .filter(u=>u.email!==currentUser.email)
      .map(u=>({
        name:u.name||u.email.split('@')[0],
        avatar:u.avatar||'🙂',
        niche:u.niche||'Creator',
        goal:u.goal||'',
        skills:u.skills||'',
        id:u.email,
        plan:u.plan||'free'
      }))
      .slice(0,10);
  }catch(e){}
  if(!candidates.length){
    list.innerHTML=`<div style="text-align:center;padding:48px 24px;color:var(--muted)">
      <div style="font-size:48px;margin-bottom:12px">🤝</div>
      <div style="font-size:14px;font-weight:700;color:var(--g5);margin-bottom:8px">No creators to match yet</div>
      <div style="font-size:12px;line-height:1.8">AI matching is based on real community profiles.<br>Complete your profile and come back when the community grows!</div>
    </div>`;
    return;
  }
  list.innerHTML=candidates.map(c=>`
    <div class="collab-card">
      <div class="collab-header">
        <div class="collab-ava" style="background:linear-gradient(135deg,var(--g1),var(--g3))">${c.avatar}</div>
        <div style="flex:1">
          <div style="font-size:14px;font-weight:700;margin-bottom:2px">${escHtml(c.name)}</div>
          <div style="font-size:11px;color:var(--muted)">${escHtml(c.niche)}${c.skills?' · '+escHtml(c.skills):''}</div>
          <span class="chat-msg-plan-badge plan-${c.plan}" style="margin-top:4px;display:inline-block">${(c.plan||'FREE').toUpperCase()}</span>
        </div>
      </div>
      ${c.goal?`<div class="collab-why">Goal : <em>${escHtml(c.goal)}</em></div>`:''}
      <div style="display:flex;gap:8px">
        <button class="btn-collab" onclick="openDMToUser('${c.id}','${escHtml(c.name)}')">💬 Contact</button>
        <button onclick="this.textContent='✓ Ignored';this.disabled=true" style="background:transparent;border:1.5px solid var(--border2);border-radius:6px;padding:7px 14px;font-size:12px;cursor:pointer;color:var(--muted);font-family:'Plus Jakarta Sans',sans-serif">Ignore</button>
      </div>
    </div>`).join('');
}

// ── EDITORIAL CALENDAR ──
let calYear=new Date().getFullYear(),calMonth=new Date().getMonth();
const calPosts={};
function buildCalendar(){
  const grid=document.getElementById('cal-grid');
  const label=document.getElementById('cal-month-label');
  if(!grid)return;
  const months=['January','February','March','April','May','June','July','August','September','October','November','December'];
  label.textContent=months[calMonth]+' '+calYear;
  const first=new Date(calYear,calMonth,1);
  const last=new Date(calYear,calMonth+1,0).getDate();
  let startDay=first.getDay()||7; // 1=lun
  const today=new Date();
  let html='';
  for(let i=1;i<startDay;i++) html+='<div class="cal-day" style="opacity:0.2"></div>';
  for(let d=1;d<=last;d++){
    const key=`${calYear}-${String(calMonth+1).padStart(2,'0')}-${String(d).padStart(2,'0')}`;
    const isToday=d===today.getDate()&&calMonth===today.getMonth()&&calYear===today.getFullYear();
    const posts=calPosts[key]||[];
    html+=`<div class="cal-day${posts.length?' has-post':''}${isToday?' today':''}" onclick="calDayClick('${key}')">
      <div class="cal-num">${d}</div>
      ${posts.map(()=>'<span class="cal-post-dot"></span>').join('')}
    </div>`;
  }
  grid.innerHTML=html;
  // Optimal slots
  const slots=document.getElementById('optimal-slots');
  if(slots){
    const times=['Mon 6pm','Tue 12pm','Wed 7pm','Thu 9am','Fri 5pm','Sat 11am','Sun 8pm'];
    slots.innerHTML=times.map(t=>`<span class="slot-chip" onclick="this.classList.toggle('selected')" title="Cliquer for programmer">⏰ ${t}</span>`).join('');
  }
}
function calNav(dir){
  calMonth+=dir;
  if(calMonth>11){calMonth=0;calYear++;}
  if(calMonth<0){calMonth=11;calYear--;}
  buildCalendar();
}
function calDayClick(key){
  const text=prompt('Scheduled post title:');
  if(!text)return;
  if(!calPosts[key])calPosts[key]=[];
  calPosts[key].push(text);
  buildCalendar();
  toast('📅 Post scheduled on '+key+'!');
}

// ── AI A/B TEST ──
async function runABTest(){
  const a=document.getElementById('ab-text-a').value.trim();
  const b=document.getElementById('ab-text-b').value.trim();
  const goal=document.getElementById('ab-goal').value;
  if(!a||!b){toast('Feedl in both versions!','error');return;}
  const btn=document.getElementById('btn-ab');
  btn.disabled=true;btn.innerHTML='<span class="dots"><span></span><span></span><span></span></span> Analysis in progress...';
  document.getElementById('ab-result').style.display='none';
  try{
    const res=await fetch('/api/ia-boost',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({
      type:'abtest',name:'A/B Test',description:`Analyze these two ad versions for the goal "${goal}".\n\nVERSION A:\n${a}\n\nVERSION B:\n${b}\n\nProvide: 1) which version is better and why, 2) estimated conversion score for each (out of 100), 3) 3 strengths and 1 weakness of each. Be concise and direct.`
    })});
    const data=await res.json();
    const txt=data.strategy||data.result||'Analysis not available.';
    const winner=txt.toLowerCase().includes('version b')&&!txt.toLowerCase().includes('version a wins')?'VERSION B WINS 🔵':'VERSION A WINS 🟢';
    document.getElementById('ab-winner-text').textContent=winner;
    document.getElementById('ab-analysis-text').textContent=txt;
    document.getElementById('ab-result').style.display='block';
  }catch(e){
    // Fallback offline
    const winner=a.length>b.length?'VERSION A':'VERSION B';
    document.getElementById('ab-winner-text').textContent=winner+' WINS';
    document.getElementById('ab-analysis-text').textContent=`Offline analysis:\n${winner} seems to perform better because it is ${a.length>b.length?'more detailed':'more concise and impactful'}.\n\nGeneral tips:\n• Always start with the customer benefit\n• Use concrete numbers\n• End with a clear call to action\n• Avoid technical jargon`;
    document.getElementById('ab-result').style.display='block';
  }
  btn.disabled=false;btn.textContent='🔬 Analyze with AI';
}

// ── MOBILE PREVIEW — managed by updateMobilePreview() above ──

// ── INIT NEW FEATURES on login ──
document.addEventListener('vb-user-logged-in', () => {
  updateCreditsDisplay();
  setTimeout(checkOnboarding, 800);
});

// Guide pub : ouverture via showAppTab() directement


const OFFER_LIMIT = 100;

async function checkAndShowOffer() {
  if (sessionStorage.getItem('vb_offer_closed')) return;
  if (localStorage.getItem('vb_offer_seen')) return;
  if (currentUser && (currentUser.plan === 'pro' || currentUser.plan === 'elite')) return;

  // Update the counter in real time
  try {
    const r = await fetchWithTimeout('/api/admin/all-users?key=viralboost-admin', {}, 3000);
    const users = r.ok ? await r.json() : [];
    const remaining = Math.max(0, OFFER_LIMIT - users.length);
    const el = document.getElementById('offer-remaining');
    if (el) el.textContent = remaining;

    if (remaining <= 0) {
      // Offer done — change the content
      const wrap = document.getElementById('offer-box-wrap');
      wrap.innerHTML = `<div class="offer-full">
        <div style="font-size:40px;margin-bottom:10px">😔</div>
        <div style="font-family:'Bebas Neue',sans-serif;font-size:28px;color:#fbbf24;letter-spacing:2px">OFFER ENDED</div>
        <div style="font-size:13px;color:#4a7a58;margin-top:8px">All 100 free spots have been taken.<br>Discover our plans starting at $3/month.</div>
        <button class="offer-cta" style="margin-top:18px;width:auto;padding:12px 28px" onclick="closeOffer()">See plans →</button>
      </div>`;
    }
  } catch(e) {
    // API unavailable or timeout — leave "—" or use approx value
    const el = document.getElementById('offer-remaining');
    if (el && el.textContent === '—') el.textContent = '< 100';
  }
}

// showOfferFallback removed — the popup is always visible by default

function claimOffer() {
  localStorage.setItem('vb_offer_seen', '1');
  localStorage.setItem('vb_offer_claimed', '1');
  localStorage.setItem('vb_offer_pending', '1');
  document.getElementById('offer-popup').classList.add('hidden');
  if (currentUser) {
    // Already connected → direct upgrade
    currentUser.plan = 'pro';
    currentUser.offerClaimed = true;
    currentUser.offerExpiry = new Date(Date.now() + 365*24*60*60*1000).toISOString();
    localStorage.setItem('viralboost_user', JSON.stringify(currentUser));
    fetch('/api/register-user', {method:'POST', headers:{'Content-Type':'application/json'}, body: JSON.stringify(currentUser)}).catch(()=>{});
    toast('🎉 Plan PRO activated for free for 1 year!');
    updateAppBar();
  } else {
    // Open the sign up form directly
    openModal('signup-modal');
  }
}

function closeOffer() {
  // Mark as permanently declined — never show again
  localStorage.setItem('vb_offer_seen', '1');
  document.getElementById('offer-popup').classList.add('hidden');
}



// Activate the PRO plan offered at account creation — integrated in createUser above

// ── OFFER COUNTDOWN — expires 01/03/2026 at 10:00 ──
const OFFER_EXPIRY = new Date('2026-03-01T10:00:00');

function updateCountdown() {
  const el = document.getElementById('offer-countdown');
  if (!el) return;
  const diff = OFFER_EXPIRY - Date.now();
  if (diff <= 0) {
    el.textContent = 'EXPIRED';
    el.style.color = '#f87171';
    return;
  }
  const d = Math.floor(diff / 86400000);
  const h = Math.floor((diff % 86400000) / 3600000);
  const m = Math.floor((diff % 3600000) / 60000);
  const s = Math.floor((diff % 60000) / 1000);
  el.textContent = (d > 0 ? d + 'j ' : '') + String(h).padStart(2,'0') + ':' + String(m).padStart(2,'0') + ':' + String(s).padStart(2,'0');
}
setInterval(updateCountdown, 1000);


// ── BOTTOM NAV ──

// ── DYNAMIC MEMBER COUNTER ──
async function loadMemberCount(){
  try{
    const r = await fetchWithTimeout('/api/admin/all-users?key=viralboost-admin', {}, 3000);
    const users = await r.json();
    if(Array.isArray(users) && users.length > 0){
      const count = users.length;
      const wrap = document.getElementById('hero-member-wrap');
      const countEl = document.getElementById('hero-member-count');
      if(countEl) countEl.textContent = count;
      if(wrap) wrap.style.display = 'inline';
    }
  }catch(e){}
}

function toggleMoreMenu(){
  const overlay=document.getElementById('bn-more-overlay');
  if(overlay) overlay.classList.toggle('hidden');
  const btn=document.getElementById('bn-more');
  if(btn) btn.classList.toggle('active');
}
function closeMoreMenu(){
  document.getElementById('bn-more-overlay')?.classList.add('hidden');
  document.getElementById('bn-more')?.classList.remove('active');
}
function moreNavGo(tab){
  closeMoreMenu();
  showAppTab(tab, null);
  // Disable all bn-items
  document.querySelectorAll('.bn-item').forEach(b=>b.classList.remove('active'));
  document.getElementById('bn-more')?.classList.add('active');
}

function bottomNavGo(tab, btn){
  // Sync with existing app tab
  const appTabBtn = document.querySelector(`.app-tab[onclick="showAppTab('${tab}',this)"]`);
  if(appTabBtn) appTabBtn.click();
  // Update the active bottom nav
  document.querySelectorAll('.bn-item').forEach(b=>b.classList.remove('active','bn-just-activated'));
  if(btn){
    btn.classList.add('active');
    // Pop animation
    btn.classList.add('bn-just-activated');
    setTimeout(()=>btn.classList.remove('bn-just-activated'), 350);
  }
}
function syncBottomNav(tab){
  const map={'home':'bn-home','feed':'bn-home','showcase':'bn-showcase','big-campaign':'bn-showcase','campaign':'bn-showcase','publish':'bn-publish','chat-global':'bn-chat','profile':'bn-profile','boost-credits':'bn-credits'};
  document.querySelectorAll('.bn-item').forEach(b=>b.classList.remove('active'));
  const id=map[tab];
  if(id) document.getElementById(id)?.classList.add('active');
  const chatDot=document.getElementById('chat-notif');
  const bnDot=document.getElementById('bn-chat-dot');
  if(bnDot && chatDot) bnDot.className='bn-dot'+(chatDot.style.display!=='none'?' show':'');
}

// ── MOBILE MENU ──

function toggleMobileMenu(){
  const menu=document.getElementById('mobile-menu');
  const btn=document.getElementById('hamburger-btn');
  const open=menu.classList.toggle('open');
  btn.classList.toggle('open',open);
  document.body.style.overflow=open?'hidden':'';
}
function closeMobileMenu(){
  document.getElementById('mobile-menu').classList.remove('open');
  document.getElementById('hamburger-btn').classList.remove('open');
  document.body.style.overflow='';
}
// Close the menu if clicking elsewhere
document.addEventListener('click',function(e){
  const menu=document.getElementById('mobile-menu');
  const btn=document.getElementById('hamburger-btn');
  if(menu&&menu.classList.contains('open')&&!menu.contains(e.target)&&!btn.contains(e.target)){
    closeMobileMenu();
  }
});

// Show popup after 60% scroll (more natural) or 15 seconds
window.addEventListener('load', () => {
  const popup = document.getElementById('offer-popup');
  const expiresd = Date.now() > OFFER_EXPIRY;
  if (!localStorage.getItem('vb_offer_seen') && !expiresd) {
    updateCountdown();
    let shown = false;
    // Trigger at 60% scroll
    const onScroll = () => {
      const scrollPct = window.scrollY / (document.body.scrollHeight - window.innerHeight);
      if (scrollPct > 0.6 && !shown) {
        shown = true;
        popup.classList.remove('hidden');
        checkAndShowOffer();
        window.removeEventListener('scroll', onScroll);
      }
    };
    window.addEventListener('scroll', onScroll);
    // Fallback after 15 seconds if no scroll
    setTimeout(() => {
      if (!shown) {
        shown = true;
        popup.classList.remove('hidden');
        checkAndShowOffer();
        window.removeEventListener('scroll', onScroll);
      }
    }, 15000);
  }
});
</script>

<!-- ═══════════════════════════════════════════
     MODAL GUIDE — First ad creation
═══════════════════════════════════════════ -->
<div class="guide-overlay hidden" id="pub-guide-overlay" onclick="if(event.target===this)closePubGuide()">
  <div class="guide-box">
    <button class="guide-box-close" onclick="closePubGuide()">✕</button>
    <div class="guide-title" style="font-size:22px;margin-bottom:4px">CREATE YOUR AD IN 5 STEPS</div>
    <div class="guide-subtitle" style="font-size:12px;margin-bottom:14px">Follow the wizard — each step is guided.</div>
    <div style="display:flex;flex-direction:column;gap:6px;margin-bottom:16px">
      <div style="display:flex;align-items:center;gap:10px;font-size:12px;color:var(--g5)"><span style="width:20px;height:20px;border-radius:50%;background:var(--g2);color:var(--bg);font-size:10px;font-weight:800;display:flex;align-items:center;justify-content:center;flex-shrink:0">1</span>🚀 Identity — name & category</div>
      <div style="display:flex;align-items:center;gap:10px;font-size:12px;color:var(--g5)"><span style="width:20px;height:20px;border-radius:50%;background:var(--g2);color:var(--bg);font-size:10px;font-weight:800;display:flex;align-items:center;justify-content:center;flex-shrink:0">2</span>✍️ Description — what you offer</div>
      <div style="display:flex;align-items:center;gap:10px;font-size:12px;color:var(--g5)"><span style="width:20px;height:20px;border-radius:50%;background:var(--g2);color:var(--bg);font-size:10px;font-weight:800;display:flex;align-items:center;justify-content:center;flex-shrink:0">3</span>🎯 Audience & tags</div>
      <div style="display:flex;align-items:center;gap:10px;font-size:12px;color:var(--g5)"><span style="width:20px;height:20px;border-radius:50%;background:var(--g2);color:var(--bg);font-size:10px;font-weight:800;display:flex;align-items:center;justify-content:center;flex-shrink:0">4</span>🖼️ Visuel <strong style="color:var(--g3)">→ 3× more votes</strong></div>
      <div style="display:flex;align-items:center;gap:10px;font-size:12px;color:var(--g5)"><span style="width:20px;height:20px;border-radius:50%;background:var(--g2);color:var(--bg);font-size:10px;font-weight:800;display:flex;align-items:center;justify-content:center;flex-shrink:0">5</span>👁️ Preview & publish</div>
    </div>
    <button class="btn-guide-start" style="padding:12px;font-size:13px" onclick="closePubGuide()">✨ Let's go!</button>
  </div>
</div>

<!-- EXIT INTENT POPUP -->


<!-- MODAL PROJET -->
<div class="project-modal-overlay hidden" id="project-modal-overlay" onclick="if(event.target===this)closeProjectModal()">
  <div class="project-modal" id="project-modal-content">
    <!-- dynamically populated -->
  </div>
</div>

<!-- BOTTOM NAV BAR (mobile) -->
<nav class="bottom-nav" id="bottom-nav" role="navigation" aria-label="Navigation principale">
  <button class="bn-item" id="bn-home" onclick="bottomNavGo('home',this)">
    <span class="bn-icon">
      <svg width="36" height="36" viewBox="0 0 40 40" fill="none">
        <defs><linearGradient id="gh1" x1="0" y1="0" x2="1" y2="1"><stop stop-color="#22c55e"/><stop offset="1" stop-color="#15803d"/></linearGradient></defs>
        <rect width="40" height="40" rx="10" fill="url(#gh1)"/>
        <path d="M8 20L20 10l12 10v10a1 1 0 01-1 1H9a1 1 0 01-1-1V20z" fill="rgba(255,255,255,0.9)"/>
        <rect id="home-door" x="16" y="23" width="8" height="8" rx="1.5" fill="#15803d"/>
      </svg>
    </span>
    <span>Home</span>
  </button>

  <button class="bn-item" id="bn-showcase" onclick="document.querySelectorAll('.bn-item').forEach(b=>b.classList.remove('active'));this.classList.add('active');showAppTab('boost-credits',document.querySelector('[data-tab=boost-credits]'));">
    <span class="bn-icon">
      <svg width="36" height="36" viewBox="0 0 40 40" fill="none">
        <defs><linearGradient id="gv1" x1="0" y1="0" x2="1" y2="1"><stop stop-color="#f97316"/><stop offset="1" stop-color="#ea580c"/></linearGradient></defs>
        <rect width="40" height="40" rx="10" fill="url(#gv1)"/>
        <path d="M8 10h4l3 14h14l3-8H13" stroke="rgba(255,255,255,0.95)" stroke-width="2.2" stroke-linecap="round" stroke-linejoin="round" fill="none"/>
        <circle cx="18" cy="28" r="2" fill="rgba(255,255,255,0.95)"/>
        <circle cx="28" cy="28" r="2" fill="rgba(255,255,255,0.95)"/>
      </svg>
    </span>
    <span>Shop</span>
  </button>

 <button class="bn-item" id="bn-profile" onclick="bottomNavGo('profile',this)">
    <span class="bn-icon">
      <svg width="36" height="36" viewBox="0 0 40 40" fill="none">
        <defs><linearGradient id="gp2" x1="0" y1="0" x2="1" y2="1"><stop stop-color="#4fc3f7"/><stop offset="1" stop-color="#0277bd"/></linearGradient></defs>
        <rect width="40" height="40" rx="10" fill="url(#gp2)"/>
        <circle cx="20" cy="15" r="7" fill="rgba(255,255,255,0.95)"/>
        <path d="M6 38c0-7.7 6.3-13 14-13s14 5.3 14 13" fill="rgba(255,255,255,0.9)"/>
      </svg>
    </span>
    <span>Profile</span>
  </button>

  <button class="bn-item" id="bn-more" onclick="toggleMoreMenu()">
    <span class="bn-icon">
      <svg width="36" height="36" viewBox="0 0 40 40" fill="none">
        <defs><linearGradient id="gm1" x1="0" y1="0" x2="1" y2="1"><stop stop-color="#78909c"/><stop offset="1" stop-color="#37474f"/></linearGradient></defs>
        <rect width="40" height="40" rx="10" fill="url(#gm1)"/>
        <rect x="9" y="12" width="22" height="3" rx="1.5" fill="rgba(255,255,255,0.9)"/>
        <rect x="9" y="18.5" width="22" height="3" rx="1.5" fill="rgba(255,255,255,0.9)"/>
        <rect x="9" y="25" width="22" height="3" rx="1.5" fill="rgba(255,255,255,0.9)"/>
      </svg>
    </span>
    <span>More</span>
  </button>
</nav>

<!-- MENU "PLUS" MOBILE -->
<div class="bn-more-overlay hidden" id="bn-more-overlay" onclick="if(event.target===this)closeMoreMenu()">
  <div class="bn-more-sheet" id="bn-more-sheet">
    <div class="bn-more-handle"></div>
    <div class="bn-more-title">More options</div>
    <div class="bn-more-grid">
      <button class="bn-more-item" onclick="moreNavGo('chat-global')">
        <span class="bn-more-icon"><svg width="36" height="36" viewBox="0 0 40 40" fill="none"><defs><linearGradient id="ic1" x1="0" y1="0" x2="1" y2="1"><stop stop-color="#4dd0e1"/><stop offset="1" stop-color="#00838f"/></linearGradient></defs><rect width="40" height="40" rx="10" fill="url(#ic1)"/><path d="M8 12h24v14a2 2 0 01-2 2H10a2 2 0 01-2-2V12z" fill="rgba(255,255,255,0.2)"/><rect x="8" y="10" width="24" height="16" rx="3" fill="rgba(255,255,255,0.9)"/><circle cx="14" cy="18" r="2" fill="#00838f"/><circle cx="20" cy="18" r="2" fill="#00838f"/><circle cx="26" cy="18" r="2" fill="#00838f"/><path d="M14 26l2 4h8l2-4" fill="rgba(255,255,255,0.9)"/></svg></span>
        <span>Chat</span>
      </button>
      <button class="bn-more-item" onclick="moreNavGo('boost-credits')">
        <span class="bn-more-icon"><svg width="36" height="36" viewBox="0 0 40 40" fill="none"><defs><linearGradient id="ic2" x1="0" y1="0" x2="1" y2="1"><stop stop-color="#ffb74d"/><stop offset="1" stop-color="#e65100"/></linearGradient></defs><rect width="40" height="40" rx="10" fill="url(#ic2)"/><rect x="7" y="13" width="26" height="18" rx="3" fill="rgba(255,255,255,0.2)"/><rect x="7" y="11" width="26" height="16" rx="3" fill="rgba(255,255,255,0.9)"/><path d="M13 17h4v2h-4zm0 4h8v2h-8zm10-4h4v6h-4z" fill="#e65100"/><circle cx="28" cy="10" r="5" fill="#ffd54f"/><text x="25.5" y="13.5" font-size="7" fill="#e65100" font-weight="bold">$</text></svg></span>
        <span>Shop</span>
      </button>
      <button class="bn-more-item" onclick="moreNavGo('groups')">
        <span class="bn-more-icon"><svg width="36" height="36" viewBox="0 0 40 40" fill="none"><defs><linearGradient id="ic3" x1="0" y1="0" x2="1" y2="1"><stop stop-color="#ce93d8"/><stop offset="1" stop-color="#7b1fa2"/></linearGradient></defs><rect width="40" height="40" rx="10" fill="url(#ic3)"/><circle cx="14" cy="15" r="5" fill="rgba(255,255,255,0.9)"/><circle cx="26" cy="15" r="5" fill="rgba(255,255,255,0.7)"/><path d="M4 32c0-5.5 4.5-9 10-9s10 3.5 10 9" fill="rgba(255,255,255,0.9)"/><path d="M22 32c0-5.5 4.5-9 10-9" fill="rgba(255,255,255,0.6)"/></svg></span>
        <span>Groups</span>
      </button>
      <button class="bn-more-item" onclick="moreNavGo('stats')">
        <span class="bn-more-icon"><svg width="36" height="36" viewBox="0 0 40 40" fill="none"><defs><linearGradient id="ic4" x1="0" y1="0" x2="1" y2="1"><stop stop-color="#81c784"/><stop offset="1" stop-color="#1b5e20"/></linearGradient></defs><rect width="40" height="40" rx="10" fill="url(#ic4)"/><rect x="8" y="24" width="5" height="9" rx="1.5" fill="rgba(255,255,255,0.9)"/><rect x="15" y="18" width="5" height="15" rx="1.5" fill="rgba(255,255,255,0.9)"/><rect x="22" y="12" width="5" height="21" rx="1.5" fill="rgba(255,255,255,0.9)"/><rect x="29" y="20" width="5" height="13" rx="1.5" fill="rgba(255,255,255,0.7)"/></svg></span>
        <span>Stats</span>
      </button>
      <button class="bn-more-item" onclick="moreNavGo('leaderboard')">
        <span class="bn-more-icon"><svg width="36" height="36" viewBox="0 0 40 40" fill="none"><defs><linearGradient id="ic5" x1="0" y1="0" x2="1" y2="1"><stop stop-color="#ffd54f"/><stop offset="1" stop-color="#f57f17"/></linearGradient></defs><rect width="40" height="40" rx="10" fill="url(#ic5)"/><path d="M20 6l3.5 7 7.5 1-5.5 5.3 1.3 7.7L20 23.5l-6.8 3.5 1.3-7.7L9 14l7.5-1L20 6z" fill="rgba(255,255,255,0.95)"/><circle cx="20" cy="17" r="3" fill="url(#ic5)"/></svg></span>
        <span>Top</span>
      </button>
      <button class="bn-more-item" onclick="moreNavGo('collab')">
        <span class="bn-more-icon"><svg width="36" height="36" viewBox="0 0 40 40" fill="none"><defs><linearGradient id="ic6" x1="0" y1="0" x2="1" y2="1"><stop stop-color="#ffcc80"/><stop offset="1" stop-color="#e65100"/></linearGradient></defs><rect width="40" height="40" rx="10" fill="url(#ic6)"/><path d="M12 22c2.5-2 5-3 8-3s5.5 1 8 3" stroke="white" stroke-width="2.5" stroke-linecap="round" fill="none"/><circle cx="15" cy="15" r="4" fill="rgba(255,255,255,0.9)"/><circle cx="25" cy="15" r="4" fill="rgba(255,255,255,0.9)"/><path d="M17 28l3 4 3-4" fill="rgba(255,255,255,0.6)"/></svg></span>
        <span>Collabs</span>
      </button>
      <button class="bn-more-item" onclick="moreNavGo('ia-boost')">
        <span class="bn-more-icon"><svg width="36" height="36" viewBox="0 0 40 40" fill="none"><defs><linearGradient id="ic7" x1="0" y1="0" x2="1" y2="1"><stop stop-color="#80deea"/><stop offset="1" stop-color="#006064"/></linearGradient></defs><rect width="40" height="40" rx="10" fill="url(#ic7)"/><rect x="10" y="10" width="20" height="20" rx="5" fill="rgba(255,255,255,0.15)"/><rect x="12" y="12" width="16" height="16" rx="4" fill="rgba(255,255,255,0.9)"/><circle cx="16" cy="18" r="2" fill="#006064"/><circle cx="24" cy="18" r="2" fill="#006064"/><path d="M14 23c1.5 2 10.5 2 12 0" stroke="#006064" stroke-width="1.5" stroke-linecap="round" fill="none"/><circle cx="20" cy="8" r="3" fill="#ffd54f"/><line x1="20" y1="11" x2="20" y2="13" stroke="#ffd54f" stroke-width="1.5"/></svg></span>
        <span>IA Boost</span>
      </button>
      <button class="bn-more-item" onclick="moreNavGo('calendrier')">
        <span class="bn-more-icon"><svg width="36" height="36" viewBox="0 0 40 40" fill="none"><defs><linearGradient id="ic8" x1="0" y1="0" x2="1" y2="1"><stop stop-color="#90caf9"/><stop offset="1" stop-color="#1565c0"/></linearGradient></defs><rect width="40" height="40" rx="10" fill="url(#ic8)"/><rect x="7" y="12" width="26" height="22" rx="3" fill="rgba(255,255,255,0.9)"/><rect x="7" y="12" width="26" height="8" rx="3" fill="url(#ic8)"/><line x1="14" y1="9" x2="14" y2="15" stroke="white" stroke-width="2.5" stroke-linecap="round"/><line x1="26" y1="9" x2="26" y2="15" stroke="white" stroke-width="2.5" stroke-linecap="round"/><rect x="12" y="24" width="4" height="4" rx="1" fill="#1565c0"/><rect x="18" y="24" width="4" height="4" rx="1" fill="#1565c0"/><rect x="24" y="24" width="4" height="4" rx="1" fill="#90caf9"/></svg></span>
        <span>Calendar</span>
      </button>
      <button class="bn-more-item" onclick="moreNavGo('ab-test')">
        <span class="bn-more-icon"><svg width="36" height="36" viewBox="0 0 40 40" fill="none"><defs><linearGradient id="ic9" x1="0" y1="0" x2="1" y2="1"><stop stop-color="#a5d6a7"/><stop offset="1" stop-color="#2e7d32"/></linearGradient></defs><rect width="40" height="40" rx="10" fill="url(#ic9)"/><rect x="7" y="10" width="11" height="20" rx="3" fill="rgba(255,255,255,0.9)"/><rect x="22" y="10" width="11" height="20" rx="3" fill="rgba(255,255,255,0.5)"/><text x="10" y="24" font-size="10" fill="#2e7d32" font-weight="bold">A</text><text x="25" y="24" font-size="10" fill="rgba(255,255,255,0.8)" font-weight="bold">B</text><path d="M18 20h4" stroke="rgba(255,255,255,0.8)" stroke-width="2" stroke-linecap="round"/></svg></span>
        <span>A/B Test</span>
      </button>
      <button class="bn-more-item" onclick="moreNavGo('followers')">
        <span class="bn-more-icon"><svg width="36" height="36" viewBox="0 0 40 40" fill="none"><defs><linearGradient id="ic10" x1="0" y1="0" x2="1" y2="1"><stop stop-color="#ffe082"/><stop offset="1" stop-color="#ff6f00"/></linearGradient></defs><rect width="40" height="40" rx="10" fill="url(#ic10)"/><path d="M20 8c-4.4 0-7 2-7 5 0 1.5.8 3 2 4l-1 4h12l-1-4c1.2-1 2-2.5 2-4 0-3-2.6-5-7-5z" fill="rgba(255,255,255,0.95)"/><rect x="14" y="30" width="12" height="3" rx="1.5" fill="rgba(255,255,255,0.8)"/><circle cx="29" cy="10" r="5" fill="#ef5350"/><text x="26.5" y="13.5" font-size="8" fill="white" font-weight="bold">3</text></svg></span>
        <span>Followers</span>
      </button>
      <button class="bn-more-item" onclick="moreNavGo('email-campaign')">
        <span class="bn-more-icon"><svg width="36" height="36" viewBox="0 0 40 40" fill="none"><defs><linearGradient id="icCamp" x1="0" y1="0" x2="1" y2="1"><stop stop-color="#0ea5e9"/><stop offset="1" stop-color="#0284c7"/></linearGradient></defs><rect width="40" height="40" rx="10" fill="url(#icCamp)"/><rect x="7" y="11" width="26" height="18" rx="3" fill="rgba(255,255,255,0.9)"/><path d="M7 14l13 9 13-9" stroke="#0284c7" stroke-width="2" fill="none" stroke-linecap="round"/></svg></span>
        <span>Campaigns</span>
      </button>
      <button class="bn-more-item" onclick="moreNavGo('crm')">
        <span class="bn-more-icon"><svg width="36" height="36" viewBox="0 0 40 40" fill="none"><defs><linearGradient id="icCRM" x1="0" y1="0" x2="1" y2="1"><stop stop-color="#14b8a6"/><stop offset="1" stop-color="#0f766e"/></linearGradient></defs><rect width="40" height="40" rx="10" fill="url(#icCRM)"/><circle cx="14" cy="16" r="5" fill="rgba(255,255,255,0.9)"/><path d="M4 32c0-5.5 4.5-9 10-9s10 3.5 10 9" fill="rgba(255,255,255,0.9)"/><line x1="26" y1="12" x2="36" y2="12" stroke="rgba(255,255,255,0.8)" stroke-width="2.5" stroke-linecap="round"/><line x1="26" y1="18" x2="34" y2="18" stroke="rgba(255,255,255,0.6)" stroke-width="2.5" stroke-linecap="round"/><line x1="26" y1="24" x2="32" y2="24" stroke="rgba(255,255,255,0.4)" stroke-width="2.5" stroke-linecap="round"/></svg></span>
        <span>CRM</span>
      </button>
      <button class="bn-more-item" onclick="moreNavGo('affiliate')">
        <span class="bn-more-icon"><svg width="36" height="36" viewBox="0 0 40 40" fill="none"><defs><linearGradient id="icAff" x1="0" y1="0" x2="1" y2="1"><stop stop-color="#f59e0b"/><stop offset="1" stop-color="#d97706"/></linearGradient></defs><rect width="40" height="40" rx="10" fill="url(#icAff)"/><circle cx="10" cy="20" r="4" fill="rgba(255,255,255,0.9)"/><circle cx="30" cy="12" r="4" fill="rgba(255,255,255,0.9)"/><circle cx="30" cy="28" r="4" fill="rgba(255,255,255,0.9)"/><line x1="14" y1="18" x2="26" y2="13" stroke="rgba(255,255,255,0.8)" stroke-width="2" stroke-linecap="round"/><line x1="14" y1="22" x2="26" y2="27" stroke="rgba(255,255,255,0.8)" stroke-width="2" stroke-linecap="round"/></svg></span>
        <span>Affiliate</span>
      </button>
      <button class="bn-more-item" onclick="moreNavGo('settings')">
        <span class="bn-more-icon"><svg width="36" height="36" viewBox="0 0 40 40" fill="none"><defs><linearGradient id="icSet" x1="0" y1="0" x2="1" y2="1"><stop stop-color="#94a3b8"/><stop offset="1" stop-color="#475569"/></linearGradient></defs><rect width="40" height="40" rx="10" fill="url(#icSet)"/><circle cx="20" cy="20" r="5" fill="rgba(255,255,255,0.9)"/><path d="M20 8v3M20 29v3M8 20h3M29 20h3M11.5 11.5l2.1 2.1M26.4 26.4l2.1 2.1M11.5 28.5l2.1-2.1M26.4 13.6l2.1-2.1" stroke="rgba(255,255,255,0.85)" stroke-width="2.5" stroke-linecap="round"/></svg></span>
        <span>Settings</span>
      </button>
      <button class="bn-more-item" onclick="moreNavGo('help')">
        <span class="bn-more-icon"><svg width="36" height="36" viewBox="0 0 40 40" fill="none"><defs><linearGradient id="icHelp" x1="0" y1="0" x2="1" y2="1"><stop stop-color="#64748b"/><stop offset="1" stop-color="#334155"/></linearGradient></defs><rect width="40" height="40" rx="10" fill="url(#icHelp)"/><circle cx="20" cy="20" r="12" fill="rgba(255,255,255,0.9)"/><text x="16.5" y="25" font-size="14" fill="#334155" font-weight="bold">?</text></svg></span>
        <span>Help</span>
      </button>
      <button class="bn-more-item bn-more-logout" onclick="closeMoreMenu();logout()">
        <span class="bn-more-icon"><svg width="36" height="36" viewBox="0 0 40 40" fill="none"><defs><linearGradient id="ic11" x1="0" y1="0" x2="1" y2="1"><stop stop-color="#ef9a9a"/><stop offset="1" stop-color="#b71c1c"/></linearGradient></defs><rect width="40" height="40" rx="10" fill="url(#ic11)"/><rect x="10" y="12" width="14" height="16" rx="2" fill="rgba(255,255,255,0.9)"/><path d="M22 20h10m-4-4l4 4-4 4" stroke="white" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round" fill="none"/></svg></span>
        <span>Leave</span>
      </button>
    </div>
  </div>
</div>


<script>
// ── PWA SERVICE WORKER ──
if('serviceWorker' in navigator){
  window.addEventListener('load', () => {
    const swCode = `
      const CACHE = 'viralboost-v1';
      self.addEventListener('install', e => {
        e.waitUntil(caches.open(CACHE).then(c => c.addAll(['/'])));
      });
      self.addEventListener('fetch', e => {
        e.respondWith(fetch(e.request).catch(() => caches.match(e.request)));
      });
    `;
    const blob = new Blob([swCode], {type: 'application/javascript'});
    const swUrl = URL.createObjectURL(blob);
    navigator.serviceWorker.register(swUrl).catch(()=>{});
  });
}

// ── INSTALL PROMPT ──
let deferredPrompt = null;
window.addEventListener('beforeinstallprompt', (e) => {
  e.preventDefault();
  deferredPrompt = e;
  showInstallBanner();
});

function showInstallBanner(){
  // Show navbar button too
  const navBtn = document.getElementById('pwa-install-btn');
  if(navBtn) navBtn.style.display = 'flex';
  if(document.getElementById('pwa-banner')) return;
  const banner = document.createElement('div');
  banner.id = 'pwa-banner';
  banner.style.cssText = 'position:fixed;bottom:24px;left:50%;transform:translateX(-50%);z-index:9990;background:linear-gradient(135deg,#0b1a0d,#142e17);border:1.5px solid rgba(34,197,94,0.4);border-radius:16px;padding:14px 20px;display:flex;align-items:center;gap:14px;box-shadow:0 8px 40px rgba(0,0,0,0.5);min-width:320px;max-width:90vw;animation:slideUp 0.4s ease;';
  banner.innerHTML = `
    <div style="width:40px;height:40px;background:linear-gradient(135deg,#22c55e,#16a34a);border-radius:10px;display:flex;align-items:center;justify-content:center;font-size:20px;flex-shrink:0">⚡</div>
    <div style="flex:1">
      <div style="font-size:13px;font-weight:800;color:#f0fdf4;margin-bottom:2px">Installer ViralBoost</div>
      <div style="font-size:11px;color:#4a7a58">Quick access from your desktop</div>
    </div>
    <button onclick="installPWA()" style="padding:8px 16px;background:#22c55e;border:none;border-radius:8px;font-family:Plus Jakarta Sans,sans-serif;font-size:12px;font-weight:800;color:#040a05;cursor:pointer;flex-shrink:0">Installer</button>
    <button onclick="dismissPWA()" style="background:none;border:none;color:#4a7a58;cursor:pointer;font-size:18px;padding:0 4px;flex-shrink:0">✕</button>
  `;
  document.body.appendChild(banner);
  // Auto-dismiss after 10s
  setTimeout(dismissPWA, 10000);
}

function handleInstallClick(){
  if(deferredPrompt){
    installPWA();
  } else {
    // Show manual instructions
    const isIOS = /iPad|iPhone|iPod/.test(navigator.userAgent);
    if(isIOS){
      toast('📲 On iPhone: Share then Add to Home Screen');
    } else {
      toast('💻 In Chrome: click the + symbol in the address bar to install!');
    }
  }
}

function installPWA(){
  if(!deferredPrompt) return;
  deferredPrompt.prompt();
  deferredPrompt.userChoice.then(result => {
    if(result.outcome === 'accepted'){
      toast('🎉 ViralBoost installed on your desktop!');
    }
    dismissPWA();
    deferredPrompt = null;
  });
}

function dismissPWA(){
  const b = document.getElementById('pwa-banner');
  if(b) b.remove();
  // Keep navbar button visible
}

// iOS specific — show instructions
window.addEventListener('load', () => {
  const isIOS = /iPad|iPhone|iPod/.test(navigator.userAgent) && !window.MSStream;
  const isStandalone = window.matchMedia('(display-mode: standalone)').matches;
  if(isIOS && !isStandalone && !localStorage.getItem('vb_ios_prompt')){
    setTimeout(() => {
      const banner = document.createElement('div');
      banner.style.cssText = 'position:fixed;bottom:24px;left:50%;transform:translateX(-50%);z-index:9990;background:linear-gradient(135deg,#0b1a0d,#142e17);border:1.5px solid rgba(34,197,94,0.4);border-radius:16px;padding:14px 20px;text-align:center;box-shadow:0 8px 40px rgba(0,0,0,0.5);max-width:90vw;';
      banner.innerHTML = `
        <div style="font-size:13px;font-weight:800;color:#f0fdf4;margin-bottom:6px">📲 Install ViralBoost on iPhone</div>
        <div style="font-size:12px;color:#4a7a58;line-height:1.6">Tap <strong style="color:#22c55e">Share</strong> then <strong style="color:#22c55e">Add to home screen</strong></div>
        <button onclick="this.parentElement.remove();localStorage.setItem('vb_ios_prompt','1')" style="margin-top:10px;padding:6px 16px;background:none;border:1px solid rgba(34,197,94,0.3);border-radius:8px;font-size:12px;color:#22c55e;cursor:pointer">OK compris</button>
      `;
      document.body.appendChild(banner);
    }, 3000);
    localStorage.setItem('vb_ios_prompt', '1');
  }
});
</script>



<!-- AD TYPE CHOOSER -->
<div class="modal-bg" id="pub-type-modal">
  <div class="modal wide" style="max-width:560px;padding:32px">
    <button class="modal-close" onclick="closeModal('pub-type-modal')">✕</button>
    <div style="text-align:center;margin-bottom:28px">
      <div style="font-size:11px;color:var(--g3);letter-spacing:2px;font-family:'DM Mono',monospace;margin-bottom:8px">NOUVELLE PUBLICATION</div>
      <h2 style="font-size:22px;font-weight:800;color:var(--white)">What type of post?</h2>
    </div>
    <div style="display:flex;flex-direction:column;gap:12px">

      <!-- TYPE 1 : PUB -->
      <div onclick="selectPubType('pub')" style="background:var(--s1);border:1.5px solid rgba(34,197,94,0.2);border-radius:14px;padding:18px 20px;cursor:pointer;display:flex;align-items:center;gap:16px;transition:all 0.2s" onmouseover="this.style.borderColor='rgba(34,197,94,0.5)'" onmouseout="this.style.borderColor='rgba(34,197,94,0.2)'">
        <div style="width:48px;height:48px;background:rgba(34,197,94,0.1);border-radius:12px;display:flex;align-items:center;justify-content:center;font-size:22px;flex-shrink:0">📢</div>
        <div style="flex:1">
          <div style="display:flex;align-items:center;gap:8px;margin-bottom:4px">
            <span style="font-size:15px;font-weight:800;color:var(--white)">Pub</span>
            <span style="font-size:10px;background:rgba(34,197,94,0.1);color:var(--g3);border-radius:4px;padding:2px 7px;font-weight:700">GRATUIT</span>
            <span style="font-size:10px;color:var(--muted)">~2 min</span>
          </div>
          <div style="font-size:12px;color:var(--muted);line-height:1.5">Introduce your project quickly. Name, description, category, link. Ideal to get started.</div>
          <div style="display:flex;gap:6px;margin-top:8px">
            <span style="font-size:10px;color:var(--muted2)">✓ Project name</span>
            <span style="font-size:10px;color:var(--muted2)">✓ Description</span>
            <span style="font-size:10px;color:var(--muted2)">✓ Link</span>
          </div>
        </div>
        <div style="font-size:20px;color:var(--muted2)">→</div>
      </div>

      <!-- TYPE 2 : AD -->
      <div onclick="selectPubType('ad')" style="background:var(--s1);border:1.5px solid rgba(74,222,128,0.2);border-radius:14px;padding:18px 20px;cursor:pointer;display:flex;align-items:center;gap:16px;transition:all 0.2s" onmouseover="this.style.borderColor='rgba(74,222,128,0.5)'" onmouseout="this.style.borderColor='rgba(74,222,128,0.2)'">
        <div style="width:48px;height:48px;background:rgba(74,222,128,0.1);border-radius:12px;display:flex;align-items:center;justify-content:center;font-size:22px;flex-shrink:0">📣</div>
        <div style="flex:1">
          <div style="display:flex;align-items:center;gap:8px;margin-bottom:4px">
            <span style="font-size:15px;font-weight:800;color:var(--white)">Ad</span>
            <span style="font-size:10px;background:rgba(74,222,128,0.1);color:#4ade80;border-radius:4px;padding:2px 7px;font-weight:700">STARTER+</span>
            <span style="font-size:10px;color:var(--muted)">~5 min</span>
          </div>
          <div style="font-size:12px;color:var(--muted);line-height:1.5">For launches, collab searches or offers. More details, more visibility.</div>
          <div style="display:flex;gap:6px;margin-top:8px;flex-wrap:wrap">
            <span style="font-size:10px;color:var(--muted2)">✓ Type d'ad</span>
            <span style="font-size:10px;color:var(--muted2)">✓ What you're looking for</span>
            <span style="font-size:10px;color:var(--muted2)">✓ Banner image</span>
          </div>
        </div>
        <div style="font-size:20px;color:var(--muted2)">→</div>
      </div>

      <!-- TYPE 3 : CAMPAIGN -->
      <div onclick="selectPubType('campaign')" style="background:linear-gradient(135deg,rgba(255,215,0,0.05),rgba(255,140,0,0.03));border:1.5px solid rgba(255,215,0,0.25);border-radius:14px;padding:18px 20px;cursor:pointer;display:flex;align-items:center;gap:16px;transition:all 0.2s" onmouseover="this.style.borderColor='rgba(255,215,0,0.5)'" onmouseout="this.style.borderColor='rgba(255,215,0,0.25)'">
        <div style="width:48px;height:48px;background:rgba(255,215,0,0.1);border-radius:12px;display:flex;align-items:center;justify-content:center;font-size:22px;flex-shrink:0">🏆</div>
        <div style="flex:1">
          <div style="display:flex;align-items:center;gap:8px;margin-bottom:4px">
            <span style="font-size:15px;font-weight:800;color:#ffd700">Campagne</span>
            <span style="font-size:10px;background:rgba(255,215,0,0.1);color:#ffd700;border-radius:4px;padding:2px 7px;font-weight:700">PRO / ELITE</span>
            <span style="font-size:10px;color:var(--muted)">~10 min</span>
          </div>
          <div style="font-size:12px;color:var(--muted);line-height:1.5">For serious projects. Maximum visibility, measurable goals, video, FAQ and credit boost.</div>
          <div style="display:flex;gap:6px;margin-top:8px;flex-wrap:wrap">
            <span style="font-size:10px;color:var(--muted2)">✓ Video</span>
            <span style="font-size:10px;color:var(--muted2)">✓ Measurable goal</span>
            <span style="font-size:10px;color:var(--muted2)">✓ FAQ</span>
            <span style="font-size:10px;color:var(--muted2)">✓ Boost top</span>
          </div>
        </div>
        <div style="font-size:20px;color:var(--muted2)">→</div>
      </div>
    </div>
  </div>
</div>

<script>
// ══════════════════════════════════
// PUB TYPE SELECTOR
// ══════════════════════════════════
function openPubTypeSelector(){
  if(!currentUser){ openModal('signup-modal'); return; }
  openModal('pub-type-modal');
}

let currentPubType = 'pub';

function selectPubType(type){
  closeModal('pub-type-modal');
  const plan = currentUser ? (currentUser.plan || 'free') : 'free';

  if(type === 'ad' && plan === 'free'){
    toast('📣 Announcements are available from the Starter plan!');
    setTimeout(() => showAppTab('boost-credits', null), 1000);
    return;
  }
  if(type === 'campaign' && (plan === 'free' || plan === 'starter')){
    toast('🏆 Campaigns are available from the Pro plan!');
    setTimeout(() => showAppTab('boost-credits', null), 1000);
    return;
  }

  currentPubType = type;
  showAppTab('feed', document.querySelector('.app-tab'));

  setTimeout(() => {
    adaptPubForm(type);
    const el = document.getElementById('feed-text');
    if(el) el.focus();
  }, 300);
}

function adaptPubForm(type){
  const labels = {
    pub: { badge: '📢 AD', color: 'var(--g3)', hint: 'Present your project in a few words' },
    ad: { badge: '📣 ANNOUNCEMENT', color: '#4ade80', hint: 'Detail your launch, collab or offer' },
    campaign: { badge: '🏆 CAMPAIGN', color: '#ffd700', hint: 'Create your complete campaign with goals and FAQ' }
  };
  const cfg = labels[type] || labels.pub;

  // Update or create type badge in feed form
  let badge = document.getElementById('pub-type-badge');
  if(!badge){
    badge = document.createElement('div');
    badge.id = 'pub-type-badge';
    badge.style.cssText = 'display:flex;align-items:center;justify-content:space-between;margin-bottom:12px;padding:8px 12px;border-radius:8px;background:rgba(34,197,94,0.05);border:1px solid rgba(34,197,94,0.15)';
    const form = document.getElementById('feed-form') || document.querySelector('.feed-form');
    if(form) form.prepend(badge);
  }
  badge.innerHTML = `<span style="font-size:13px;font-weight:800;color:${cfg.color}">${cfg.badge}</span><button onclick="openPubTypeSelector()" style="background:none;border:none;font-size:11px;color:var(--muted);cursor:pointer">Changer →</button>`;

  // Show/hide extra fields based on type
  const extraAd = document.getElementById('pub-extra-ad');
  const extraCampagne = document.getElementById('pub-extra-campaign');

  // Create extra fields if needed
  if(type !== 'pub'){
    const feedForm = document.getElementById('feed-form') || document.querySelector('.feed-post-form');
    if(feedForm && !document.getElementById('pub-extra-ad')){
      const adFields = document.createElement('div');
      adFields.id = 'pub-extra-ad';
      adFields.style.cssText = 'margin-top:10px;display:flex;flex-direction:column;gap:8px';
      adFields.innerHTML = `
        <select id="ad-type-select" style="padding:10px;background:var(--s1);border:1.5px solid var(--border2);border-radius:10px;color:var(--white);font-family:Plus Jakarta Sans,sans-serif;font-size:13px">
          <option value="">Ad type...</option>
          <option>🚀 Launch</option><option>🤝 Find collab</option><option>💼 Service offer</option><option>👥 Recruiting</option>
        </select>
        <input id="ad-seeking" type="text" placeholder="What you're looking for exactly..." style="padding:10px;background:var(--s1);border:1.5px solid var(--border2);border-radius:10px;color:var(--white);font-family:Plus Jakarta Sans,sans-serif;font-size:13px"/>
        <input id="ad-budget" type="text" placeholder="Budget ou conditions (optional)" style="padding:10px;background:var(--s1);border:1.5px solid var(--border2);border-radius:10px;color:var(--white);font-family:Plus Jakarta Sans,sans-serif;font-size:13px"/>
      `;
      feedForm.appendChild(adFields);
    }
    if(type === 'campaign' && !document.getElementById('pub-extra-campaign')){
      const campaignFields = document.createElement('div');
      campaignFields.id = 'pub-extra-campaign';
      campaignFields.style.cssText = 'margin-top:8px;display:flex;flex-direction:column;gap:8px';
      campaignFields.innerHTML = `
        <input id="campagne-goal" type="text" placeholder="Measurable goal (ex: 500 signups, $10k revenue)" style="padding:10px;background:var(--s1);border:1.5px solid var(--border2);border-radius:10px;color:var(--white);font-family:Plus Jakarta Sans,sans-serif;font-size:13px"/>
        <input id="campagne-video" type="url" placeholder="Presentation video URL (YouTube, Loom...)" style="padding:10px;background:var(--s1);border:1.5px solid var(--border2);border-radius:10px;color:var(--white);font-family:Plus Jakarta Sans,sans-serif;font-size:13px"/>
        <textarea id="campagne-faq" placeholder="FAQ — Q: ... A: ... (3 questions/answers)" style="padding:10px;background:var(--s1);border:1.5px solid var(--border2);border-radius:10px;color:var(--white);font-family:Plus Jakarta Sans,sans-serif;font-size:13px;resize:none;min-height:70px"></textarea>
      `;
      const adDiv = document.getElementById('pub-extra-ad');
      if(adDiv) adDiv.after(campaignFields);
    }
    if(document.getElementById('pub-extra-ad')) document.getElementById('pub-extra-ad').style.display = 'flex';
    if(type === 'campaign' && document.getElementById('pub-extra-campaign')) document.getElementById('pub-extra-campaign').style.display = 'flex';
  } else {
    if(document.getElementById('pub-extra-ad')) document.getElementById('pub-extra-ad').style.display = 'none';
    if(document.getElementById('pub-extra-campaign')) document.getElementById('pub-extra-campaign').style.display = 'none';
  }
}
</script>

<script>
// ══════════════════════════════════════════════
// WIZARD CONFIG — CONTENT BY AD TYPE
// ══════════════════════════════════════════════
const WIZ_CONFIGS = {

  pub: {
    mainTitle: 'CREATE MY AD',
    mainSub: 'Introduce your project to the entire ViralBoost community.',
    color: '#22c55e',
    steps: ['Identity', 'Description', 'Audience', 'Visual', 'Preview'],
    step1: {
      icon: '📢', head: 'YOUR AD IDENTITY',
      sub: 'The name is the first thing people see',
      fields: `
        <div class="fg" style="grid-column:1/-1">
          <label>Project / product name *</label>
          <input type="text" id="pub-name" placeholder="Ex: ContentPro — The AI tool for creators" oninput="updatePubCompletion();updateMobilePreview()" maxlength="80" style="font-size:15px;padding:13px 15px;"/>
          <div style="font-size:10px;color:var(--muted2);margin-top:4px;font-family:'DM Mono',monospace"><span id="pub-name-count">0</span>/80 chars · <em style="color:var(--g4)">Be precise and catchy</em></div>
        </div>
        <div class="fg">
          <label>Category *</label>
          <select id="pub-cat" onchange="updatePubTypeEmoji()">
            <option>🚀 SaaS / App</option><option>🌐 Website</option><option>🛍️ E-commerce</option><option>💼 Service / Freelance</option><option>🎓 Coaching / Training</option><option>🎵 Social media</option><option>📧 Newsletter</option><option>🎙️ Podcast</option><option>👥 Community</option>
          </select>
        </div>
        <div class="fg">
          <label>Project URL</label>
          <input type="url" id="pub-url" placeholder="https://myproject.com" oninput="updatePubCompletion()"/>
        </div>
        <div class="fg" style="grid-column:1/-1"><label>Emoji / Icon</label><div style="display:flex;gap:8px;align-items:center"><input type="text" id="pub-emoji" placeholder="🚀" maxlength="2" style="width:58px;text-align:center;font-size:24px;padding:8px;"/><div style="display:flex;gap:6px;flex-wrap:wrap">
          ${['🚀','💡','🎯','🔥','💎','⚡','🛍️','📣','🌟','💪'].map(e=>`<span onclick="document.getElementById('pub-emoji').value='${e}';updateMobilePreview()" style="cursor:pointer;font-size:20px;padding:5px;border-radius:6px;background:var(--s2);border:1.5px solid var(--border2);transition:border-color 0.2s" onmouseover="this.style.borderColor=\'var(--g3)\'" onmouseout="this.style.borderColor=\'var(--border2)\'">${e}</span>`).join('')}
        </div></div></div>`
    },
    step2: {
      icon: '✍️', head: 'DESCRIBE YOUR AD', sub: 'A good description makes people want to click',
      fields: `
        <div class="fg">
          <label>Short hook <span style="color:var(--muted);font-weight:400">(60 chars max)</span></label>
          <input type="text" id="pub-hook" placeholder="Ex: The tool that replaces 5 paid subscriptions" maxlength="60" oninput="updateMobilePreview()" style="font-size:14px;font-weight:600;"/>
        </div>
        <div class="fg">
          <label>Description principale *</label>
          <textarea id="pub-desc" rows="5" placeholder="Explain what your project does, what problem it solves, why people should care..." oninput="updatePubCompletion();updateMobilePreview();updateDescCount()" maxlength="300" style="font-size:13px;resize:vertical;min-height:120px;"></textarea>
          <div style="font-size:10px;color:var(--muted2);margin-top:5px;font-family:'DM Mono',monospace"><span id="pub-desc-count">0</span>/300 · <span id="pub-desc-quality"></span></div>
        </div>
        <div style="background:rgba(22,163,74,0.04);border:1px solid rgba(22,163,74,0.12);border-radius:10px;padding:14px 16px">
          <div style="font-family:'DM Mono',monospace;font-size:9px;color:var(--g3);letter-spacing:2px;margin-bottom:10px">💡 CLICK TO ADD</div>
          <div style="display:grid;grid-template-columns:1fr 1fr;gap:8px">
            <div class="pub-tip-item" onclick="insertDescTip(this)" data-tip="❌ Problem resolved : ">❌ Problem resolved</div>
            <div class="pub-tip-item" onclick="insertDescTip(this)" data-tip="✅ Solution : ">✅ Solution</div>
            <div class="pub-tip-item" onclick="insertDescTip(this)" data-tip="🎯 For who: ">🎯 For who</div>
            <div class="pub-tip-item" onclick="insertDescTip(this)" data-tip="💰 Price : ">💰 Price / offer</div>
            <div class="pub-tip-item" onclick="insertDescTip(this)" data-tip="🔥 Why now: ">🔥 Why now</div>
            <div class="pub-tip-item" onclick="insertDescTip(this)" data-tip="📈 Result: ">📈 Expected result</div>
          </div>
        </div>`
    },
    step3: {
      icon: '🎯', head: 'AUDIENCE & TAGS', sub: 'Help the community find your project',
      fields: `
        <div class="fg">
          <label>Target audience *</label>
          <input type="text" id="pub-target" placeholder="Ex: TikTok creators 18-35, freelancers, SMBs..." oninput="updatePubCompletion()"/>
        </div>
        <div class="fg">
          <label>Project stage</label>
          <select id="pub-stage"><option>💭 Idea</option><option>🧪 Beta</option><option>🚀 Launched</option><option>📈 Growing</option><option>💰 Monetized</option></select>
        </div>
        <div class="fg" style="grid-column:1/-1">
          <label>Tags <span style="color:var(--muted);font-weight:400">(comma · 5 max)</span></label>
          <input type="text" id="pub-tags" placeholder="Ex: IA, TikTok, Free, SaaS" oninput="updatePubCompletion();renderTagsPreview()"/>
          <div id="pub-tags-preview" style="display:flex;gap:6px;flex-wrap:wrap;margin-top:8px"></div>
        </div>
        <div class="fg" style="grid-column:1/-1">
          <label>Are you looking for collaborators?</label>
          <select id="pub-collab-need"><option value="">Not specified</option><option>👨‍💻 Developer</option><option>📣 Marketer</option><option>🎨 Designer</option><option>🎬 Video creator</option><option>💸 Investor</option><option>🤝 Partner</option><option>🧑‍💼 First clients</option></select>
        </div>`
    }
  },

  ad: {
    mainTitle: 'CREATE MY ANNOUNCEMENT',
    mainSub: 'Inform the community about something new, an update or event.',
    color: '#4ade80',
    steps: ['Title', 'Message', 'Distribution', 'Visual', 'Preview'],
    step1: {
      icon: '📣', head: 'AD TITLE', sub: 'A good title = 3× more reads',
      fields: `
        <div class="fg" style="grid-column:1/-1">
          <label>Announcement title *</label>
          <input type="text" id="pub-name" placeholder="Ex: Major update v2.0 — New features!" oninput="updatePubCompletion();updateMobilePreview()" maxlength="80" style="font-size:15px;padding:13px 15px;"/>
          <div style="font-size:10px;color:var(--muted2);margin-top:4px;font-family:'DM Mono',monospace"><span id="pub-name-count">0</span>/80 chars.</div>
        </div>
        <div class="fg">
          <label>Ad type *</label>
          <select id="pub-cat">
            <option>🚀 Launch / Update</option><option>🤝 Partnership</option><option>📅 Event</option><option>📢 Important news</option><option>🎉 Celebration / Milestone</option><option>⚠️ Service change</option>
          </select>
        </div>
        <div class="fg">
          <label>Event / announcement date</label>
          <input type="date" id="pub-date" oninput="updatePubCompletion()"/>
        </div>
        <div class="fg" style="grid-column:1/-1">
          <label>Associated link</label>
          <input type="url" id="pub-url" placeholder="https://your-link.com"/>
        </div>
        <div class="fg" style="grid-column:1/-1"><label>Announcement emoji</label><div style="display:flex;gap:8px;align-items:center"><input type="text" id="pub-emoji" placeholder="📣" maxlength="2" style="width:58px;text-align:center;font-size:24px;padding:8px;"/><div style="display:flex;gap:6px;flex-wrap:wrap">
          ${['📣','🚀','🎉','📅','⚠️','🔔','💡','🤝','📢','🌟'].map(e=>`<span onclick="document.getElementById('pub-emoji').value='${e}';updateMobilePreview()" style="cursor:pointer;font-size:20px;padding:5px;border-radius:6px;background:var(--s2);border:1.5px solid var(--border2);transition:border-color 0.2s" onmouseover="this.style.borderColor=\'var(--g3)\'" onmouseout="this.style.borderColor=\'var(--border2)\'">${e}</span>`).join('')}
        </div></div></div>`
    },
    step2: {
      icon: '💬', head: 'ANNOUNCEMENT MESSAGE', sub: 'Be clear, precise, and make people want to react',
      fields: `
        <div class="fg">
          <label>One-line summary *</label>
          <input type="text" id="pub-hook" placeholder="Ex: We just hit 10,000 users 🎉" maxlength="60" oninput="updateMobilePreview()" style="font-size:14px;font-weight:600;"/>
        </div>
        <div class="fg">
          <label>Full message *</label>
          <textarea id="pub-desc" rows="5" placeholder="Detail your announcement: what's changing? Why is it important? What does it change for the community?" oninput="updatePubCompletion();updateMobilePreview();updateDescCount()" maxlength="300" style="font-size:13px;resize:vertical;min-height:120px;"></textarea>
          <div style="font-size:10px;color:var(--muted2);margin-top:5px;font-family:'DM Mono',monospace"><span id="pub-desc-count">0</span>/300 · <span id="pub-desc-quality"></span></div>
        </div>
        <div style="background:rgba(74,222,128,0.04);border:1px solid rgba(74,222,128,0.12);border-radius:10px;padding:14px 16px">
          <div style="font-family:'DM Mono',monospace;font-size:9px;color:#4ade80;letter-spacing:2px;margin-bottom:10px">💡 STRUCTURE YOUR AD</div>
          <div style="display:grid;grid-template-columns:1fr 1fr;gap:8px">
            <div class="pub-tip-item" onclick="insertDescTip(this)" data-tip="📢 What changes: ">📢 What changes</div>
            <div class="pub-tip-item" onclick="insertDescTip(this)" data-tip="🎯 Why it matters: ">🎯 Why it matters</div>
            <div class="pub-tip-item" onclick="insertDescTip(this)" data-tip="👥 Who is concerned : ">👥 Who is concerned</div>
            <div class="pub-tip-item" onclick="insertDescTip(this)" data-tip="📅 Starting from: ">📅 Effective date</div>
            <div class="pub-tip-item" onclick="insertDescTip(this)" data-tip="🔗 Learn more: ">🔗 Learn more</div>
            <div class="pub-tip-item" onclick="insertDescTip(this)" data-tip="🙏 Thanks to: ">🙏 Acknowledgments</div>
          </div>
        </div>`
    },
    step3: {
      icon: '📡', head: 'DISTRIBUTION', sub: 'Target the right people',
      fields: `
        <div class="fg" style="grid-column:1/-1">
          <label>Tags <span style="color:var(--muted);font-weight:400">(comma · 5 max)</span></label>
          <input type="text" id="pub-tags" placeholder="Ex: Update, V2, News, Announcement" oninput="updatePubCompletion();renderTagsPreview()"/>
          <div id="pub-tags-preview" style="display:flex;gap:6px;flex-wrap:wrap;margin-top:8px"></div>
        </div>
        <div class="fg" style="grid-column:1/-1">
          <label>Target audience</label>
          <input type="text" id="pub-target" placeholder="Ex: Existing users, newsletter followers, creators..." oninput="updatePubCompletion()"/>
        </div>`
    }
  },

  service: {
    mainTitle: 'OFFER A SERVICE',
    mainSub: 'Showcase your skills and find your first clients.',
    color: '#60a5fa',
    steps: ['Service', 'Details', 'Terms', 'Visual', 'Preview'],
    step1: {
      icon: '🛍️', head: 'YOUR SERVICE', sub: 'Describe what you do in a few clear words',
      fields: `
        <div class="fg" style="grid-column:1/-1">
          <label>Service title *</label>
          <input type="text" id="pub-name" placeholder="Ex: Logo creation + professional brand guidelines" oninput="updatePubCompletion();updateMobilePreview()" maxlength="80" style="font-size:15px;padding:13px 15px;"/>
          <div style="font-size:10px;color:var(--muted2);margin-top:4px;font-family:'DM Mono',monospace"><span id="pub-name-count">0</span>/80 chars.</div>
        </div>
        <div class="fg">
          <label>Category *</label>
          <select id="pub-cat">
            <option>🎨 Design & Creative</option><option>💻 Development</option><option>📣 Marketing & Growth</option><option>✍️ Writing & Content</option><option>🎬 Video & Photo</option><option>🎵 Audio & Music</option><option>📊 Business & Consulting</option><option>🎓 Coaching & Training</option><option>📱 Social media</option><option>🔧 Tech & Support</option>
          </select>
        </div>
        <div class="fg">
          <label>Rate *</label>
          <input type="text" id="pub-price" placeholder="Ex: From $150 · or flat rate $500" oninput="updatePubCompletion()"/>
        </div>
        <div class="fg">
          <label>Delivery time</label>
          <select id="pub-delay"><option>⚡ Express (24h)</option><option>🚀 Fast (2-3d)</option><option>📅 Standard (1 week)</option><option>🗓️ Long-term (2+ weeks)</option><option>🔄 On quote</option></select>
        </div>
        <div class="fg" style="grid-column:1/-1"><label>Service emoji</label><div style="display:flex;gap:8px;align-items:center"><input type="text" id="pub-emoji" placeholder="🛍️" maxlength="2" style="width:58px;text-align:center;font-size:24px;padding:8px;"/><div style="display:flex;gap:6px;flex-wrap:wrap">
          ${['🎨','💻','📣','✍️','🎬','📊','🔧','🎓','📱','💡'].map(e=>`<span onclick="document.getElementById('pub-emoji').value='${e}';updateMobilePreview()" style="cursor:pointer;font-size:20px;padding:5px;border-radius:6px;background:var(--s2);border:1.5px solid var(--border2);transition:border-color 0.2s" onmouseover="this.style.borderColor=\'var(--g3)\'" onmouseout="this.style.borderColor=\'var(--border2)\'">${e}</span>`).join('')}
        </div></div></div>`
    },
    step2: {
      icon: '📋', head: 'SERVICE DESCRIPTION', sub: 'Convince by explaining exactly what you deliver',
      fields: `
        <div class="fg">
          <label>Hook *</label>
          <input type="text" id="pub-hook" placeholder="Ex: I create visual identities that convert" maxlength="60" oninput="updateMobilePreview()" style="font-size:14px;font-weight:600;"/>
        </div>
        <div class="fg">
          <label>Full description *</label>
          <textarea id="pub-desc" rows="5" placeholder="Describe precisely what you deliver, your process, your added value and why choose you..." oninput="updatePubCompletion();updateMobilePreview();updateDescCount()" maxlength="300" style="font-size:13px;resize:vertical;min-height:120px;"></textarea>
          <div style="font-size:10px;color:var(--muted2);margin-top:5px;font-family:'DM Mono',monospace"><span id="pub-desc-count">0</span>/300 · <span id="pub-desc-quality"></span></div>
        </div>
        <div style="background:rgba(59,130,246,0.04);border:1px solid rgba(59,130,246,0.15);border-radius:10px;padding:14px 16px">
          <div style="font-family:'DM Mono',monospace;font-size:9px;color:#60a5fa;letter-spacing:2px;margin-bottom:10px">💡 WHAT SELLS YOUR SERVICE</div>
          <div style="display:grid;grid-template-columns:1fr 1fr;gap:8px">
            <div class="pub-tip-item" onclick="insertDescTip(this)" data-tip="✅ What's included: ">✅ What's included</div>
            <div class="pub-tip-item" onclick="insertDescTip(this)" data-tip="⭐ My expertise: ">⭐ My expertise</div>
            <div class="pub-tip-item" onclick="insertDescTip(this)" data-tip="📦 What you receive: ">📦 Concrete deliverables</div>
            <div class="pub-tip-item" onclick="insertDescTip(this)" data-tip="🏆 Client results : ">🏆 Client results</div>
            <div class="pub-tip-item" onclick="insertDescTip(this)" data-tip="🔄 My process: ">🔄 My process</div>
            <div class="pub-tip-item" onclick="insertDescTip(this)" data-tip="🎯 Who it's for: ">🎯 Who it's for</div>
          </div>
        </div>`
    },
    step3: {
      icon: '📞', head: 'TERMS & CONTACT', sub: 'How clients can contact you',
      fields: `
        <div class="fg" style="grid-column:1/-1">
          <label>Contact link / portfolio *</label>
          <input type="url" id="pub-url" placeholder="https://myfreelance.com or Calendly link" oninput="updatePubCompletion()"/>
        </div>
        <div class="fg">
          <label>Work mode</label>
          <select id="pub-mode"><option>🌍 100% Remote</option><option>🏢 On-site possible</option><option>🔄 Hybrid</option></select>
        </div>
        <div class="fg">
          <label>Availability</label>
          <select id="pub-dispo"><option>✅ Available now</option><option>📅 Available within 1 week</option><option>⏳ Waitlist</option><option>❌ Fully booked for now</option></select>
        </div>
        <div class="fg" style="grid-column:1/-1">
          <label>Tags <span style="color:var(--muted);font-weight:400">(comma · 5 max)</span></label>
          <input type="text" id="pub-tags" placeholder="Ex: Design, Logo, Visual identity, Freelance" oninput="updatePubCompletion();renderTagsPreview()"/>
          <div id="pub-tags-preview" style="display:flex;gap:6px;flex-wrap:wrap;margin-top:8px"></div>
        </div>`
    }
  },

  launch: {
    mainTitle: 'LAUNCH MY PRODUCT',
    mainSub: 'Officially announce your product and create maximum buzz.',
    color: '#f87171',
    steps: ['Product', 'Pitch', 'Target & Price', 'Visual', 'Preview'],
    step1: {
      icon: '🚀', head: 'YOUR PRODUCT', sub: 'Present your launch with impact',
      fields: `
        <div class="fg" style="grid-column:1/-1">
          <label>Product name *</label>
          <input type="text" id="pub-name" placeholder="Ex: LaunchKit — The all-in-one kit for founders" oninput="updatePubCompletion();updateMobilePreview()" maxlength="80" style="font-size:15px;padding:13px 15px;"/>
          <div style="font-size:10px;color:var(--muted2);margin-top:4px;font-family:'DM Mono',monospace"><span id="pub-name-count">0</span>/80 chars.</div>
        </div>
        <div class="fg">
          <label>Product category *</label>
          <select id="pub-cat"><option>🚀 SaaS / App</option><option>🛍️ Physical product</option><option>📚 Training / E-learning</option><option>🎓 Coaching</option><option>📱 Mobile app</option><option>🔧 Tool / Extension</option><option>💼 Service</option><option>📖 Book / Ebook</option></select>
        </div>
        <div class="fg">
          <label>Launch stage</label>
          <select id="pub-stage"><option>🔥 Launching today!</option><option>🧪 Open beta</option><option>📅 Pre-launch (waitlist)</option><option>🎯 Official launch</option></select>
        </div>
        <div class="fg" style="grid-column:1/-1">
          <label>Product URL *</label>
          <input type="url" id="pub-url" placeholder="https://myproduct.com" oninput="updatePubCompletion()"/>
        </div>
        <div class="fg" style="grid-column:1/-1"><label>Product emoji</label><div style="display:flex;gap:8px;align-items:center"><input type="text" id="pub-emoji" placeholder="🚀" maxlength="2" style="width:58px;text-align:center;font-size:24px;padding:8px;"/><div style="display:flex;gap:6px;flex-wrap:wrap">
          ${['🚀','🔥','💥','⚡','🎯','💡','🏆','💎','🌟','🛠️'].map(e=>`<span onclick="document.getElementById('pub-emoji').value='${e}';updateMobilePreview()" style="cursor:pointer;font-size:20px;padding:5px;border-radius:6px;background:var(--s2);border:1.5px solid var(--border2);transition:border-color 0.2s" onmouseover="this.style.borderColor=\'var(--g3)\'" onmouseout="this.style.borderColor=\'var(--border2)\'">${e}</span>`).join('')}
        </div></div></div>`
    },
    step2: {
      icon: '🎤', head: 'YOUR PITCH', sub: 'Explain the problem you solve and your solution',
      fields: `
        <div class="fg">
          <label>Tagline / One-liner pitch *</label>
          <input type="text" id="pub-hook" placeholder="Ex: Stop wasting 3h/week on repetitive tasks" maxlength="60" oninput="updateMobilePreview()" style="font-size:14px;font-weight:600;"/>
        </div>
        <div class="fg">
          <label>Full description *</label>
          <textarea id="pub-desc" rows="6" placeholder="What problem do you solve? How? For whom? Why now?" oninput="updatePubCompletion();updateMobilePreview();updateDescCount()" maxlength="300" style="font-size:13px;resize:vertical;min-height:140px;"></textarea>
          <div style="font-size:10px;color:var(--muted2);margin-top:5px;font-family:'DM Mono',monospace"><span id="pub-desc-count">0</span>/300 · <span id="pub-desc-quality"></span></div>
        </div>
        <div style="background:rgba(239,68,68,0.04);border:1px solid rgba(239,68,68,0.15);border-radius:10px;padding:14px 16px">
          <div style="font-family:'DM Mono',monospace;font-size:9px;color:#f87171;letter-spacing:2px;margin-bottom:10px">🔥 GOOD PITCH STRUCTURE</div>
          <div style="display:grid;grid-template-columns:1fr 1fr;gap:8px">
            <div class="pub-tip-item" onclick="insertDescTip(this)" data-tip="❌ The problem: ">❌ The problem</div>
            <div class="pub-tip-item" onclick="insertDescTip(this)" data-tip="✅ My solution: ">✅ My solution</div>
            <div class="pub-tip-item" onclick="insertDescTip(this)" data-tip="🎯 For who: ">🎯 For who</div>
            <div class="pub-tip-item" onclick="insertDescTip(this)" data-tip="📈 Concrete result: ">📈 Concrete result</div>
            <div class="pub-tip-item" onclick="insertDescTip(this)" data-tip="🏆 What sets me apart: ">🏆 My difference</div>
            <div class="pub-tip-item" onclick="insertDescTip(this)" data-tip="⚡ Why now: ">⚡ Why now</div>
          </div>
        </div>`
    },
    step3: {
      icon: '💰', head: 'TARGET & PRICE', sub: 'Who buys and at what price?',
      fields: `
        <div class="fg" style="grid-column:1/-1">
          <label>Product price *</label>
          <input type="text" id="pub-price" placeholder="Ex: $29/mo · $197 one-time · Free with premium" oninput="updatePubCompletion()"/>
        </div>
        <div class="fg">
          <label>Launch offer?</label>
          <input type="text" id="pub-promo" placeholder="Ex: -50% first 72 hours · Code LAUNCH"/>
        </div>
        <div class="fg">
          <label>Main target audience</label>
          <input type="text" id="pub-target" placeholder="Ex: B2B founders, freelancers, SMBs..." oninput="updatePubCompletion()"/>
        </div>
        <div class="fg" style="grid-column:1/-1">
          <label>Tags <span style="color:var(--muted);font-weight:400">(comma · 5 max)</span></label>
          <input type="text" id="pub-tags" placeholder="Ex: SaaS, AI, Productivity, Launch, B2B" oninput="updatePubCompletion();renderTagsPreview()"/>
          <div id="pub-tags-preview" style="display:flex;gap:6px;flex-wrap:wrap;margin-top:8px"></div>
        </div>`
    }
  },

  collab: {
    mainTitle: 'FIND A COLLAB',
    mainSub: 'Find the ideal partner to boost your project.',
    color: '#c084fc',
    steps: ['Project', 'Profile', 'Terms', 'Visual', 'Preview'],
    step1: {
      icon: '🤝', head: 'YOUR PROJECT', sub: 'Present the context to attract the right profiles',
      fields: `
        <div class="fg" style="grid-column:1/-1">
          <label>Project name *</label>
          <input type="text" id="pub-name" placeholder="Ex: Looking for a partner for educational SaaS" oninput="updatePubCompletion();updateMobilePreview()" maxlength="80" style="font-size:15px;padding:13px 15px;"/>
        </div>
        <div class="fg">
          <label>Collaboration type *</label>
          <select id="pub-cat"><option>🤝 Co-founder</option><option>💼 Partner</option><option>🎨 Creative partner</option><option>📣 Marketing partner</option><option>👨‍💻 Tech partner</option><option>🌍 Distribution partner</option><option>💰 Business Angel</option></select>
        </div>
        <div class="fg">
          <label>Project sector</label>
          <select id="pub-secteur"><option>💻 Tech / SaaS</option><option>🛍️ E-commerce</option><option>🎓 Education</option><option>💪 Health / Wellness</option><option>🎬 Content creators</option><option>🏢 B2B</option><option>👥 Community</option><option>🌱 Impact / Social</option></select>
        </div>
        <div class="fg" style="grid-column:1/-1">
          <label>Link to your project</label>
          <input type="url" id="pub-url" placeholder="https://myproject.com ou pitch deck"/>
        </div>
        <div class="fg" style="grid-column:1/-1"><label>Emoji</label><div style="display:flex;gap:8px;align-items:center"><input type="text" id="pub-emoji" placeholder="🤝" maxlength="2" style="width:58px;text-align:center;font-size:24px;padding:8px;"/><div style="display:flex;gap:6px;flex-wrap:wrap">
          ${['🤝','💼','🎯','🚀','💡','🌟','👥','🔥','💪','🌍'].map(e=>`<span onclick="document.getElementById('pub-emoji').value='${e}';updateMobilePreview()" style="cursor:pointer;font-size:20px;padding:5px;border-radius:6px;background:var(--s2);border:1.5px solid var(--border2);transition:border-color 0.2s" onmouseover="this.style.borderColor=\'var(--g3)\'" onmouseout="this.style.borderColor=\'var(--border2)\'">${e}</span>`).join('')}
        </div></div></div>`
    },
    step2: {
      icon: '🔍', head: 'DESIRED PROFILE', sub: 'Describe precisely the person you\'re looking for',
      fields: `
        <div class="fg">
          <label>Hook *</label>
          <input type="text" id="pub-hook" placeholder="Ex: Looking for a React dev to co-found an EdTech" maxlength="60" oninput="updateMobilePreview()" style="font-size:14px;font-weight:600;"/>
        </div>
        <div class="fg">
          <label>Project & need description *</label>
          <textarea id="pub-desc" rows="5" placeholder="Present your project, its stage, what you've already accomplished, and what you expect from your future partner..." oninput="updatePubCompletion();updateMobilePreview();updateDescCount()" maxlength="300" style="font-size:13px;resize:vertical;min-height:130px;"></textarea>
          <div style="font-size:10px;color:var(--muted2);margin-top:5px;font-family:'DM Mono',monospace"><span id="pub-desc-count">0</span>/300 · <span id="pub-desc-quality"></span></div>
        </div>
        <div style="background:rgba(168,85,247,0.04);border:1px solid rgba(168,85,247,0.15);border-radius:10px;padding:14px 16px">
          <div style="font-family:'DM Mono',monospace;font-size:9px;color:#c084fc;letter-spacing:2px;margin-bottom:10px">💡 KEY ELEMENTS</div>
          <div style="display:grid;grid-template-columns:1fr 1fr;gap:8px">
            <div class="pub-tip-item" onclick="insertDescTip(this)" data-tip="🏗️ Current stage: ">🏗️ Project stage</div>
            <div class="pub-tip-item" onclick="insertDescTip(this)" data-tip="✅ What I already have: ">✅ Already done</div>
            <div class="pub-tip-item" onclick="insertDescTip(this)" data-tip="🎯 Skills needed: ">🎯 Key skills</div>
            <div class="pub-tip-item" onclick="insertDescTip(this)" data-tip="📈 Long-term vision: ">📈 Vision</div>
            <div class="pub-tip-item" onclick="insertDescTip(this)" data-tip="💰 Planned share: ">💰 Share / equity</div>
            <div class="pub-tip-item" onclick="insertDescTip(this)" data-tip="📩 To contact me: ">📩 Contact</div>
          </div>
        </div>`
    },
    step3: {
      icon: '📋', head: 'TERMS', sub: 'Be transparent about the terms',
      fields: `
        <div class="fg" style="grid-column:1/-1">
          <label>Collaboration terms *</label>
          <input type="text" id="pub-conditions" placeholder="Ex: 50/50 equity · Remote OK · Full-time ideally" oninput="updatePubCompletion()"/>
        </div>
        <div class="fg">
          <label>Required investment</label>
          <select id="pub-invest"><option>💸 Capital only</option><option>⏱️ Time only</option><option>🔄 Time + capital</option><option>🤝 To be discussed</option></select>
        </div>
        <div class="fg">
          <label>Work mode</label>
          <select id="pub-mode"><option>🌍 100% Remote</option><option>🏢 On-site (Paris)</option><option>🏢 On-site (Other city)</option><option>🔄 Hybrid</option></select>
        </div>
        <div class="fg" style="grid-column:1/-1">
          <label>Tags</label>
          <input type="text" id="pub-tags" placeholder="Ex: Tech, Equity, Remote, EdTech, Collab" oninput="updatePubCompletion();renderTagsPreview()"/>
          <div id="pub-tags-preview" style="display:flex;gap:6px;flex-wrap:wrap;margin-top:8px"></div>
        </div>`
    }
  },

  promo: {
    mainTitle: 'CREATE MY PROMO',
    mainSub: 'Create urgency with an irresistible offer.',
    color: '#fbbf24',
    steps: ['Offer', 'Message', 'Limits', 'Visual', 'Preview'],
    step1: {
      icon: '🏷️', head: 'YOUR PROMO OFFER', sub: 'Crossed price + discount = the magic formula',
      fields: `
        <div class="fg" style="grid-column:1/-1">
          <label>Promo title *</label>
          <input type="text" id="pub-name" placeholder="Ex: -60% off all courses for 48h!" oninput="updatePubCompletion();updateMobilePreview()" maxlength="80" style="font-size:15px;padding:13px 15px;"/>
        </div>
        <div class="fg">
          <label>Original price (crossed)</label>
          <input type="text" id="pub-oldprice" placeholder="Ex: $199" oninput="updatePubCompletion()"/>
        </div>
        <div class="fg">
          <label>Promo price *</label>
          <input type="text" id="pub-price" placeholder="Ex: $79 = -60%" oninput="updatePubCompletion()"/>
        </div>
        <div class="fg">
          <label>Promo code</label>
          <input type="text" id="pub-code" placeholder="Ex: VIRAL60" style="text-transform:uppercase;letter-spacing:2px;font-family:'DM Mono',monospace;font-weight:700"/>
        </div>
        <div class="fg">
          <label>Expiry date *</label>
          <input type="datetime-local" id="pub-expiry" oninput="updatePubCompletion()"/>
        </div>
        <div class="fg" style="grid-column:1/-1">
          <label>Link to offer *</label>
          <input type="url" id="pub-url" placeholder="https://monoffer.fr" oninput="updatePubCompletion()"/>
        </div>
        <div class="fg" style="grid-column:1/-1"><label>Emoji</label><div style="display:flex;gap:8px;align-items:center"><input type="text" id="pub-emoji" placeholder="🏷️" maxlength="2" style="width:58px;text-align:center;font-size:24px;padding:8px;"/><div style="display:flex;gap:6px;flex-wrap:wrap">
          ${['🏷️','💸','🔥','⚡','🎉','💥','🎁','⏳','✂️','💰'].map(e=>`<span onclick="document.getElementById('pub-emoji').value='${e}';updateMobilePreview()" style="cursor:pointer;font-size:20px;padding:5px;border-radius:6px;background:var(--s2);border:1.5px solid var(--border2);transition:border-color 0.2s" onmouseover="this.style.borderColor=\'var(--g3)\'" onmouseout="this.style.borderColor=\'var(--border2)\'">${e}</span>`).join('')}
        </div></div></div>`
    },
    step2: {
      icon: '💬', head: 'SALES MESSAGE', sub: 'Create urgency and justify the value',
      fields: `
        <div class="fg">
          <label>Hook *</label>
          <input type="text" id="pub-hook" placeholder="Ex: 🔥 Offer flash — seulement 48h !" maxlength="60" oninput="updateMobilePreview()" style="font-size:14px;font-weight:600;"/>
        </div>
        <div class="fg">
          <label>Offer description *</label>
          <textarea id="pub-desc" rows="5" placeholder="What's included, why it's a great deal, who it's for..." oninput="updatePubCompletion();updateMobilePreview();updateDescCount()" maxlength="300" style="font-size:13px;resize:vertical;min-height:120px;"></textarea>
          <div style="font-size:10px;color:var(--muted2);margin-top:5px;font-family:'DM Mono',monospace"><span id="pub-desc-count">0</span>/300 · <span id="pub-desc-quality"></span></div>
        </div>
        <div style="background:rgba(245,158,11,0.04);border:1px solid rgba(245,158,11,0.15);border-radius:10px;padding:14px 16px">
          <div style="font-family:'DM Mono',monospace;font-size:9px;color:#fbbf24;letter-spacing:2px;margin-bottom:10px">⚡ CREATE URGENCY</div>
          <div style="display:grid;grid-template-columns:1fr 1fr;gap:8px">
            <div class="pub-tip-item" onclick="insertDescTip(this)" data-tip="✅ What is included: ">✅ Included</div>
            <div class="pub-tip-item" onclick="insertDescTip(this)" data-tip="⏳ Expiress on: ">⏳ Deadline</div>
            <div class="pub-tip-item" onclick="insertDescTip(this)" data-tip="🎯 Who it's for: ">🎯 Who it's for</div>
            <div class="pub-tip-item" onclick="insertDescTip(this)" data-tip="🔥 Why now: ">🔥 Urgency</div>
            <div class="pub-tip-item" onclick="insertDescTip(this)" data-tip="💎 Total value: ">💎 Value</div>
            <div class="pub-tip-item" onclick="insertDescTip(this)" data-tip="⭐ Testimonial: ">⭐ Social proof</div>
          </div>
        </div>`
    },
    step3: {
      icon: '⏱️', head: 'LIMITS & TARGETING', sub: 'Define who can benefit',
      fields: `
        <div class="fg" style="grid-column:1/-1">
          <label>Target audience</label>
          <input type="text" id="pub-target" placeholder="Ex: Creators, entrepreneurs, students..." oninput="updatePubCompletion()"/>
        </div>
        <div class="fg">
          <label>Number of spots</label>
          <input type="text" id="pub-slots" placeholder="Ex: 50 spots · Unlimitd · 1 winner only"/>
        </div>
        <div class="fg">
          <label>Access conditions</label>
          <select id="pub-access"><option>🌍 Open to all</option><option>📧 Newsletter subscribers</option><option>💎 VIP members</option><option>🔗 Secret link only</option></select>
        </div>
        <div class="fg" style="grid-column:1/-1">
          <label>Tags</label>
          <input type="text" id="pub-tags" placeholder="Ex: Promo, Training, -60%, Flash, Limitd" oninput="updatePubCompletion();renderTagsPreview()"/>
          <div id="pub-tags-preview" style="display:flex;gap:6px;flex-wrap:wrap;margin-top:8px"></div>
        </div>`
    }
  },

  poll: {
    mainTitle: 'CREATE A POLL',
    mainSub: 'Collect votes and community insights in real time.',
    color: '#2dd4bf',
    steps: ['Question', 'Options', 'Settings', 'Visual', 'Preview'],
    step1: {
      icon: '📊', head: 'YOUR QUESTION', sub: 'A good question = actionable answers',
      fields: `
        <div class="fg" style="grid-column:1/-1">
          <label>Your question *</label>
          <input type="text" id="pub-name" placeholder="Ex: Which AI tool do you use most in 2025?" oninput="updatePubCompletion();updateMobilePreview()" maxlength="80" style="font-size:15px;padding:13px 15px;"/>
        </div>
        <div class="fg">
          <label>Poll theme</label>
          <select id="pub-cat"><option>💻 Tech & AI</option><option>📣 Marketing</option><option>💼 Business</option><option>🎨 Creativity</option><option>💰 Finance</option><option>🌍 Society</option><option>🎓 Education</option><option>🤔 General opinion</option></select>
        </div>
        <div class="fg">
          <label>Vote duration</label>
          <select id="pub-duration"><option>⚡ 24 hours</option><option>📅 3 days</option><option>📅 1 week</option><option>📅 2 weeks</option><option>♾️ Unlimitd</option></select>
        </div>
        <div class="fg" style="grid-column:1/-1">
          <label>Context / explanation (optional)</label>
          <input type="text" id="pub-hook" placeholder="Ex: I'm writing an article and would love your opinion!" maxlength="60" oninput="updateMobilePreview()"/>
        </div>
        <div class="fg" style="grid-column:1/-1"><label>Emoji</label><div style="display:flex;gap:8px;align-items:center"><input type="text" id="pub-emoji" placeholder="📊" maxlength="2" style="width:58px;text-align:center;font-size:24px;padding:8px;"/><div style="display:flex;gap:6px;flex-wrap:wrap">
          ${['📊','🤔','💡','🗳️','❓','🔍','📈','🎯','💬','🌐'].map(e=>`<span onclick="document.getElementById('pub-emoji').value='${e}';updateMobilePreview()" style="cursor:pointer;font-size:20px;padding:5px;border-radius:6px;background:var(--s2);border:1.5px solid var(--border2);transition:border-color 0.2s" onmouseover="this.style.borderColor=\'var(--g3)\'" onmouseout="this.style.borderColor=\'var(--border2)\'">${e}</span>`).join('')}
        </div></div></div>`
    },
    step2: {
      icon: '🔘', head: 'THE OPTIONS', sub: 'Offer 2 to 4 clear and distinct choices',
      fields: `
        <div class="fg">
          <label>Option A *</label>
          <input type="text" id="pub-opt-a" placeholder="Ex: ChatGPT" oninput="updatePubCompletion()" style="border-left:3px solid #2dd4bf"/>
        </div>
        <div class="fg">
          <label>Option B *</label>
          <input type="text" id="pub-opt-b" placeholder="Ex: Claude" oninput="updatePubCompletion()" style="border-left:3px solid #34d399"/>
        </div>
        <div class="fg">
          <label>Option C</label>
          <input type="text" id="pub-opt-c" placeholder="Ex: Gemini" style="border-left:3px solid #a78bfa"/>
        </div>
        <div class="fg">
          <label>Option D</label>
          <input type="text" id="pub-opt-d" placeholder="Ex: Other (specify in comments)" style="border-left:3px solid #fb923c"/>
        </div>
        <div class="fg" style="grid-column:1/-1">
          <label>Description / Details</label>
          <textarea id="pub-desc" rows="3" placeholder="Add context or details about your poll..." oninput="updatePubCompletion();updateMobilePreview();updateDescCount()" maxlength="300" style="font-size:13px;resize:vertical;min-height:80px;"></textarea>
          <div style="font-size:10px;color:var(--muted2);margin-top:5px;font-family:'DM Mono',monospace"><span id="pub-desc-count">0</span>/300</div>
        </div>`
    },
    step3: {
      icon: '⚙️', head: 'SETTINGS', sub: 'Who can vote and how',
      fields: `
        <div class="fg" style="grid-column:1/-1">
          <label>Target audience</label>
          <input type="text" id="pub-target" placeholder="Ex: Creators, developers, marketers..." oninput="updatePubCompletion()"/>
        </div>
        <div class="fg">
          <label>Visible results</label>
          <select id="pub-results"><option>👁️ After vote only</option><option>🌍 Visible in real time</option><option>🔒 At the end only</option></select>
        </div>
        <div class="fg">
          <label>Multiple votes allowed?</label>
          <select id="pub-multi"><option>❌ No (1 vote per person)</option><option>✅ Yes (multiple choices)</option></select>
        </div>
        <div class="fg" style="grid-column:1/-1">
          <label>Tags</label>
          <input type="text" id="pub-tags" placeholder="Ex: AI, Poll, Tools, Tech" oninput="updatePubCompletion();renderTagsPreview()"/>
          <div id="pub-tags-preview" style="display:flex;gap:6px;flex-wrap:wrap;margin-top:8px"></div>
        </div>`
    }
  },

  tutorial: {
    mainTitle: 'CREATE A TUTORIAL',
    mainSub: 'Share your expertise and position yourself as a reference.',
    color: '#86efac',
    steps: ['Topic', 'Content', 'Audience', 'Visual', 'Preview'],
    step1: {
      icon: '🎓', head: 'YOUR TUTORIAL', sub: 'A good tutorial title is precise and promises results',
      fields: `
        <div class="fg" style="grid-column:1/-1">
          <label>Tutorial title *</label>
          <input type="text" id="pub-name" placeholder="Ex: How to create a landing page that converts in 2h" oninput="updatePubCompletion();updateMobilePreview()" maxlength="80" style="font-size:15px;padding:13px 15px;"/>
        </div>
        <div class="fg">
          <label>Category</label>
          <select id="pub-cat"><option>💻 Development</option><option>🎨 Design</option><option>📣 Marketing</option><option>💼 Business</option><option>🤖 AI & Automation</option><option>📱 Social media</option><option>💰 Finance / Investment</option><option>🎬 Content creation</option><option>🛠️ Productivity</option></select>
        </div>
        <div class="fg">
          <label>Required level</label>
          <select id="pub-level"><option>🟢 Beginner</option><option>🟡 Intermediate</option><option>🔴 Advanced</option><option>🌍 All levels</option></select>
        </div>
        <div class="fg">
          <label>Estimated duration</label>
          <select id="pub-duration"><option>⚡ 5-10 min</option><option>📖 15-30 min</option><option>⏱️ 30-60 min</option><option>🗓️ Several hours</option></select>
        </div>
        <div class="fg" style="grid-column:1/-1">
          <label>Link to the full tutorial</label>
          <input type="url" id="pub-url" placeholder="https://your-blog.com/tutorial or YouTube..."/>
        </div>
        <div class="fg" style="grid-column:1/-1"><label>Emoji</label><div style="display:flex;gap:8px;align-items:center"><input type="text" id="pub-emoji" placeholder="🎓" maxlength="2" style="width:58px;text-align:center;font-size:24px;padding:8px;"/><div style="display:flex;gap:6px;flex-wrap:wrap">
          ${['🎓','📚','💡','🔧','⚙️','🎯','📝','🖥️','🔑','🚀'].map(e=>`<span onclick="document.getElementById('pub-emoji').value='${e}';updateMobilePreview()" style="cursor:pointer;font-size:20px;padding:5px;border-radius:6px;background:var(--s2);border:1.5px solid var(--border2);transition:border-color 0.2s" onmouseover="this.style.borderColor=\'var(--g3)\'" onmouseout="this.style.borderColor=\'var(--border2)\'">${e}</span>`).join('')}
        </div></div></div>`
    },
    step2: {
      icon: '📝', head: 'TUTORIAL CONTENT', sub: 'Describe what readers will learn',
      fields: `
        <div class="fg">
          <label>1-line summary *</label>
          <input type="text" id="pub-hook" placeholder="Ex: Learn to double your conversion rate in 5 steps" maxlength="60" oninput="updateMobilePreview()" style="font-size:14px;font-weight:600;"/>
        </div>
        <div class="fg">
          <label>Full description *</label>
          <textarea id="pub-desc" rows="5" placeholder="Describe the main steps, prerequisites, and what readers will learn exactly..." oninput="updatePubCompletion();updateMobilePreview();updateDescCount()" maxlength="300" style="font-size:13px;resize:vertical;min-height:130px;"></textarea>
          <div style="font-size:10px;color:var(--muted2);margin-top:5px;font-family:'DM Mono',monospace"><span id="pub-desc-count">0</span>/300 · <span id="pub-desc-quality"></span></div>
        </div>
        <div style="background:rgba(34,197,94,0.04);border:1px solid rgba(34,197,94,0.12);border-radius:10px;padding:14px 16px">
          <div style="font-family:'DM Mono',monospace;font-size:9px;color:#86efac;letter-spacing:2px;margin-bottom:10px">📚 STRUCTURE YOUR TUTORIAL</div>
          <div style="display:grid;grid-template-columns:1fr 1fr;gap:8px">
            <div class="pub-tip-item" onclick="insertDescTip(this)" data-tip="🎯 What you'll learn: ">🎯 Goal</div>
            <div class="pub-tip-item" onclick="insertDescTip(this)" data-tip="📋 📋 Prerequisites : ">📋 📋 Prerequisites</div>
            <div class="pub-tip-item" onclick="insertDescTip(this)" data-tip="1️⃣ Step 1 : ">1️⃣ Step 1</div>
            <div class="pub-tip-item" onclick="insertDescTip(this)" data-tip="2️⃣ Step 2 : ">2️⃣ Step 2</div>
            <div class="pub-tip-item" onclick="insertDescTip(this)" data-tip="🛠️ Tools used: ">🛠️ Tools</div>
            <div class="pub-tip-item" onclick="insertDescTip(this)" data-tip="✅ Final result : ">✅ Final result</div>
          </div>
        </div>`
    },
    step3: {
      icon: '👥', head: 'AUDIENCE', sub: 'Who is this tutorial for?',
      fields: `
        <div class="fg" style="grid-column:1/-1">
          <label>Target audience</label>
          <input type="text" id="pub-target" placeholder="Ex: Beginner developers, freelancers, entrepreneurs..." oninput="updatePubCompletion()"/>
        </div>
        <div class="fg" style="grid-column:1/-1">
          <label>Tags</label>
          <input type="text" id="pub-tags" placeholder="Ex: Tutorial, Marketing, Beginner, Free" oninput="updatePubCompletion();renderTagsPreview()"/>
          <div id="pub-tags-preview" style="display:flex;gap:6px;flex-wrap:wrap;margin-top:8px"></div>
        </div>`
    }
  },

  search: {
    mainTitle: 'POST A SEARCH',
    mainSub: 'Describe your need and receive proposals from the community.',
    color: '#a5b4fc',
    steps: ['Need', 'Details', 'Budget & timeline', 'Visual', 'Preview'],
    step1: {
      icon: '🔍', head: 'YOUR NEED', sub: 'The more precise you are, the better served you\'ll be',
      fields: `
        <div class="fg" style="grid-column:1/-1">
          <label>Need title *</label>
          <input type="text" id="pub-name" placeholder="Ex: Looking for React developer for urgent mobile app" oninput="updatePubCompletion();updateMobilePreview()" maxlength="80" style="font-size:15px;padding:13px 15px;"/>
        </div>
        <div class="fg">
          <label>Search type *</label>
          <select id="pub-cat"><option>👨‍💻 Freelance / Contractor</option><option>🤝 Business partner</option><option>🛠️ Tool / Software</option><option>📚 Resource / Content</option><option>💡 Advice / Feedback</option><option>🌍 Supplier</option><option>📢 Influencer / Ambassador</option></select>
        </div>
        <div class="fg">
          <label>Urgency</label>
          <select id="pub-urgence"><option>🔥 Very urgent (this week)</option><option>⚡ Urgent (2 weeks)</option><option>📅 Normal (1 month)</option><option>🗓️ Not urgent (whenever available)</option></select>
        </div>
        <div class="fg" style="grid-column:1/-1"><label>Emoji</label><div style="display:flex;gap:8px;align-items:center"><input type="text" id="pub-emoji" placeholder="🔍" maxlength="2" style="width:58px;text-align:center;font-size:24px;padding:8px;"/><div style="display:flex;gap:6px;flex-wrap:wrap">
          ${['🔍','🤝','👨‍💻','🛠️','📢','💡','🎯','📚','💼','🌍'].map(e=>`<span onclick="document.getElementById('pub-emoji').value='${e}';updateMobilePreview()" style="cursor:pointer;font-size:20px;padding:5px;border-radius:6px;background:var(--s2);border:1.5px solid var(--border2);transition:border-color 0.2s" onmouseover="this.style.borderColor=\'var(--g3)\'" onmouseout="this.style.borderColor=\'var(--border2)\'">${e}</span>`).join('')}
        </div></div></div>`
    },
    step2: {
      icon: '📋', head: 'NEED DESCRIPTION', sub: 'Describe exactly what you need',
      fields: `
        <div class="fg">
          <label>Summary *</label>
          <input type="text" id="pub-hook" placeholder="Ex: I'm looking for someone to redesign my site in 2 weeks" maxlength="60" oninput="updateMobilePreview()" style="font-size:14px;font-weight:600;"/>
        </div>
        <div class="fg">
          <label>Full description *</label>
          <textarea id="pub-desc" rows="5" placeholder="Describe your project, the context, required skills, and what you expect exactly..." oninput="updatePubCompletion();updateMobilePreview();updateDescCount()" maxlength="300" style="font-size:13px;resize:vertical;min-height:130px;"></textarea>
          <div style="font-size:10px;color:var(--muted2);margin-top:5px;font-family:'DM Mono',monospace"><span id="pub-desc-count">0</span>/300 · <span id="pub-desc-quality"></span></div>
        </div>
        <div style="background:rgba(99,102,241,0.04);border:1px solid rgba(99,102,241,0.15);border-radius:10px;padding:14px 16px">
          <div style="font-family:'DM Mono',monospace;font-size:9px;color:#a5b4fc;letter-spacing:2px;margin-bottom:10px">💡 BE PRECISE</div>
          <div style="display:grid;grid-template-columns:1fr 1fr;gap:8px">
            <div class="pub-tip-item" onclick="insertDescTip(this)" data-tip="🎯 What I need: ">🎯 Specific need</div>
            <div class="pub-tip-item" onclick="insertDescTip(this)" data-tip="📋 Required skills: ">📋 ✅ Skills</div>
            <div class="pub-tip-item" onclick="insertDescTip(this)" data-tip="🏗️ Project context: ">🏗️ Context</div>
            <div class="pub-tip-item" onclick="insertDescTip(this)" data-tip="📦 Expected deliverables: ">📦 Deliverables</div>
            <div class="pub-tip-item" onclick="insertDescTip(this)" data-tip="📩 How to apply: ">📩 How to apply</div>
            <div class="pub-tip-item" onclick="insertDescTip(this)" data-tip="⚠️ Important: ">⚠️ Key points</div>
          </div>
        </div>`
    },
    step3: {
      icon: '💰', head: 'BUDGET & TIMELINE', sub: 'Be transparent to attract the right people',
      fields: `
        <div class="fg" style="grid-column:1/-1">
          <label>Budget *</label>
          <input type="text" id="pub-price" placeholder="Ex: 300-500$ · Daily rate 350$ · Quote-based · Equity possible" oninput="updatePubCompletion()"/>
        </div>
        <div class="fg">
          <label>Work mode</label>
          <select id="pub-mode"><option>🌍 Remote only</option><option>🏢 Paris / Greater Paris</option><option>🏢 Other city</option><option>🔄 Remote or on-site</option></select>
        </div>
        <div class="fg">
          <label>Contrat</label>
          <select id="pub-contrat"><option>📄 Freelance mission</option><option>🤝 Partnership</option><option>💼 Full-time / Fixed-term</option><option>🔄 To be defined</option></select>
        </div>
        <div class="fg" style="grid-column:1/-1">
          <label>Tags</label>
          <input type="text" id="pub-tags" placeholder="Ex: React, Freelance, Urgent, Remote, Dev" oninput="updatePubCompletion();renderTagsPreview()"/>
          <div id="pub-tags-preview" style="display:flex;gap:6px;flex-wrap:wrap;margin-top:8px"></div>
        </div>`
    }
  },

  result: {
    mainTitle: 'SHARE MY RESULTS',
    mainSub: 'Insworst the community with your stats and wins.',
    color: '#fde68a',
    steps: ['Numbers', 'Story', 'Learnings', 'Visual', 'Preview'],
    step1: {
      icon: '🏆', head: 'YOUR NUMBERS', sub: 'Concrete numbers inspire and engage',
      fields: `
        <div class="fg" style="grid-column:1/-1">
          <label>Result title *</label>
          <input type="text" id="pub-name" placeholder="Ex: $10,000 revenue in 3 months — here's how I did it" oninput="updatePubCompletion();updateMobilePreview()" maxlength="80" style="font-size:15px;padding:13px 15px;"/>
        </div>
        <div class="fg">
          <label>Key metric *</label>
          <input type="text" id="pub-metric" placeholder="Ex: 10 000$ · 5 000 followers · +300% de trafic" oninput="updatePubCompletion()" style="font-size:18px;font-weight:800;text-align:center"/>
        </div>
        <div class="fg">
          <label>Period</label>
          <input type="text" id="pub-period" placeholder="Ex: January to March 2025 · In 90 days" oninput="updatePubCompletion()"/>
        </div>
        <div class="fg">
          <label>Domaine</label>
          <select id="pub-cat"><option>💰 Revenue / MRR</option><option>👥 Audience / Followers</option><option>🔗 Traffic / Visitors</option><option>🛍️ Sales / Clients</option><option>📈 Growth</option><option>🎓 Training / Learning</option><option>🏋️ Personal / Challenge</option></select>
        </div>
        <div class="fg" style="grid-column:1/-1"><label>Emoji</label><div style="display:flex;gap:8px;align-items:center"><input type="text" id="pub-emoji" placeholder="🏆" maxlength="2" style="width:58px;text-align:center;font-size:24px;padding:8px;"/><div style="display:flex;gap:6px;flex-wrap:wrap">
          ${['🏆','📈','💰','🎉','🚀','⭐','💪','🔥','🌟','🎯'].map(e=>`<span onclick="document.getElementById('pub-emoji').value='${e}';updateMobilePreview()" style="cursor:pointer;font-size:20px;padding:5px;border-radius:6px;background:var(--s2);border:1.5px solid var(--border2);transition:border-color 0.2s" onmouseover="this.style.borderColor=\'var(--g3)\'" onmouseout="this.style.borderColor=\'var(--border2)\'">${e}</span>`).join('')}
        </div></div></div>`
    },
    step2: {
      icon: '📖', head: 'YOUR STORY', sub: 'Context + journey = inspiring content',
      fields: `
        <div class="fg">
          <label>Hook *</label>
          <input type="text" id="pub-hook" placeholder="Ex: 3 months ago, I started from zero. Here's what changed." maxlength="60" oninput="updateMobilePreview()" style="font-size:14px;font-weight:600;"/>
        </div>
        <div class="fg">
          <label>Your full story *</label>
          <textarea id="pub-desc" rows="6" placeholder="Talk about your starting point, the challenges faced, the actions that changed everything..." oninput="updatePubCompletion();updateMobilePreview();updateDescCount()" maxlength="300" style="font-size:13px;resize:vertical;min-height:140px;"></textarea>
          <div style="font-size:10px;color:var(--muted2);margin-top:5px;font-family:'DM Mono',monospace"><span id="pub-desc-count">0</span>/300 · <span id="pub-desc-quality"></span></div>
        </div>
        <div style="background:rgba(255,215,0,0.04);border:1px solid rgba(255,215,0,0.15);border-radius:10px;padding:14px 16px">
          <div style="font-family:'DM Mono',monospace;font-size:9px;color:#fde68a;letter-spacing:2px;margin-bottom:10px">🏆 STRUCTURE QUI ENGAGE</div>
          <div style="display:grid;grid-template-columns:1fr 1fr;gap:8px">
            <div class="pub-tip-item" onclick="insertDescTip(this)" data-tip="📍 Starting point : ">📍 Starting point</div>
            <div class="pub-tip-item" onclick="insertDescTip(this)" data-tip="⚡ What changed everything: ">⚡ The spark</div>
            <div class="pub-tip-item" onclick="insertDescTip(this)" data-tip="🔑 Key actions : ">🔑 Key actions</div>
            <div class="pub-tip-item" onclick="insertDescTip(this)" data-tip="📈 The results: ">📈 The numbers</div>
            <div class="pub-tip-item" onclick="insertDescTip(this)" data-tip="😰 The challenges: ">😰 Challenges</div>
            <div class="pub-tip-item" onclick="insertDescTip(this)" data-tip="💡 What I would have done differently: ">💡 Retro</div>
          </div>
        </div>`
    },
    step3: {
      icon: '💡', head: 'LEARNINGS', sub: 'Share what you\'ve learned to help others',
      fields: `
        <div class="fg" style="grid-column:1/-1">
          <label>Apprentissage principal</label>
          <textarea id="pub-lesson" rows="3" placeholder="What is the #1 lesson you take away from this experience?" style="font-size:13px;resize:none;min-height:70px;padding:10px;background:var(--s1);border:1.5px solid var(--border2);border-radius:10px;color:var(--white);font-family:'Plus Jakarta Sans',sans-serif;outline:none"></textarea>
        </div>
        <div class="fg" style="grid-column:1/-1">
          <label>Tags</label>
          <input type="text" id="pub-tags" placeholder="Ex: Results, Revenue, Growth, Testimonial" oninput="updatePubCompletion();renderTagsPreview()"/>
          <div id="pub-tags-preview" style="display:flex;gap:6px;flex-wrap:wrap;margin-top:8px"></div>
        </div>
        <div class="fg" style="grid-column:1/-1">
          <label>Audience inspired by this result</label>
          <input type="text" id="pub-target" placeholder="Ex: Entrepreneurs, creators, beginner freelancers..." oninput="updatePubCompletion()"/>
        </div>`
    }
  },

  campaign: {
    mainTitle: 'LAUNCH MY CAMPAIGN',
    mainSub: 'The ultimate format for maximum visibility with measurable goals.',
    color: '#ffd700',
    steps: ['Campaign', 'Pitch', 'Goals', 'Visual', 'Preview'],
    step1: {
      icon: '🎯', head: 'YOUR CAMPAIGN', sub: 'The name + goal set the tone for your campaign',
      fields: `
        <div class="fg" style="grid-column:1/-1">
          <label>Campaign name *</label>
          <input type="text" id="pub-name" placeholder="Ex: 🎯 LaunchBoost — 1000 beta testers in 30 days" oninput="updatePubCompletion();updateMobilePreview()" maxlength="80" style="font-size:15px;padding:13px 15px;"/>
        </div>
        <div class="fg">
          <label>Campaign type *</label>
          <select id="pub-cat"><option>🚀 Product launch</option><option>🧪 Beta tester recruitment</option><option>💰 Fundraising</option><option>👥 Audience growth</option><option>🤝 Search partners</option><option>🌍 Impact / Cause</option></select>
        </div>
        <div class="fg">
          <label>Campaign duration</label>
          <select id="pub-duration"><option>⚡ 7 days</option><option>📅 14 days</option><option>📅 30 days</option><option>📅 60 days</option><option>♾️ No limitimit</option></select>
        </div>
        <div class="fg" style="grid-column:1/-1">
          <label>Campaign URL *</label>
          <input type="url" id="pub-url" placeholder="https://my-campaign.com" oninput="updatePubCompletion()"/>
        </div>
        <div class="fg" style="grid-column:1/-1">
          <label>Presentation video URL</label>
          <input type="url" id="pub-video" placeholder="https://youtube.com/... ou Loom..." oninput="updatePubCompletion()"/>
        </div>
        <div class="fg" style="grid-column:1/-1"><label>Emoji</label><div style="display:flex;gap:8px;align-items:center"><input type="text" id="pub-emoji" placeholder="🎯" maxlength="2" style="width:58px;text-align:center;font-size:24px;padding:8px;"/><div style="display:flex;gap:6px;flex-wrap:wrap">
          ${['🎯','🚀','💥','🔥','⭐','🏆','💎','🌟','⚡','🎪'].map(e=>`<span onclick="document.getElementById('pub-emoji').value='${e}';updateMobilePreview()" style="cursor:pointer;font-size:20px;padding:5px;border-radius:6px;background:var(--s2);border:1.5px solid var(--border2);transition:border-color 0.2s" onmouseover="this.style.borderColor=\'var(--g3)\'" onmouseout="this.style.borderColor=\'var(--border2)\'">${e}</span>`).join('')}
        </div></div></div>`
    },
    step2: {
      icon: '🎤', head: 'CAMPAIGN PITCH', sub: 'Convince people to join your cause',
      fields: `
        <div class="fg">
          <label>Campaign slogan *</label>
          <input type="text" id="pub-hook" placeholder="Ex: Join 500 founders changing their industry" maxlength="60" oninput="updateMobilePreview()" style="font-size:14px;font-weight:600;"/>
        </div>
        <div class="fg">
          <label>Full description *</label>
          <textarea id="pub-desc" rows="5" placeholder="Present your campaign, why it matters, what people gain by joining..." oninput="updatePubCompletion();updateMobilePreview();updateDescCount()" maxlength="300" style="font-size:13px;resize:vertical;min-height:130px;"></textarea>
          <div style="font-size:10px;color:var(--muted2);margin-top:5px;font-family:'DM Mono',monospace"><span id="pub-desc-count">0</span>/300 · <span id="pub-desc-quality"></span></div>
        </div>
        <div style="background:rgba(255,215,0,0.04);border:1px solid rgba(255,215,0,0.2);border-radius:10px;padding:14px 16px">
          <div style="font-family:'DM Mono',monospace;font-size:9px;color:#ffd700;letter-spacing:2px;margin-bottom:10px">🌟 PITCH GAGNANT</div>
          <div style="display:grid;grid-template-columns:1fr 1fr;gap:8px">
            <div class="pub-tip-item" onclick="insertDescTip(this)" data-tip="🎯 The mission: ">🎯 The mission</div>
            <div class="pub-tip-item" onclick="insertDescTip(this)" data-tip="❓ The problem addressed: ">❓ Problem</div>
            <div class="pub-tip-item" onclick="insertDescTip(this)" data-tip="🎁 What you offer: ">🎁 The offer</div>
            <div class="pub-tip-item" onclick="insertDescTip(this)" data-tip="💪 Why you: ">💪 Why you</div>
            <div class="pub-tip-item" onclick="insertDescTip(this)" data-tip="🔥 The urgency: ">🔥 Urgency</div>
            <div class="pub-tip-item" onclick="insertDescTip(this)" data-tip="🚀 How to join: ">🚀 How to join</div>
          </div>
        </div>`
    },
    step3: {
      icon: '📊', head: 'GOALS & FAQ', sub: 'Precise numbers + FAQ = maximum credibility',
      fields: `
        <div class="fg" style="grid-column:1/-1">
          <label>Main measurable goal *</label>
          <input type="text" id="pub-goal" placeholder="Ex: 1,000 signups · $50,000 raised · 10k followers" oninput="updatePubCompletion()"/>
        </div>
        <div class="fg" style="grid-column:1/-1">
          <label>FAQ (3 key Q&As)</label>
          <textarea id="pub-faq" rows="4" placeholder="Q: How does it work?&#10;A: ...&#10;Q: Is it free?&#10;A: ..." style="font-size:13px;resize:none;min-height:100px;padding:10px;background:var(--s1);border:1.5px solid var(--border2);border-radius:10px;color:var(--white);font-family:'DM Mono',monospace;outline:none"></textarea>
        </div>
        <div class="fg" style="grid-column:1/-1">
          <label>Tags</label>
          <input type="text" id="pub-tags" placeholder="Ex: Campaign, SaaS, Launch, Beta, Growth" oninput="updatePubCompletion();renderTagsPreview()"/>
          <div id="pub-tags-preview" style="display:flex;gap:6px;flex-wrap:wrap;margin-top:8px"></div>
        </div>`
    }
  },

  'service-pro': {
    mainTitle: 'MY PRO SERVICE',
    mainSub: 'Create your complete professional showcase to attract premium clients.',
    color: '#a855f7',
    steps: ['Profile', 'Offers', 'Proof', 'Visual', 'Preview'],
    step1: {
      icon: '🔧', head: 'YOUR PRO PROFILE', sub: 'Your premium digital business card',
      fields: `
        <div class="fg" style="grid-column:1/-1">
          <label>Your professional title *</label>
          <input type="text" id="pub-name" placeholder="Ex: Antoine D. — Expert Growth & Acquisition B2B" oninput="updatePubCompletion();updateMobilePreview()" maxlength="80" style="font-size:15px;padding:13px 15px;"/>
        </div>
        <div class="fg">
          <label>Main specialty *</label>
          <select id="pub-cat"><option>🎨 Design & Branding</option><option>💻 Development Web/App</option><option>📣 Marketing & Growth</option><option>✍️ Copywriting & Content</option><option>🎬 Video & Production</option><option>📊 Data & Analytics</option><option>🤖 AI & Automation</option><option>💼 Consulting & Strategy</option><option>🎓 Training & Coaching</option></select>
        </div>
        <div class="fg">
          <label>Years of experience</label>
          <select id="pub-exp"><option>🌱 1-2 ans</option><option>📈 3-5 ans</option><option>⭐ 5-10 ans</option><option>🏆 +10 ans</option></select>
        </div>
        <div class="fg" style="grid-column:1/-1">
          <label>Portfolio / Website *</label>
          <input type="url" id="pub-url" placeholder="https://monportfolio.fr" oninput="updatePubCompletion()"/>
        </div>
        <div class="fg" style="grid-column:1/-1"><label>Emoji</label><div style="display:flex;gap:8px;align-items:center"><input type="text" id="pub-emoji" placeholder="🔧" maxlength="2" style="width:58px;text-align:center;font-size:24px;padding:8px;"/><div style="display:flex;gap:6px;flex-wrap:wrap">
          ${['🔧','💼','⭐','🎨','💻','📣','✍️','🎬','📊','🏆'].map(e=>`<span onclick="document.getElementById('pub-emoji').value='${e}';updateMobilePreview()" style="cursor:pointer;font-size:20px;padding:5px;border-radius:6px;background:var(--s2);border:1.5px solid var(--border2);transition:border-color 0.2s" onmouseover="this.style.borderColor=\'var(--g3)\'" onmouseout="this.style.borderColor=\'var(--border2)\'">${e}</span>`).join('')}
        </div></div></div>`
    },
    step2: {
      icon: '💰', head: 'YOUR OFFERS', sub: 'Your services with clear pricing',
      fields: `
        <div class="fg">
          <label>Hook *</label>
          <input type="text" id="pub-hook" placeholder="Ex: I turn ideas into products that convert" maxlength="60" oninput="updateMobilePreview()" style="font-size:14px;font-weight:600;"/>
        </div>
        <div class="fg">
          <label>Description & offers *</label>
          <textarea id="pub-desc" rows="5" placeholder="Describe your main offers, your approach, what sets you apart..." oninput="updatePubCompletion();updateMobilePreview();updateDescCount()" maxlength="300" style="font-size:13px;resize:vertical;min-height:130px;"></textarea>
          <div style="font-size:10px;color:var(--muted2);margin-top:5px;font-family:'DM Mono',monospace"><span id="pub-desc-count">0</span>/300 · <span id="pub-desc-quality"></span></div>
        </div>
        <div class="fg">
          <label>Starting rate</label>
          <input type="text" id="pub-price" placeholder="Ex: From $800 · Daily rate $500"/>
        </div>
        <div class="fg">
          <label>Availability</label>
          <select id="pub-dispo"><option>✅ Available immediately</option><option>📅 Available in 1 week</option><option>⏳ Waitlist 2 weeks</option><option>❌ Complet actuellement</option></select>
        </div>`
    },
    step3: {
      icon: '⭐', head: 'SOCIAL PROOF', sub: 'Testimonials + references = instant trust',
      fields: `
        <div class="fg" style="grid-column:1/-1">
          <label>Customer testimonial 1</label>
          <input type="text" id="pub-testi1" placeholder="\"Excellent work, delivered ahead of schedule. Highly recommended!\" — Marie D., CEO Startup XY"/>
        </div>
        <div class="fg" style="grid-column:1/-1">
          <label>Customer testimonial 2</label>
          <input type="text" id="pub-testi2" placeholder="\"ROI x3 in 2 months. Performance beyond expectations.\" — Pierre L., Founder"/>
        </div>
        <div class="fg" style="grid-column:1/-1">
          <label>Notable clients / Brands</label>
          <input type="text" id="pub-refs" placeholder="Ex: Orange, BNP, 12 startups Series A, +50 freelances..."/>
        </div>
        <div class="fg" style="grid-column:1/-1">
          <label>Tags</label>
          <input type="text" id="pub-tags" placeholder="Ex: Design, UX, Branding, Premium, Paris" oninput="updatePubCompletion();renderTagsPreview()"/>
          <div id="pub-tags-preview" style="display:flex;gap:6px;flex-wrap:wrap;margin-top:8px"></div>
        </div>`
    }
  },

  job: {
    mainTitle: 'POST A JOB OFFER',
    mainSub: 'Find the best talent for your team or project.',
    color: '#60a5fa',
    steps: ['Position', 'Mission', 'Terms', 'Visual', 'Preview'],
    step1: {
      icon: '💼', head: 'THE POSITION', sub: 'A precise title attracts the right candidates',
      fields: `
        <div class="fg" style="grid-column:1/-1">
          <label>Job title *</label>
          <input type="text" id="pub-name" placeholder="Ex: Full-Stack Developer React/Node.js — FinTech Startup" oninput="updatePubCompletion();updateMobilePreview()" maxlength="80" style="font-size:15px;padding:13px 15px;"/>
        </div>
        <div class="fg">
          <label>Contract type *</label>
          <select id="pub-contrat"><option>💼 Permanent</option><option>📋 Fixed-term</option><option>🚀 Freelance / Mission</option><option>🎓 Internship</option><option>🌱 Apprenticeship</option><option>🤝 Partner / Co-fondateur</option></select>
        </div>
        <div class="fg">
          <label>Department / Field *</label>
          <select id="pub-cat"><option>💻 Tech & Dev</option><option>🎨 Design & Creative</option><option>📣 Marketing & Growth</option><option>💼 Commercial / Sales</option><option>📊 Data & BI</option><option>🤖 AI & ML</option><option>💰 Finance & Management</option><option>🎓 Product / PM</option><option>👥 HR / Recruiting</option><option>🔧 Ops / Support</option></select>
        </div>
        <div class="fg">
          <label>Required experience</label>
          <select id="pub-exp"><option>🌱 Junior (0-2 yrs)</option><option>📈 Confirmed (2-5 yrs)</option><option>⭐ Senior (5-10 yrs)</option><option>🏆 Expert (10+ yrs)</option><option>🤔 Tous niveaux</option></select>
        </div>
        <div class="fg" style="grid-column:1/-1">
          <label>Company / project name *</label>
          <input type="text" id="pub-company" placeholder="Ex: FinTech XYZ · My Startup · Side project" oninput="updatePubCompletion()"/>
        </div>
        <div class="fg" style="grid-column:1/-1">
          <label>Link candidature / site *</label>
          <input type="url" id="pub-url" placeholder="https://rejoins.mastartup.fr ou email direct" oninput="updatePubCompletion()"/>
        </div>
        <div class="fg" style="grid-column:1/-1"><label>Emoji</label><div style="display:flex;gap:8px;align-items:center"><input type="text" id="pub-emoji" placeholder="💼" maxlength="2" style="width:58px;text-align:center;font-size:24px;padding:8px;"/><div style="display:flex;gap:6px;flex-wrap:wrap">
          ${['💼','👨‍💻','🎨','📣','💻','📊','🤖','💰','🎯','🚀'].map(e=>`<span onclick="document.getElementById('pub-emoji').value='${e}';updateMobilePreview()" style="cursor:pointer;font-size:20px;padding:5px;border-radius:6px;background:var(--s2);border:1.5px solid var(--border2);transition:border-color 0.2s" onmouseover="this.style.borderColor=\'var(--g3)\'" onmouseout="this.style.borderColor=\'var(--border2)\'">${e}</span>`).join('')}
        </div></div></div>`
    },
    step2: {
      icon: '📋', head: 'MISSION & SKILLS', sub: 'What the candidate does daily',
      fields: `
        <div class="fg">
          <label>Hook *</label>
          <input type="text" id="pub-hook" placeholder="Ex: Join a team of 5 scaling to +10k users/month" maxlength="60" oninput="updateMobilePreview()" style="font-size:14px;font-weight:600;"/>
        </div>
        <div class="fg">
          <label>Job description & mission *</label>
          <textarea id="pub-desc" rows="5" placeholder="Describe the main missions, team context, job challenges, and what makes this positione unique..." oninput="updatePubCompletion();updateMobilePreview();updateDescCount()" maxlength="300" style="font-size:13px;resize:vertical;min-height:130px;"></textarea>
          <div style="font-size:10px;color:var(--muted2);margin-top:5px;font-family:'DM Mono',monospace"><span id="pub-desc-count">0</span>/300 · <span id="pub-desc-quality"></span></div>
        </div>
        <div style="background:rgba(59,130,246,0.04);border:1px solid rgba(59,130,246,0.15);border-radius:10px;padding:14px 16px">
          <div style="font-family:'DM Mono',monospace;font-size:9px;color:#60a5fa;letter-spacing:2px;margin-bottom:10px">💡 KEY ELEMENTS OF AN OFFER</div>
          <div style="display:grid;grid-template-columns:1fr 1fr;gap:8px">
            <div class="pub-tip-item" onclick="insertDescTip(this)" data-tip="🎯 Main missions: ">🎯 Missions</div>
            <div class="pub-tip-item" onclick="insertDescTip(this)" data-tip="✅ Required skills: ">✅ ✅ Skills</div>
            <div class="pub-tip-item" onclick="insertDescTip(this)" data-tip="🌟 Bonus skills: ">🌟 Bonus skills</div>
            <div class="pub-tip-item" onclick="insertDescTip(this)" data-tip="🏢 The team : ">🏢 The team</div>
            <div class="pub-tip-item" onclick="insertDescTip(this)" data-tip="🚀 The project: ">🚀 The project</div>
            <div class="pub-tip-item" onclick="insertDescTip(this)" data-tip="📈 Career growth prospects: ">📈 Evolution</div>
          </div>
        </div>`
    },
    step3: {
      icon: '💰', head: 'TERMS', sub: 'Compensation, workplace and benefits',
      fields: `
        <div class="fg" style="grid-column:1/-1">
          <label>Compensation *</label>
          <input type="text" id="pub-salary" placeholder="Ex: $45-55k/year · Daily rate $400 · Equity 0.5% · Negotiable" oninput="updatePubCompletion()"/>
        </div>
        <div class="fg">
          <label>Work mode *</label>
          <select id="pub-mode"><option>🌍 Full Remote</option><option>🏢 Paris</option><option>🏢 Lyon</option><option>🏢 Other city</option><option>🔄 Hybrid (2d office/week)</option><option>🔄 Hybrid (3j bureau/sem)</option></select>
        </div>
        <div class="fg">
          <label>Start date</label>
          <select id="pub-start"><option>⚡ Immediately</option><option>📅 In 1 month</option><option>📅 In 2-3 months</option><option>🤝 To be defined</option></select>
        </div>
        <div class="fg" style="grid-column:1/-1">
          <label>Benefits</label>
          <input type="text" id="pub-perks" placeholder="Ex: Stock options, health insurance, MacBook, training budget, team offsite..."/>
        </div>
        <div class="fg" style="grid-column:1/-1">
          <label>Tags</label>
          <input type="text" id="pub-tags" placeholder="Ex: CDI, Remote, React, Senior, Paris" oninput="updatePubCompletion();renderTagsPreview()"/>
          <div id="pub-tags-preview" style="display:flex;gap:6px;flex-wrap:wrap;margin-top:8px"></div>
        </div>`
    }
  }
};

// Fallback for types without custom config (tutorial, search already done above)
['pub','ad','service','launch','collab','promo','poll','tutorial','search','result','campaign','service-pro','job'].forEach(t => {
  if(!WIZ_CONFIGS[t]) WIZ_CONFIGS[t] = WIZ_CONFIGS['pub'];
});

function applyWizardConfig(type) {
  const cfg = WIZ_CONFIGS[type] || WIZ_CONFIGS['pub'];

  // Main header
  const mt = document.getElementById('wiz-main-title');
  const ms = document.getElementById('wiz-main-sub');
  if(mt) mt.textContent = cfg.mainTitle;
  if(ms) ms.textContent = cfg.mainSub;

  // Stepper labels
  cfg.steps.forEach((lbl, i) => {
    const el = document.getElementById('wlbl-' + (i+1));
    if(el) el.textContent = lbl;
  });

  // Step 1
  const s1 = cfg.step1;
  document.getElementById('wiz-step1-icon').textContent = s1.icon;
  document.getElementById('wiz-step1-head').textContent = s1.head;
  document.getElementById('wiz-step1-sub').textContent = s1.sub;
  document.getElementById('wiz-step1-fields').innerHTML = s1.fields;
  document.getElementById('wiz-step1-next').innerHTML = `Next — ${cfg.steps[1]} <span>→</span>`;

  // Step 2
  const s2 = cfg.step2;
  document.getElementById('wiz-step2-icon').textContent = s2.icon;
  document.getElementById('wiz-step2-head').textContent = s2.head;
  document.getElementById('wiz-step2-sub').textContent = s2.sub;
  document.getElementById('wiz-step2-fields').innerHTML = s2.fields;
  document.getElementById('wiz-step2-next').innerHTML = `Next — ${cfg.steps[2]} <span>→</span>`;

  // Step 3
  const s3 = cfg.step3;
  document.getElementById('wiz-step3-icon').textContent = s3.icon;
  document.getElementById('wiz-step3-head').textContent = s3.head;
  document.getElementById('wiz-step3-sub').textContent = s3.sub;
  document.getElementById('wiz-step3-fields').innerHTML = s3.fields;
  document.getElementById('wiz-step3-next').innerHTML = `Next — ${cfg.steps[3]} <span>→</span>`;

  // Accent color on wizard header title
  if(mt) mt.style.color = cfg.color;

  // Re-init char counters if present
  const nameEl = document.getElementById('pub-name');
  const descEl = document.getElementById('pub-desc');
  if(nameEl) {
    nameEl.addEventListener('input', () => {
      const c = document.getElementById('pub-name-count');
      if(c) c.textContent = nameEl.value.length;
    });
  }
  if(descEl) {
    descEl.addEventListener('input', () => {
      const c = document.getElementById('pub-desc-count');
      if(c) c.textContent = descEl.value.length;
    });
  }
}
</script>

<script>
const PUB_TYPE_INFO = {
  pub: {
    emoji:'📢', name:'Ad', color:'#22c55e', btnBg:'linear-gradient(135deg,#15803d,#22c55e)',
    intro:'The simplest and most direct post. Ideal for presenting your project, app or brand to the entire ViralBoost community in seconds.',
    tags:['✍️ Project name','📝 Description','🔗 Link','🏷️ Tags'],
    tip:'💡 Perfect for getting started or testing your message.'
  },
  ad: {
    emoji:'📣', name:'Announcement', color:'#4ade80', btnBg:'linear-gradient(135deg,#166534,#4ade80)',
    intro:'Have important news to share? An update, a partnership, a change? Use Announcement to inform the community with a date and a link.',
    tags:['📋 Title','💬 Message','📅 Date','🔗 Link'],
    tip:'💡 Great for engaging and keeping your audience informed.'
  },
  service: {
    emoji:'🛍️', name:'Service', color:'#60a5fa', btnBg:'linear-gradient(135deg,#1e40af,#60a5fa)',
    intro:'Selling a service? Design, development, coaching, writing… Offer your skills with a clear rate and a way to contact you directly.',
    tags:['🔧 Service','💰 Rate','⏱️ Deadline','📩 Contact'],
    tip:'💡 Perfect for finding your first clients.'
  },
  launch: {
    emoji:'🚀', name:'Launch', color:'#f87171', btnBg:'linear-gradient(135deg,#991b1b,#f87171)',
    intro:'Today\'s the big day! Officially announce your product or service with full context: the problem you solve, your solution, and the price. Maximum impact.',
    tags:['📦 Product','❓ Problem solved','✅ Solution','💵 Price'],
    tip:'🔥 The best way to make noise at launch.'
  },
  collab: {
    emoji:'🤝', name:'Collab', color:'#c084fc', btnBg:'linear-gradient(135deg,#6b21a8,#c084fc)',
    intro:'Looking for a partner, co-founder, content creator or business partner? Describe the ideal profile and collaboration terms.',
    tags:['👤 Target profile','🎯 Niche','📋 Terms','📩 Contact'],
    tip:'💡 Hundreds of collabs are born here every month.'
  },
  promo: {
    emoji:'🏷️', name:'Promo', color:'#fbbf24', btnBg:'linear-gradient(135deg,#92400e,#fbbf24)',
    intro:'Exclusive deal, promo code, flash sale… Create urgency with a time-limitd offer. The crossed-out price and expiry date boost conversions.',
    tags:['🎁 Offer','💸 Crossed price','🔑 Promo code','⏳ Expiry'],
    tip:'⚡ Promos generate 3x more clicks on average.'
  },
  poll: {
    emoji:'📊', name:'Poll', color:'#2dd4bf', btnBg:'linear-gradient(135deg,#134e4a,#2dd4bf)',
    intro:'Ask the community a question and collect votes in real time. Perfect for validating an idea, testing a product name or gauging your audience\'s preferences.',
    tags:['❓ Question','🔘 4 choices','⏱️ Duration','📈 Live results'],
    tip:'💡 Excellent for free market research.'
  },
  tutorial: {
    emoji:'🎓', name:'Tutorial', color:'#86efac', btnBg:'linear-gradient(135deg,#14532d,#86efac)',
    intro:'Share your expertise! Publish a step-by-step guide on a topic you master. Tutorials generate lots of engagement and position you as an expert.',
    tags:['📚 Topic','🔢 Steps','📶 Level','⏱️ Estimated time'],
    tip:'💡 Tutorials get 5x more saves than other posts.'
  },
  search: {
    emoji:'🔍', name:'Search', color:'#a5b4fc', btnBg:'linear-gradient(135deg,#312e81,#a5b4fc)',
    intro:'Looking for a freelancer, tool, resource or recommendation? Precisely describe your need, budget and deadline to receive proposals from the community.',
    tags:['📋 Need','💰 Budget','📅 Deadline','📩 Contact'],
    tip:'💡 The community responds in under 2h on average.'
  },
  result: {
    emoji:'🏆', name:'Result', color:'#fde68a', btnBg:'linear-gradient(135deg,#78350f,#fde68a)',
    intro:'Share your wins and inspiring the community! Sales figures, followers gained, revenue achieved… Show your progress and what you\'ve learned along the way.',
    tags:['📈 Key figures','📅 Period','💡 Learnings','🙏 Thank you'],
    tip:'🏆 Result posts are the most shared.'
  },
  campaign: {
    emoji:'🎯', name:'Campaign', color:'#ffd700', btnBg:'linear-gradient(135deg,#78350f,#ffd700)',
    intro:'The ultimate format for maximum visibility. Campaign combines a measurable goal, presentation video and FAQ to fully convince. Perfect for fundraising, launching a big product or finding investors.',
    tags:['🎯 Measurable goal','🎬 Video','❓ Full FAQ','🚀 Top feed boost'],
    tip:'🌟 The most impactful format on the platform.'
  },
  'service-pro': {
    emoji:'🔧', name:'Pro Service', color:'#a855f7', btnBg:'linear-gradient(135deg,#4c1d95,#a855f7)',
    intro:'The complete professional showcase for serious freelancers. Includes a portfolio, client testimonials, detailed pricing grids and a booking system.',
    tags:['🖼️ Portfolio','⭐ Testimonials','💰 Pricing grid','📅 Booking'],
    tip:'💎 To stand out and justify premium rates.'
  },
  job: {
    emoji:'💼', name:'Job Offer', color:'#60a5fa', btnBg:'linear-gradient(135deg,#1e3a8a,#60a5fa)',
    intro:'Recruit the best talent for your team or project. Describe the role, required skills, work conditions (remote, on-site) and compensation to attract the right profiles.',
    tags:['👤 Position','🛠️ Skills','🏠 Remote/On-site','💵 Compensation'],
    tip:'💼 Find your next collaborator in the community.'
  }
};

let _pendingPubType = null;

function previewPubType(type) {
  const info = PUB_TYPE_INFO[type];
  if (!info) { choosePubType(type); return; }

  _pendingPubType = type;

  // Highlight selected card
  document.querySelectorAll('.pub-type-card').forEach(c => c.classList.remove('ptc-selected'));
  const card = document.getElementById('ptc-' + type) || document.getElementById('ptc-' + type.replace('-','-'));
  if(card) card.classList.add('ptc-selected');

  const box = document.getElementById('pub-type-intro');
  document.getElementById('pub-intro-emoji').textContent = info.emoji;
  document.getElementById('pub-intro-title').textContent = info.name.toUpperCase();
  document.getElementById('pub-intro-title').style.color = info.color;
  document.getElementById('pub-intro-text').textContent = info.intro;

  // Tags
  const tagsEl = document.getElementById('pub-intro-tags');
  tagsEl.innerHTML = info.tags.map(t =>
    `<span style="font-size:10px;padding:3px 9px;border-radius:20px;background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);color:var(--g5);font-family:'DM Mono',monospace">${t}</span>`
  ).join('');

  // Confirm button
  const btn = document.getElementById('pub-intro-confirm');
  btn.style.background = info.btnBg;

  // Style the box border to match type color
  box.style.border = `1.5px solid ${info.color}30`;
  box.style.background = `linear-gradient(135deg,${info.color}08,transparent)`;

  // Add tip if needed
  if(info.tip) {
    document.getElementById('pub-intro-text').textContent = info.intro + '\n\n' + info.tip;
  }

  box.style.display = 'block';

  // Scroll intro into view smoothly
  setTimeout(()=>{ box.scrollIntoView({behavior:'smooth',block:'nearest'}); }, 100);
}

function confirmPubTypeChoice() {
  if(_pendingPubType) {
    choosePubType(_pendingPubType);
    _pendingPubType = null;
  }
}
</script>

<script>
// ── AD TYPE CHOOSER (inline in tab-publish) ──
function choosePubType(type){
  const plan = currentUser ? (currentUser.plan || 'free') : 'free';
  // All types are free now!
  // Hide chooser, show wizard
  const chooser = document.getElementById('pub-type-chooser');
  const wizard = document.getElementById('pub-wizard-content');
  const badge = document.getElementById('pub-type-badge');
  if(chooser) chooser.style.display = 'none';
  if(wizard) wizard.style.display = 'block';

  // Apply wizard config for this type
  applyWizardConfig(type);
  if(badge){
    const labels = {pub:'📢 AD', ad:'📣 ANNOUNCEMENT', service:'🛍️ SERVICE', launch:'🚀 LAUNCH', collab:'🤝 COLLAB', promo:'🏷️ PROMO', poll:'📊 POLL', tutorial:'🎓 TUTORIAL', search:'🔍 SEARCH', result:'🏆 RESULT', campaign:'🎯 CAMPAIGN', 'service-pro':'🔧 PRO SERVICE', job:'💼 JOB OFFER'};
    badge.textContent = labels[type] || '';
  }
  window._currentPubType = type;
  if(type === 'campaign'){
    toast('🏆 Campaign mode activated — maximum visibility!');
  } else if(type === 'ad'){
    toast('📣 Announcement mode activated!');
  }
}

function backToPubTypeChooser(){
  const chooser = document.getElementById('pub-type-chooser');
  const wizard = document.getElementById('pub-wizard-content');
  if(chooser) chooser.style.display = 'block';
  if(wizard) wizard.style.display = 'none';
  window._currentPubType = null;
  // Reset intro
  const intro = document.getElementById('pub-type-intro');
  if(intro) intro.style.display = 'none';
  document.querySelectorAll('.pub-type-card').forEach(c => c.classList.remove('ptc-selected'));
  _pendingPubType = null;
}

// Reset chooser when switching away and back to publish tab
const _origShowAppTab = showAppTab;
showAppTab = function(tab, el){
  if(tab === 'publish'){
    setTimeout(() => {
      const chooser = document.getElementById('pub-type-chooser');
      const wizard = document.getElementById('pub-wizard-content');
      if(chooser && wizard && !window._currentPubType){
        chooser.style.display = 'block';
        wizard.style.display = 'none';
        const intro = document.getElementById('pub-type-intro');
        if(intro) intro.style.display = 'none';
        document.querySelectorAll('.pub-type-card').forEach(c => c.classList.remove('ptc-selected'));
      }
    }, 50);
  }
  _origShowAppTab(tab, el);
  if(tab === 'reviews') setTimeout(renderReviews, 50);
};

// ══════════════════════════════════════════════════════
// ── ALL NEW VIRALBOOST FEATURES ──
// ══════════════════════════════════════════════════════

// ── 1. PROFILE COMPLETION ──
function getProfileCompletion(u){
  if(!u) return {pct:0, items:[]};
  const checks = [
    {key:'name',    label:'Name',    done: !!(u.name && u.name !== u.email?.split('@')[0])},
    {key:'username',label:'Username',    done: !!(u.username && u.username !== u.email?.split('@')[0])},
    {key:'bio',     label:'Bio',       done: !!(u.bio && u.bio.length > 10)},
    {key:'avatar',  label:'Avatar',    done: !!(u.avatarUrl || (u.avatar && u.avatar !== '🙂'))},
    {key:'niche',   label:'Niche',     done: !!u.niche},
    {key:'goal',    label:'Goal',  done: !!u.goal},
    {key:'social',  label:'Social',    done: !!(u.tiktok || u.instagram || u.twitter || u.website)},
    {key:'title',   label:'Title',     done: !!u.title},
  ];
  const done = checks.filter(c=>c.done).length;
  return { pct: Math.round(done/checks.length*100), items: checks };
}

// renderProfileCompletion — voir version améliorée plus haut

// ── 2. PARRAINAGE ──
function getReferralLink(u){
  if(!u) return '';
  const base = window.location.origin + window.location.pathname;
  return base + '?ref=' + (u.username || u.email.split('@')[0]);
}

function renderReferralBox(u){
  const link = getReferralLink(u);
  const refs = u.referrals || 0;
  const refCredits = (u.referralCredits || 0);
  return `<div class="referral-box">
    <div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:6px;">
      <div style="font-family:'Bebas Neue',sans-serif;font-size:20px;letter-spacing:1.5px;color:var(--g3)">🎁 REFERRAL</div>
      <span style="font-size:11px;color:var(--g4);font-weight:600">+100 credits per referral</span>
    </div>
    <div style="font-size:12px;color:var(--muted);line-height:1.6;margin-bottom:4px;">Share your link — you and your referral each receive <strong style="color:var(--g3)">100 ViralCredits</strong> upon their signup.</div>
    <div class="referral-link">
      <span id="referral-link-text">${link}</span>
      <button class="referral-copy-btn" onclick="copyReferralLink()">📋 Copy</button>
    </div>
    <div class="referral-stats">
      <div class="referral-stat"><div class="referral-stat-num">${refs}</div><div class="referral-stat-lbl">Feedleuls</div></div>
      <div class="referral-stat"><div class="referral-stat-num">${refCredits}</div><div class="referral-stat-lbl">Credits earned</div></div>
      <div class="referral-stat"><div class="referral-stat-num">${refs * 100}</div><div class="referral-stat-lbl">Value ($)</div></div>
    </div>
  </div>`;
}

function copyReferralLink(){
  const link = getReferralLink(currentUser);
  navigator.clipboard?.writeText(link).then(()=>toast('✅ Link copied!')).catch(()=>{
    const el = document.getElementById('referral-link-text');
    if(el){ const range=document.createRange();range.selectNode(el);window.getSelection().removeAllRanges();window.getSelection().addRange(range);document.execCommand('copy');toast('✅ Link copied!'); }
  });
}

function checkReferral(){
  const params = new URLSearchParams(window.location.search);
  const ref = params.get('ref');
  if(ref && currentUser){
    const refKey = 'vb_ref_credited_' + currentUser.email;
    if(!localStorage.getItem(refKey)){
      // Credit both
      addCredits(100);
      localStorage.setItem(refKey, ref);
      toast('🎁 +100 credits gifted by referral!');
      // Update referrer stats in accounts
      const accounts = _getAccounts();
      const refUser = Object.values(accounts).find(u => u.username === ref || u.email.split('@')[0] === ref);
      if(refUser){
        refUser.referrals = (refUser.referrals||0) + 1;
        refUser.referralCredits = (refUser.referralCredits||0) + 100;
        _saveAccount(refUser);
      }
    }
  }
}

// ── 3. BADGE VERIFIED ──
function isVerified(u){
  if(!u) return false;
  return u.plan === 'pro' || u.plan === 'elite' || u.verified === true;
}

function getVerifiedBadge(u){
  if(!isVerified(u)) return '';
  return ' <span class="badge-verified">VERIFIED</span>';
}

// ── 4. TRENDING TOPICS ──
// ── TRENDING IA — trending curées ──
const AI_TRENDS = [
  {tag:'AI Agents', emoji:'🤖', desc:'Automate with autonomous agents', heat:'🔥🔥🔥'},
  {tag:'Short-form video', emoji:'🎬', desc:'TikTok & Reels still dominate', heat:'🔥🔥🔥'},
  {tag:'Micro SaaS', emoji:'🚀', desc:'Launch solo, monetize fast', heat:'🔥🔥🔥'},
  {tag:'Personal Branding', emoji:'💎', desc:'Sell yourself before your product', heat:'🔥🔥🔥'},
  {tag:'Newsletter payante', emoji:'📧', desc:'The creator email renaissance', heat:'🔥🔥'},
  {tag:'No-code / Vibe coding', emoji:'⚡', desc:'Build without code in 2025', heat:'🔥🔥🔥'},
  {tag:'UGC & Collab', emoji:'🤝', desc:'Paid user-generated content', heat:'🔥🔥'},
  {tag:'Digital Product', emoji:'💰', desc:'Passive revenue: ebooks, templates', heat:'🔥🔥'},
];

function renderTrendingWidget(){
  const container = document.getElementById('trending-widget-container');
  if(!container) return '';
  container.innerHTML = `
    <div class="trending-widget">
      <div class="trending-title" style="display:flex;align-items:center;justify-content:space-between;margin-bottom:14px;">
        <span>🔥 Current trends</span>
        <span style="font-size:9px;background:linear-gradient(135deg,var(--g1),var(--g2));color:var(--bg);padding:2px 8px;border-radius:4px;font-family:'DM Mono',monospace;letter-spacing:1px;font-weight:700;">⚡ IA</span>
      </div>
      ${AI_TRENDS.map((t,i) => `
        <div class="trending-item" onclick="searchGlobal('${t.tag.replace(/'/g,"\\'")}')">
          <span class="trending-rank">${i+1}</span>
          <span class="trending-tag">${t.emoji} ${t.tag}</span>
          <span class="trending-count" title="${t.desc}">${t.heat}</span>
        </div>`).join('')}
      <div style="font-size:10px;color:var(--muted2);text-align:right;margin-top:10px;font-family:'DM Mono',monospace;letter-spacing:0.5px;">AI Selection · Creators 2025</div>
    </div>`;
  return '';
}

// ── 5. STORIES ──
let storiesData = JSON.parse(localStorage.getItem('vb_stories')||'[]');

function renderStoriesBar(){
  const now = Date.now();
  const active = storiesData.filter(s => now - s.ts < 86400000); // 24h
  const seenKey = 'vb_seen_stories_' + (currentUser?.email||'guest');
  const seen = JSON.parse(localStorage.getItem(seenKey)||'[]');
  
  return `<div class="stories-bar">
    ${currentUser && !currentUser.isDemo ? `
    <div class="story-item" onclick="openAddStory()">
      <div class="story-ring add-story">
        <div class="story-ava">📸</div>
        <div class="story-add-icon">+</div>
      </div>
      <div class="story-label">My story</div>
    </div>` : ''}
    ${active.map((s,i) => `
    <div class="story-item" onclick="viewStory(${i})">
      <div class="story-ring ${seen.includes(s.id)?'seen':''}">
        <div class="story-ava" style="background:${getAvatarColor(s.userId)}">${s.emoji||'🙂'}</div>
      </div>
      <div class="story-label">${s.author}</div>
    </div>`).join('')}
  </div>`;
}

function openAddStory(){
  if(!currentUser||currentUser.isDemo){openDemoSignupModal();return;}
  const text = prompt('💬 Your story (text, max 200 chars) — visible 24h:');
  if(!text || !text.trim()) return;
  const story = {
    id: 's'+Date.now(), userId: currentUser.email, author: currentUser.name,
    emoji: currentUser.avatar||'🙂', text: text.trim().slice(0,200),
    ts: Date.now(), plan: currentUser.plan||'free'
  };
  storiesData.unshift(story);
  storiesData = storiesData.filter(s => Date.now()-s.ts < 86400000).slice(0,50);
  localStorage.setItem('vb_stories', JSON.stringify(storiesData));
  // Re-render stories in feed
  const sb = document.getElementById('stories-bar-container');
  if(sb) sb.innerHTML = renderStoriesBar();
  toast('✅ Story published! Visible for 24h 👀');
}

function viewStory(idx){
  const now = Date.now();
  const active = storiesData.filter(s => now - s.ts < 86400000);
  const s = active[idx];
  if(!s) return;
  // Mark as seen
  const seenKey = 'vb_seen_stories_' + (currentUser?.email||'guest');
  const seen = JSON.parse(localStorage.getItem(seenKey)||'[]');
  if(!seen.includes(s.id)){ seen.push(s.id); localStorage.setItem(seenKey, JSON.stringify(seen)); }
  
  let overlay = document.getElementById('story-viewer-overlay');
  if(!overlay){
    overlay = document.createElement('div');
    overlay.id = 'story-viewer-overlay';
    overlay.className = 'story-viewer-overlay';
    document.body.appendChild(overlay);
  }
  overlay.innerHTML = `
    <div class="story-viewer-box">
      <div class="story-viewer-progress">
        ${active.map((_,i)=>`<div class="story-progress-bar"><div class="story-progress-fill" style="${i===idx?'':'width:100%'};${i>idx?'width:0':''};animation:${i===idx?'storyProgress 5s linear forwards':'none'}"></div></div>`).join('')}
      </div>
      <div class="story-viewer-header">
        <div style="display:flex;align-items:center;gap:8px;">
          <div style="width:32px;height:32px;border-radius:50%;background:${getAvatarColor(s.userId)};display:flex;align-items:center;justify-content:center;font-size:16px;">${s.emoji}</div>
          <div style="color:#fff;font-size:13px;font-weight:700;">${s.author}</div>
          <div style="color:rgba(255,255,255,0.5);font-size:11px;">${Math.round((Date.now()-s.ts)/60000)}min</div>
        </div>
        <button class="story-viewer-close" onclick="document.getElementById('story-viewer-overlay').className='story-viewer-overlay hidden'">✕</button>
      </div>
      <div class="story-content" onclick="${idx < active.length-1 ? `viewStory(${idx+1})` : `document.getElementById('story-viewer-overlay').className='story-viewer-overlay hidden'`}">
        <div style="padding:40px 28px;text-align:center;">
          <div style="font-size:48px;margin-bottom:20px;">${s.emoji}</div>
          <div style="font-size:20px;font-weight:700;color:#fff;line-height:1.5;">${s.text}</div>
          <div style="margin-top:20px;font-size:12px;color:rgba(255,255,255,0.5);">${s.author} · plan ${(s.plan||'free').toUpperCase()}</div>
        </div>
      </div>
    </div>`;
  overlay.className = 'story-viewer-overlay';
  // Auto-advance
  setTimeout(()=>{
    if(idx < active.length-1) viewStory(idx+1);
    else overlay.className = 'story-viewer-overlay hidden';
  }, 5000);
}

// ── 6. BOOST PAYANT ──
function openBoostMyPost(postId){
  if(!currentUser||currentUser.isDemo){openDemoSignupModal();return;}
  const credits = currentUser._credits||0;
  const options = [
    {label:'🔥 TOP 3 of Feed — 6h',    cost:50,  hours:6},
    {label:'⚡ TOP 1 of Feed — 12h',   cost:100, hours:12},
    {label:'💎 TOP 1 of Feed — 24h',   cost:180, hours:24},
  ];
  const modal = document.createElement('div');
  modal.id = 'boost-post-modal';
  modal.style.cssText = 'position:fixed;inset:0;background:rgba(4,10,5,0.94);backdrop-filter:blur(16px);z-index:9999;display:flex;align-items:center;justify-content:center;padding:20px;';
  modal.innerHTML = `
    <div style="background:var(--s1);border:2px solid rgba(255,215,0,0.4);border-radius:20px;padding:28px;max-width:380px;width:100%;position:relative;">
      <button onclick="document.getElementById('boost-post-modal').remove()" style="position:absolute;top:12px;right:12px;background:var(--s2);border:1px solid var(--border);border-radius:50%;width:28px;height:28px;cursor:pointer;color:var(--muted);">✕</button>
      <div style="font-family:'Bebas Neue',sans-serif;font-size:26px;letter-spacing:2px;color:var(--gold);margin-bottom:4px;">🚀 BOOSTER MA PUB</div>
      <div style="font-size:12px;color:var(--muted);margin-bottom:20px;">Boost your ad to the top of the feed. Use your ViralCredits.</div>
      <div style="font-family:'DM Mono',monospace;font-size:11px;color:var(--g3);margin-bottom:12px;">⚡ YOUR BALANCE: <strong>${credits} credits</strong></div>
      ${options.map((o,i)=>`
        <div class="boost-promo-card" onclick="applyBoostToPost('${postId}',${o.cost},${o.hours})" style="${credits<o.cost?'opacity:0.4;cursor:not-allowed':''}">
          <div style="display:flex;align-items:center;justify-content:space-between;">
            <div class="boost-promo-title">${o.label}</div>
            <div class="boost-promo-price">${o.cost}⚡</div>
          </div>
          <div class="boost-promo-desc">${credits<o.cost?'❌ Insufficient credits':'✅ Available — Click to activate'}</div>
        </div>`).join('')}
      <div style="font-size:11px;color:var(--muted2);text-align:center;margin-top:8px;">💡 Earn credits by posting, voting and referring</div>
    </div>`;
  document.body.appendChild(modal);
}

function applyBoostToPost(postId, cost, hours){
  if(!currentUser) return;
  const credits = currentUser._credits||0;
  if(credits < cost){ toast('❌ Insufficient credits!'); return; }
  addCredits(-cost);
  const post = feedPosts.find(p=>p.id===postId);
  if(post){
    post.boosted = true;
    post.boostEnd = Date.now() + hours*3600000;
    // Move to top
    feedPosts = feedPosts.filter(p=>p.id!==postId);
    feedPosts.unshift(post);
    buildFeed();
  }
  document.getElementById('boost-post-modal')?.remove();
  toast(`🚀 Ad boosted for ${hours}h to top of feed! -${cost}⚡`);
}

// ── 7. AFFILIATION ──
function renderAffiliationBox(u){
  const commissions = u.affiliateEarnings || 0;
  const clicks = u.affiliateClicks || 0;
  const conversions = u.affiliateConversions || 0;
  return `<div style="background:linear-gradient(135deg,rgba(168,85,247,0.08),rgba(139,92,246,0.04));border:1.5px solid rgba(168,85,247,0.25);border-radius:14px;padding:18px 20px;margin-bottom:16px;">
    <div style="font-family:'Bebas Neue',sans-serif;font-size:20px;letter-spacing:1.5px;color:#a855f7;margin-bottom:4px;">💜 PROGRAMME AFFILIATION</div>
    <div style="font-size:12px;color:var(--muted);line-height:1.6;margin-bottom:12px;">Gagne <strong style="color:#a855f7">20% commission</strong> on each upgrade via your link.</div>
    <div style="display:grid;grid-template-columns:1fr 1fr 1fr;gap:8px;margin-bottom:12px;">
      <div style="text-align:center;background:rgba(255,255,255,0.02);border:1px solid rgba(168,85,247,0.2);border-radius:8px;padding:10px 6px;">
        <div style="font-family:'Bebas Neue',sans-serif;font-size:22px;color:#a855f7;">${clicks}</div>
        <div style="font-size:10px;color:var(--muted);font-family:'DM Mono',monospace;">Clicks</div>
      </div>
      <div style="text-align:center;background:rgba(255,255,255,0.02);border:1px solid rgba(168,85,247,0.2);border-radius:8px;padding:10px 6px;">
        <div style="font-family:'Bebas Neue',sans-serif;font-size:22px;color:#a855f7;">${conversions}</div>
        <div style="font-size:10px;color:var(--muted);font-family:'DM Mono',monospace;">Conversions</div>
      </div>
      <div style="text-align:center;background:rgba(255,255,255,0.02);border:1px solid rgba(168,85,247,0.2);border-radius:8px;padding:10px 6px;">
        <div style="font-family:'Bebas Neue',sans-serif;font-size:22px;color:#a855f7;">${commissions}$</div>
        <div style="font-size:10px;color:var(--muted);font-family:'DM Mono',monospace;">Gains</div>
      </div>
    </div>
    <div style="display:flex;align-items:center;gap:8px;background:rgba(4,10,5,0.8);border:1.5px solid rgba(168,85,247,0.25);border-radius:8px;padding:10px 14px;">
      <span style="flex:1;font-family:'DM Mono',monospace;font-size:12px;color:#c4b5fd;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;">${getReferralLink(u)}?aff=1</span>
      <button onclick="copyAffiliateLink()" style="background:#a855f7;border:none;border-radius:6px;padding:6px 12px;font-size:11px;font-weight:700;color:#fff;cursor:pointer;white-space:nowrap;">📋 Copy</button>
    </div>
  </div>`;
}

function copyAffiliateLink(){
  const link = getReferralLink(currentUser) + '?aff=1';
  navigator.clipboard?.writeText(link).then(()=>toast('✅ Affiliate link copied!')).catch(()=>toast('✅ Copied!'));
}

// ── 8. GLOBAL SEARCH ──
let _searchOverlay = null;

function openSearch(){
  if(!document.getElementById('search-overlay')){
    document.body.insertAdjacentHTML('beforeend', `
      <div id="search-overlay" class="search-overlay hidden">
        <div class="search-input-row">
          <input id="search-big-input" class="search-big-input" placeholder="🔍 Search posts, profiles, groups..." oninput="runSearch(this.value)" />
          <button class="search-close-btn" onclick="closeSearch()">✕</button>
        </div>
        <div class="search-results" id="search-results-container">
          <div style="text-align:center;padding:40px;color:var(--muted);font-size:14px;">Start typing to search...</div>
        </div>
      </div>`);
  }
  const overlay = document.getElementById('search-overlay');
  overlay.classList.remove('hidden');
  setTimeout(()=>document.getElementById('search-big-input')?.focus(), 100);
}

function closeSearch(){
  document.getElementById('search-overlay')?.classList.add('hidden');
}

function searchGlobal(query){
  openSearch();
  setTimeout(()=>{
    const inp = document.getElementById('search-big-input');
    if(inp){ inp.value=query; runSearch(query); }
  }, 150);
}

function runSearch(query){
  const container = document.getElementById('search-results-container');
  if(!container) return;
  if(!query || query.length < 2){
    container.innerHTML = '<div style="text-align:center;padding:40px;color:var(--muted);font-size:14px;">Start typing...</div>';
    return;
  }
  const q = query.toLowerCase();
  
  // Search in posts
  const matchPosts = feedPosts.filter(p => 
    p.text?.toLowerCase().includes(q) || p.author?.toLowerCase().includes(q) || p.projName?.toLowerCase().includes(q)
  ).slice(0,5);
  
  // Search in accounts
  const accounts = _getAccounts ? _getAccounts() : {};
  const matchUsers = Object.values(accounts).filter(u =>
    u.name?.toLowerCase().includes(q) || u.username?.toLowerCase().includes(q) || u.niche?.toLowerCase().includes(q) || u.bio?.toLowerCase().includes(q)
  ).slice(0,5);

  let html = '';
  if(matchUsers.length){
    html += `<div class="search-section-title">👤 Profiles (${matchUsers.length})</div>`;
    html += matchUsers.map(u=>`
      <div class="search-result-item" onclick="closeSearch();viewUserProfile('${u.email}')">
        <div class="search-result-ava" style="background:${getAvatarColor(u.email)}">${u.avatar||u.name?.[0]||'?'}</div>
        <div>
          <div class="search-result-name">${u.name||u.email} ${getVerifiedBadge(u)}</div>
          <div class="search-result-sub">@${u.username||'—'} · ${u.niche||'Creator'}</div>
        </div>
      </div>`).join('');
  }
  if(matchPosts.length){
    html += `<div class="search-section-title">📢 Posts (${matchPosts.length})</div>`;
    html += matchPosts.map(p=>`
      <div class="search-result-item">
        <div class="search-result-ava" style="background:${getAvatarColor(p.userId)}">${p.emoji||p.author?.[0]||'?'}</div>
        <div>
          <div class="search-result-name">${p.author}</div>
          <div class="search-result-sub">${(p.text||'').slice(0,70)}...</div>
        </div>
      </div>`).join('');
  }
  if(!html) html = `<div style="text-align:center;padding:40px;color:var(--muted);">No results for "<strong>${query}</strong>"</div>`;
  container.innerHTML = html;
}

// ── 9. MODE CLAIR ──
function toggleTheme(){
  document.body.classList.toggle('light-mode');
  const isLight = document.body.classList.contains('light-mode');
  localStorage.setItem('vb_theme', isLight?'light':'dark');
  if(currentUser){ currentUser.theme = isLight?'light':'dark'; _saveAccount&&_saveAccount(currentUser); }
}

function applyTheme(){
  const saved = localStorage.getItem('vb_theme') || currentUser?.theme;
  if(saved === 'light') document.body.classList.add('light-mode');
  else document.body.classList.remove('light-mode');
}

// ── 10. SHAREABLE PUBLIC PROFILE ──
function getPublicProfileUrl(u){
  const base = window.location.origin + window.location.pathname;
  return base + '?u=' + encodeURIComponent(u.username || u.email.split('@')[0]);
}

function shareMyProfile(){
  if(!currentUser) return;
  const url = getPublicProfileUrl(currentUser);
  if(navigator.share){
    navigator.share({title:'My ViralBoost profile', text:'Check out my profile on ViralBoost!', url}).catch(()=>{});
  } else {
    navigator.clipboard?.writeText(url).then(()=>toast('✅ Profile link copied!')).catch(()=>toast('✅ Copied!'));
  }
}

function checkPublicProfileParam(){
  const params = new URLSearchParams(window.location.search);
  const username = params.get('u');
  if(username && !currentUser){
    // Show public profile preview
    const accounts = _getAccounts ? _getAccounts() : {};
    const u = Object.values(accounts).find(a => 
      a.username?.toLowerCase() === username.toLowerCase() || 
      a.email.split('@')[0].toLowerCase() === username.toLowerCase()
    );
    if(u) setTimeout(()=>viewUserProfile(u.email), 500);
  }
}

// ── 11. SEARCH IN APP BAR ──
function injectSearchBtn(){
  const appRight = document.querySelector('.app-right');
  if(appRight && !document.getElementById('global-search-btn')){
    const btn = document.createElement('button');
    btn.id = 'global-search-btn';
    btn.style.cssText = 'background:var(--s1);border:1.5px solid var(--border2);border-radius:7px;padding:6px 12px;cursor:pointer;color:var(--muted);font-size:13px;display:flex;align-items:center;gap:5px;transition:all 0.2s;';
    btn.innerHTML = '🔍 <span style="font-size:11px;font-family:DM Mono,monospace;">Search</span>';
    btn.onmouseover = ()=>{ btn.style.borderColor='var(--g3)'; btn.style.color='var(--g3)'; };
    btn.onmouseout = ()=>{ btn.style.borderColor='var(--border2)'; btn.style.color='var(--muted)'; };
    btn.onclick = openSearch;
    appRight.insertBefore(btn, appRight.firstChild);
  }
}

// ── 12. THEME TOGGLE IN PROFILE ──
function renderThemeToggle(){
  const isLight = document.body.classList.contains('light-mode');
  return `<div style="display:flex;align-items:center;justify-content:space-between;padding:12px 16px;background:var(--s1);border:1.5px solid var(--border2);border-radius:10px;margin-bottom:10px;">
    <div style="display:flex;align-items:center;gap:8px;">
      <span style="font-size:16px">${isLight?'☀️':'🌙'}</span>
      <div>
        <div style="font-size:13px;font-weight:600;">${isLight?'Light mode':'Dark mode'}</div>
        <div style="font-size:11px;color:var(--muted);">Click to change</div>
      </div>
    </div>
    <div class="theme-toggle" onclick="toggleTheme();renderMyProfile();">
      <div class="theme-toggle-track"><div class="theme-toggle-thumb"></div></div>
    </div>
  </div>`;
}

// ── INIT NEW FEATURES ──
document.addEventListener('DOMContentLoaded', function(){
  applyTheme();
  checkPublicProfileParam();
});

</script>

<!-- ═══ WRAPPED PREVIEW MODAL ═══ -->
<div id="wrapped-preview-modal" style="display:none;position:fixed;inset:0;background:rgba(4,10,5,0.95);backdrop-filter:blur(20px);z-index:9000;align-items:center;justify-content:center;padding:20px;">
  <div style="background:linear-gradient(160deg,#061a09,#0f3016,#061a09);border:1.5px solid rgba(34,197,94,0.4);border-radius:24px;padding:36px;max-width:340px;width:100%;position:relative;animation:popIn 0.4s cubic-bezier(0.34,1.56,0.64,1);">
    <button onclick="closeWrappedPreview()" style="position:absolute;top:14px;right:14px;background:rgba(255,255,255,0.08);border:1px solid rgba(255,255,255,0.12);border-radius:50%;width:30px;height:30px;cursor:pointer;color:#fff;font-size:13px;display:flex;align-items:center;justify-content:center;">✕</button>
    <div style="font-family:'DM Mono',monospace;font-size:9px;letter-spacing:3px;color:var(--g3);text-transform:uppercase;margin-bottom:4px;opacity:0.7;">ViralBoost</div>
    <div style="font-family:'Bebas Neue',sans-serif;font-size:11px;letter-spacing:5px;color:rgba(255,255,255,0.25);margin-bottom:20px;">2025 · MY YEAR</div>
    <div style="font-family:'Bebas Neue',sans-serif;font-size:72px;color:var(--g3);text-shadow:0 0 30px rgba(34,197,94,0.5);line-height:1;margin-bottom:4px;">47</div>
    <div style="font-size:13px;font-weight:700;color:rgba(255,255,255,0.6);margin-bottom:16px;">collaborations found</div>
    <div style="height:1px;background:rgba(255,255,255,0.08);margin-bottom:16px;"></div>
    <div style="display:flex;gap:6px;flex-wrap:wrap;margin-bottom:18px;">
      <span style="background:rgba(34,197,94,0.12);color:var(--g4);border:1px solid rgba(34,197,94,0.2);border-radius:10px;padding:3px 10px;font-size:10px;font-family:'DM Mono',monospace;">SaaS</span>
      <span style="background:rgba(34,197,94,0.12);color:var(--g4);border:1px solid rgba(34,197,94,0.2);border-radius:10px;padding:3px 10px;font-size:10px;font-family:'DM Mono',monospace;">Growth</span>
      <span style="background:rgba(34,197,94,0.12);color:var(--g4);border:1px solid rgba(34,197,94,0.2);border-radius:10px;padding:3px 10px;font-size:10px;font-family:'DM Mono',monospace;">Creator</span>
    </div>
    <div style="font-size:11px;color:rgba(255,255,255,0.2);font-family:'DM Mono',monospace;margin-bottom:14px;letter-spacing:1px;text-align:center;">viralboost.io · JOIN FREE</div>
    <div style="display:flex;gap:8px;margin-bottom:10px;">
      <button onclick="copyWrappedLink()" style="flex:1;padding:11px;border:1.5px solid rgba(255,255,255,0.15);border-radius:10px;background:rgba(255,255,255,0.06);font-family:'Plus Jakarta Sans',sans-serif;font-size:12px;font-weight:700;cursor:pointer;color:#fff;">📋 Copy link</button>
      <button onclick="shareWrappedNative()" style="flex:1;padding:11px;border:1.5px solid rgba(255,255,255,0.15);border-radius:10px;background:rgba(255,255,255,0.06);font-family:'Plus Jakarta Sans',sans-serif;font-size:12px;font-weight:700;cursor:pointer;color:#fff;">↗ Share</button>
    </div>
    <div style="height:1px;background:rgba(255,255,255,0.06);margin-bottom:12px;"></div>
    <div style="text-align:center;font-size:11px;color:rgba(255,255,255,0.3);margin-bottom:10px;">✨ Generate your real card with your stats</div>
    <button onclick="closeWrappedPreview();openModal('signup-modal')" style="width:100%;padding:13px;background:linear-gradient(135deg,var(--g1),var(--g2));border:none;border-radius:10px;font-family:'Plus Jakarta Sans',sans-serif;font-size:14px;font-weight:800;cursor:pointer;color:var(--bg);box-shadow:0 0 24px rgba(34,197,94,0.35);">Create my free account</button>
  </div>
</div>

<script>
// ═══ LIVE TICKER ═══
(function(){
  const events = [
    '🇫🇷 <strong>Lucas M.</strong> just posted an ad · SaaS',
    '🇺🇸 <strong>Sarah C.</strong> found a collab · TikTok',
    '🇩🇪 <strong>Max K.</strong> just joined the community',
    '🇧🇷 <strong>Ana L.</strong> earned 200 ViralCredits via referral 🎁',
    '🇯🇵 <strong>Kenji T.</strong> just posted an ad · Mobile App',
    '🇪🇸 <strong>Carlos R.</strong> shared his Creator Card ✨',
    '🇮🇹 <strong>Marco B.</strong> just joined · PRO Plan',
    '🇬🇧 <strong>Emma W.</strong> found 3 new collabs this week',
    '🇳🇱 <strong>Daan V.</strong> invited 5 friends → 1 month PRO free 🏆',
    '🇸🇦 <strong>Yusuf A.</strong> just posted an ad · E-commerce',
  ];
  let current = 0;
  const inner = document.getElementById('ticker-inner');
  if(!inner) return;

  function buildItem(text){
    const d = document.createElement('div');
    d.style.cssText = 'height:36px;display:flex;align-items:center;padding:0 16px;background:rgba(11,26,13,0.85);border:1px solid rgba(34,197,94,0.18);border-radius:8px;font-size:12px;color:rgba(240,253,244,0.75);font-family:Plus Jakarta Sans,sans-serif;white-space:nowrap;gap:8px;flex-shrink:0;';
    d.innerHTML = '<span style="width:6px;height:6px;border-radius:50%;background:var(--g3);display:inline-block;box-shadow:0 0 5px var(--g3);animation:blink 2s infinite;flex-shrink:0;"></span>' + text + '<span style="font-family:DM Mono,monospace;font-size:9px;color:var(--muted);margin-left:auto;padding-left:12px;flex-shrink:0;">' + (Math.floor(Math.random()*55)+5) + 's ago</span>';
    return d;
  }

  inner.appendChild(buildItem(events[0]));
  inner.appendChild(buildItem(events[1]));

  setInterval(function(){
    current = (current + 1) % events.length;
    const newItem = buildItem(events[current]);
    newItem.style.opacity = '0';
    newItem.style.transform = 'translateY(10px)';
    newItem.style.transition = 'opacity 0.4s,transform 0.4s';
    inner.appendChild(newItem);
    requestAnimationFrame(function(){ requestAnimationFrame(function(){
      newItem.style.opacity = '1';
      newItem.style.transform = 'translateY(0)';
    }); });
    if(inner.children.length > 2){
      var old = inner.children[0];
      old.style.transition = 'opacity 0.3s,transform 0.3s';
      old.style.opacity = '0';
      old.style.transform = 'translateY(-10px)';
      setTimeout(function(){ old.remove(); }, 320);
    }
  }, 3200);
})();

// ═══ WRAPPED PREVIEW ═══
function openWrappedPreview(){
  var m = document.getElementById('wrapped-preview-modal');
  m.style.display = 'flex';
}
function closeWrappedPreview(){
  document.getElementById('wrapped-preview-modal').style.display = 'none';
}
document.addEventListener('click',function(e){
  var m = document.getElementById('wrapped-preview-modal');
  if(m && e.target === m) closeWrappedPreview();
});
function copyWrappedLink(){
  var url = window.location.origin + window.location.pathname + '?ref=wrapped';
  navigator.clipboard && navigator.clipboard.writeText(url).then(function(){ typeof toast==='function' && toast('📋 Lien copié !'); });
}
function shareWrappedNative(){
  var url = window.location.origin + window.location.pathname;
  if(navigator.share){ navigator.share({title:'Ma ViralBoost 2025 Recap 🚀',text:'Regarde mes stats creator sur ViralBoost !',url:url}).catch(function(){}); }
  else { copyWrappedLink(); }
}

// ═══ REFERRAL ═══
function copyReferralLink(){
  if(typeof currentUser !== 'undefined' && currentUser){
    var id = currentUser.username || currentUser.email.split('@')[0];
    var link = window.location.origin + window.location.pathname + '?ref=' + encodeURIComponent(id);
    navigator.clipboard && navigator.clipboard.writeText(link).then(function(){ typeof toast==='function' && toast('🎁 Referral link copied!'); });
  } else {
    typeof openModal === 'function' && openModal('signup-modal');
  }
}
(function(){
  var ref = new URLSearchParams(window.location.search).get('ref');
  if(ref && ref !== 'wrapped') sessionStorage.setItem('vb_referrer', ref);
})();

// ═══════════════════════════════════════
// ⭐ REVIEWS SYSTEM
// ═══════════════════════════════════════
var _selectedStar = 0;

function _getReviews(){
  try { return JSON.parse(localStorage.getItem('vb_reviews')||'[]'); } catch(e){ return []; }
}
function _saveReviews(arr){
  localStorage.setItem('vb_reviews', JSON.stringify(arr));
}

function renderReviews(){
  var reviews = _getReviews();
  // Global score
  var avg = reviews.length ? (reviews.reduce(function(s,r){ return s+r.stars; },0)/reviews.length).toFixed(1) : '—';
  var scoreEl = document.getElementById('rv-global-score');
  var countEl = document.getElementById('rv-total-count');
  if(scoreEl) scoreEl.textContent = avg;
  if(countEl) countEl.textContent = reviews.length + (reviews.length===1?' review':' reviews');

  // Distribution bars
  var barsEl = document.getElementById('rv-bars');
  if(barsEl){
    var html = '';
    for(var s=5;s>=1;s--){
      var count = reviews.filter(function(r){ return r.stars===s; }).length;
      var pct = reviews.length ? Math.round(count/reviews.length*100) : 0;
      html += '<div style="display:flex;align-items:center;gap:10px;margin-bottom:8px;">'
        +'<div style="font-family:\'DM Mono\',monospace;font-size:11px;color:var(--g4);width:14px;text-align:right;flex-shrink:0;">'+s+'</div>'
        +'<div style="color:#facc15;font-size:12px;flex-shrink:0;">★</div>'
        +'<div style="flex:1;height:8px;background:var(--s3);border-radius:4px;overflow:hidden;">'
        +'<div style="height:100%;width:'+pct+'%;background:linear-gradient(90deg,var(--g2),var(--g3));border-radius:4px;transition:width 0.6s ease;"></div>'
        +'</div>'
        +'<div style="font-family:\'DM Mono\',monospace;font-size:10px;color:var(--muted);width:28px;text-align:right;flex-shrink:0;">'+count+'</div>'
        +'</div>';
    }
    barsEl.innerHTML = html;
  }

  // Reviews list
  var listEl = document.getElementById('rv-list');
  if(!listEl) return;
  if(!reviews.length){
    listEl.innerHTML = '<div style="text-align:center;padding:48px 0;color:var(--muted);font-size:13px;">No reviews yet — be the first to share your experience!</div>';
    return;
  }
  listEl.innerHTML = reviews.slice().reverse().map(function(r){
    var stars = '';
    for(var i=1;i<=5;i++) stars += '<span style="color:'+(i<=r.stars?'#facc15':'var(--border)')+';">★</span>';
    var date = new Date(r.date).toLocaleDateString('en-US',{year:'numeric',month:'short',day:'numeric'});
    var planBadge = r.plan && r.plan!=='free'
      ? '<span style="background:var(--g2);color:var(--bg);font-family:\'DM Mono\',monospace;font-size:8px;font-weight:700;padding:2px 6px;border-radius:3px;letter-spacing:1px;margin-left:6px;">'+r.plan.toUpperCase()+'</span>'
      : '';
    return '<div style="background:var(--s1);border:1.5px solid var(--border2);border-radius:12px;padding:18px 20px;margin-bottom:12px;transition:border-color 0.2s;" onmouseover="this.style.borderColor=\'rgba(34,197,94,0.25)\'" onmouseout="this.style.borderColor=\'var(--border2)\'">'
      +'<div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:10px;flex-wrap:wrap;gap:8px;">'
      +'<div style="display:flex;align-items:center;gap:10px;">'
      +'<div style="width:38px;height:38px;border-radius:50%;background:'+r.color+';display:flex;align-items:center;justify-content:center;font-size:16px;font-weight:700;color:var(--bg);flex-shrink:0;">'+r.initial+'</div>'
      +'<div>'
      +'<div style="font-size:13px;font-weight:700;color:var(--white);">'+r.name+planBadge+'</div>'
      +'<div style="font-size:11px;color:var(--muted);">@'+r.username+'</div>'
      +'</div>'
      +'</div>'
      +'<div style="display:flex;flex-direction:column;align-items:flex-end;gap:3px;">'
      +'<div style="font-size:15px;letter-spacing:2px;">'+stars+'</div>'
      +'<div style="font-family:\'DM Mono\',monospace;font-size:9px;color:var(--muted2);">'+date+'</div>'
      +'</div>'
      +'</div>'
      +'<div style="font-size:13px;color:#c4d9cb;line-height:1.75;">'+r.comment+'</div>'
      +'</div>';
  }).join('');
}

function openWriteReview(){
  if(typeof currentUser==='undefined'||!currentUser){ typeof openModal==='function'&&openModal('signup-modal'); return; }
  var reviews = _getReviews();
  var alreadyReviewed = reviews.some(function(r){ return r.userId===currentUser.email; });
  if(alreadyReviewed){ typeof toast==='function'&&toast('⭐ You have already left a review. Thank you!'); return; }
  var box = document.getElementById('rv-form-box');
  var btn = document.getElementById('rv-write-section');
  if(box) box.style.display='block';
  if(btn) btn.style.display='none';
  _selectedStar=0;
  updateStarPicker(0);
}

function closeWriteReview(){
  var box = document.getElementById('rv-form-box');
  var btn = document.getElementById('rv-write-section');
  if(box) box.style.display='none';
  if(btn) btn.style.display='block';
  _selectedStar=0;
}

function setReviewStar(n){
  _selectedStar=n;
  updateStarPicker(n);
}

function hoverStar(n){
  updateStarPicker(n, true);
}

function unhoverStar(){
  updateStarPicker(_selectedStar);
}

function updateStarPicker(n, hover){
  var stars = document.querySelectorAll('#rv-star-picker span');
  stars.forEach(function(s,i){
    var active = i < n;
    s.style.color = active ? '#facc15' : 'var(--muted)';
    s.style.opacity = active ? '1' : '0.35';
    s.style.transform = hover && active ? 'scale(1.2)' : 'scale(1)';
  });
}

var _AVATAR_COLORS = ['#16a34a','#2563eb','#7c3aed','#ea580c','#0891b2','#be185d','#d97706','#059669'];

function submitReview(){
  if(!currentUser){ typeof openModal==='function'&&openModal('signup-modal'); return; }
  if(!_selectedStar){ typeof toast==='function'&&toast('⭐ Please select a star rating.'); return; }
  var comment = (document.getElementById('rv-comment-input')||{}).value||'';
  if(comment.trim().length < 10){ typeof toast==='function'&&toast('✏️ Please write at least 10 characters.'); return; }

  var reviews = _getReviews();
  var color = _AVATAR_COLORS[Math.floor(Math.random()*_AVATAR_COLORS.length)];
  reviews.push({
    userId: currentUser.email,
    name: currentUser.name || currentUser.email.split('@')[0],
    username: currentUser.username || currentUser.email.split('@')[0],
    initial: (currentUser.name||currentUser.email)[0].toUpperCase(),
    color: color,
    stars: _selectedStar,
    comment: comment.trim(),
    plan: currentUser.plan||'free',
    date: new Date().toISOString()
  });
  _saveReviews(reviews);
  closeWriteReview();
  renderReviews();
  typeof toast==='function'&&toast('✅ Review published! Thank you.');
}

// Auto-render reviews when tab opened — hooked into existing showAppTab patch above
</script>

<style>
@keyframes counterPop{0%{transform:scale(1)}50%{transform:scale(1.3)}100%{transform:scale(1)}}
.counter-pop{animation:counterPop 0.4s ease;}

/* ── FLASH OFFER BAR ── */
.flash-offer-bar {
  position:fixed;
  bottom:72px;
  left:50%;
  transform:translateX(-50%) translateY(80px);
  width:calc(100% - 24px);
  max-width:440px;
  z-index:1000;
  opacity:0;
  transition:all 0.5s cubic-bezier(0.34,1.2,0.64,1);
  pointer-events:none;
}
.flash-offer-bar.visible {
  transform:translateX(-50%) translateY(0);
  opacity:1;
  pointer-events:all;
}
.flash-offer-bar-inner {
  background:linear-gradient(135deg,#1a0e00,#2d1800,#1a0a00);
  border:1.5px solid rgba(255,215,0,0.6);
  border-radius:14px;
  padding:12px 14px;
  display:flex;
  align-items:center;
  gap:10px;
  box-shadow:0 -4px 30px rgba(255,215,0,0.25),0 8px 30px rgba(0,0,0,0.5);
  position:relative;
  overflow:hidden;
}
.flash-offer-bar-inner::before {
  content:'';
  position:absolute;
  inset:0;
  background:repeating-linear-gradient(90deg,transparent,transparent 40px,rgba(255,215,0,0.03) 40px,rgba(255,215,0,0.03) 41px);
  pointer-events:none;
}
.flash-offer-pulse {
  width:8px;height:8px;border-radius:50%;background:#ffd700;
  box-shadow:0 0 10px #ffd700;
  flex-shrink:0;
  animation:blink 1s infinite;
}
</style>

<script>
// ═══ COMPTEUR LIVE ANIMÉ ═══
(function(){
  var base = 4231;
  var el = document.getElementById('hero-counter');
  if(!el) return;
  // Animate count up on load
  var start = base - 47;
  var end = base;
  var dur = 1800;
  var startTime = null;
  function easeOut(t){ return 1 - Math.pow(1-t, 3); }
  function tick(ts){
    if(!startTime) startTime = ts;
    var progress = Math.min((ts - startTime) / dur, 1);
    var val = Math.floor(start + (end - start) * easeOut(progress));
    el.textContent = val.toLocaleString('en-US');
    if(progress < 1) requestAnimationFrame(tick);
  }
  requestAnimationFrame(tick);
  // Increment randomly every 8-20s
  setInterval(function(){
    base += Math.floor(Math.random() * 3) + 1;
    el.textContent = base.toLocaleString('en-US');
    el.classList.remove('counter-pop');
    void el.offsetWidth;
    el.classList.add('counter-pop');
  }, Math.random() * 12000 + 8000);
})();

</script>

<script>
// ══════════════════════════════════════
//  HOME TAB — Creator Card + Deals
// ══════════════════════════════════════

function renderHomeTab() {
  updateCreatorCard();
  renderHomeGreeting();
  renderCreatorCardSection();
  renderFeaturedCreators();
  // Update feed composer avatar with first letter of user name
  if(typeof currentUser !== 'undefined' && currentUser) {
    const pubAva = document.getElementById('feed-pub-ava');
    if(pubAva) {
      if(currentUser.avatarUrl) {
        pubAva.innerHTML = `<img src="${currentUser.avatarUrl}" style="width:36px;height:36px;border-radius:50%;object-fit:cover;">`;
      } else {
        pubAva.textContent = (currentUser.name || currentUser.username || 'C')[0].toUpperCase();
        pubAva.style.background = 'var(--g2)';
        pubAva.style.fontFamily = "'Bebas Neue', sans-serif";
        pubAva.style.fontSize = '16px';
        pubAva.style.fontWeight = '800';
        pubAva.style.color = 'var(--bg)';
      }
    }
  }
}

function renderFeaturedCreators() {
  const carousel = document.getElementById('featured-creators-carousel');
  if (!carousel) return;

  // Gather VIP/Elite users from accounts + fake pool
  const accounts = _getAccounts ? _getAccounts() : {};
  let featured = Object.values(accounts).filter(u =>
    u.plan === 'vip' || u.plan === 'elite' || u.plan === 'legend'
  );

  // Pad with fake VIP creators if not enough real ones
  const FAKE_VIP = [
    { name: 'Alex Rivera', username: 'alex_r', plan: 'vip', niche: 'SaaS & Growth', bio: 'Building the next-gen CRM for solopreneurs. 10k+ users in 6 months.', followers: 4820, votes: 312 },
    { name: 'Sophie Chen', username: 'sophie_c', plan: 'elite', niche: 'E-commerce', bio: 'Dropshipping coach. Generated $2M+ in sales. DM for collab.', followers: 7340, votes: 521 },
    { name: 'Marcus Osei', username: 'marcus_o', plan: 'vip', niche: 'AI Tools', bio: 'Building AI micro-tools that make creators 10x faster.', followers: 3200, votes: 198 },
    { name: 'Luna Park', username: 'luna_p', plan: 'elite', niche: 'Content Creator', bio: '1M views/month on TikTok. Looking for brand collabs.', followers: 12400, votes: 874 },
    { name: 'Jordan West', username: 'jordan_w', plan: 'legend', niche: 'Web3 & NFT', bio: 'Web3 consultant. 5 successful launches. Let\'s build together.', followers: 9100, votes: 640 },
  ];

  const all = [...featured, ...FAKE_VIP].slice(0, 8);

  if (!all.length) { carousel.parentElement.style.display = 'none'; return; }
  carousel.parentElement.style.display = 'block';

  const planColors = {
    vip:    { border: 'rgba(255,215,0,0.6)',    glow: 'rgba(255,215,0,0.15)',    badge: '#ffd700',    bg: 'linear-gradient(135deg,#1c1400,#120e00)', icon: '💎' },
    elite:  { border: 'rgba(168,85,247,0.6)',   glow: 'rgba(168,85,247,0.12)',   badge: '#c084fc',    bg: 'linear-gradient(135deg,#160a28,#0e0518)', icon: '👑' },
    legend: { border: 'rgba(249,115,22,0.6)',   glow: 'rgba(249,115,22,0.12)',   badge: '#fb923c',    bg: 'linear-gradient(135deg,#2d1000,#1a0800)', icon: '🔥' },
  };

  carousel.innerHTML = all.map(u => {
    const pc = planColors[u.plan] || planColors.vip;
    const ava = u.avatarUrl
      ? `<img src="${u.avatarUrl}" style="width:44px;height:44px;border-radius:50%;object-fit:cover;border:2px solid ${pc.badge};">`
      : `<div style="width:44px;height:44px;border-radius:50%;background:linear-gradient(135deg,#052e16,#0b3d1e);border:2px solid ${pc.badge};display:flex;align-items:center;justify-content:center;font-size:20px;font-weight:800;color:${pc.badge};font-family:'Bebas Neue',sans-serif;flex-shrink:0;">${(u.name||u.username||'?')[0].toUpperCase()}</div>`;
    const followers = u.followers ? (u.followers > 999 ? (u.followers/1000).toFixed(1)+'k' : u.followers) : '0';
    const pitch = (u.bio || u.niche || 'Creator on ViralBoost').slice(0, 72);
    const isDM = currentUser && !currentUser.isDemo;

    return `<div style="flex-shrink:0;width:220px;background:${pc.bg};border:1.5px solid ${pc.border};border-radius:16px;padding:16px;display:flex;flex-direction:column;gap:10px;box-shadow:0 0 18px ${pc.glow},0 4px 20px rgba(0,0,0,0.4);position:relative;overflow:hidden;">
      <!-- glow top -->
      <div style="position:absolute;top:-30px;right:-30px;width:80px;height:80px;border-radius:50%;background:radial-gradient(circle,${pc.glow} 0%,transparent 70%);pointer-events:none;"></div>
      <!-- header -->
      <div style="display:flex;align-items:center;gap:10px;">
        ${ava}
        <div style="flex:1;min-width:0;">
          <div style="font-family:'Plus Jakarta Sans',sans-serif;font-size:13px;font-weight:800;color:#f0fdf4;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;">${u.name || u.username}</div>
          <div style="display:flex;align-items:center;gap:4px;margin-top:2px;">
            <span style="font-size:10px;">${pc.icon}</span>
            <span style="font-family:'DM Mono',monospace;font-size:8px;font-weight:700;color:${pc.badge};letter-spacing:1px;">${(u.plan||'VIP').toUpperCase()}</span>
          </div>
        </div>
      </div>
      <!-- niche tag -->
      ${u.niche ? `<div style="font-family:'DM Mono',monospace;font-size:8px;color:${pc.badge};background:${pc.glow};border:1px solid ${pc.border};border-radius:5px;padding:2px 8px;display:inline-block;letter-spacing:1px;width:fit-content;">${u.niche.toUpperCase()}</div>` : ''}
      <!-- pitch -->
      <div style="font-size:11px;color:#a0b8a8;line-height:1.5;flex:1;">${pitch}${pitch.length >= 72 ? '…' : ''}</div>
      <!-- footer -->
      <div style="display:flex;align-items:center;justify-content:space-between;margin-top:2px;">
        <div style="font-family:'DM Mono',monospace;font-size:9px;color:var(--muted);">👥 ${followers}</div>
        <button onclick="${isDM ? `openDMToUser('${u.email||u.username}','${(u.name||u.username).replace(/'/g,"\\'")}')` : "openModal('signup-modal')"}" style="padding:5px 12px;background:${pc.bg};border:1.5px solid ${pc.border};border-radius:7px;font-family:'DM Mono',monospace;font-size:9px;font-weight:700;color:${pc.badge};cursor:pointer;letter-spacing:1px;transition:all 0.2s;" onmouseover="this.style.background='${pc.glow}'" onmouseout="this.style.background='transparent'">💬 DM</button>
      </div>
    </div>`;
  }).join('');
}

function renderHomeGreeting() {
  var el = document.getElementById('home-greeting');
  if (!el) return;
  var hour = new Date().getHours();
  var greet = hour < 12 ? 'GOOD MORNING' : hour < 18 ? 'GOOD AFTERNOON' : 'GOOD EVENING';
  var name = (typeof currentUser !== 'undefined' && currentUser && currentUser.name)
    ? ' · ' + currentUser.name.split(' ')[0].toUpperCase() : '';
  el.textContent = greet + name;
}

function updateCreatorCard() {
  if (typeof currentUser === 'undefined' || !currentUser) return;
  var u = currentUser;
  var avaEl = document.getElementById('cc-avatar');
  if (avaEl) avaEl.textContent = (u.name || u.username || 'C')[0].toUpperCase();
  var nameEl = document.getElementById('cc-name');
  if (nameEl) nameEl.textContent = (u.name || 'CREATOR').toUpperCase();
  var unEl = document.getElementById('cc-username');
  if (unEl) unEl.textContent = '@' + (u.username || (u.email||'').split('@')[0]);
  var planEl = document.getElementById('cc-plan-badge');
  if (planEl) {
    var plan = (u.plan || 'free').toUpperCase();
    var planColors = {FREE:'var(--g3)',PRO:'#60a5fa',ELITE:'#ffd700',VIP:'#ffd700',LEGEND:'#f97316'};
    planEl.textContent = plan; planEl.style.color = planColors[plan]||'var(--g3)';
  }
  var posts = []; try { posts = JSON.parse(localStorage.getItem('vb_posts') || '[]'); } catch(e) {}
  var myP = posts.filter(function(p){ return p.userId === u.email; });
  var myV = myP.reduce(function(a,p){ return a+(p.votes||0); }, 0);
  var serial = 0; var em = u.email||''; for(var i=0;i<em.length;i++) serial=((serial*31)+em.charCodeAt(i))&0xffff;
  var d = document;
  if(d.getElementById('cc-posts')) d.getElementById('cc-posts').textContent = myP.length;
  if(d.getElementById('cc-votes')) d.getElementById('cc-votes').textContent = myV;
  if(d.getElementById('cc-followers')) d.getElementById('cc-followers').textContent = (u.followers||[]).length;
  if(d.getElementById('cc-serial')) d.getElementById('cc-serial').textContent = '#VB-'+String(serial).padStart(4,'0');
  if(d.getElementById('cc-rank')) d.getElementById('cc-rank').textContent = myV>500?'🥇':myV>100?'🥈':myV>20?'🥉':'—';
}

// ── CREATOR CARD SECTION ──
function renderCreatorCardSection() {
  var el = document.getElementById('home-creator-card-section');
  if (!el) return;
  var u = (typeof currentUser !== 'undefined' && currentUser) ? currentUser : null;
  var hasCard = u && (u.plan === 'pro' || u.plan === 'elite' || u.plan === 'vip' || u.plan === 'legend' || u.creatorCard);
  if (!hasCard) {
    el.innerHTML = '<div style="background:rgba(255,255,255,0.02);border:1.5px dashed rgba(34,197,94,0.2);border-radius:14px;padding:20px 18px;display:flex;align-items:center;gap:14px;">'
      + '<div style="font-size:36px;flex-shrink:0;filter:grayscale(1);opacity:0.35;">🪪</div>'
      + '<div><div style="font-family:\'Bebas Neue\',sans-serif;font-size:16px;letter-spacing:1.5px;color:#4a7a58;margin-bottom:3px;">CREATOR CARD</div>'
      + '<div style="font-size:11px;color:#2d5a3a;line-height:1.5;">You do not own a Creator Card. Upgrade to PRO or higher to get your shareable Creator Card.</div></div>'
      + '</div>';
    return;
  }
  var serial = 0; var em = u.email||''; for(var i=0;i<em.length;i++) serial=((serial*31)+em.charCodeAt(i))&0xffff;
  var posts = []; try { posts = JSON.parse(localStorage.getItem('vb_posts') || '[]'); } catch(e) {}
  var myP = posts.filter(function(p){ return p.userId === u.email; });
  var myV = myP.reduce(function(a,p){ return a+(p.votes||0); }, 0);
  var plan = (u.plan || 'free').toUpperCase();
  var planColors = {FREE:'var(--g3)',PRO:'#60a5fa',ELITE:'#ffd700',VIP:'#ffd700',LEGEND:'#f97316'};
  var planColor = planColors[plan] || 'var(--g3)';
  var rank = myV>500?'🥇':myV>100?'🥈':myV>20?'🥉':'—';
  el.innerHTML = '<div style="background:linear-gradient(135deg,#0b1a0d,#0f2312);border:1.5px solid rgba(34,197,94,0.3);border-radius:14px;padding:16px 18px;position:relative;overflow:hidden;box-shadow:0 4px 20px rgba(0,0,0,0.4);">'
    + '<div style="position:absolute;inset:0;background:radial-gradient(ellipse at 80% 20%,rgba(34,197,94,0.05) 0%,transparent 60%);pointer-events:none;"></div>'
    + '<div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:12px;">'
    + '<div style="font-family:\'DM Mono\',monospace;font-size:8px;letter-spacing:2px;color:var(--muted);">CREATOR CARD · #VB-'+String(serial).padStart(4,'0')+'</div>'
    + '<div style="font-family:\'DM Mono\',monospace;font-size:8px;font-weight:700;color:'+planColor+';background:rgba(255,255,255,0.05);border:1px solid '+planColor+'33;border-radius:3px;padding:2px 7px;letter-spacing:1px;">'+plan+'</div>'
    + '</div>'
    + '<div style="display:flex;align-items:center;gap:12px;margin-bottom:12px;">'
    + '<div style="width:48px;height:48px;border-radius:50%;background:linear-gradient(135deg,var(--g1),var(--g3));display:flex;align-items:center;justify-content:center;font-size:20px;font-weight:700;color:var(--bg);flex-shrink:0;box-shadow:0 0 14px rgba(34,197,94,0.3);">'+(u.name||u.username||'C')[0].toUpperCase()+'</div>'
    + '<div><div style="font-family:\'Bebas Neue\',sans-serif;font-size:20px;letter-spacing:1.5px;color:#f0fdf4;line-height:1;">'+(u.name||'CREATOR').toUpperCase()+'</div>'
    + '<div style="font-family:\'DM Mono\',monospace;font-size:10px;color:var(--g4);margin-top:1px;">@'+(u.username||(u.email||'').split('@')[0])+'</div>'
    + '</div></div>'
    + '<div style="display:grid;grid-template-columns:repeat(4,1fr);gap:6px;margin-bottom:12px;">'
    + '<div style="text-align:center;background:rgba(34,197,94,0.06);border:1px solid rgba(34,197,94,0.12);border-radius:8px;padding:8px 4px;">'
    + '<div style="font-family:\'Bebas Neue\',sans-serif;font-size:18px;color:#22c55e;line-height:1;">'+myP.length+'</div>'
    + '<div style="font-family:\'DM Mono\',monospace;font-size:7px;color:#4a7a58;letter-spacing:0.5px;margin-top:1px;">POSTS</div></div>'
    + '<div style="text-align:center;background:rgba(34,197,94,0.06);border:1px solid rgba(34,197,94,0.12);border-radius:8px;padding:8px 4px;">'
    + '<div style="font-family:\'Bebas Neue\',sans-serif;font-size:18px;color:#22c55e;line-height:1;">'+myV+'</div>'
    + '<div style="font-family:\'DM Mono\',monospace;font-size:7px;color:#4a7a58;letter-spacing:0.5px;margin-top:1px;">VOTES</div></div>'
    + '<div style="text-align:center;background:rgba(34,197,94,0.06);border:1px solid rgba(34,197,94,0.12);border-radius:8px;padding:8px 4px;">'
    + '<div style="font-family:\'Bebas Neue\',sans-serif;font-size:18px;color:#22c55e;line-height:1;">'+(u.followers||[]).length+'</div>'
    + '<div style="font-family:\'DM Mono\',monospace;font-size:7px;color:#4a7a58;letter-spacing:0.5px;margin-top:1px;">FOLLOWERS</div></div>'
    + '<div style="text-align:center;background:rgba(34,197,94,0.06);border:1px solid rgba(34,197,94,0.12);border-radius:8px;padding:8px 4px;">'
    + '<div style="font-family:\'Bebas Neue\',sans-serif;font-size:18px;color:#22c55e;line-height:1;">'+rank+'</div>'
    + '<div style="font-family:\'DM Mono\',monospace;font-size:7px;color:#4a7a58;letter-spacing:0.5px;margin-top:1px;">RANK</div></div>'
    + '</div>'
    + '<button onclick="if(typeof shareCreatorCard===\'function\') shareCreatorCard()" style="width:100%;padding:10px;background:rgba(34,197,94,0.08);border:1.5px solid rgba(34,197,94,0.25);border-radius:9px;font-family:\'Plus Jakarta Sans\',sans-serif;font-size:12px;font-weight:700;cursor:pointer;color:#4ade80;transition:all 0.2s;display:flex;align-items:center;justify-content:center;gap:7px;" onmouseover="this.style.background=\'rgba(34,197,94,0.15)\';this.style.borderColor=\'rgba(34,197,94,0.5)\'" onmouseout="this.style.background=\'rgba(34,197,94,0.08)\';this.style.borderColor=\'rgba(34,197,94,0.25)\'">📤 Share your Creator Card</button>'
    + '</div>';
}


var MISSIONS = [
  { id:'pub', emoji:'&#128226;', label:'Publish an offer', xp:'+50 XP', done: function(){ var p=[]; try{p=JSON.parse(localStorage.getItem('vb_posts')||'[]')}catch(e){} var u=typeof currentUser!=='undefined'&&currentUser; return u&&p.some(function(x){return x.userId===u.email&&new Date(x.timestamp).toDateString()===new Date().toDateString()}); }, action: 'publish' },
  { id:'vote', emoji:'&#9650;', label:'Vote on 3 posts', xp:'+20 XP', done: function(){ return (parseInt(localStorage.getItem('vb_votes_today')||'0'))>=3; }, action: 'feed' },
  { id:'share', emoji:'&#8599;', label:'Share your Creator Card', xp:'+30 XP', done: function(){ return !!localStorage.getItem('vb_card_shared_today'); }, action: 'card' },
  { id:'collab', emoji:'&#129309;', label:'Send a collab request', xp:'+40 XP', done: function(){ return !!localStorage.getItem('vb_collab_today'); }, action: 'collab' },
];

function doMissionAction(id){
  var m = MISSIONS.find(function(x){ return x.id===id; });
  if(!m) return;
  if(m.action==='publish') showAppTab('publish',document.querySelector('[data-tab=publish]'));
  else if(m.action==='feed') showAppTab('feed',document.querySelector('[data-tab=feed]'));
  else if(m.action==='card'){ if(typeof shareCreatorCard==='function') shareCreatorCard(); localStorage.setItem('vb_card_shared_today','1'); renderHomeTab(); }
  else if(m.action==='collab') showAppTab('collab',document.querySelector('[data-tab=collab]'));
}

function renderMissionsHome() {
  var el = document.getElementById('home-missions');
  if (!el) return;
  var today = new Date().toDateString();
  if(localStorage.getItem('vb_missions_date') !== today){
    localStorage.setItem('vb_missions_date', today);
    localStorage.removeItem('vb_votes_today');
    localStorage.removeItem('vb_card_shared_today');
    localStorage.removeItem('vb_collab_today');
  }
  var done = MISSIONS.filter(function(m){ return m.done(); }).length;
  var pct = Math.round(done/MISSIONS.length*100);
  var rows = MISSIONS.map(function(m){
    var isDone = m.done();
    var bg = isDone ? 'rgba(34,197,94,0.06)' : '#0b1a0d';
    var border = isDone ? 'rgba(34,197,94,0.25)' : 'rgba(34,197,94,0.12)';
    var cursor = isDone ? 'default' : 'pointer';
    var oc = isDone ? '' : ' onclick="doMissionAction(\''+m.id+'\')"';
    var hover = isDone ? '' : ' onmouseover="this.style.borderColor=\'rgba(34,197,94,0.4)\'" onmouseout="this.style.borderColor=\'rgba(34,197,94,0.12)\'"';
    var avaBg = isDone ? 'rgba(34,197,94,0.15)' : 'rgba(255,255,255,0.04)';
    var avaBorder = isDone ? 'rgba(34,197,94,0.3)' : 'rgba(34,197,94,0.12)';
    var label = isDone ? '<s style="opacity:0.5">'+m.label+'</s>' : m.label;
    var labelColor = isDone ? '#4ade80' : '#f0fdf4';
    var xpColor = isDone ? '#22c55e' : '#4a7a58';
    return '<div'+oc+hover+' style="display:flex;align-items:center;gap:10px;background:'+bg+';border:1.5px solid '+border+';border-radius:10px;padding:10px 12px;cursor:'+cursor+';transition:all 0.2s;">'
      + '<div style="width:32px;height:32px;border-radius:8px;background:'+avaBg+';border:1px solid '+avaBorder+';display:flex;align-items:center;justify-content:center;font-size:15px;flex-shrink:0;">'+(isDone?'&#9989;':m.emoji)+'</div>'
      + '<div style="flex:1;"><div style="font-size:12px;font-weight:700;color:'+labelColor+';margin-bottom:1px;">'+label+'</div></div>'
      + '<div style="font-family:DM Mono,monospace;font-size:9px;color:'+xpColor+';font-weight:700;">'+m.xp+'</div>'
      + '</div>';
  }).join('');
  el.innerHTML = '<div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:8px;">'
    + '<div style="display:flex;align-items:center;gap:6px;">'
    + '<div style="width:6px;height:6px;border-radius:50%;background:#facc15;box-shadow:0 0 6px #facc15;flex-shrink:0;"></div>'
    + '<div style="font-family:Bebas Neue,sans-serif;font-size:17px;letter-spacing:2px;color:#f0fdf4;">MISSIONS DU JOUR</div>'
    + '</div>'
    + '<div style="font-family:DM Mono,monospace;font-size:9px;color:#4a7a58;">'+done+'/'+MISSIONS.length+' DONE &middot; '+pct+'%</div>'
    + '</div>'
    + '<div style="height:4px;background:#0f2312;border-radius:2px;margin-bottom:10px;overflow:hidden;">'
    + '<div style="height:100%;width:'+pct+'%;background:linear-gradient(90deg,#facc15,#f97316);border-radius:2px;transition:width 0.6s;"></div>'
    + '</div>'
    + '<div style="display:flex;flex-direction:column;gap:6px;">'+rows+'</div>';
}

// ── AI-GENERATED DEALS ──
var AI_DEALS_POOL = [
  { emoji:'⚡', name:'VB PRO -50%', hook:'Publications illimitées + analytics', originalPrice:'19.99', price:'9.99', discount:'-50%', badge:'FLASH', color:'#22c55e', bg:'rgba(34,197,94,0.07)', border:'rgba(34,197,94,0.3)', tab:'boost-credits' },
  { emoji:'👑', name:'Plan VIP -40%', hook:'Badge VIP + Boost credits x2', originalPrice:'34.99', price:'20.99', discount:'-40%', badge:'VIP DEAL', color:'#ffd700', bg:'rgba(255,215,0,0.07)', border:'rgba(255,215,0,0.3)', tab:'boost-credits' },
  { emoji:'🎯', name:'Pack Collab', hook:'Matching IA prioritaire 3 mois', originalPrice:'29.99', price:'14.99', discount:'-50%', badge:'BEST DEAL', color:'#fb923c', bg:'rgba(251,146,60,0.07)', border:'rgba(251,146,60,0.3)', tab:'boost-credits' },
  { emoji:'🏆', name:'Boost x100', hook:'Mettez vos pubs en avant immédiatement', originalPrice:'9.99', price:'4.99', discount:'-50%', badge:'POPULAIRE', color:'#facc15', bg:'rgba(250,204,21,0.07)', border:'rgba(250,204,21,0.3)', tab:'boost-credits' },
  { emoji:'🚀', name:'Elite Launch', hook:'Tous les avantages Elite 1 mois', originalPrice:'39.99', price:'19.99', discount:'-50%', badge:'LIMITÉ', color:'#c084fc', bg:'rgba(192,132,252,0.07)', border:'rgba(192,132,252,0.3)', tab:'boost-credits' },
  { emoji:'💎', name:'Diamond Pack', hook:'Credits + PRO + Collab matching', originalPrice:'49.99', price:'24.99', discount:'-50%', badge:'EXCLUSIF', color:'#38bdf8', bg:'rgba(56,189,248,0.07)', border:'rgba(56,189,248,0.3)', tab:'boost-credits' },
];

function renderAIDeals() {
  var el = document.getElementById('home-deals-grid');
  if (!el) return;
  // BG gradients visuels par deal
  var BG_VISUALS = [
    'linear-gradient(135deg,#064e3b 0%,#022c22 50%,#052e16 100%)',
    'linear-gradient(135deg,#1c1400 0%,#2d1f00 50%,#1a0e00 100%)',
    'linear-gradient(135deg,#1e0a2e 0%,#2d0a4e 50%,#12002e 100%)',
    'linear-gradient(135deg,#001d2e 0%,#002e48 50%,#001524 100%)',
    'linear-gradient(135deg,#2e0a00 0%,#4e1400 50%,#1a0600 100%)',
    'linear-gradient(135deg,#0a0a2e 0%,#1a1a5e 50%,#06062e 100%)',
  ];
  var today = new Date().toDateString();
  var seed = 0; for(var i=0;i<today.length;i++) seed=(seed*31+today.charCodeAt(i))&0xffff;
  var picks = [];
  var pool = AI_DEALS_POOL.slice();
  // Pick 4 for 2x2 grid
  for(var j=0;j<4;j++){
    var idx = (seed+j*7)%pool.length;
    picks.push(pool.splice(idx%pool.length,1)[0]);
  }
  el.innerHTML = picks.map(function(d,i){
    var bgVis = BG_VISUALS[i % BG_VISUALS.length];
    return '<div style="border-radius:14px;overflow:hidden;position:relative;cursor:pointer;box-shadow:0 4px 20px rgba(0,0,0,0.5);background:'+bgVis+';border:1.5px solid '+d.border+';transition:all 0.25s;" onmouseover="this.style.transform=\'translateY(-2px)\';this.style.boxShadow=\'0 12px 30px rgba(0,0,0,0.6)\'" onmouseout="this.style.transform=\'\';this.style.boxShadow=\'0 4px 20px rgba(0,0,0,0.5)\'">'
      // discount badge top-left
      + '<div style="position:absolute;top:8px;left:8px;background:'+d.color+';color:#040a05;font-family:DM Mono,monospace;font-size:8px;font-weight:900;padding:3px 7px;border-radius:4px;letter-spacing:1px;z-index:2;">'+d.discount+'</div>'
      // badge top-right
      + '<div style="position:absolute;top:8px;right:8px;background:rgba(0,0,0,0.5);border:1px solid '+d.border+';color:'+d.color+';font-family:DM Mono,monospace;font-size:7px;padding:2px 5px;border-radius:3px;letter-spacing:1px;z-index:2;">'+d.badge+'</div>'
      // visual emoji area
      + '<div style="height:80px;display:flex;align-items:center;justify-content:center;position:relative;">'
      + '<div style="font-size:38px;filter:drop-shadow(0 0 12px '+d.color+'88);">'+d.emoji+'</div>'
      + '<div style="position:absolute;inset:0;background:radial-gradient(ellipse at center,'+d.color+'15 0%,transparent 70%);pointer-events:none;"></div>'
      + '</div>'
      // content
      + '<div style="padding:10px 12px 12px;">'
      + '<div style="font-family:Bebas Neue,sans-serif;font-size:16px;letter-spacing:1.5px;color:#f0fdf4;line-height:1;margin-bottom:3px;">'+d.name+'</div>'
      + '<div style="font-size:9px;color:#6aaa80;line-height:1.35;margin-bottom:8px;min-height:24px;">'+d.hook+'</div>'
      // price row
      + '<div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:8px;">'
      + '<div>'
      + '<span style="font-family:DM Mono,monospace;font-size:9px;color:#4a7a58;text-decoration:line-through;margin-right:4px;">'+d.originalPrice+'$</span>'
      + '<span style="font-family:Bebas Neue,sans-serif;font-size:24px;color:'+d.color+';line-height:1;">'+d.price+'$</span>'
      + '</div>'
      + '</div>'
      // PAY button
      + '<button onclick="payDeal(this.dataset.n,this.dataset.p)" data-n="'+d.name+'" data-p="'+d.price+'" style="width:100%;padding:8px;background:linear-gradient(135deg,'+d.color+','+d.color+'cc);border:none;border-radius:8px;font-family:Bebas Neue,sans-serif;font-size:15px;letter-spacing:1.5px;color:#040a05;cursor:pointer;font-weight:900;transition:all 0.2s;box-shadow:0 2px 8px '+d.color+'44;">💳 PAY</button>'
      + '</div>'
      + '</div>';
  }).join('');
}

function payDeal(name, price) {
  // Show payment confirmation modal
  var modal = document.getElementById('deal-pay-modal');
  if (!modal) {
    modal = document.createElement('div');
    modal.id = 'deal-pay-modal';
    modal.style.cssText = 'position:fixed;inset:0;background:rgba(0,0,0,0.88);backdrop-filter:blur(16px);z-index:9998;display:flex;align-items:flex-end;justify-content:center;padding:0;';
    modal.onclick = function(e){ if(e.target===modal) modal.remove(); };
    document.body.appendChild(modal);
  }
  modal.innerHTML = '<div style="background:#0b1a0d;border:1.5px solid rgba(255,215,0,0.35);border-radius:20px 20px 0 0;width:100%;max-width:480px;padding:24px 20px 36px;animation:slideUp 0.3s cubic-bezier(0.34,1.2,0.64,1);">'
    + '<div style="width:40px;height:4px;border-radius:2px;background:rgba(255,255,255,0.2);margin:0 auto 18px;"></div>'
    + '<div style="font-family:DM Mono,monospace;font-size:9px;letter-spacing:3px;color:#ffd700;text-align:center;margin-bottom:4px;">&#128176; SECURE PAYMENT</div>'
    + '<div style="font-family:Bebas Neue,sans-serif;font-size:26px;letter-spacing:2px;color:#f0fdf4;text-align:center;margin-bottom:6px;">'+name+'</div>'
    + '<div style="font-family:Bebas Neue,sans-serif;font-size:44px;color:#ffd700;text-align:center;line-height:1;margin-bottom:4px;">'+price+'$</div>'
    + '<div style="font-family:DM Mono,monospace;font-size:9px;color:#4a7a58;text-align:center;margin-bottom:20px;">Limited offer · Save 50%</div>'
    + '<div style="background:rgba(0,0,0,0.4);border:1px solid rgba(255,215,0,0.15);border-radius:12px;padding:14px;margin-bottom:16px;">'
    + '<div style="font-family:DM Mono,monospace;font-size:10px;color:#ffd700;margin-bottom:8px;letter-spacing:1px;">PAYMENT METHOD</div>'
    + '<div style="display:flex;gap:8px;margin-bottom:10px;">'
    + '<button onclick="selectPayMethod(this,\'card\')" style="flex:1;padding:9px;background:rgba(255,215,0,0.12);border:1.5px solid #ffd700;border-radius:8px;color:#ffd700;font-family:DM Mono,monospace;font-size:9px;cursor:pointer;letter-spacing:1px;">💳 CARD</button>'
    + '<button onclick="selectPayMethod(this,\'paypal\')" style="flex:1;padding:9px;background:rgba(255,255,255,0.04);border:1.5px solid rgba(255,255,255,0.1);border-radius:8px;color:#aaa;font-family:DM Mono,monospace;font-size:9px;cursor:pointer;letter-spacing:1px;">🅿 PAYPAL</button>'
    + '<button onclick="selectPayMethod(this,\'apple\')" style="flex:1;padding:9px;background:rgba(255,255,255,0.04);border:1.5px solid rgba(255,255,255,0.1);border-radius:8px;color:#aaa;font-family:DM Mono,monospace;font-size:9px;cursor:pointer;letter-spacing:1px;">🍎 PAY</button>'
    + '</div>'
    + '<input placeholder="Card number •••• •••• •••• ••••" style="width:100%;padding:10px 12px;background:rgba(255,255,255,0.04);border:1.5px solid rgba(255,215,0,0.2);border-radius:8px;color:#f0fdf4;font-family:DM Mono,monospace;font-size:12px;outline:none;box-sizing:border-box;margin-bottom:8px;" onfocus="this.style.borderColor=\'#ffd700\'" onblur="this.style.borderColor=\'rgba(255,215,0,0.2)\'">'
    + '<div style="display:grid;grid-template-columns:1fr 1fr;gap:8px;">'
    + '<input placeholder="MM/YY" style="width:100%;padding:10px 12px;background:rgba(255,255,255,0.04);border:1.5px solid rgba(255,215,0,0.2);border-radius:8px;color:#f0fdf4;font-family:DM Mono,monospace;font-size:12px;outline:none;box-sizing:border-box;" onfocus="this.style.borderColor=\'#ffd700\'" onblur="this.style.borderColor=\'rgba(255,215,0,0.2)\'">'
    + '<input placeholder="CVV" style="width:100%;padding:10px 12px;background:rgba(255,255,255,0.04);border:1.5px solid rgba(255,215,0,0.2);border-radius:8px;color:#f0fdf4;font-family:DM Mono,monospace;font-size:12px;outline:none;box-sizing:border-box;" onfocus="this.style.borderColor=\'#ffd700\'" onblur="this.style.borderColor=\'rgba(255,215,0,0.2)\'">'
    + '</div>'
    + '</div>'
    + '<button onclick="confirmDealPayment(this.dataset.n,this.dataset.p)" data-n="'+name+'" data-p="'+price+'" style="width:100%;padding:15px;background:linear-gradient(135deg,#ffd700,#ff8c00);border:none;border-radius:12px;font-family:Bebas Neue,sans-serif;font-size:20px;letter-spacing:2px;color:#040a05;cursor:pointer;margin-bottom:10px;box-shadow:0 4px 20px rgba(255,215,0,0.4);">🔒 PAY '+price+'$</button>'
    + '<button onclick="document.getElementById(\'deal-pay-modal\').remove()" style="width:100%;padding:10px;background:none;border:1px solid rgba(255,255,255,0.1);border-radius:8px;color:#4a7a58;font-family:DM Mono,monospace;font-size:10px;cursor:pointer;letter-spacing:1px;">CANCEL</button>'
    + '</div>';
}

function selectPayMethod(btn, method) {
  btn.parentElement.querySelectorAll('button').forEach(function(b) {
    b.style.background = 'rgba(255,255,255,0.04)';
    b.style.borderColor = 'rgba(255,255,255,0.1)';
    b.style.color = '#aaa';
  });
  btn.style.background = 'rgba(255,215,0,0.12)';
  btn.style.borderColor = '#ffd700';
  btn.style.color = '#ffd700';
}

function confirmDealPayment(name, price) {
  var modal = document.getElementById('deal-pay-modal');
  if (modal) modal.remove();
  if (typeof toast === 'function') toast('✅ Payment of ' + price + '$ confirmed! Thank you 🎉');
}

function shareCreatorCard() {
  var name = (typeof currentUser !== 'undefined' && currentUser) ? currentUser.name : 'Creator';
  var text = '🚀 Check out my ViralBoost Creator Card! Join the community → viralboost.app';
  if (navigator.share) {
    navigator.share({ title: 'ViralBoost Creator Card', text: text });
  } else {
    navigator.clipboard && navigator.clipboard.writeText(text);
    if (typeof toast === 'function') toast('📋 Card link copied!');
  }
}

var DEMO_DEALS = [
  { emoji: '⚡', name: 'ViralBoost PRO', hook: 'Publiez illimité + analytics avancés', originalPrice: '19.99', price: '9.99', discount: '-50%', badge: 'OFFRE LIMITÉE', color: '#22c55e', bg: 'rgba(34,197,94,0.07)', border: 'rgba(34,197,94,0.3)', action: function(){ if(typeof showAppTab==='function') showAppTab('boost-credits',document.querySelector('[data-tab=boost-credits]')); } },
  { emoji: '🎯', name: 'Pack Collab Premium', hook: '3 mois de matching IA prioritaire', originalPrice: '29.99', price: '14.99', discount: '-50%', badge: 'BEST DEAL', color: '#fb923c', bg: 'rgba(251,146,60,0.07)', border: 'rgba(251,146,60,0.3)', action: function(){ if(typeof showAppTab==='function') showAppTab('boost-credits',document.querySelector('[data-tab=boost-credits]')); } },
  { emoji: '🏆', name: 'Boost Credits x100', hook: 'Mettez vos pubs en avant dans le feed', originalPrice: '9.99', price: '4.99', discount: '-50%', badge: 'POPULAIRE', color: '#facc15', bg: 'rgba(250,204,21,0.07)', border: 'rgba(250,204,21,0.3)', action: function(){ if(typeof showAppTab==='function') showAppTab('boost-credits',document.querySelector('[data-tab=boost-credits]')); } },
];

function renderDeals() {
  var grid = document.getElementById('home-deals-grid');
  if (!grid) return;
  grid.innerHTML = DEMO_DEALS.map(function(d, i) {
    return '<div onclick="DEMO_DEALS['+i+'].action()" style="background:'+d.bg+';border:1.5px solid '+d.border+';border-radius:12px;padding:14px 16px;cursor:pointer;transition:all 0.2s;display:flex;align-items:center;gap:12px;position:relative;overflow:hidden;" onmouseover="this.style.transform=\'translateY(-1px)\';this.style.boxShadow=\'0 8px 24px rgba(0,0,0,0.35)\'" onmouseout="this.style.transform=\'\';this.style.boxShadow=\'\'">'
      + '<div style="position:absolute;top:8px;right:10px;font-family:DM Mono,monospace;font-size:7px;font-weight:700;color:'+d.color+';background:rgba(0,0,0,0.35);border:1px solid '+d.border+';border-radius:3px;padding:2px 6px;letter-spacing:1px;">'+d.badge+'</div>'
      + '<div style="width:46px;height:46px;border-radius:11px;background:rgba(0,0,0,0.3);border:1px solid '+d.border+';display:flex;align-items:center;justify-content:center;font-size:22px;flex-shrink:0;">'+d.emoji+'</div>'
      + '<div style="flex:1;min-width:0;padding-right:80px;">'
      + '<div style="font-size:13px;font-weight:700;color:var(--white);margin-bottom:2px;">'+d.name+'</div>'
      + '<div style="font-size:11px;color:var(--muted);line-height:1.4;">'+d.hook+'</div>'
      + '</div>'
      + '<div style="flex-shrink:0;text-align:right;">'
      + '<div style="font-family:DM Mono,monospace;font-size:9px;color:var(--muted);text-decoration:line-through;margin-bottom:1px;">'+d.originalPrice+'$</div>'
      + '<div style="font-family:Bebas Neue,sans-serif;font-size:22px;color:'+d.color+';line-height:1;">'+d.price+'$</div>'
      + '<div style="font-family:DM Mono,monospace;font-size:9px;color:'+d.color+';background:rgba(0,0,0,0.3);border-radius:3px;padding:1px 5px;letter-spacing:1px;">'+d.discount+'</div>'
      + '</div>'
      + '</div>';
  }).join('');
}

function renderTopCommunity() {
  var grid = document.getElementById('home-top-offers');
  if (!grid) return;
  var FAKE_USERS = [
    {name:'Lucas M.', tag:'@lucas_mkt', plan:'PRO', emoji:'📊', title:'Pack Collab Marketing', votes:847, color:'#22c55e', avatar:'L'},
    {name:'Sarah D.', tag:'@sarah_dev', plan:'ELITE', emoji:'💻', title:'Audit Tech & Stratégie', votes:634, color:'#ffd700', avatar:'S'},
    {name:'Marc B.', tag:'@marc_boss', plan:'PRO', emoji:'🚀', title:'Lancement Startup 2025', votes:512, color:'#60a5fa', avatar:'M'},
    {name:'Emma R.', tag:'@emma_rich', plan:'VIP', emoji:'💰', title:'Formation Revenu Passif', votes:489, color:'#c084fc', avatar:'E'},
    {name:'Karim O.', tag:'@karim_off', plan:'PRO', emoji:'🎯', title:'Coaching Croissance', votes:378, color:'#fb923c', avatar:'K'},
    {name:'Léa V.', tag:'@lea_viral', plan:'FREE', emoji:'🌟', title:'Design & Branding', votes:265, color:'#38bdf8', avatar:'L'},
  ];
  var planC = {PRO:'#60a5fa', ELITE:'#ffd700', VIP:'#c084fc', FREE:'#4a7a58'};
  var posts = [];
  try { posts = JSON.parse(localStorage.getItem('vb_posts')||'[]'); } catch(e){}
  var real = posts.filter(function(p){ return (p.votes||0) > 0; }).sort(function(a,b){ return (b.votes||0)-(a.votes||0); }).slice(0,6);
  var display = real.length >= 2 ? real.map(function(p){
    return {name: p.userName||'Creator', tag:'@'+(p.userName||'user').toLowerCase().replace(/\s/g,'_'), plan: p.userPlan||'FREE', emoji: p.emoji||'📢', title: p.projectName||p.name||'Mon projet', votes: p.votes||0, color: '#22c55e', avatar: (p.userName||'C')[0].toUpperCase()};
  }) : FAKE_USERS;
  
  try { grid.innerHTML = display.slice(0,6).map(function(u, i) {
    var pc = planC[u.plan] || '#4a7a58';
    var rank = i === 0 ? '🥇' : i === 1 ? '🥈' : i === 2 ? '🥉' : '#'+(i+1);
    return '<div style="background:#0b1a0d;border:1.5px solid rgba(34,197,94,0.12);border-radius:12px;padding:12px;cursor:pointer;transition:all 0.2s;" onmouseover="this.style.borderColor=\'rgba(34,197,94,0.3)\';this.style.transform=\'translateY(-1px)\';" onmouseout="this.style.borderColor=\'rgba(34,197,94,0.12)\';this.style.transform=\'\';">'
      + '<div style="display:flex;align-items:center;gap:8px;margin-bottom:8px;">'
      + '<div style="width:28px;height:28px;border-radius:8px;background:linear-gradient(135deg,'+u.color+'44,'+u.color+'22);border:1px solid '+u.color+'44;display:flex;align-items:center;justify-content:center;font-family:Bebas Neue,sans-serif;font-size:14px;color:'+u.color+';flex-shrink:0;">'+u.avatar+'</div>'
      + '<div style="flex:1;min-width:0;">'
      + '<div style="font-size:11px;font-weight:700;color:#f0fdf4;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;">'+u.name+'</div>'
      + '<div style="font-family:DM Mono,monospace;font-size:8px;color:'+pc+';">'+u.plan+'</div>'
      + '</div>'
      + '<div style="font-size:13px;">'+rank+'</div>'
      + '</div>'
      + '<div style="font-size:10px;color:#6aaa80;margin-bottom:6px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;">'+u.emoji+' '+u.title+'</div>'
      + '<div style="font-family:DM Mono,monospace;font-size:9px;color:#22c55e;">▲ '+u.votes+' votes</div>'
      + '</div>';
  }).join('');
} catch(e) {}
  var top = posts.slice().sort(function(a,b){ return (b.votes||0)-(a.votes||0); }).slice(0,4);

  var DEMO_TOP = [
    { emoji:'🚀', projectName:'LaunchPad AI', text:'Turn your idea into a startup in 7 days with AI feedback.', votes:142, userName:'alex_b', userColor:'#15803d' },
    { emoji:'🎯', projectName:'CollabMatch', text:'Find your perfect co-founder in 48h. AI powered.', votes:201, userName:'sarah_d', userColor:'#2563eb' },
    { emoji:'📊', projectName:'DashMetrics', text:'All your KPIs in one beautiful real-time dashboard.', votes:89, userName:'mike_t', userColor:'#7c3aed' },
    { emoji:'💡', projectName:'IdeaValidator', text:'Validate before you build. Templates + landing page.', votes:115, userName:'lena_k', userColor:'#be185d' },
  ];
  var display = top.length >= 2 ? top : DEMO_TOP;

  grid.innerHTML = display.slice(0,4).map(function(p) {
    var emoji = p.emoji || '📢';
    var name = p.projectName || p.name || 'Project';
    var votes = p.votes || 0;
    var ava = (p.userName||'U')[0].toUpperCase();
    var avaColor = p.userColor || '#15803d';
    return '<div onclick="showAppTab(\'feed\',document.querySelector(\'[data-tab=feed]\'))" style="background:var(--s1);border:1.5px solid var(--border2);border-radius:12px;padding:12px;cursor:pointer;transition:all 0.2s;" onmouseover="this.style.borderColor=\'rgba(34,197,94,0.3)\';this.style.transform=\'translateY(-1px)\'" onmouseout="this.style.borderColor=\'var(--border2)\';this.style.transform=\'\'">'
      + '<div style="display:flex;align-items:center;gap:7px;margin-bottom:7px;">'
      + '<span style="font-size:18px">'+emoji+'</span>'
      + '<div style="font-size:12px;font-weight:700;color:var(--white);flex:1;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;">'+name+'</div>'
      + '<div style="font-family:DM Mono,monospace;font-size:10px;color:var(--g3);flex-shrink:0;">▲'+votes+'</div>'
      + '</div>'
      + '<div style="font-size:11px;color:var(--muted);line-height:1.5;margin-bottom:7px;display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden;">'+(p.text||'').substring(0,70)+'</div>'
      + '<div style="display:flex;align-items:center;gap:5px;">'
      + '<div style="width:16px;height:16px;border-radius:50%;background:'+avaColor+';display:flex;align-items:center;justify-content:center;font-size:8px;font-weight:700;color:#040a05;">'+ava+'</div>'
      + '<span style="font-family:DM Mono,monospace;font-size:9px;color:var(--muted);">@'+(p.userName||'creator')+'</span>'
      + '</div>'
      + '</div>';
  }).join('');
}

// ══ NAME STYLE PICKER ══
var NS_STYLES = [
  {id:'default', label:'Default', css:'color:#22c55e', preview:'DEFAULT'},
  {id:'neon', label:'Neon', css:'color:#22c55e;text-shadow:0 0 14px rgba(34,197,94,0.9)', preview:'NEON'},
  {id:'gold', label:'Gold', css:'color:#ffd700;text-shadow:0 0 12px rgba(255,215,0,0.7)', preview:'GOLD'},
  {id:'fire', label:'Fire', css:'background:linear-gradient(135deg,#f97316,#ef4444);-webkit-background-clip:text;-webkit-text-fill-color:transparent', preview:'FIRE'},
  {id:'ice', label:'Ice', css:'color:#38bdf8;text-shadow:0 0 12px rgba(56,189,248,0.7)', preview:'ICE'},
  {id:'purple', label:'Purple', css:'color:#c084fc;text-shadow:0 0 12px rgba(192,132,252,0.6)', preview:'PURPLE'},
  {id:'italic', label:'Italic', css:'color:#22c55e;font-style:italic', preview:'Italic'},
  {id:'mono', label:'Mono', css:'color:#4ade80;letter-spacing:4px', preview:'MONO'},
];

function openNameStylePicker(){
  var modal = document.getElementById('name-style-modal');
  if(!modal){
    modal = document.createElement('div');
    modal.id = 'name-style-modal';
    modal.style.cssText = 'position:fixed;inset:0;background:rgba(0,0,0,0.85);backdrop-filter:blur(12px);z-index:9999;display:flex;align-items:center;justify-content:center;padding:20px;';
    modal.onclick = function(e){ if(e.target===modal) closeNameStylePicker(); };
    document.body.appendChild(modal);
  }
  var cur = (typeof currentUser !== 'undefined' && currentUser) ? (currentUser.nameStyle||'default') : 'default';
  var name = (typeof currentUser !== 'undefined' && currentUser) ? (currentUser.name||'CREATOR').toUpperCase() : 'CREATOR';
  var curStyle = NS_STYLES.find(function(s){ return s.id===cur; }) || NS_STYLES[0];

  var btns = NS_STYLES.map(function(s){
    var isActive = s.id === cur;
    var bg = isActive ? 'rgba(34,197,94,0.12)' : '#0b1a0d';
    var border = isActive ? 'rgba(34,197,94,0.8)' : 'rgba(34,197,94,0.15)';
    return '<button id="nsp-btn-'+s.id+'" onclick="previewNameStyle(this.dataset.sid)" data-sid="'+s.id+'" style="background:'+bg+';border:1.5px solid '+border+';border-radius:10px;padding:10px 4px;cursor:pointer;display:flex;flex-direction:column;align-items:center;gap:4px;">'
      + '<div style="font-family:Bebas Neue,sans-serif;font-size:13px;letter-spacing:1px;'+s.css+'">'+s.preview+'</div>'
      + '<div style="font-family:DM Mono,monospace;font-size:8px;color:#4a7a58;letter-spacing:1px;">'+s.label+'</div>'
      + '</button>';
  }).join('');

  modal.innerHTML = '<div style="background:#0b1a0d;border:1.5px solid rgba(34,197,94,0.35);border-radius:18px;padding:24px;max-width:380px;width:100%;position:relative;">'
    + '<button onclick="closeNameStylePicker()" style="position:absolute;top:12px;right:12px;background:#0f2312;border:1px solid rgba(34,197,94,0.2);border-radius:50%;width:28px;height:28px;cursor:pointer;color:#4a7a58;font-size:12px;display:flex;align-items:center;justify-content:center;">✕</button>'
    + '<div style="font-family:DM Mono,monospace;font-size:9px;letter-spacing:3px;color:#22c55e;text-transform:uppercase;margin-bottom:4px;">&#127912; NAME STYLE</div>'
    + '<div style="font-size:12px;color:#4a7a58;margin-bottom:16px;">Choose the visual style of your name</div>'
    + '<div id="nsp-preview" style="text-align:center;margin-bottom:18px;padding:14px;background:rgba(0,0,0,0.4);border-radius:10px;border:1px solid rgba(34,197,94,0.12);">'
    + '<div id="nsp-name" style="font-family:Bebas Neue,sans-serif;font-size:28px;letter-spacing:3px;'+curStyle.css+'">'+name+'</div>'
    + '</div>'
    + '<div style="display:grid;grid-template-columns:repeat(4,1fr);gap:8px;margin-bottom:14px;">' + btns + '</div>'
    + '<button onclick="applyNameStyle()" style="width:100%;padding:12px;background:linear-gradient(135deg,#15803d,#22c55e);border:none;border-radius:10px;font-size:14px;font-weight:800;color:#040a05;cursor:pointer;">Apply ✓</button>'
    + '</div>';
  window._pendingNameStyle = cur;
}

function previewNameStyle(styleId){
  window._pendingNameStyle = styleId;
  var s = NS_STYLES.find(function(x){ return x.id===styleId; }) || NS_STYLES[0];
  var previewEl = document.getElementById('nsp-name');
  if(previewEl){
    previewEl.removeAttribute('style');
    previewEl.style.fontFamily = 'Bebas Neue,sans-serif';
    previewEl.style.fontSize = '28px';
    previewEl.style.letterSpacing = '3px';
    previewEl.setAttribute('style', 'font-family:Bebas Neue,sans-serif;font-size:28px;letter-spacing:3px;'+s.css);
  }
  document.querySelectorAll('[id^=nsp-btn-]').forEach(function(b){
    b.style.borderColor='rgba(34,197,94,0.15)';
    b.style.background='#0b1a0d';
  });
  var btn = document.getElementById('nsp-btn-'+styleId);
  if(btn){ btn.style.borderColor='rgba(34,197,94,0.8)'; btn.style.background='rgba(34,197,94,0.12)'; }
}

function applyNameStyle(){
  if(typeof currentUser === 'undefined' || !currentUser) return;
  currentUser.nameStyle = window._pendingNameStyle || 'default';
  localStorage.setItem('viralboost_user', JSON.stringify(currentUser));
  closeNameStylePicker();
  if(typeof updateAppBar === 'function') updateAppBar();
  if(typeof renderMyProfile === 'function') renderMyProfile();
}

function closeNameStylePicker(){
  var modal = document.getElementById('name-style-modal');
  if(modal) modal.remove();
}

// ── ACCORDION HOME ──
function toggleAccordion(id) {
  var body = document.getElementById(id+'-body');
  var chev = document.getElementById(id+'-chev');
  var isOpen = body.style.maxHeight && body.style.maxHeight !== '0px' && body.style.maxHeight !== '0';
  // Close all
  ['acc-1','acc-2','acc-3'].forEach(function(aid) {
    var b = document.getElementById(aid+'-body');
    var c = document.getElementById(aid+'-chev');
    if (b) { b.style.maxHeight = '0'; }
    if (c) { c.style.transform = ''; }
  });
  // Open clicked if it was closed
  if (!isOpen && body) {
    body.style.maxHeight = '800px';
    if (chev) chev.style.transform = 'rotate(180deg)';
  }
}


// Init
document.addEventListener('DOMContentLoaded', function() {
  setTimeout(renderHomeTab, 300);
});

// ═══════════════════════════════════════════
// ── PUBCREATOR — ELITE AD STUDIO ──
// ═══════════════════════════════════════════

let _pcCurrentStep = 1;
let _pcSelectedColor = '#ffd700';
const PC_AD_CATS = [
  { id:'product',  label:'🛍️ PRODUCT',   color:'#f97316', bg:'rgba(249,115,22,0.08)',  border:'rgba(249,115,22,0.3)'  },
  { id:'service',  label:'💻 SERVICE',   color:'#a855f7', bg:'rgba(168,85,247,0.08)',  border:'rgba(168,85,247,0.3)'  },
  { id:'course',   label:'📚 COURSE',    color:'#22c55e', bg:'rgba(34,197,94,0.08)',   border:'rgba(34,197,94,0.3)'   },
  { id:'collab',   label:'🤝 COLLAB',    color:'#38bdf8', bg:'rgba(56,189,248,0.08)',  border:'rgba(56,189,248,0.3)'  },
  { id:'campaign', label:'🎯 CAMPAIGN',  color:'#ffd700', bg:'rgba(255,215,0,0.08)',   border:'rgba(255,215,0,0.3)'   },
];

function showPubCreatorTab(el) {
  showAppTab('pubcreator', el);
  const user = window._currentUser || JSON.parse(localStorage.getItem('viralboost_user')||'null');
  const isElite = user && (user.plan==='elite'||user.plan==='vip'||user.plan==='legend'||user.isAdmin);
  const lock = document.getElementById('pc-elite-lock');
  const main = document.getElementById('pc-main');
  if (!isElite) {
    if(lock) lock.style.display='block';
    if(main) main.style.display='none';
    return;
  }
  if(lock) lock.style.display='none';
  if(main) main.style.display='block';
  pcInitGroup();
}

function pcSwitchMode(mode) {
  const single = document.getElementById('pc-panel-single');
  const group  = document.getElementById('pc-panel-group');
  const btnS   = document.getElementById('pc-mode-single');
  const btnG   = document.getElementById('pc-mode-group');
  if(mode==='single') {
    if(single) single.style.display='block';
    if(group)  group.style.display='none';
    btnS.style.background='rgba(255,215,0,0.12)'; btnS.style.borderColor='rgba(255,215,0,0.5)'; btnS.style.color='#ffd700';
    btnG.style.background='transparent'; btnG.style.borderColor='rgba(255,215,0,0.2)'; btnG.style.color='rgba(255,215,0,0.5)';
  } else {
    if(single) single.style.display='none';
    if(group)  group.style.display='block';
    btnG.style.background='rgba(255,215,0,0.12)'; btnG.style.borderColor='rgba(255,215,0,0.5)'; btnG.style.color='#ffd700';
    btnS.style.background='transparent'; btnS.style.borderColor='rgba(255,215,0,0.2)'; btnS.style.color='rgba(255,215,0,0.5)';
  }
}

function pcGoStep(n) {
  for(let i=1;i<=4;i++){
    const panel = document.getElementById('pcstep-'+i);
    const dot   = document.getElementById('pcs-'+i);
    if(panel) panel.style.display = i===n ? 'block' : 'none';
    if(dot) { dot.classList.toggle('active', i===n); dot.style.opacity = i<=n ? '1' : '0.4'; }
  }
  _pcCurrentStep = n;
  if(n===4) pcUpdateLaunchSummary();
}

function pcNextStep(from) {
  if(from===1) { const nm=document.getElementById('pc-ad-name'); if(!nm||!nm.value.trim()){toast('⚠️ Please enter an ad name');return;} }
  if(from===2) { const hl=document.getElementById('pc-ad-headline'); if(!hl||!hl.value.trim()){toast('⚠️ Please add a headline');return;} }
  pcGoStep(from+1);
  if(from===2) pcUpdatePreview();
}

function pcPrevStep(from) { pcGoStep(from-1); }

function pcUpdatePreview() {
  const hl = (document.getElementById('pc-ad-headline')||{}).value || '';
  const hk = (document.getElementById('pc-ad-hook')||{}).value || '';
  const bd = (document.getElementById('pc-ad-body')||{}).value || '';
  const em = (document.getElementById('pc-emoji-input')||{}).value || '🚀';
  const elH = document.getElementById('pc-preview-headline');
  const elK = document.getElementById('pc-preview-hook');
  const elB = document.getElementById('pc-preview-body');
  const elE = document.getElementById('pc-preview-emoji');
  const elES = document.getElementById('pc-emoji-selected');
  if(elH) elH.textContent = hl || 'Your headline here…';
  if(elK) elK.textContent = hk || 'Your hook here…';
  if(elB) elB.textContent = bd.substring(0,140) + (bd.length>140?'…':'') || 'Your ad body will appear here…';
  if(elE) elE.textContent = em;
  if(elES) elES.textContent = em;
}

function pcSelectColor(c) {
  _pcSelectedColor = c;
  document.querySelectorAll('#pc-color-picker div').forEach(d => d.style.borderColor='transparent');
  event.target.style.borderColor = c;
  const banner = document.getElementById('pc-preview-banner');
  if(banner) banner.style.background = 'linear-gradient(135deg,'+c+'20,'+c+'08)';
}

function pcHandleBanner(input) {
  if(!input.files||!input.files[0]) return;
  const reader = new FileReader();
  reader.onload = e => {
    const prev = document.getElementById('pc-banner-preview');
    if(prev) prev.innerHTML = `<img src="${e.target.result}" style="width:100%;max-height:140px;object-fit:cover;border-radius:8px;margin-top:4px"/>`;
    const banner = document.getElementById('pc-preview-banner');
    if(banner) banner.style.backgroundImage = `url(${e.target.result})`;
  };
  reader.readAsDataURL(input.files[0]);
}

function pcUpdateLaunchSummary() {
  const nm  = (document.getElementById('pc-ad-name')||{}).value||'—';
  const hl  = (document.getElementById('pc-ad-headline')||{}).value||'—';
  const cat = (document.getElementById('pc-ad-cat')||{}).value||'—';
  const obj = (document.getElementById('pc-ad-objective')||{}).value||'—';
  const url = (document.getElementById('pc-ad-url')||{}).value||'—';
  const el  = document.getElementById('pc-launch-summary');
  if(el) el.innerHTML = `
    📛 <b style="color:#f0fdf4">Name:</b> ${nm}<br>
    📂 <b style="color:#f0fdf4">Category:</b> ${cat}<br>
    🎯 <b style="color:#f0fdf4">Objective:</b> ${obj}<br>
    ✍️ <b style="color:#f0fdf4">Headline:</b> ${hl}<br>
    🔗 <b style="color:#f0fdf4">Link:</b> ${url}<br>
    🎨 <b style="color:#f0fdf4">Color:</b> <span style="display:inline-block;width:12px;height:12px;border-radius:50%;background:${_pcSelectedColor};vertical-align:middle;margin-left:4px"></span>
  `;
}

function pcLaunchSingle() {
  const nm  = (document.getElementById('pc-ad-name')||{}).value||'My Ad';
  const hl  = (document.getElementById('pc-ad-headline')||{}).value||'';
  const bd  = (document.getElementById('pc-ad-body')||{}).value||'';
  const em  = (document.getElementById('pc-emoji-input')||{}).value||'🚀';
  const cta = (document.getElementById('pc-ad-cta')||{}).value||'Learn more';
  const url = (document.getElementById('pc-ad-url')||{}).value||'';
  const tags= ((document.getElementById('pc-ad-tags')||{}).value||'').split(',').map(t=>t.trim()).filter(Boolean);

  const post = {
    id: 'pc_'+Date.now(),
    type: 'pub',
    text: (hl?hl+'\n\n':'')+bd+(cta?'\n\n👉 '+cta:''),
    projName: nm, projEmoji: em, projType: 'PubCreator',
    user: window._currentUser?.id||'me',
    plan: 'elite', likes: 0, comments: 0, shares: 0,
    postUrl: url, tags: tags
  };

  if(typeof FAKE_POSTS_POOL !== 'undefined') FAKE_POSTS_POOL.unshift(post);
  if(typeof renderFeed === 'function') renderFeed();
  toast('🚀 Your ad is live! Check the Feed →');
  setTimeout(() => { showAppTab('feed', document.querySelector('[data-tab=feed]')); }, 1200);
}

// ── AI ASSIST (simulated) ──
const PC_AI_HEADLINES = [
  'Turn Your Passion Into Profit — Starting Today',
  '10x Your Results Without 10x The Work',
  'The Unfair Advantage Creators Are Using Right Now',
  'Stop Struggling. Start Growing. Here\'s How.',
  'Join 10,000+ Creators Who\'ve Made The Switch',
];
const PC_AI_HOOKS = [
  '→ This changes everything.',
  '⚡ Results in 24 hours or your money back.',
  '🔥 Only 7 spots left this month.',
  '✅ Trusted by top creators worldwide.',
  '🎯 Finally — something that actually works.',
];
function pcAIAssist(type) {
  const loadEl = document.getElementById('pc-ai-loading');
  if(loadEl) loadEl.style.display='block';
  setTimeout(() => {
    if(loadEl) loadEl.style.display='none';
    const nm  = (document.getElementById('pc-ad-name')||{}).value||'my project';
    const obj = (document.getElementById('pc-ad-objective')||{}).value||'Drive traffic';
    if(type==='headline'||type==='full') {
      const hl = document.getElementById('pc-ad-headline');
      if(hl) hl.value = PC_AI_HEADLINES[Math.floor(Math.random()*PC_AI_HEADLINES.length)];
    }
    if(type==='hook'||type==='full') {
      const hk = document.getElementById('pc-ad-hook');
      if(hk) hk.value = PC_AI_HOOKS[Math.floor(Math.random()*PC_AI_HOOKS.length)];
    }
    if(type==='body'||type==='full') {
      const bd = document.getElementById('pc-ad-body');
      if(bd) bd.value = `Are you tired of slow growth and wasted effort?\n\n${nm} is the solution you've been waiting for.\n\n✅ Built for serious creators\n✅ Results you can measure from day one\n✅ Backed by a proven system\n\n${obj} has never been easier. Join hundreds of creators who are already winning.\n\n👉 Click below to get started — your success starts now.`;
    }
    pcUpdatePreview();
    toast('✨ AI copy generated!');
  }, 1400);
}

// ── AD GROUP INIT ──
function pcInitGroup() {
  const container = document.getElementById('pcg-ads-container');
  if(!container||container.children.length>0) return;
  PC_AD_CATS.forEach((cat, i) => {
    const card = document.createElement('div');
    card.className = 'pcg-ad-card';
    card.id = 'pcg-card-'+i;
    card.innerHTML = `
      <div class="pcg-card-header" onclick="pcToggleAdCard(${i})" style="background:${cat.bg};border-bottom:1px solid ${cat.border}">
        <div class="pcg-num">${i+1}</div>
        <div style="flex:1">
          <div style="display:flex;align-items:center;gap:8px">
            <span class="pcg-cat-label" style="background:${cat.bg};border:1px solid ${cat.border};color:${cat.color}">${cat.label}</span>
            <span id="pcg-adname-${i}" style="font-family:'DM Mono',monospace;font-size:10px;color:rgba(255,255,255,0.35);letter-spacing:0.5px">Click to configure →</span>
          </div>
        </div>
        <div id="pcg-chevron-${i}" style="color:${cat.color};font-size:12px;transition:transform 0.3s;flex-shrink:0">▼</div>
      </div>
      <div class="pcg-card-body" id="pcg-body-${i}">
        <div style="display:grid;grid-template-columns:1fr 1fr;gap:10px">
          <div class="fg"><label style="color:${cat.color};font-size:10px;font-family:'DM Mono',monospace;letter-spacing:1px">AD NAME *</label><input type="text" id="pcg-name-${i}" placeholder="Name for this ${cat.label.replace(/[^a-zA-Z ]/g,'')} ad" style="border-color:${cat.border}" oninput="pcgUpdateLabel(${i})"/></div>
          <div class="fg"><label style="color:${cat.color};font-size:10px;font-family:'DM Mono',monospace;letter-spacing:1px">HEADLINE *</label><input type="text" id="pcg-hl-${i}" placeholder="Attention-grabbing headline" style="border-color:${cat.border}"/></div>
        </div>
        <div class="fg"><label style="color:${cat.color};font-size:10px;font-family:'DM Mono',monospace;letter-spacing:1px">AD BODY *</label><textarea id="pcg-body-txt-${i}" rows="3" placeholder="Describe your offer, key benefits, and CTA…" style="border-color:${cat.border}"></textarea></div>
        <div style="display:grid;grid-template-columns:1fr 1fr;gap:10px">
          <div class="fg"><label style="color:${cat.color};font-size:10px;font-family:'DM Mono',monospace;letter-spacing:1px">CTA TEXT</label><input type="text" id="pcg-cta-${i}" placeholder="e.g. Get started →" style="border-color:${cat.border}"/></div>
          <div class="fg"><label style="color:${cat.color};font-size:10px;font-family:'DM Mono',monospace;letter-spacing:1px">LINK / URL</label><input type="url" id="pcg-url-${i}" placeholder="https://…" style="border-color:${cat.border}"/></div>
        </div>
        <button onclick="pcgAIFill(${i},'${cat.id}')" style="align-self:flex-start;padding:7px 16px;background:${cat.bg};border:1.5px solid ${cat.border};border-radius:6px;font-family:'DM Mono',monospace;font-size:9px;font-weight:700;letter-spacing:1px;color:${cat.color};cursor:pointer">🤖 AI FILL THIS AD</button>
      </div>`;
    container.appendChild(card);
  });
}

function pcToggleAdCard(i) {
  const body  = document.getElementById('pcg-body-'+i);
  const chev  = document.getElementById('pcg-chevron-'+i);
  const card  = document.getElementById('pcg-card-'+i);
  const isOpen = body && body.classList.contains('open');
  if(isOpen) {
    body.classList.remove('open'); body.style.display='none';
    card.classList.remove('expanded');
    if(chev) chev.style.transform='';
  } else {
    body.classList.add('open'); body.style.display='flex';
    card.classList.add('expanded');
    if(chev) chev.style.transform='rotate(180deg)';
  }
}

function pcgUpdateLabel(i) {
  const nm = (document.getElementById('pcg-name-'+i)||{}).value||'';
  const lb = document.getElementById('pcg-adname-'+i);
  if(lb) lb.textContent = nm || 'Click to configure →';
}

const PCG_AI_BODIES = {
  product: 'Looking for the best [product] on the market?\n\n✅ Premium quality guaranteed\n✅ Fast worldwide delivery\n✅ 30-day money-back promise\n\nJoin thousands of satisfied customers. Limited stock — order yours today.',
  service: 'Tired of juggling everything alone?\n\nMy professional service delivers:\n🎯 Tailored solutions for your goals\n⚡ Fast turnaround & clear communication\n📈 Proven results across industries\n\nLet\'s work together. DM now for a free consultation.',
  course: 'What if you could learn this in 30 days?\n\nMy course gives you:\n📚 Step-by-step video lessons\n🛠 Practical exercises & real case studies\n💬 Private community access\n\nOver 500 students enrolled. Your transformation starts today.',
  collab: 'Looking for the right partner to scale faster?\n\nI\'m open to collaborations on:\n🤝 Joint projects & co-creation\n📢 Cross-promotion & audience sharing\n💡 New business opportunities\n\nDrop me a message — let\'s build something great together.',
  campaign: 'This is your invitation to something big.\n\n🎯 Campaign goal: maximum reach & engagement\n📅 Limited time · act now\n🏆 Join early & get exclusive bonuses\n\nSpots are filling fast. Don\'t miss your window.',
};
function pcgAIFill(i, catId) {
  const nm  = document.getElementById('pcg-name-'+i);
  const hl  = document.getElementById('pcg-hl-'+i);
  const bd  = document.getElementById('pcg-body-txt-'+i);
  const cta = document.getElementById('pcg-cta-'+i);
  const campaignName = (document.getElementById('pcg-campaign-name')||{}).value||'My Campaign';
  if(!nm.value) nm.value = campaignName + ' — ' + PC_AD_CATS[i].label.replace(/[^a-zA-Z ]/g,'').trim();
  if(!hl.value) hl.value = PC_AI_HEADLINES[i % PC_AI_HEADLINES.length];
  if(!bd.value) bd.value = PCG_AI_BODIES[catId] || PCG_AI_BODIES.campaign;
  if(!cta.value) cta.value = ['Get started →','Learn more →','Book now →','Join for free →','Claim your spot →'][i];
  pcgUpdateLabel(i);
  toast('🤖 Ad #'+(i+1)+' filled by AI!');
}

function pcLaunchGroup() {
  const campaignName = (document.getElementById('pcg-campaign-name')||{}).value;
  if(!campaignName) { toast('⚠️ Please enter a campaign name'); return; }
  let launched = 0;
  PC_AD_CATS.forEach((cat, i) => {
    const nm  = (document.getElementById('pcg-name-'+i)||{}).value;
    const hl  = (document.getElementById('pcg-hl-'+i)||{}).value;
    const bd  = (document.getElementById('pcg-body-txt-'+i)||{}).value;
    const cta = (document.getElementById('pcg-cta-'+i)||{}).value||'Learn more';
    const url = (document.getElementById('pcg-url-'+i)||{}).value||'';
    if(!nm||!hl) return; // skip empty
    const post = {
      id: 'pcg_'+i+'_'+Date.now(),
      type: 'pub',
      text: hl+'\n\n'+bd+(cta?'\n\n👉 '+cta:''),
      projName: nm, projEmoji: ['🛍️','💻','📚','🤝','🎯'][i], projType: cat.label.replace(/[^a-zA-Z ]/g,'').trim(),
      user: window._currentUser?.id||'me', plan: 'elite', likes: 0, comments: 0, shares: 0,
      postUrl: url, campaign: campaignName
    };
    if(typeof FAKE_POSTS_POOL !== 'undefined') FAKE_POSTS_POOL.unshift(post);
    launched++;
  });
  if(launched===0) { toast('⚠️ Please configure at least one ad'); return; }
  if(typeof renderFeed === 'function') renderFeed();
  toast('🚀 '+launched+' ad'+(launched>1?'s':'')+' launched from campaign "'+campaignName+'"!');
  setTimeout(() => showAppTab('feed', document.querySelector('[data-tab=feed]')), 1400);
}

// ═══════════════════════════════════════════
// ── SPONSOR PANEL ──
// ═══════════════════════════════════════════

const SP_PRICES = {
  'feed-banner':   { daily: 9.99,  reach: '~240,000 impressions/month'  },
  'popup-banner':  { daily: 14.99, reach: '~150,000 impressions/month'  },
  'showcase-top':  { daily: 19.99, reach: '~105,000 impressions/month'  },
  'home-hero':     { daily: 29.99, reach: '~360,000 impressions/month'  },
  'push-notif':    { daily: 4.99,  reach: 'Full community blast'         },
  'full-package':  { daily: 59.99, reach: '~855,000 impressions/month'  },
  'hanging-card':  { daily: 17.99, reach: '~180,000 impressions/month'  },
};

let _spCurrentPlacement = 'feed-banner';
let _spCurrentDays = 1;
let _spCampaigns = [];
let _spBalance = 0;

function showSponsorTab(el) {
  showAppTab('sponsor', el);
}

function spSwitchTab(tab, btn) {
  document.querySelectorAll('.sp-tab').forEach(t => {
    t.classList.remove('active');
    t.style.background = 'transparent';
    t.style.color = 'rgba(244,63,94,0.4)';
  });
  btn.classList.add('active');
  document.querySelectorAll('.sp-panel').forEach(p => p.style.display='none');
  const panel = document.getElementById('sppanel-'+tab);
  if(panel) { panel.style.display='block'; panel.style.animation='fadeUp 0.25s ease'; }
  if(tab==='active') spRenderCampaigns();
  if(tab==='stats') spRenderStats();
}

function spSelectSlot(slotId) {
  _spCurrentPlacement = slotId;
  // Switch to create tab
  const createBtn = document.getElementById('sptab-create');
  if(createBtn) spSwitchTab('create', createBtn);
  // Select the right placement
  document.querySelectorAll('.sp-place-opt').forEach(o => {
    o.classList.remove('selected');
    o.style.background = 'transparent';
    o.style.borderColor = 'rgba(244,63,94,0.15)';
  });
  const opt = document.getElementById('sppl-'+slotId);
  if(opt) { opt.classList.add('selected'); opt.style.background='rgba(244,63,94,0.12)'; opt.style.borderColor='rgba(244,63,94,0.55)'; }
  spUpdateBudget();
}

function spTogglePlacement(slotId, el) {
  _spCurrentPlacement = slotId;
  document.querySelectorAll('.sp-place-opt').forEach(o => {
    o.classList.remove('selected');
    o.style.background = 'transparent';
    o.style.borderColor = 'rgba(244,63,94,0.15)';
  });
  el.classList.add('selected');
  el.style.background = 'rgba(244,63,94,0.12)';
  el.style.borderColor = 'rgba(244,63,94,0.55)';
  spUpdateBudget();
}

function spSetDays(n) {
  _spCurrentDays = n;
  document.querySelectorAll('.sp-day-btn').forEach(b => {
    b.classList.remove('active');
    b.style.background = 'transparent';
    b.style.borderColor = 'rgba(244,63,94,0.15)';
    b.style.color = 'rgba(244,63,94,0.4)';
  });
  const btn = document.getElementById('spd-'+n);
  if(btn) { btn.classList.add('active'); btn.style.background='rgba(244,63,94,0.12)'; btn.style.borderColor='rgba(244,63,94,0.5)'; btn.style.color='#f43f5e'; }
  spUpdateBudget();
}

function spUpdateBudget() {
  const price = SP_PRICES[_spCurrentPlacement] || SP_PRICES['feed-banner'];
  const total = price.daily;
  const el = document.getElementById('sp-budget-total');
  const reach = document.getElementById('sp-budget-reach');
  if(el) el.textContent = '$'+total.toFixed(2);
  if(reach) reach.textContent = price.reach;
}

// Live preview update
document.addEventListener('input', function(e) {
  if(e.target.id === 'sp-ad-headline') {
    const el = document.getElementById('sp-preview-headline');
    if(el) el.textContent = e.target.value || 'Your headline will appear here';
  }
  if(e.target.id === 'sp-ad-body') {
    const el = document.getElementById('sp-preview-body');
    if(el) el.textContent = e.target.value.substring(0,80) || 'Your ad description…';
  }
  if(e.target.id === 'sp-ad-cta') {
    const el = document.getElementById('sp-preview-cta');
    if(el) el.textContent = e.target.value || 'Learn more →';
  }
});

function spSubmitAd() {
  const brand   = (document.getElementById('sp-ad-brand')||{}).value;
  const headline= (document.getElementById('sp-ad-headline')||{}).value;
  const body    = (document.getElementById('sp-ad-body')||{}).value;
  const cta     = (document.getElementById('sp-ad-cta')||{}).value || 'Learn more';
  const url     = (document.getElementById('sp-ad-url')||{}).value;
  if(!brand||!headline||!body) { toast('⚠️ Please fill in Brand, Headline and Body'); return; }

  const price = SP_PRICES[_spCurrentPlacement] || SP_PRICES['feed-banner'];
  const total = price.daily;

  const campaign = {
    id: 'sp_'+Date.now(),
    brand, headline, body, cta, url,
    placement: _spCurrentPlacement,
    days: _spCurrentDays,
    total: total.toFixed(2),
    status: 'active',
    impressions: 0,
    clicks: 0,
    startDate: new Date().toLocaleDateString('en-GB'),
  };

  _spCampaigns.unshift(campaign);

  const adObj = {
    name: brand, plan: 'elite', niche: 'Sponsor',
    title: headline, cta: cta,
    userId: currentUser ? currentUser.email : null,
    color: '#f43f5e', border: 'rgba(244,63,94,0.6)',
    bg: 'linear-gradient(135deg,#1a0008,#0e0005)'
  };

  // Inject into appropriate pool
  if(typeof SPONSORED_ADS !== 'undefined') {
    SPONSORED_ADS.unshift(adObj);
  }

  // Show preview immediately based on placement
  if (_spCurrentPlacement === 'hanging-card') {
    setTimeout(() => { typeof showHangingCard === 'function' && showHangingCard(); }, 800);
  } else {
    _removeSponsoredBanner && _removeSponsoredBanner();
    setTimeout(showSponsoredAd, 800);
  }

  // Live notification toast — rich version
  showAdLiveNotif(brand, _spCurrentPlacement, total);

  // Switch to My Campaigns
  const activeBtn = document.getElementById('sptab-active');
  if(activeBtn) spSwitchTab('active', activeBtn);
}

function spRenderCampaigns() {
  const el = document.getElementById('sp-campaigns-list');
  if(!el) return;
  if(!_spCampaigns.length) {
    el.innerHTML = `<div style="text-align:center;padding:60px 20px;color:var(--muted)">
      <div style="font-size:48px;margin-bottom:12px">📊</div>
      <div style="font-family:'Bebas Neue',sans-serif;font-size:22px;letter-spacing:2px;color:rgba(244,63,94,0.5);margin-bottom:8px">NO ACTIVE CAMPAIGNS</div>
      <p style="font-size:13px;line-height:1.7">You haven't launched any sponsored campaigns yet.</p>
    </div>`;
    return;
  }
  el.innerHTML = _spCampaigns.map(c => {
    const pData = SP_PRICES[c.placement]||SP_PRICES['feed-banner'];
    c.impressions = c.impressions || Math.floor(Math.random()*800+200);
    c.clicks = c.clicks || Math.floor(c.impressions * (0.05 + Math.random()*0.1));
    const ctr = ((c.clicks/c.impressions)*100).toFixed(1);
    return `<div style="background:var(--s1);border:1.5px solid rgba(244,63,94,0.2);border-radius:12px;padding:16px 18px;margin-bottom:12px;transition:all 0.2s" onmouseover="this.style.borderColor='rgba(244,63,94,0.45)'" onmouseout="this.style.borderColor='rgba(244,63,94,0.2)'">
      <div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:12px;flex-wrap:wrap;gap:8px">
        <div style="display:flex;align-items:center;gap:10px">
          <div style="width:36px;height:36px;border-radius:8px;background:linear-gradient(135deg,#f43f5e,#be123c);display:flex;align-items:center;justify-content:center;font-size:16px">💼</div>
          <div>
            <div style="font-size:14px;font-weight:700;color:#f0fdf4">${c.brand}</div>
            <div style="font-family:'DM Mono',monospace;font-size:8px;color:rgba(244,63,94,0.5);letter-spacing:1px">${c.placement.replace(/-/g,' ').toUpperCase()} · ${c.startDate}</div>
          </div>
        </div>
        <div style="display:flex;align-items:center;gap:6px">
          <span style="font-family:'DM Mono',monospace;font-size:8px;background:rgba(34,197,94,0.1);border:1px solid rgba(34,197,94,0.25);border-radius:3px;padding:2px 8px;color:var(--g4)">● ACTIVE</span>
          <span style="font-family:'Bebas Neue',sans-serif;font-size:16px;color:#f43f5e">$${c.total}</span>
        </div>
      </div>
      <div style="font-size:12px;color:var(--muted);margin-bottom:12px;line-height:1.5">"${c.headline}"</div>
      <div style="display:grid;grid-template-columns:repeat(3,1fr);gap:8px">
        <div style="background:rgba(244,63,94,0.05);border-radius:8px;padding:10px;text-align:center">
          <div style="font-family:'Bebas Neue',sans-serif;font-size:20px;color:#f43f5e">${c.impressions.toLocaleString()}</div>
          <div style="font-size:10px;color:var(--muted)">Impressions</div>
        </div>
        <div style="background:rgba(244,63,94,0.05);border-radius:8px;padding:10px;text-align:center">
          <div style="font-family:'Bebas Neue',sans-serif;font-size:20px;color:#f43f5e">${c.clicks}</div>
          <div style="font-size:10px;color:var(--muted)">Clicks</div>
        </div>
        <div style="background:rgba(244,63,94,0.05);border-radius:8px;padding:10px;text-align:center">
          <div style="font-family:'Bebas Neue',sans-serif;font-size:20px;color:#f43f5e">${ctr}%</div>
          <div style="font-size:10px;color:var(--muted)">CTR</div>
        </div>
      </div>
    </div>`;
  }).join('');
}

function spRenderStats() {
  const totImp = _spCampaigns.reduce((s,c) => s+(c.impressions||0), 0);
  const totClk = _spCampaigns.reduce((s,c) => s+(c.clicks||0), 0);
  const totSpent = _spCampaigns.reduce((s,c) => s+parseFloat(c.total||0), 0);
  const ctr = totImp > 0 ? ((totClk/totImp)*100).toFixed(1)+'%' : '—';
  const elI = document.getElementById('sp-stat-impressions'); if(elI) elI.textContent = totImp.toLocaleString();
  const elC = document.getElementById('sp-stat-clicks'); if(elC) elC.textContent = totClk.toLocaleString();
  const elCTR = document.getElementById('sp-stat-ctr'); if(elCTR) elCTR.textContent = ctr;
  const elS = document.getElementById('sp-stat-spent'); if(elS) elS.textContent = '$'+totSpent.toFixed(2);
}

function spTopUp() {
  toast('💳 Top-up — Stripe integration coming soon!');
}

// ── COMPACT APP BAR ON SCROLL ──
(function(){
  let lastY = 0;
  function handleAppScroll() {
    const bar = document.querySelector('.app-bar');
    if(!bar) return;
    const y = window.scrollY;
    if(y > lastY && y > 80) bar.classList.add('bar-hidden');
    else bar.classList.remove('bar-hidden');
    lastY = y;
  }
  document.addEventListener('DOMContentLoaded', function() {
    window.addEventListener('scroll', handleAppScroll, {passive:true});
  });
})();
</script>

<!-- FLASH OFFER BAR -->
<div class="flash-offer-bar" id="flash-offer-bar">
  <div class="flash-offer-bar-inner" id="flash-offer-inner">
    <div class="flash-offer-pulse"></div>
    <div style="flex:1;min-width:0;">
      <div id="flash-offer-label" style="font-family:'DM Mono',monospace;font-size:7px;letter-spacing:2px;color:#ffd700;text-transform:uppercase;margin-bottom:1px;">⚡ INSTANT OFFER</div>
      <div id="flash-offer-name" style="font-family:'Bebas Neue',sans-serif;font-size:15px;letter-spacing:1px;color:#f0fdf4;line-height:1;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;"></div>
    </div>
    <div style="flex-shrink:0;text-align:right;margin-right:8px;">
      <div id="flash-offer-old" style="font-family:'DM Mono',monospace;font-size:9px;color:#6a6a4a;text-decoration:line-through;"></div>
      <div id="flash-offer-price" style="font-family:'Bebas Neue',sans-serif;font-size:22px;color:#ffd700;line-height:1;"></div>
    </div>
    <button id="flash-offer-btn" style="flex-shrink:0;padding:8px 14px;background:linear-gradient(135deg,#ffd700,#f97316);border:none;border-radius:8px;font-family:'Bebas Neue',sans-serif;font-size:14px;letter-spacing:1px;color:#040a05;cursor:pointer;font-weight:900;">PAYER</button>
    <button onclick="hideFlashOffer()" style="position:absolute;top:6px;right:6px;background:none;border:none;color:rgba(255,215,0,0.4);font-size:12px;cursor:pointer;padding:2px 4px;line-height:1;">✕</button>
  </div>
</div>

<script>
// ── FLASH OFFER BAR ──
var FLASH_POOL = [
  {name:'VB PRO -50%', hook:'Unlimited publishing', oldPrice:'19.99', price:'9.99'},
  {name:'ELITE Plan -40%', hook:'All premium features', oldPrice:'39.99', price:'23.99'},
  {name:'Collab Pack', hook:'AI Matching 3 months', oldPrice:'29.99', price:'14.99'},
  {name:'Boost x200', hook:'Put your ads at the top', oldPrice:'14.99', price:'7.49'},
  {name:'Diamond Pack', hook:'Credits + PRO + Collab', oldPrice:'49.99', price:'24.99'},
  {name:'VIP Launch', hook:'Badge + credits x2', oldPrice:'34.99', price:'17.49'},
];
var _flashTimer = null;
var _flashIdx = 0;

// ══════════════════════════════════════════════════════
//  GESTIONNAIRE ANTI-COLLISION — bas de page
//  Règle : sponsored banner et flash offer ne peuvent
//  jamais s'afficher en même temps (zone bottom partagée)
// ══════════════════════════════════════════════════════
var _bottomZoneBusy = false;   // true = bas de page occupé
var _flashPending   = false;   // flash offer en attente

function _setBottomBusy(val) {
  _bottomZoneBusy = val;
  // Si une offre flash attendait, on la lance maintenant
  if (!val && _flashPending) {
    _flashPending = false;
    setTimeout(_doShowFlashOffer, 800);
  }
}

function showFlashOffer() {
  if (_bottomZoneBusy) {
    // La zone est occupée par un sponsored banner → mettre en attente
    _flashPending = true;
    return;
  }
  _doShowFlashOffer();
}

function _doShowFlashOffer() {
  var bar = document.getElementById('flash-offer-bar');
  var tabHome = document.getElementById('tab-home');
  if (!bar || !tabHome || !tabHome.classList.contains('active')) return;
  if (_bottomZoneBusy) { _flashPending = true; return; } // double-check
  var deal = FLASH_POOL[_flashIdx % FLASH_POOL.length];
  _flashIdx++;
  document.getElementById('flash-offer-name').textContent = deal.name;
  document.getElementById('flash-offer-label').textContent = '⚡ INSTANT OFFER · ' + deal.hook;
  document.getElementById('flash-offer-old').textContent = deal.oldPrice + '$';
  document.getElementById('flash-offer-price').textContent = deal.price + '$';
  var btn = document.getElementById('flash-offer-btn');
  if (btn) btn.onclick = function() { payDeal(deal.name, deal.price); };
  bar.classList.add('visible');
  _setBottomBusy(true);
  clearTimeout(_flashTimer);
  _flashTimer = setTimeout(function() {
    bar.classList.remove('visible');
    _setBottomBusy(false);
    // Prochaine offre dans 8-15s
    setTimeout(showFlashOffer, 8000 + Math.random() * 7000);
  }, 6000);
}

function hideFlashOffer() {
  var bar = document.getElementById('flash-offer-bar');
  if (bar) bar.classList.remove('visible');
  clearTimeout(_flashTimer);
  _setBottomBusy(false);
}

// ✅ Flash offer : 1ère apparition après 5s, puis toutes les 30-40s
document.addEventListener('DOMContentLoaded', function() {
  setTimeout(function() {
    var tabHome = document.getElementById('tab-home');
    if (tabHome && tabHome.classList.contains('active')) showFlashOffer();
  }, 5000);
});// ═══════════════════════════════════════════
// ── SPONSORED ADS SYSTEM (every 3 min) ──
// ═══════════════════════════════════════════

const SPONSORED_ADS = [
  { name:'Alex Rivera',    plan:'vip',    niche:'SaaS',       title:'LaunchPad AI — Turn your idea into a startup in 7 days',      cta:'Contact', userId:'u_alex_r',  color:'#ffd700', border:'rgba(255,215,0,0.6)',   bg:'linear-gradient(135deg,#1c1400,#0e0800)' },
  { name:'Sophie Chen',   plan:'elite',  niche:'E-commerce', title:'$0 to $10k in 90 days — My exact dropshipping method',         cta:'DM me',   userId:'u_sophie_c',color:'#c084fc', border:'rgba(192,132,252,0.6)', bg:'linear-gradient(135deg,#160a28,#0a0518)' },
  { name:'Luna Park',     plan:'vip',    niche:'TikTok',     title:'1M views/month — My TikTok growth formula revealed',           cta:'Contact', userId:'u_luna_p',  color:'#ffd700', border:'rgba(255,215,0,0.6)',   bg:'linear-gradient(135deg,#1c1400,#0e0800)' },
  { name:'Marcus Osei',   plan:'elite',  niche:'AI Tools',   title:'10 AI tools that replace a full marketing team',               cta:'DM me',   userId:'u_marcus_o',color:'#c084fc', border:'rgba(192,132,252,0.6)', bg:'linear-gradient(135deg,#160a28,#0a0518)' },
  { name:'Jordan West',   plan:'legend', niche:'Web3',       title:'Web3 launch checklist — 5 successful launches, 0 failures',   cta:'Contact', userId:'u_jordan_w',color:'#fb923c', border:'rgba(249,115,22,0.6)',  bg:'linear-gradient(135deg,#2d1000,#180800)' },
  { name:'Camille Torres',plan:'vip',    niche:'Coaching',   title:'Sold 200 coaching sessions in 30 days — here\'s how',         cta:'DM me',   userId:'u_camille', color:'#ffd700', border:'rgba(255,215,0,0.6)',   bg:'linear-gradient(135deg,#1c1400,#0e0800)' },
  { name:'Nina Patel',    plan:'elite',  niche:'Newsletter', title:'My newsletter hit 50K subs in 6 months — steal my strategy',   cta:'DM me',   userId:'u_nina_p',  color:'#38bdf8', border:'rgba(56,189,248,0.6)',  bg:'linear-gradient(135deg,#001828,#000e18)' },
  { name:'Karim Slater',  plan:'legend', niche:'Fitness',    title:'Built a 7-figure fitness brand with 0 paid ads — here\'s how', cta:'Contact', userId:'u_karim_s', color:'#4ade80', border:'rgba(74,222,128,0.6)',  bg:'linear-gradient(135deg,#001a05,#000f03)' },
];

let _sponsorIdx = 0;
let _sponsorInterval = null;
let _sponsorAutoClose = null;

// ── Single unified function: removes any existing banner first ──
function _removeSponsoredBanner(cb) {
  // Remove ALL possible sponsored banners (by id and by class)
  document.querySelectorAll('#sponsored-ad-banner, .sponsored-ad-banner').forEach(el => el.remove());
  if (cb) cb();
}

function _buildSponsoredBanner(ad, bottomOffset, autoCloseSecs) {
  // Anti-collision : si flash offer visible → le masquer d'abord
  if (typeof hideFlashOffer === 'function') hideFlashOffer();
  _removeSponsoredBanner();
  if (_sponsorAutoClose) { clearTimeout(_sponsorAutoClose); _sponsorAutoClose = null; }
  if (typeof _setBottomBusy === 'function') _setBottomBusy(true);

  const planLabel = (ad.plan || 'creator').toUpperCase();
  const planGold  = ['elite','vip','legend'].includes(ad.plan);
  const planBg    = planGold ? 'linear-gradient(135deg,#ffd700,#ff8c00)' : `linear-gradient(135deg,${ad.color},${ad.color}aa)`;
  const planText  = planGold ? '#1a0a00' : '#fff';
  const initials  = (ad.name||'?')[0].toUpperCase();
  const ctaAction = `closeSponsoredAd();viewUserProfile('${ad.userId||ad.name}')`;

  const banner = document.createElement('div');
  banner.id = 'sponsored-ad-banner';
  banner.className = 'sponsored-ad-banner';
  banner.style.cssText = `position:fixed;bottom:${bottomOffset}px;left:50%;transform:translateX(-50%) translateY(110px);width:calc(100% - 24px);max-width:440px;z-index:99999;opacity:0;transition:all 0.45s cubic-bezier(0.34,1.15,0.64,1);pointer-events:none;`;

  banner.innerHTML = `
    <div style="background:${ad.bg};border:1.5px solid ${ad.border};border-radius:18px;padding:13px 14px;display:flex;align-items:center;gap:11px;box-shadow:0 0 28px ${ad.border.replace('0.6','0.18')},0 10px 36px rgba(0,0,0,0.65);position:relative;overflow:hidden;">
      <!-- shimmer -->
      <div style="position:absolute;inset:0;border-radius:18px;background:linear-gradient(105deg,transparent 40%,${ad.border.replace('0.6','0.07')} 50%,transparent 60%);pointer-events:none;"></div>
      <!-- SPONSORED badge -->
      <div style="position:absolute;top:5px;right:36px;font-family:'DM Mono',monospace;font-size:7px;color:${ad.color};opacity:0.55;letter-spacing:1px;">SPONSORED</div>
      <!-- Close ✕ -->
      <button onclick="closeSponsoredAd()" style="position:absolute;top:5px;right:8px;background:none;border:none;color:rgba(255,255,255,0.28);font-size:13px;cursor:pointer;padding:2px 5px;line-height:1;z-index:2;">✕</button>
      <!-- Avatar + plan -->
      <div style="display:flex;flex-direction:column;align-items:center;gap:4px;flex-shrink:0;cursor:pointer;" onclick="${ctaAction}">
        <div style="width:44px;height:44px;border-radius:50%;background:linear-gradient(135deg,#0b2e14,#0f3d1c);border:2px solid ${ad.border};display:flex;align-items:center;justify-content:center;font-size:19px;font-weight:900;color:${ad.color};font-family:'Bebas Neue',sans-serif;">${initials}</div>
        <div style="background:${planBg};color:${planText};font-family:'DM Mono',monospace;font-size:6px;font-weight:900;padding:1px 6px;border-radius:3px;letter-spacing:1px;white-space:nowrap;">${planLabel}</div>
      </div>
      <!-- Content -->
      <div style="flex:1;min-width:0;cursor:pointer;" onclick="${ctaAction}">
        <div style="display:flex;align-items:center;gap:5px;margin-bottom:3px;">
          <div style="font-size:12px;font-weight:800;color:#f0fdf4;">${ad.name}</div>
          <div style="background:rgba(255,255,255,0.06);border:1px solid rgba(255,255,255,0.1);border-radius:3px;padding:1px 5px;font-family:'DM Mono',monospace;font-size:7px;color:rgba(255,255,255,0.45);letter-spacing:0.5px;">${ad.niche||'Creator'}</div>
        </div>
        <div style="font-size:11px;font-weight:600;color:${ad.color};line-height:1.35;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;">${ad.title}</div>
      </div>
      <!-- CTA button -->
      <button onclick="${ctaAction}" style="flex-shrink:0;padding:8px 13px;background:${ad.border.replace('0.6','0.18')};border:1.5px solid ${ad.border};border-radius:9px;font-family:'DM Mono',monospace;font-size:9px;font-weight:800;color:${ad.color};cursor:pointer;letter-spacing:1px;white-space:nowrap;transition:all 0.2s;" onmouseover="this.style.background='${ad.border.replace('0.6','0.32')}';this.style.transform='scale(1.04)'" onmouseout="this.style.background='${ad.border.replace('0.6','0.18')}';this.style.transform=''">${ad.cta} →</button>
    </div>`;

  document.body.appendChild(banner);

  requestAnimationFrame(() => requestAnimationFrame(() => {
    banner.style.opacity = '1';
    banner.style.transform = 'translateX(-50%) translateY(0)';
    banner.style.pointerEvents = 'all';
  }));

  _sponsorAutoClose = setTimeout(() => closeSponsoredAd(), autoCloseSecs * 1000);
}

function showSponsoredAd() {
  if (!document.getElementById('app') || document.getElementById('app').style.display === 'none') return;

  // Anti-doublon personne : ne pas afficher la même personne que le hanging card actuel
  const hangingName = window._vbCurrentHangingName || null;
  let idx = _sponsorIdx % SPONSORED_ADS.length;
  let tries = 0;
  while (hangingName && SPONSORED_ADS[idx].name === hangingName && tries < SPONSORED_ADS.length) {
    idx = (idx + 1) % SPONSORED_ADS.length;
    tries++;
  }
  _sponsorIdx = (idx + 1) % SPONSORED_ADS.length;

  const ad = SPONSORED_ADS[idx];
  window._vbCurrentBannerName = ad.name;
  _buildSponsoredBanner(ad, 76, 9);
}

function showLoadingSponsoredAd() {
  const ad = SPONSORED_ADS[Math.floor(Math.random() * SPONSORED_ADS.length)];
  _buildSponsoredBanner(ad, 24, 7);
}

function closeSponsoredAd() {
  if (_sponsorAutoClose) { clearTimeout(_sponsorAutoClose); _sponsorAutoClose = null; }
  const banner = document.getElementById('sponsored-ad-banner');
  if (!banner) return;
  window._vbCurrentBannerName = null;
  banner.style.opacity = '0';
  banner.style.transform = 'translateX(-50%) translateY(110px)';
  banner.style.pointerEvents = 'none';
  setTimeout(() => {
    banner.remove();
    if (typeof _setBottomBusy === 'function') _setBottomBusy(false);
  }, 450);
}

// Launch: toutes les 45s (après 20s) — pas de pub au loading
document.addEventListener('DOMContentLoaded', function() {
  setTimeout(function() {
    _removeSponsoredBanner();
    showSponsoredAd();
    if (_sponsorInterval) clearInterval(_sponsorInterval);
    _sponsorInterval = setInterval(showSponsoredAd, 45 * 1000);
  }, 20000);
});

// ══════════════════════════════════════════════════════
//  HANGING CARD SYSTEM — carte suspendue à ficelle
// ══════════════════════════════════════════════════════

(function() {

const HANG_CSS = `
@keyframes vb-drop-in {
  0%   { transform: translateY(-120%) rotate(-4deg); opacity: 0; }
  55%  { transform: translateY(8px) rotate(1.5deg);  opacity: 1; }
  72%  { transform: translateY(-5px) rotate(-1deg);  opacity: 1; }
  84%  { transform: translateY(3px) rotate(0.5deg);  opacity: 1; }
  93%  { transform: translateY(-2px) rotate(0deg);   opacity: 1; }
  100% { transform: translateY(0px) rotate(0deg);    opacity: 1; }
}
@keyframes vb-swing {
  0%,100% { transform: rotate(-1.8deg); }
  50%      { transform: rotate(1.8deg);  }
}
@keyframes vb-string-appear {
  0%   { height: 0px; opacity: 0; }
  40%  { opacity: 1; }
  100% { height: var(--str-h, 60px); opacity: 1; }
}
@keyframes vb-slide-out {
  0%   { transform: translateX(0); opacity: 1; }
  100% { transform: translateX(140%); opacity: 0; }
}
@keyframes vb-shimmer {
  0%   { background-position: -200% center; }
  100% { background-position: 200% center;  }
}
#vb-hang-wrap {
  position: fixed;
  top: 0;
  right: 18px;
  z-index: 99998;
  display: flex;
  flex-direction: column;
  align-items: center;
  pointer-events: none;
  width: 190px;
}
#vb-hang-string {
  width: 2px;
  background: linear-gradient(180deg, rgba(255,255,255,0.55) 0%, rgba(200,180,120,0.7) 60%, rgba(180,140,60,0.5) 100%);
  border-radius: 2px;
  height: 0px;
  --str-h: 64px;
  animation: vb-string-appear 0.55s cubic-bezier(0.4,0,0.2,1) forwards;
  box-shadow: 0 0 3px rgba(255,220,100,0.3);
  flex-shrink: 0;
}
#vb-hang-card {
  pointer-events: all;
  width: 190px;
  border-radius: 16px;
  overflow: hidden;
  animation: vb-drop-in 0.9s cubic-bezier(0.34,1.3,0.64,1) forwards,
             vb-swing 3.8s ease-in-out 0.9s infinite;
  transform-origin: top center;
  box-shadow:
    0 8px 32px rgba(0,0,0,0.55),
    0 2px 8px rgba(0,0,0,0.3),
    inset 0 1px 0 rgba(255,255,255,0.08);
  cursor: pointer;
  position: relative;
}
#vb-hang-card .vb-hook {
  position: absolute;
  top: -1px;
  left: 50%;
  transform: translateX(-50%);
  width: 12px;
  height: 7px;
  border-radius: 0 0 8px 8px;
  background: linear-gradient(180deg, rgba(200,170,80,0.9), rgba(160,120,40,0.7));
  box-shadow: 0 2px 4px rgba(0,0,0,0.4);
  z-index: 2;
}
#vb-hang-card .vb-card-inner {
  padding: 14px 13px 13px;
  display: flex;
  flex-direction: column;
  gap: 9px;
  position: relative;
}
#vb-hang-card .vb-shimmer-bar {
  position: absolute;
  inset: 0;
  background: linear-gradient(105deg, transparent 30%, rgba(255,255,255,0.07) 50%, transparent 70%);
  background-size: 200% 100%;
  animation: vb-shimmer 3s ease-in-out infinite;
  pointer-events: none;
  border-radius: 16px;
}
#vb-hang-card .vb-sp-tag {
  font-family: 'DM Mono', monospace;
  font-size: 7px;
  letter-spacing: 1.5px;
  opacity: 0.5;
  text-align: right;
  line-height: 1;
}
#vb-hang-card .vb-ava-row {
  display: flex;
  align-items: center;
  gap: 9px;
}
#vb-hang-card .vb-ava {
  width: 38px;
  height: 38px;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-family: 'Bebas Neue', sans-serif;
  font-size: 18px;
  font-weight: 900;
  flex-shrink: 0;
  border: 2px solid rgba(255,255,255,0.15);
}
#vb-hang-card .vb-name {
  font-family: 'Plus Jakarta Sans', sans-serif;
  font-size: 12px;
  font-weight: 800;
  color: #f0fdf4;
  line-height: 1.2;
}
#vb-hang-card .vb-plan-badge {
  font-family: 'DM Mono', monospace;
  font-size: 6px;
  font-weight: 900;
  padding: 1px 5px;
  border-radius: 3px;
  letter-spacing: 1px;
  display: inline-block;
  margin-top: 2px;
}
#vb-hang-card .vb-title {
  font-size: 10px;
  font-family: 'Plus Jakarta Sans', sans-serif;
  font-weight: 600;
  line-height: 1.45;
  display: -webkit-box;
  -webkit-line-clamp: 3;
  -webkit-box-orient: vertical;
  overflow: hidden;
}
#vb-hang-card .vb-niche {
  font-family: 'DM Mono', monospace;
  font-size: 7px;
  background: rgba(255,255,255,0.06);
  border: 1px solid rgba(255,255,255,0.1);
  border-radius: 3px;
  padding: 1px 6px;
  display: inline-block;
  letter-spacing: 0.5px;
  color: rgba(255,255,255,0.45);
}
#vb-hang-card .vb-cta {
  width: 100%;
  padding: 8px;
  border: none;
  border-radius: 9px;
  font-family: 'DM Mono', monospace;
  font-size: 9px;
  font-weight: 800;
  letter-spacing: 1px;
  cursor: pointer;
  transition: all 0.18s;
  text-align: center;
}
#vb-hang-card .vb-cta:hover {
  filter: brightness(1.15);
  transform: scale(1.03);
}
#vb-hang-card .vb-close {
  position: absolute;
  top: 7px;
  right: 8px;
  background: rgba(0,0,0,0.25);
  border: none;
  border-radius: 50%;
  width: 18px;
  height: 18px;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 9px;
  color: rgba(255,255,255,0.5);
  cursor: pointer;
  z-index: 3;
  transition: all 0.15s;
  padding: 0;
}
#vb-hang-card .vb-close:hover {
  background: rgba(0,0,0,0.5);
  color: #fff;
}
#vb-hang-wrap.vb-exit {
  animation: vb-slide-out 0.5s cubic-bezier(0.55,0,1,0.45) forwards;
}
`;

let _hangInterval = null;
let _hangHideTimer = null;
let _hangIdx = 0;

function _injectHangStyles() {
  if (document.getElementById('vb-hang-styles')) return;
  const s = document.createElement('style');
  s.id = 'vb-hang-styles';
  s.textContent = HANG_CSS;
  document.head.appendChild(s);
}

function _removeHangCard() {
  const w = document.getElementById('vb-hang-wrap');
  if (!w) return;
  w.classList.add('vb-exit');
  setTimeout(() => w.remove(), 520);
  if (_hangHideTimer) { clearTimeout(_hangHideTimer); _hangHideTimer = null; }
}

function showHangingCard() {
  if (!document.getElementById('app') || document.getElementById('app').style.display === 'none') return;

  _injectHangStyles();

  // Remove any existing
  const old = document.getElementById('vb-hang-wrap');
  if (old) old.remove();
  if (_hangHideTimer) { clearTimeout(_hangHideTimer); _hangHideTimer = null; }

  const ads = typeof SPONSORED_ADS !== 'undefined' ? SPONSORED_ADS : [];
  if (!ads.length) return;

  // Anti-doublon personne : ne pas afficher la même personne que le banner du bas
  const bannerName = window._vbCurrentBannerName || null;
  let idx = _hangIdx % ads.length;
  let tries = 0;
  while (bannerName && ads[idx].name === bannerName && tries < ads.length) {
    idx = (idx + 1) % ads.length;
    tries++;
  }
  _hangIdx = (idx + 1) % ads.length;

  const ad = ads[idx];
  window._vbCurrentHangingName = ad.name;

  const planGold  = ['elite','vip','legend'].includes(ad.plan);
  const planBg    = planGold ? 'linear-gradient(135deg,#ffd700,#ff8c00)' : `${ad.color}cc`;
  const planText  = planGold ? '#1a0a00' : '#fff';
  const planLabel = (ad.plan||'creator').toUpperCase();
  const initial   = (ad.name||'?')[0].toUpperCase();
  const strHeight = 56 + Math.random() * 24 | 0; // 56–80px ficelle

  // Wrap
  const wrap = document.createElement('div');
  wrap.id = 'vb-hang-wrap';

  // String
  const str = document.createElement('div');
  str.id = 'vb-hang-string';
  str.style.setProperty('--str-h', strHeight + 'px');
  wrap.appendChild(str);

  // Card
  const card = document.createElement('div');
  card.id = 'vb-hang-card';
  card.style.background = ad.bg || 'linear-gradient(135deg,#0b1a0d,#060e07)';
  card.style.border = `1.5px solid ${ad.border || 'rgba(34,197,94,0.4)'}`;

  const ctaFn = `closeHangingCard();viewUserProfile('${ad.userId||ad.name}')`;

  card.innerHTML = `
    <div class="vb-hook"></div>
    <div class="vb-shimmer-bar"></div>
    <div class="vb-card-inner">
      <button class="vb-close" onclick="closeHangingCard()" title="Close">✕</button>
      <div class="vb-sp-tag" style="color:${ad.color}">SPONSORED</div>
      <div class="vb-ava-row">
        <div class="vb-ava" style="background:linear-gradient(135deg,${ad.color}22,${ad.color}0d);color:${ad.color};">${initial}</div>
        <div>
          <div class="vb-name">${ad.name}</div>
          <span class="vb-plan-badge" style="background:${planBg};color:${planText};">${planLabel}</span>
        </div>
      </div>
      <span class="vb-niche">${ad.niche||'Creator'}</span>
      <div class="vb-title" style="color:${ad.color};">${ad.title}</div>
      <button class="vb-cta" style="background:${ad.border.replace('0.6','0.22')};border:1.5px solid ${ad.border};color:${ad.color};" onclick="${ctaFn}">${ad.cta} →</button>
    </div>`;

  wrap.appendChild(card);
  document.body.appendChild(wrap);

  // Auto-dismiss after 12s
  _hangHideTimer = setTimeout(closeHangingCard, 12000);
}

window.closeHangingCard = function() {
  window._vbCurrentHangingName = null;
  _removeHangCard();
};

// Start: first hanging card après 10s, puis toutes les 50s
document.addEventListener('DOMContentLoaded', function() {
  setTimeout(function() {
    showHangingCard();
    _hangInterval = setInterval(showHangingCard, 50 * 1000);
  }, 10000);
});

})(); // end IIFE

// ══════════════════════════════════════════
//  PROFIL CLIQUABLE depuis les pubs
// ══════════════════════════════════════════
function viewUserProfile(userId) {
  if (!userId) return;
  const accounts = typeof _getAccounts === 'function' ? _getAccounts() : {};
  const user = Object.values(accounts).find(a =>
    a.email === userId || a.username === userId ||
    a.email.split('@')[0] === userId ||
    'u_'+a.name?.toLowerCase().replace(/\s+/g,'_') === userId
  ) || Object.values(accounts).find(a => a.name?.toLowerCase().replace(/\s+/g,'_') === userId.replace('u_','').replace(/_/g,'_'));

  // Remove any existing profile popup
  document.getElementById('vb-profile-popup')?.remove();

  const u = user || {
    name: userId.replace('u_','').replace(/_/g,' ').replace(/\b\w/g,c=>c.toUpperCase()),
    email: userId, plan: 'creator', bio: 'Creator on ViralBoost', niche: 'Creator'
  };
  const initial = (u.name||'?')[0].toUpperCase();
  const planColors = {free:'#6b7280',starter:'#22c55e',pro:'#3b82f6',elite:'#a855f7',legend:'#f97316',vip:'#ffd700',creator:'#22c55e'};
  const col = planColors[u.plan] || '#22c55e';

  const popup = document.createElement('div');
  popup.id = 'vb-profile-popup';
  popup.style.cssText = `position:fixed;inset:0;z-index:999999;display:flex;align-items:center;justify-content:center;background:rgba(0,0,0,0.7);backdrop-filter:blur(6px);animation:fadeIn 0.2s ease;`;
  popup.onclick = (e) => { if(e.target===popup) popup.remove(); };

  popup.innerHTML = `
    <div style="background:linear-gradient(135deg,#0b1a0d,#060e07);border:1.5px solid ${col}44;border-radius:24px;padding:28px 24px;max-width:340px;width:90%;position:relative;box-shadow:0 0 60px ${col}22,0 24px 64px rgba(0,0,0,0.7);animation:fadeUp 0.3s cubic-bezier(0.34,1.3,0.64,1);">
      <button onclick="document.getElementById('vb-profile-popup').remove()" style="position:absolute;top:14px;right:14px;background:rgba(255,255,255,0.06);border:1px solid rgba(255,255,255,0.1);border-radius:50%;width:28px;height:28px;color:rgba(255,255,255,0.4);font-size:12px;cursor:pointer;display:flex;align-items:center;justify-content:center;">✕</button>
      <!-- Avatar -->
      <div style="text-align:center;margin-bottom:18px;">
        <div style="width:72px;height:72px;border-radius:50%;background:linear-gradient(135deg,${col}33,${col}11);border:3px solid ${col}66;display:flex;align-items:center;justify-content:center;font-size:30px;font-weight:900;color:${col};font-family:'Bebas Neue',sans-serif;margin:0 auto 10px;">${initial}</div>
        <div style="font-family:'Plus Jakarta Sans',sans-serif;font-size:18px;font-weight:800;color:#f0fdf4;">${u.name||'Creator'}</div>
        ${u.title ? `<div style="font-size:12px;color:${col};margin-top:2px;">${u.title}</div>` : ''}
        <div style="margin-top:8px;display:inline-flex;align-items:center;gap:6px;">
          <span style="background:${col}22;border:1px solid ${col}55;border-radius:4px;padding:2px 8px;font-family:'DM Mono',monospace;font-size:8px;color:${col};font-weight:900;letter-spacing:1px;">${(u.plan||'FREE').toUpperCase()}</span>
          ${u.niche||u.skills ? `<span style="background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:4px;padding:2px 8px;font-family:'DM Mono',monospace;font-size:8px;color:rgba(255,255,255,0.4);letter-spacing:0.5px;">${u.niche||u.skills}</span>` : ''}
        </div>
      </div>
      ${u.bio ? `<p style="font-size:12px;color:rgba(255,255,255,0.55);text-align:center;line-height:1.6;margin-bottom:18px;">${u.bio}</p>` : ''}
      <!-- Social links -->
      ${(u.tiktok||u.instagram||u.twitter||u.youtube) ? `
      <div style="display:flex;gap:8px;justify-content:center;margin-bottom:18px;flex-wrap:wrap;">
        ${u.tiktok?`<a href="${u.tiktok}" target="_blank" style="background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:6px;padding:4px 10px;font-family:'DM Mono',monospace;font-size:9px;color:rgba(255,255,255,0.5);text-decoration:none;">TikTok</a>`:''}
        ${u.instagram?`<a href="${u.instagram}" target="_blank" style="background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:6px;padding:4px 10px;font-family:'DM Mono',monospace;font-size:9px;color:rgba(255,255,255,0.5);text-decoration:none;">Instagram</a>`:''}
        ${u.twitter?`<a href="${u.twitter}" target="_blank" style="background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:6px;padding:4px 10px;font-family:'DM Mono',monospace;font-size:9px;color:rgba(255,255,255,0.5);text-decoration:none;">Twitter</a>`:''}
        ${u.youtube?`<a href="${u.youtube}" target="_blank" style="background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:6px;padding:4px 10px;font-family:'DM Mono',monospace;font-size:9px;color:rgba(255,255,255,0.5);text-decoration:none;">YouTube</a>`:''}
      </div>` : ''}
      <!-- Actions -->
      <div style="display:grid;grid-template-columns:1fr 1fr;gap:10px;">
        <button onclick="document.getElementById('vb-profile-popup').remove();openDMToUser('${u.email||userId}','${u.name||'Creator'}')" style="padding:10px;background:linear-gradient(135deg,#15803d,#22c55e);border:none;border-radius:10px;font-family:'DM Mono',monospace;font-size:10px;font-weight:800;color:#040a05;cursor:pointer;letter-spacing:1px;">💬 MESSAGE</button>
        <button onclick="document.getElementById('vb-profile-popup').remove()" style="padding:10px;background:rgba(255,255,255,0.05);border:1.5px solid rgba(255,255,255,0.1);border-radius:10px;font-family:'DM Mono',monospace;font-size:10px;font-weight:700;color:rgba(255,255,255,0.5);cursor:pointer;letter-spacing:1px;">CLOSE</button>
      </div>
    </div>`;

  document.body.appendChild(popup);
}

// ══════════════════════════════════════════
//  VIDEO FILTER
// ══════════════════════════════════════════
function filterVideos(type, btn) {
  document.querySelectorAll('#tab-videos .feed-tab').forEach(t => t.classList.remove('active'));
  if (btn) btn.classList.add('active');
  document.querySelectorAll('.video-card').forEach(card => {
    if (type === 'all') {
      card.style.display = '';
    } else {
      const f = (card.dataset.filter || '');
      card.style.display = f.includes(type) ? '' : 'none';
    }
  });
}

function searchVideos(q) {
  q = q.toLowerCase();
  document.querySelectorAll('.video-card').forEach(card => {
    const txt = card.textContent.toLowerCase();
    card.style.display = (!q || txt.includes(q)) ? '' : 'none';
  });
}

// ══════════════════════════════════════════
//  LIVE STUDIO
// ══════════════════════════════════════════
let liveStream = null;
let liveActive = false;
let liveViewerInterval = null;

async function startLiveCamera() {
  try {
    liveStream = await navigator.mediaDevices.getUserMedia({ video: true, audio: true });
    const video = document.getElementById('live-camera-preview');
    video.srcObject = liveStream;
    video.style.display = 'block';
    document.getElementById('live-camera-placeholder').style.display = 'none';
    document.getElementById('live-cam-btn').textContent = '📷 Camera ON';
    document.getElementById('live-cam-btn').style.borderColor = 'rgba(34,197,94,0.5)';
    document.getElementById('live-cam-btn').style.color = '#4ade80';
    toast('✅ Camera started — you\'re ready to go live!');
  } catch (e) {
    toast('⚠️ Camera access denied. Please allow camera in your browser.');
  }
}

function toggleLiveMic() {
  if (!liveStream) { toast('⚠️ Start your camera first'); return; }
  const audioTrack = liveStream.getAudioTracks()[0];
  if (!audioTrack) return;
  audioTrack.enabled = !audioTrack.enabled;
  const btn = document.getElementById('live-mic-btn');
  btn.textContent = audioTrack.enabled ? '🎙️ Mic ON' : '🔇 Mic OFF';
  btn.style.color = audioTrack.enabled ? '#4ade80' : '#f87171';
}

async function startScreenShare() {
  try {
    const screenStream = await navigator.mediaDevices.getDisplayMedia({ video: true });
    const video = document.getElementById('live-camera-preview');
    video.srcObject = screenStream;
    video.style.display = 'block';
    document.getElementById('live-camera-placeholder').style.display = 'none';
    document.getElementById('live-screen-btn').textContent = '🖥️ Sharing';
    document.getElementById('live-screen-btn').style.color = '#4ade80';
    toast('✅ Screen sharing started');
  } catch (e) {
    toast('⚠️ Screen share cancelled');
  }
}

function startLiveBroadcast() {
  const title = (document.getElementById('live-title')||{}).value?.trim();
  const cat = (document.getElementById('live-category')||{}).value;
  if (!title) { toast('⚠️ Please enter a live title'); return; }
  if (!cat) { toast('⚠️ Please select a category'); return; }
  liveActive = true;
  document.getElementById('live-on-air').style.display = 'flex';
  document.getElementById('live-viewer-count').style.display = 'block';
  document.getElementById('btn-go-live').style.display = 'none';
  document.getElementById('btn-end-live').style.display = 'block';
  document.getElementById('live-status-badge').style.display = 'flex';
  // Simulate viewers
  let v = 0;
  liveViewerInterval = setInterval(() => {
    v = Math.min(v + Math.floor(Math.random() * 8), 999);
    const el = document.getElementById('live-viewers-num');
    if (el) el.textContent = v;
    addLiveChatMsg('👋 A new viewer joined');
  }, 4000);
  toast('🔴 You are now LIVE! Your followers have been notified.');
}

function endLiveBroadcast() {
  liveActive = false;
  clearInterval(liveViewerInterval);
  document.getElementById('live-on-air').style.display = 'none';
  document.getElementById('live-viewer-count').style.display = 'none';
  document.getElementById('btn-go-live').style.display = 'flex';
  document.getElementById('btn-end-live').style.display = 'none';
  document.getElementById('live-status-badge').style.display = 'none';
  toast('⏹ Live ended. Your replay has been saved to the Videos tab.');
}

function addLiveChatMsg(text, name) {
  const box = document.getElementById('live-chat-msgs');
  if (!box) return;
  const placeholder = box.querySelector('[style*="Chat messages"]');
  if (placeholder) placeholder.remove();
  const msg = document.createElement('div');
  msg.style.cssText = 'background:var(--s2);border-radius:7px;padding:7px 10px;';
  msg.innerHTML = `<div style="font-size:10px;font-weight:700;color:var(--g4);margin-bottom:2px;">${name||'👤 Viewer'}</div><div style="font-size:12px;color:#7a9a82;">${text}</div>`;
  box.appendChild(msg);
  box.scrollTop = box.scrollHeight;
  const cnt = document.getElementById('live-chat-count');
  if (cnt) cnt.textContent = box.children.length + ' messages';
}

function sendLiveChatMsg() {
  const input = document.getElementById('live-chat-input');
  if (!input || !input.value.trim()) return;
  const user = JSON.parse(localStorage.getItem('viralboost_user')||'{}');
  addLiveChatMsg(input.value.trim(), user.name || 'You');
  input.value = '';
}

function previewLiveThumb(input) {
  if (!input.files[0]) return;
  const area = document.getElementById('live-thumb-area');
  const reader = new FileReader();
  reader.onload = e => {
    area.style.background = `url(${e.target.result}) center/cover`;
    area.style.borderStyle = 'solid';
    area.innerHTML = '<div style="background:rgba(0,0,0,0.5);border-radius:8px;padding:6px 12px;font-size:11px;color:#fff;">✓ Thumbnail set</div>';
  };
  reader.readAsDataURL(input.files[0]);
}

// ══════════════════════════════════════════
//  VIDEO CREATOR
// ══════════════════════════════════════════
function handleVideoUpload(input) {
  if (!input.files[0]) return;
  const file = input.files[0];
  const url = URL.createObjectURL(file);
  const preview = document.getElementById('vc-video-preview');
  const info = document.getElementById('vc-video-info');
  const idle = document.getElementById('vc-upload-idle');
  const previewDiv = document.getElementById('vc-upload-preview');
  preview.src = url;
  idle.style.display = 'none';
  previewDiv.style.display = 'block';
  preview.onloadedmetadata = () => {
    const dur = preview.duration;
    const mins = Math.floor(dur / 60);
    const secs = Math.floor(dur % 60);
    const sizeMB = (file.size / 1024 / 1024).toFixed(1);
    info.textContent = `⏱ ${mins}m ${secs}s · 📁 ${sizeMB} MB · ${file.name}`;
    const warning = document.getElementById('vc-duration-warning');
    const val = document.getElementById('vc-duration-val');
    if (dur < 180) {
      if (warning) { warning.style.display = 'flex'; }
      if (val) val.textContent = `${mins}m ${secs}s`;
    } else {
      if (warning) warning.style.display = 'none';
      toast(`✅ Video loaded: ${mins}m ${secs}s — ready to publish!`);
    }
  };
}

function previewVideoThumb(input) {
  if (!input.files[0]) return;
  const preview = document.getElementById('vc-thumb-preview');
  const reader = new FileReader();
  reader.onload = e => {
    preview.innerHTML = `<img src="${e.target.result}" style="width:100%;max-height:120px;object-fit:cover;border-radius:8px;"/>`;
  };
  reader.readAsDataURL(input.files[0]);
}

function publishVideo() {
  const title = (document.getElementById('vc-title')||{}).value?.trim();
  const desc = (document.getElementById('vc-description')||{}).value?.trim();
  const file = document.getElementById('vc-file-input')?.files[0];
  if (!file) { toast('⚠️ Please upload a video first'); return; }
  if (!title) { toast('⚠️ Please add a title'); return; }
  if (!desc) { toast('⚠️ Please add a description'); return; }
  const video = document.getElementById('vc-video-preview');
  if (video && video.duration && video.duration < 180) {
    toast('⚠️ Your video must be at least 3 minutes long');
    return;
  }
  const btn = document.getElementById('btn-publish-video');
  if (btn) { btn.textContent = '⏳ Uploading…'; btn.disabled = true; }
  setTimeout(() => {
    if (btn) { btn.textContent = '✅ Published!'; btn.style.background = 'linear-gradient(135deg,#15803d,#22c55e)'; }
    toast('🎬 Your video has been published and is now visible in the Videos tab!');
    setTimeout(() => {
      if (btn) { btn.textContent = '🎬 Publish Video'; btn.disabled = false; btn.style.background = ''; }
    }, 4000);
  }, 2000);
}


function showAdLiveNotif(brand, placement, total) {
  const existing = document.getElementById('vb-ad-live-notif');
  if (existing) existing.remove();

  const placementLabels = {
    'feed-banner':'Feed Post','popup-banner':'Popup Banner','showcase-top':'Showcase Top',
    'home-hero':'Home Banner','push-notif':'Push Blast','full-package':'Full Package','hanging-card':'Hanging Card'
  };
  const label = placementLabels[placement] || placement;

  const notif = document.createElement('div');
  notif.id = 'vb-ad-live-notif';
  notif.style.cssText = `position:fixed;top:20px;left:50%;transform:translateX(-50%) translateY(-120px);z-index:9999999;min-width:320px;max-width:420px;opacity:0;transition:all 0.5s cubic-bezier(0.34,1.3,0.64,1);pointer-events:none;`;
  notif.innerHTML = `
    <div style="background:linear-gradient(135deg,#0b2e14,#0f3d1c);border:1.5px solid rgba(34,197,94,0.5);border-radius:16px;padding:14px 18px;display:flex;align-items:center;gap:14px;box-shadow:0 0 40px rgba(34,197,94,0.2),0 12px 40px rgba(0,0,0,0.6);">
      <div style="width:42px;height:42px;border-radius:50%;background:linear-gradient(135deg,#15803d,#22c55e);display:flex;align-items:center;justify-content:center;font-size:20px;flex-shrink:0;">🎉</div>
      <div style="flex:1;min-width:0;">
        <div style="font-family:'Plus Jakarta Sans',sans-serif;font-size:13px;font-weight:800;color:#f0fdf4;margin-bottom:2px;">Campaign is now LIVE!</div>
        <div style="font-family:'DM Mono',monospace;font-size:10px;color:#22c55e;letter-spacing:0.5px;">"${brand}" · ${label} · $${parseFloat(total).toFixed(2)}/mo</div>
      </div>
      <div style="width:8px;height:8px;border-radius:50%;background:#22c55e;box-shadow:0 0 10px rgba(34,197,94,0.9);animation:vb-pulse 1s ease-in-out infinite;flex-shrink:0;"></div>
    </div>`;

  // Add pulse keyframe if not already there
  if (!document.getElementById('vb-pulse-style')) {
    const s = document.createElement('style');
    s.id = 'vb-pulse-style';
    s.textContent = `@keyframes vb-pulse{0%,100%{transform:scale(1);opacity:1;}50%{transform:scale(1.4);opacity:0.6;}}`;
    document.head.appendChild(s);
  }

  document.body.appendChild(notif);
  requestAnimationFrame(() => requestAnimationFrame(() => {
    notif.style.opacity = '1';
    notif.style.transform = 'translateX(-50%) translateY(0)';
    notif.style.pointerEvents = 'all';
  }));
  setTimeout(() => {
    notif.style.opacity = '0';
    notif.style.transform = 'translateX(-50%) translateY(-120px)';
    setTimeout(() => notif.remove(), 500);
  }, 5000);
}

// ══════════════════════════════════════════
//  PAGE ADVERTISE
// ══════════════════════════════════════════
function toggleAdvertisePage() {
  const adv = document.getElementById('advertise');
  const footer = document.querySelector('#landing footer');
  if (!adv) return;
  const isOpen = adv.style.display !== 'none';
  if (isOpen) {
    adv.style.display = 'none';
    document.querySelector('#landing .landing-hero')?.scrollIntoView({ behavior:'smooth' });
  } else {
    adv.style.display = 'block';
    setTimeout(() => adv.scrollIntoView({ behavior:'smooth', block:'start' }), 50);
  }
}

function submitAdvertiseForm() {
  const name  = (document.getElementById('adv-name')||{}).value?.trim();
  const email = (document.getElementById('adv-email')||{}).value?.trim();
  const format= (document.getElementById('adv-format')||{}).value;
  const msg   = (document.getElementById('adv-msg')||{}).value?.trim();
  if (!name || !email) { toast('⚠️ Please fill in your name and email'); return; }
  if (!email.includes('@')) { toast('⚠️ Please enter a valid email'); return; }

  // Simulate submission
  const btn = document.querySelector('#advertise button[onclick="submitAdvertiseForm()"]');
  if (btn) { btn.textContent = 'SENDING…'; btn.disabled = true; }

  setTimeout(() => {
    if (btn) {
      btn.textContent = '✅ INQUIRY SENT!';
      btn.style.background = 'linear-gradient(135deg,#15803d,#22c55e)';
    }
    toast('✅ We\'ll get back to you within 24h, ' + name.split(' ')[0] + '!');
    // Clear form
    ['adv-name','adv-email','adv-msg'].forEach(id => {
      const el = document.getElementById(id);
      if (el) el.value = '';
    });
    const sel = document.getElementById('adv-format');
    if (sel) sel.selectedIndex = 0;
    setTimeout(() => {
      if (btn) {
        btn.textContent = 'SEND INQUIRY →';
        btn.disabled = false;
        btn.style.background = 'linear-gradient(135deg,#f43f5e,#be123c)';
      }
    }, 4000);
  }, 1200);
}
</script>


<!-- ═══ MODALS AUTH — placés hors de #app ═══ -->




<script>
// ═══ AUTH SYSTEM — REWRITTEN FROM SCRATCH ═══

function vbShowLogin() {
  var modal = document.getElementById('login-modal');
  // Déplacer dans body si nécessaire pour éviter display:none du parent
  if (modal.parentElement !== document.body) document.body.appendChild(modal);
  document.querySelectorAll('.modal-bg').forEach(m => m.classList.remove('open'));
  modal.classList.add('open');
}

function vbShowSignup() {
  var modal = document.getElementById('signup-modal');
  if (modal.parentElement !== document.body) document.body.appendChild(modal);
  document.querySelectorAll('.modal-bg').forEach(m => m.classList.remove('open'));
  modal.classList.add('open');
}

function vbLogin() {
  var email = (document.getElementById('l-email').value || '').trim().toLowerCase();
  var pass  = (document.getElementById('l-pass').value  || '');
  if (!email || !pass) { toast('⚠️ Fill in all fields.'); return; }

  // Super admin
  if (email === 'soug759@gmail.com' && pass === 'Carla123') {
    currentUser = { id: email, name: 'Admin', username: 'admin_viralboost', email: email,
      plan: 'elite', avatar: '👑', isSuperAdmin: true, followers:[], following:[], projects:[], totalVotes:0, createdAt: new Date().toISOString() };
    localStorage.setItem('viralboost_user', JSON.stringify(currentUser));
    document.getElementById('login-modal').classList.remove('open');
    showApp();
    showAppTab('home', document.querySelector('.app-tab[data-tab="home"]'));
    setTimeout(renderHomeTab, 200);
    return;
  }

  // Compte normal
  try {
    var accounts = JSON.parse(localStorage.getItem('vb_accounts') || '{}');
    var acc = accounts[email];
    if (!acc) { toast('❌ No account found. Sign up!'); return; }
    if (acc._pass && acc._pass !== pass) { toast('❌ Wrong password.'); return; }
    currentUser = acc;
    localStorage.setItem('viralboost_user', JSON.stringify(currentUser));
    document.getElementById('login-modal').classList.remove('open');
    showApp();
    showAppTab('home', document.querySelector('.app-tab[data-tab="home"]'));
    setTimeout(renderHomeTab, 200);
  } catch(e) { toast('❌ Login error.'); }
}

function vbSignup() {
  var email = (document.getElementById('s-email').value || '').trim();
  var pass  = (document.getElementById('s-pass').value  || '');
  if (!email || !pass)      { toast('⚠️ Fill in email and password.'); return; }
  if (!email.includes('@')) { toast('⚠️ Invalid email.'); return; }
  if (pass.length < 8)      { toast('⚠️ Password too short (8 chars min).'); return; }
  var name = email.split('@')[0];
  createUser({ name: name, username: name, email: email, plan: 'free', pass: pass });
  document.getElementById('signup-modal').classList.remove('open');
  showApp();
  showAppTab('home', document.querySelector('.app-tab[data-tab="home"]'));
  setTimeout(renderHomeTab, 200);
  setTimeout(function(){ if(typeof openOnboarding==='function') openOnboarding(); }, 1000);
}

function vbStartDemo() {
  document.querySelectorAll('.modal-bg').forEach(m => m.classList.remove('open'));
  var saved = localStorage.getItem('viralboost_user');
  if (saved) {
    try {
      var u = JSON.parse(saved);
      if (u && u.email && !u.isDemo) { currentUser = u; showApp(); return; }
    } catch(e) {}
  }
  if (typeof startDemo === 'function') startDemo();
  else {
    currentUser = { name:'Demo Visitor', username:'demo_visitor', email:'demo@viralboost.app',
      plan:'free', avatar:'👀', isDemo:true, followers:[], following:[], projects:[], totalVotes:0 };
    showApp();
  }
}

// Patcher openModal pour login/signup → utiliser nos nouvelles fonctions
var _origOM = window.openModal;
window.openModal = function(id) {
  if (id === 'login-modal')  { vbShowLogin();  return; }
  if (id === 'signup-modal') { vbShowSignup(); return; }
  if (typeof _origOM === 'function') _origOM(id);
  else { var el = document.getElementById(id); if(el) el.classList.add('open'); }
};
</script>

</main>
</body>
</html>

<div class="modal-bg" id="signup-modal">
  <div class="modal wide">
    <button class="modal-close" onclick="this.closest('.modal-bg').classList.remove('open')">✕</button>
    <div class="signup-header">
      <div class="signup-logo">⚡ VIRALBOOST</div>
      <h2 class="signup-title">Join the community</h2>
      <p class="signup-subtitle">Free · No card · 30 seconds</p>
    </div>
    <div class="signup-benefits">
      <div class="signup-benefit">✅ Publish your ad in front of thousands of creators</div>
      <div class="signup-benefit">✅ Find collaborators via AI matching</div>
      <div class="signup-benefit">✅ Access community chat &amp; groups</div>
    </div>
    <div class="signup-form">
      <input type="email" id="s-email" placeholder="📧 Your email *" class="signup-input"/>
      <input type="password" id="s-pass" placeholder="🔒 Password (8 chars min.) *" class="signup-input"/>
    </div>
    <div style="display:none"><div class="signup-plans" id="signup-plans-grid"></div></div>
    <button class="btn-signup-big" onclick="vbSignup()">Create my free account</button>
    <div class="signup-footer-note">✓ Free forever · Upgrade anytime</div>
    <div class="modal-switch">Already have an account? <a href="#plans" onclick="vbShowLogin();return false;" style="cursor:pointer">Log in</a></div>
  </div>
</div>

<div class="modal-bg" id="login-modal">
  <div class="modal">
    <button class="modal-close" onclick="this.closest('.modal-bg').classList.remove('open')">✕</button>
    <h2>LOG IN</h2>
    <div class="modal-sub">WELCOME BACK 👋</div>
    <div class="fg"><label>Email</label><input type="email" id="l-email" placeholder="hello@example.com"/></div>
    <div class="fg"><label>Password</label><input type="password" id="l-pass" placeholder="Your password"/></div>
    <button class="btn-modal-g" onclick="vbLogin()">Log in →</button>
    <div class="modal-switch">No account? <a href="#plans" onclick="vbShowSignup();return false;" style="cursor:pointer">Sign up</a></div>
  </div>
</div>

<script>
// ═══ GA4 EVENTS TRACKING ═══
function gaEvent(name, params) {
  if (typeof window.gtag === 'function') {
    window.gtag('event', name, params || {});
  }
}

// — AUTH —
(function() {
  var _origSignup = window.vbSignup;
  window.vbSignup = function() {
    var r = _origSignup.apply(this, arguments);
    gaEvent('sign_up', { method: 'email' });
    return r;
  };
  var _origLogin = window.vbLogin;
  window.vbLogin = function() {
    var r = _origLogin.apply(this, arguments);
    gaEvent('login', { method: 'email' });
    return r;
  };
  var _origDemo = window.vbStartDemo;
  window.vbStartDemo = function() {
    gaEvent('demo_start');
    return _origDemo.apply(this, arguments);
  };
})();

// — PUBLICATION —
document.addEventListener('DOMContentLoaded', function() {
  var _origPublish = window.publishProject;
  if (_origPublish) window.publishProject = function() {
    var r = _origPublish.apply(this, arguments);
    var type = document.getElementById('pub-type')?.value || 'unknown';
    gaEvent('ad_published', { ad_type: type, user_plan: window.currentUser?.plan || 'free' });
    return r;
  };

  // — CAMPAIGN —
  var _origBc = window.bcRender;
  if (_origBc) window.bcRender = function() {
    gaEvent('campaign_tools_viewed');
    return _origBc.apply(this, arguments);
  };

  // — SPONSOR —
  var _origSponsor = window.showSponsorTab;
  if (_origSponsor) window.showSponsorTab = function() {
    gaEvent('sponsor_panel_viewed');
    return _origSponsor.apply(this, arguments);
  };

  // — AD CREATOR —
  var _origPub = window.showPubCreatorTab;
  if (_origPub) window.showPubCreatorTab = function() {
    gaEvent('ad_creator_viewed');
    return _origPub.apply(this, arguments);
  };

  // — SHOP —
  var _origShop = window.shopBuy;
  if (_origShop) window.shopBuy = function(item, price) {
    gaEvent('purchase', { item_id: item, value: price, currency: 'credits' });
    return _origShop.apply(this, arguments);
  };

  // — TAB NAVIGATION —
  var _origShowTab = window.showAppTab;
  if (_origShowTab) window.showAppTab = function(tab, el) {
    gaEvent('tab_viewed', { tab_name: tab });
    return _origShowTab.apply(this, arguments);
  };
});

// — UPGRADE CLICK —
document.addEventListener('click', function(e) {
  var t = e.target.closest('button, a');
  if (!t) return;
  var oc = (t.getAttribute('onclick') || '') + (t.textContent || '');
  if (oc.match(/upgrade|boost-credits|Pro|Elite|Premium/i)) {
    gaEvent('upgrade_clicked', { user_plan: window.currentUser?.plan || 'free' });
  }
});
</script>
<script>
// ═══ GA4 EVENTS — PACK 2 ═══
document.addEventListener('DOMContentLoaded', function() {

  // — LIKE POST —
  var _origLike = window.likePost;
  if (_origLike) window.likePost = function(id, btn) {
    gaEvent('like_post', { post_id: id, user_plan: window.currentUser?.plan || 'free' });
    return _origLike.apply(this, arguments);
  };

  // — SHARE POST —
  var _origShare = window.sharePost;
  if (_origShare) window.sharePost = function(id, btn) {
    gaEvent('share', { content_type: 'post', item_id: id });
    return _origShare.apply(this, arguments);
  };

  // — BIG CAMPAIGN STARTED —
  var _origBcSave = window.bcSaveAll;
  if (_origBcSave) window.bcSaveAll = function(data) {
    if (data && data.length) gaEvent('big_campaign_started', { user_plan: window.currentUser?.plan || 'free' });
    return _origBcSave.apply(this, arguments);
  };

  // — AD SLOT BOOKED —
  var _origSpSelect = window.spSelectSlot;
  if (_origSpSelect) window.spSelectSlot = function(slot) {
    gaEvent('ad_slot_booked', { slot_name: slot, user_plan: window.currentUser?.plan || 'free' });
    return _origSpSelect.apply(this, arguments);
  };

  // — PLANS PAGE VIEWED —
  var _origScrollPlans = window.scrollToPricing;
  document.querySelectorAll('a[href="#plans"]').forEach(function(el) {
    el.addEventListener('click', function() {
      gaEvent('plan_viewed');
    });
  });

  // — LOGIN FAILED —
  var _origVbLogin = window.vbLogin;
  if (_origVbLogin) window.vbLogin = function() {
    var email = (document.getElementById('l-email')?.value || '').trim();
    var pass  = (document.getElementById('l-pass')?.value  || '');
    try {
      var accounts = JSON.parse(localStorage.getItem('vb_accounts') || '{}');
      if (!accounts[email]) gaEvent('login_failed', { reason: 'no_account' });
      else if (accounts[email]._pass && accounts[email]._pass !== pass) gaEvent('login_failed', { reason: 'wrong_password' });
    } catch(e) {}
    return _origVbLogin.apply(this, arguments);
  };

  // — PUBLISH FAILED —
  var _origPublish2 = window.publishProject;
  if (_origPublish2) window.publishProject = function() {
    var name = document.getElementById('pub-name')?.value.trim() || '';
    var desc = document.getElementById('pub-desc')?.value.trim() || '';
    if (!name || !desc || name.length < 4 || desc.length < 20) {
      gaEvent('publish_failed', { reason: !name ? 'no_name' : !desc ? 'no_desc' : 'too_short' });
    }
    return _origPublish2.apply(this, arguments);
  };

  // — PAYWALL HIT —
  var _origToast = window.toast;
  if (_origToast) window.toast = function(msg, type) {
    if (type === 'error' && msg && msg.toLowerCase().includes('upgrade')) {
      gaEvent('paywall_hit', { user_plan: window.currentUser?.plan || 'free', message: msg });
    }
    return _origToast.apply(this, arguments);
  };

  // — PROFILE COMPLETED —
  var _origSaveProfile = window.saveProfile;
  if (_origSaveProfile) window.saveProfile = function() {
    var r = _origSaveProfile.apply(this, arguments);
    var u = window.currentUser;
    if (u && u.name && u.bio && u.avatarUrl) {
      gaEvent('profile_completed', { user_plan: u.plan || 'free' });
    }
    return r;
  };

  // — RETURN VISITOR —
  var visits = parseInt(localStorage.getItem('vb_visit_count') || '0') + 1;
  localStorage.setItem('vb_visit_count', visits);
  if (visits === 2) gaEvent('return_visitor');
  if (visits >= 5) gaEvent('loyal_visitor', { visit_count: visits });

  // — SESSION DEPTH (nb tabs visités) —
  var _tabsVisited = [];
  var _origShowTab2 = window.showAppTab;
  if (_origShowTab2) window.showAppTab = function(tab, el) {
    if (!_tabsVisited.includes(tab)) {
      _tabsVisited.push(tab);
      if (_tabsVisited.length === 3) gaEvent('session_depth', { depth: 3 });
      if (_tabsVisited.length === 5) gaEvent('session_depth', { depth: 5 });
      if (_tabsVisited.length === 10) gaEvent('session_depth', { depth: 10 });
    }
    return _origShowTab2.apply(this, arguments);
  };

  // — COLLAB REQUEST —
  var _origCollab = window.sendCollabRequest;
  if (_origCollab) window.sendCollabRequest = function() {
    gaEvent('collab_request', { user_plan: window.currentUser?.plan || 'free' });
    return _origCollab.apply(this, arguments);
  };

  // — VIDEO START —
  document.addEventListener('click', function(e) {
    var btn = e.target.closest('button, [onclick]');
    if (!btn) return;
    var oc = btn.getAttribute('onclick') || btn.textContent || '';
    if (oc.includes('live-studio') || oc.includes('Go Live') || oc.includes('Start Your Live')) {
      gaEvent('live_started', { user_plan: window.currentUser?.plan || 'free' });
    }
    if (oc.includes('video-creator') || oc.includes('Upload Video')) {
      gaEvent('video_upload_started', { user_plan: window.currentUser?.plan || 'free' });
    }
  });

});
</script>
